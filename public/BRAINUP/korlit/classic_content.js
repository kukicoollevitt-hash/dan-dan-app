/**
 * ✅ 단원 자동 인식 (강화)
 * 우선순위: HTML에서 미리 설정된 CUR_UNIT → ?unit=classic_XX → 파일명 classic_XX.html → 제목 숫자
 */
(function () {
  // 이미 설정된 CUR_UNIT이 있고, classic_로 시작하면 덮어쓰지 않음
  if (window.CUR_UNIT && window.CUR_UNIT.startsWith('classic_')) {
    console.log('[classic_content.js] CUR_UNIT 이미 설정됨:', window.CUR_UNIT);
    return;
  }

  const qs = new URLSearchParams(location.search).get('unit');
  let unit = null;

  if (qs) {
    const m = qs.toLowerCase().match(/classic[_-]?(\d{1,2})/);
    if (m) unit = `classic_${m[1].padStart(2, '0')}`;
  }

  if (!unit) {
    const m2 = location.pathname.toLowerCase().match(/classic[_-]?(\d{1,2})\.html/);
    if (m2) unit = `classic_${m2[1].padStart(2, '0')}`;
  }

  if (!unit && document.title) {
    const m3 = document.title.match(/(\d{1,2})/);
    if (m3) unit = `classic_${m3[1].padStart(2, '0')}`;
  }

  window.CUR_UNIT = unit || 'classic_01';
})();

/* ===============================
   ✅ 전역 CONTENTS 준비 (단일화)
   =============================== */
window.CONTENTS = window.CONTENTS || {};

/* ===== 콘텐츠 팩: 단원별 지문/어휘/문제/정답 =====
   ✅ 기존 const CONTENTS = {...} → window.CONTENTS 에 합치기
*/
window.CONTENTS = Object.assign(window.CONTENTS, {
  /* ===== classic_01 : "춘향과 몽룡의 약속" ===== */
  classic_01: {
    labelNo: '01',
    title: '📜 춘향과 몽룡의 약속',
    passage: [
      '옛날 전라도 남원에 <b>월매</b>라는 <b>기생</b>이 살았어요. 월매는 어느 날 꿈에서 선녀가 내려와 아이를 안겨 주었고, 그 뒤로 예쁜 딸을 낳아 이름을 \'춘향\'이라고 지었어요. 춘향은 자라면서 마을에서 가장 예쁘고 마음씨 착한 아이가 되었어요.',
      '어느 <b>단오</b>날, 춘향은 그네를 타러 광한루에 나갔어요. 마침 남원 부사의 아들 이몽룡도 그곳에 구경 나왔다가 춘향을 보고 첫눈에 반했지요. 몽룡은 하인 방자를 시켜 춘향을 불러오게 했어요.',
      '둘은 만나자마자 서로 마음이 통했어요. 춘향은 기생의 딸이었지만 공부도 잘하고 예의도 바른 아이였어요. 몽룡은 춘향을 아끼며 <b>약속했어요</b>. "내가 <b>한양</b>에 가서 <b>벼슬</b>에 오르면 꼭 돌아와 너를 데려가겠다."',
      '얼마 후, 몽룡의 아버지가 다른 곳으로 <b>부임하게</b> 되어 몽룡은 한양으로 떠나야 했어요. 춘향은 눈물을 흘리며 몽룡을 배웅했지만, 둘은 다시 만날 날을 굳게 약속했어요.',
      '몽룡이 떠난 뒤, 남원에 새로운 사또 변학도가 <b>부임했어요</b>. 변학도는 욕심이 많고 나쁜 사람이었어요. 그는 춘향이 예쁘다는 소문을 듣고 <b>관아</b>로 불렀어요. "내 수청을 들라!"',
      '하지만 춘향은 단호하게 거절했어요. "저는 이미 이몽룡 도련님과 약속한 사람입니다!" 변학도는 화가 나서 춘향을 감옥에 가두고 <b>매를 때렸어요</b>. 춘향은 끝까지 몽룡을 기다리며 버텼어요.'
    ],
    vocab: [
      ['기생','옛날에 노래와 춤으로 손님을 접대하던 여자.'],
      ['부임하다','새로운 관직이나 직책을 맡아 그 자리에 가다.'],
      ['관아','옛날에 지방 관리가 일하던 관청.'],
      ['매를 맞다','벌로 막대기 등으로 맞는 것.'],
      ['한양','조선 시대의 수도, 지금의 서울.'],
      ['단오','음력 5월 5일, 그네뛰기와 씨름을 하던 명절.'],
      ['약속하다','앞으로 어떤 일을 꼭 하기로 다짐하다.'],
      ['벼슬','옛날에 나라에서 받는 관직.']
    ],
    vocabFill: {
      instructions: '',
      items: [
        { no: 1, text: '월매는 노래와 춤으로 손님을 접대하는 (      )이었어요.', answer: '기생', initials: 'ㄱㅅ', aliases: ['기생'] },
        { no: 2, text: '몽룡의 아버지가 다른 곳으로 (         )되어 떠나야 했어요.', answer: '부임하게', initials: 'ㅂㅇㅎㄱ', aliases: ['부임하게','부임'] },
        { no: 3, text: '변학도는 춘향을 (      )로 불러 수청을 들라고 했어요.', answer: '관아', initials: 'ㄱㅇ', aliases: ['관아'] },
        { no: 4, text: '춘향은 거절했다가 감옥에 갇히고 (         ).', answer: '매를 맞았어요', initials: 'ㅁㄹ ㅁㅈㅇㅇ', aliases: ['매를맞았어요','매를 맞았어요','매를맞다'] },
        { no: 5, text: '몽룡은 (      )에 가서 과거 시험을 보겠다고 했어요.', answer: '한양', initials: 'ㅎㅇ', aliases: ['한양'] },
        { no: 6, text: '춘향과 몽룡이 처음 만난 날은 (      )날이었어요.', answer: '단오', initials: 'ㄷㅇ', aliases: ['단오'] },
        { no: 7, text: '몽룡은 춘향에게 꼭 돌아오겠다고 (         ).', answer: '약속했어요', initials: 'ㅇㅅㅎㅇㅇ', aliases: ['약속했어요','약속하다','약속'] },
        { no: 8, text: '몽룡은 한양에서 (      )에 올라 암행어사가 되어 돌아왔어요.', answer: '벼슬', initials: 'ㅂㅅ', aliases: ['벼슬'] }
      ]
    },
    quiz: {
      q1_text: '춘향이 변학도의 요구를 거절한 가장 큰 이유는 무엇인가요?',
      q1_opts: [
        '① 변학도가 무서웠기 때문이다.',
        '② 이미 몽룡과 약속한 사람이기 때문이다.',
        '③ 기생이 아니었기 때문이다.',
        '④ 월매가 허락하지 않았기 때문이다.'
      ],
      q2_text: '이야기의 전개 순서로 올바른 것은 무엇인가요?',
      q2_opts: [
        '① 단오날 만남 → 몽룡 이별 → 변학도 부임 → 감옥',
        '② 변학도 부임 → 단오날 만남 → 감옥 → 몽룡 이별',
        '③ 감옥 → 단오날 만남 → 변학도 부임 → 몽룡 이별',
        '④ 몽룡 이별 → 감옥 → 단오날 만남 → 변학도 부임'
      ],
      q3_1_ph: 'ㄱㅅ', q3_2_ph: 'ㄷㅇ',
      q4_1_ph: 'ㅎㅇ', q4_2_ph: 'ㅂㅅ',
      q5_text: '춘향이 끝까지 몽룡을 기다린 행동에서 우리가 배울 수 있는 점은 무엇인지 자신의 생각을 써 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['기생'], q3_2:['단오'], q4_1:['한양'], q4_2:['벼슬'] },
    essayKeywords: ['약속','믿음','사랑','기다림','신뢰','진심'],
    explain: {
      q1:'해설: 춘향은 이미 몽룡과 굳게 약속한 사이였기에 변학도의 요구를 거절했습니다.',
      q2:'해설: 단오날 만남 → 몽룡 한양 이별 → 변학도 부임 → 감옥 순서입니다.',
      q3:'해설: 월매는 기생이었고, 춘향과 몽룡은 단오날 광한루에서 처음 만났습니다.',
      q4:'해설: 몽룡은 한양에 가서 벼슬에 오르겠다고 약속했습니다.',
      q5:'예시: 춘향은 어려운 상황에서도 약속을 지키려 했어요. 우리도 한번 한 약속은 끝까지 지키는 것이 중요합니다.'
    }
  },

  /* ===== classic_02 : "어사 이도령과 춘향의 재회" ===== */
  classic_02: {
    labelNo: '02',
    title: '⚖️ 어사 이도령과 춘향의 재회',
    passage: [
      '한양으로 올라간 이도령은 과거 시험에서 으뜸으로 급제해 <b>암행어사</b> 임무를 받게 되었어요. 그는 백성의 삶을 살피기 위해 거지처럼 변장한 뒤 전라도 땅으로 내려갔지요. 그곳에서 남원을 어지럽히고 있던 변 사또의 횡포로, 춘향이 <b>수청</b>을 거절했다는 이유로 매질을 당하고 감옥에 갇혀 있다는 소식을 듣습니다. 이도령은 곧장 남원으로 향해 월매의 집을 찾아갔지만, 누추한 차림을 본 월매는 그를 내쫓듯 <b>박대</b>했어요. 그러나 <b>향단</b>은 눈빛만 보고도 그가 이도령임을 알아차린 듯 정성껏 대접하며 숨은 뜻을 헤아렸습니다.',
      '신분을 드러내지 않은 채 감옥으로 들어간 이도령은 쇠창살 너머로 춘향을 보며 마음이 무너졌습니다. 하지만 춘향은 그를 원망하기는커녕, 어머니에게 이도령을 잘 대해 달라고 당부했고 변 사또의 생일 잔치에서 죽임을 당하더라도 자신의 몸을 이도령의 <b>선산</b> 근처에 묻어 달라고 부탁했지요. 다음 날 잔치가 열리자, 거지 차림의 이도령은 조용히 자리에 앉아 <b>탐관오리</b>의 악행을 풍자하는 시를 읊어 사람들의 시선을 끌었습니다. 모두가 흩어지고 변 사또만 취해 있던 그때, "어사出두야!"라는 외침과 함께 관아 문이 열리고 봉황 문양의 <b>어사패</b>가 눈부시게 들어섰어요.',
      '어사 또가 된 이도령은 죄수들을 한 명씩 불러 억울함을 풀어 주기 시작했습니다. 마지막으로 춘향을 불러 수청을 들면 살려 주겠다고 일부러 시험하자, 춘향은 죽음을 택하겠다며 단호하게 거절했지요. 그 순간 이도령은 조용히 "얼굴을 들어 나를 보아라."라고 말했습니다. 춘향은 놀라움과 기쁨에 눈물을 흘리며 비로소 그가 이도령임을 알아보았어요. 이후 춘향과 월매, 향단은 이도령과 함께 한양으로 올라갔고, 임금은 이도령에게 더 높은 벼슬을 내리고 춘향에게는 절개를 지킨 여인에게 주는 칭호인 <b>정렬부인</b>이라는 이름을 내렸습니다. 두 사람은 혼인하여 오래도록 서로를 의지하며 평안한 삶을 살았답니다.'
    ],
    vocab: [
      ['암행어사','임금 몰래 지방을 살피던 관직.'],
      ['수청','여인이 상급자의 요구로 시중을 드는 일.'],
      ['박대','푸대접하거나 냉정하게 대하는 것.'],
      ['선산','조상의 묘가 있는 산.'],
      ['탐관오리','부정을 저지르며 백성을 괴롭히는 관리.'],
      ['어사패','암행어사의 신분을 증명하는 표식.'],
      ['정렬부인','절개를 지킨 여인에게 주는 칭호.'],
      ['향단','춘향의 몸종으로 충직한 인물.']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[어사 이도령과 춘향의 재회 어휘].',
      items: [
        { no: 1, text: '이도령은 과거에 급제해 (        ) 임무를 받았어요.', answer: '암행어사', initials: 'ㅇㅎㅇㅅ', aliases: ['암행어사'] },
        { no: 2, text: '춘향이 (      )을 거절했다는 이유로 감옥에 갇혔어요.', answer: '수청', initials: 'ㅅㅊ', aliases: ['수청'] },
        { no: 3, text: '월매는 거지 차림의 이도령을 (      )했어요.', answer: '박대', initials: 'ㅂㄷ', aliases: ['박대'] },
        { no: 4, text: '춘향은 자신의 몸을 이도령의 (      ) 근처에 묻어 달라고 부탁했어요.', answer: '선산', initials: 'ㅅㅅ', aliases: ['선산'] },
        { no: 5, text: '이도령은 (        )의 악행을 풍자하는 시를 읊었어요.', answer: '탐관오리', initials: 'ㅌㄱㅇㄹ', aliases: ['탐관오리'] },
        { no: 6, text: '봉황 문양의 (      )가 눈부시게 들어섰어요.', answer: '어사패', initials: 'ㅇㅅㅍ', aliases: ['어사패'] },
        { no: 7, text: '춘향에게 (        )이라는 칭호가 내려졌어요.', answer: '정렬부인', initials: 'ㅈㄹㅂㅇ', aliases: ['정렬부인'] },
        { no: 8, text: '(      )은 눈빛만 보고도 이도령임을 알아차렸어요.', answer: '향단', initials: 'ㅎㄷ', aliases: ['향단'] }
      ]
    },
    quiz: {
      q1_text: '향단이 거지 차림의 이도령을 알아보고 정성껏 대접한 이유로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 이도령이 미리 편지를 보냈기 때문이다.',
        '② 향단은 눈빛만으로 그가 이도령임을 알아차렸기 때문이다.',
        '③ 월매가 향단에게 귀띔해 주었기 때문이다.',
        '④ 이도령이 어사패를 먼저 보여 주었기 때문이다.'
      ],
      q2_text: '이 글의 서사 구조를 바르게 설명한 것은 무엇인가요?',
      q2_opts: [
        '① 현재 → 과거 회상 → 현재로 돌아오는 구조이다.',
        '② 이도령의 귀환 → 위기(시험) → 절정(재회) → 결말(행복)의 순차적 구조이다.',
        '③ 여러 인물의 시점이 번갈아 나타나는 다시점 구조이다.',
        '④ 결말을 먼저 제시하고 원인을 설명하는 역순행 구조이다.'
      ],
      q3_1_ph: 'ㅇㅎㅇㅅ', q3_2_ph: 'ㅅㅊ',
      q4_1_ph: 'ㅈㄹㅂㅇ', q4_2_ph: 'ㅈㄱ',
      q5_text: '춘향이 어사가 된 이도령 앞에서도 수청을 거절한 행동에서 알 수 있는 춘향의 성격과 가치관을 본문 내용을 바탕으로 써 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['암행어사'], q3_2:['수청'], q4_1:['정렬부인'], q4_2:['절개','절개를'] },
    essayKeywords: ['절개','신의','약속','사랑','충절','정절','일편단심','굳은','지조'],
    explain: {
      q1:'해설: 향단은 눈빛만 보고도 그가 이도령임을 알아차린 듯 정성껏 대접했다.',
      q2:'해설: 이도령의 귀환에서 시작해 위기(춘향 시험), 절정(재회), 결말(행복한 결혼)로 순차적으로 전개된다.',
      q3:'해설: 이도령은 암행어사가 되었고, 춘향은 수청을 거절했다는 이유로 감옥에 갇혔다.',
      q4:'해설: 춘향은 정렬부인이라는 칭호를 받았는데, 이는 절개를 지킨 여인에게 주는 칭호이다.',
      q5:'예시: 춘향은 죽음 앞에서도 수청을 거절하며 자신의 약속과 절개를 지켰다. 이를 통해 춘향이 신의와 지조를 중요하게 여기는 인물임을 알 수 있다.'
    }
  },

  /* ===== classic_03 : "홍계월, 물에서 건져 올린 운명" ===== */
  classic_03: {
    labelNo: '03',
    title: '🌊 홍계월, 물에서 건져 올린 운명',
    passage: [
      '명나라 시대, 홍계월은 높은 벼슬을 지낸 아버지의 외딸로 귀하게 자랐어요. 하지만 <b>간신</b>들이 <b>반란</b>을 일으키며 가족이 흩어지고, 계월은 <b>수적</b>들에게 붙잡혀 물에 던져지는 위험한 일을 겪습니다. 다행히도 무릉포에 살던 여공 부부가 우연히 그녀를 발견해 살려 주었고, 계월은 그 집에서 새 삶을 시작하게 되었지요. 부모를 잃은 슬픔 속에서도 계월은 여공의 아들과 함께 글과 무예를 익히며 차근차근 힘을 길러 갔습니다.',
      '세월이 흘러 계월은 뛰어난 실력으로 <b>장원</b>에 오르고, 여공의 아들 여보국 역시 부장원으로 합격하며 두 사람은 함께 이름을 알리게 됩니다. 그러던 중 나라에 외적이 침입하자 계월은 대<b>원수</b>로, 여보국은 부원수로 <b>제수</b>되어 전쟁터로 나가게 되었어요. 하지만 여보국은 원수의 지시를 제대로 따르지 않아 큰 패배를 당했고, 그로 인해 크게 꾸지람을 받았습니다. 계월은 훗날 전쟁을 승리로 이끌며 명성을 얻고, 잃어버렸던 부모와 기적처럼 다시 만나게 되지요. 천자는 계월에게 높은 관직을 내리며 그의 공을 인정했습니다.',
      '이후 홍계월은 자신의 지나친 행동을 스스로 인정하며 천자에게 죄를 청했지만, 천자는 오히려 그의 충심을 높게 평가해 벼슬을 유지하게 했습니다. 또한 천자는 계월과 여보국의 인연을 다시 이어주기 위해 직접 <b>중매</b>를 서서 혼인을 이끌었지요. 하지만 두 사람은 위치와 자존심 때문에 여러 갈등을 겪었습니다. 그러던 어느 날, 또다시 반란군이 들고일어나 전장이 다시 어지러워졌고, 위험에 빠진 여보국을 계월이 몸을 던져 구해 냅니다. 이 일을 계기로 두 사람은 서로의 마음을 다시 확인했고, 부부의 정인 <b>금실</b> 또한 더욱 돈독해졌습니다.'
    ],
    vocab: [
      ['간신', '임금에게 충성하지 않고 사사로이 나쁜 짓을 꾸미는 신하'],
      ['수적', '바다에서 사람이나 짐을 빼앗는 도둑'],
      ['장원', '시험에서 가장 높은 점수로 합격함'],
      ['제수', '임금이 벼슬이나 직위를 내려 줌'],
      ['반란', '나라나 권력에 맞서 무력을 일으키는 일'],
      ['원수', '군대를 지휘하는 가장 높은 장수'],
      ['금실', '부부 사이가 사이좋고 정이 깊은 것'],
      ['중매', '두 사람이 혼인할 수 있도록 살피고 연결해 줌']
    ],
    vocabFill: {
      instructions: '[홍계월전 어휘]',
      items: [
        { no: 1, text: '임금에게 충성하지 않고 나쁜 짓을 꾸미는 신하를 (      )이라 한다.', answer: '간신', initials: 'ㄱㅅ', aliases: ['간신'] },
        { no: 2, text: '바다에서 사람이나 짐을 빼앗는 도둑을 (      )이라 한다.', answer: '수적', initials: 'ㅅㅈ', aliases: ['수적'] },
        { no: 3, text: '계월은 뛰어난 실력으로 (      )에 올랐다.', answer: '장원', initials: 'ㅈㅇ', aliases: ['장원'] },
        { no: 4, text: '임금이 벼슬이나 직위를 내려 주는 것을 (      )라 한다.', answer: '제수', initials: 'ㅈㅅ', aliases: ['제수'] },
        { no: 5, text: '간신들이 (      )을 일으키며 가족이 흩어졌다.', answer: '반란', initials: 'ㅂㄹ', aliases: ['반란'] },
        { no: 6, text: '군대를 지휘하는 가장 높은 장수를 (      )라 한다.', answer: '원수', initials: 'ㅇㅅ', aliases: ['원수'] },
        { no: 7, text: '부부 사이가 사이좋고 정이 깊은 것을 (      )이라 한다.', answer: '금실', initials: 'ㄱㅅ', aliases: ['금실'] },
        { no: 8, text: '천자가 직접 (      )를 서서 혼인을 이끌었다.', answer: '중매', initials: 'ㅈㅁ', aliases: ['중매'] }
      ]
    },
    quiz: {
      q1_text: '홍계월이 물에 빠졌다가 살아난 뒤 새 삶을 시작하게 된 계기는 무엇인가요?',
      q1_opts: [
        '① 천자가 직접 구해 주었기 때문이다.',
        '② 여보국이 물속에서 구해 주었기 때문이다.',
        '③ 무릉포의 여공 부부가 발견해 살려 주었기 때문이다.',
        '④ 부모님이 수적을 물리쳤기 때문이다.'
      ],
      q2_text: '이 글의 전개 순서로 올바른 것은 무엇인가요?',
      q2_opts: [
        '① 반란 → 물에 빠짐 → 장원 급제 → 전쟁 승리 → 혼인',
        '② 장원 급제 → 반란 → 혼인 → 물에 빠짐 → 전쟁 승리',
        '③ 혼인 → 장원 급제 → 반란 → 전쟁 승리 → 물에 빠짐',
        '④ 전쟁 승리 → 혼인 → 반란 → 장원 급제 → 물에 빠짐'
      ],
      q3_1_ph: 'ㅈㅇ', q3_2_ph: 'ㅇㅅ',
      q4_1_ph: 'ㅈㅁ', q4_2_ph: 'ㄱㅅ',
      q5_text: '홍계월이 위험에 빠진 여보국을 구한 행동이 두 사람의 관계에 어떤 변화를 가져왔는지 본문 내용을 바탕으로 써 보세요.'
    },
    answerKey: { q1:'3', q2:'1', q3_1:['장원'], q3_2:['원수'], q4_1:['중매'], q4_2:['금실'] },
    essayKeywords: ['구하다','마음','확인','금실','돈독','부부','갈등','화해','사랑'],
    explain: {
      q1:'해설: 본문에서 무릉포에 살던 여공 부부가 우연히 그녀를 발견해 살려 주었다고 서술되어 있다.',
      q2:'해설: 간신의 반란 → 물에 빠짐 → 장원 급제 → 전쟁 승리 → 천자의 중매로 혼인 순서이다.',
      q3:'해설: 계월은 장원에 올랐고, 대원수로 제수되어 전쟁터로 나갔다.',
      q4:'해설: 천자가 중매를 서서 혼인을 이끌었고, 이후 금실이 더욱 돈독해졌다.',
      q5:'예시: 홍계월이 여보국을 구한 일을 계기로 두 사람은 서로의 마음을 다시 확인하게 되었고, 부부의 정인 금실이 더욱 돈독해졌다.'
    }
  },

  /* ===== classic_04 : "백성을 위해 나선 신비한 선비" ===== */
  classic_04: {
    labelNo: '04',
    title: '✨ 백성을 위해 나선 신비한 선비',
    passage: [
      '조선 초기, 송경 근처에는 전우치라는 수수께끼 같은 선비가 살고 있었어요. 그는 뛰어난 <b>도술</b>과 재주를 지녔지만 평소에는 그 모습을 숨기고 조용히 지냈지요. 그 무렵 남쪽 지방에는 해적이 날뛰고, 흉년까지 겹쳐 백성들의 삶이 더욱 어려워졌습니다. 전우치는 이런 현실을 외면하는 관리들과 조정을 보며 크게 분노했고, 결국 자신을 선관으로 <b>가장</b>해 궁궐에 나타났습니다. 그는 옥황상제가 지을 궁전을 위해 금으로 만든 들보를 바치라는 명목을 내세워 부유한 관리들에게서 황금을 거두어, <b>곤궁</b>한 백성들에게 나누어 주었지요.',
      '얼마 뒤 전우치에게 속은 사실을 알게 된 왕은 크게 노하여 즉시 <b>체포령</b>을 내렸습니다. 포도청의 병사들이 그를 잡으려 했지만, 전우치는 도술로 몸을 숨기고 변신하며 병사들을 가볍게 물리쳤어요. 그러나 그는 왕의 명령을 완전히 거역할 수 없다고 판단해 스스로 병 속으로 들어가 궁궐 앞에 나타났습니다. 왕은 온갖 방법을 동원해 그를 벌하려 했으나 그의 도술을 이기지 못했고, 결국 자진해 나타난다면 죄를 사하고 관직을 내리겠다고 약속합니다. 전우치는 이후 선전관이 되어 도적을 잡고 백성을 도우며 이름을 떨쳤지만, 그를 시기한 <b>간신</b>들은 거짓 음모를 꾸며 그에게 <b>누명</b>을 씌웠습니다.',
      '억울한 누명을 쓰고 도망치던 전우치는 자신이 지닌 신비한 족자를 펼쳐 미인을 불러내 술과 음식을 대접해 손님들을 즐겁게 하기도 했습니다. 하지만 족자를 탐낸 사람이 그것을 사들여 장난을 치려다가 오히려 큰 <b>봉변</b>을 당하기도 했지요. 그러던 중 전우치는 이름 높던 서화담을 찾아가 그의 도술을 시험받게 되었고, 결국 화담의 능력에 감탄하며 그의 제자가 되었습니다. 그는 세상의 시비에서 벗어나 태백산으로 들어가 더욱 깊이 도를 닦으며 남은 생을 보냈다고 전해집니다.'
    ],
    vocab: [
      ['도술', '초자연적인 힘을 다루는 신비한 기술'],
      ['체포령', '특정 인물을 잡으라는 공식 명령'],
      ['가장(假裝)', '사실과 다르게 꾸미거나 속이는 행동'],
      ['누명', '사실이 아닌 죄를 뒤집어쓴 억울한 상황'],
      ['간신', '사사로운 이익을 위해 권력자를 속이는 신하'],
      ['곤궁', '몹시 가난하고 어려운 상태'],
      ['문초', '죄를 따지기 위해 조사하고 심문하는 일'],
      ['봉변', '뜻하지 않게 당하는 불행한 사건, 망신']
    ],
    vocabFill: {
      instructions: '[전우치전 어휘]',
      items: [
        { no: 1, text: '초자연적인 힘을 다루는 신비한 기술을 (      )이라 한다.', answer: '도술', initials: 'ㄷㅅ', aliases: ['도술'] },
        { no: 2, text: '특정 인물을 잡으라는 공식 명령을 (      )이라 한다.', answer: '체포령', initials: 'ㅊㅍㄹ', aliases: ['체포령'] },
        { no: 3, text: '사실과 다르게 꾸미거나 속이는 행동을 (      )이라 한다.', answer: '가장', initials: 'ㄱㅈ', aliases: ['가장'] },
        { no: 4, text: '사실이 아닌 죄를 뒤집어쓴 억울한 상황을 (      )이라 한다.', answer: '누명', initials: 'ㄴㅁ', aliases: ['누명'] },
        { no: 5, text: '사사로운 이익을 위해 권력자를 속이는 신하를 (      )이라 한다.', answer: '간신', initials: 'ㄱㅅ', aliases: ['간신'] },
        { no: 6, text: '몹시 가난하고 어려운 상태를 (      )이라 한다.', answer: '곤궁', initials: 'ㄱㄱ', aliases: ['곤궁'] },
        { no: 7, text: '죄를 따지기 위해 조사하고 심문하는 일을 (      )이라 한다.', answer: '문초', initials: 'ㅁㅊ', aliases: ['문초'] },
        { no: 8, text: '뜻하지 않게 당하는 불행한 사건을 (      )이라 한다.', answer: '봉변', initials: 'ㅂㅂ', aliases: ['봉변'] }
      ]
    },
    quiz: {
      q1_text: '전우치가 부유한 관리들에게서 황금을 거둔 목적은 무엇인가요?',
      q1_opts: [
        '① 자신의 재산을 불리기 위해서',
        '② 왕에게 바쳐 관직을 얻기 위해서',
        '③ 곤궁한 백성들에게 나누어 주기 위해서',
        '④ 도술을 더 익히기 위한 비용으로 쓰려고'
      ],
      q2_text: '이 글의 전개 순서로 올바른 것은 무엇인가요?',
      q2_opts: [
        '① 도술 수련 → 백성 구제 → 체포령 → 관직 → 누명 → 은둔',
        '② 백성 구제 → 체포령 → 관직 → 누명 → 서화담 제자 → 은둔',
        '③ 관직 → 백성 구제 → 누명 → 체포령 → 도술 수련 → 은둔',
        '④ 체포령 → 백성 구제 → 관직 → 도술 수련 → 누명 → 은둔'
      ],
      q3_html: `전우치는 자신을 선관으로 <input class="inline-input" id="q3-1" type="text" placeholder="ㄱㅈ">하여 궁궐에 나타났고,
                왕은 그를 잡으라는 <input class="inline-input" id="q3-2" type="text" placeholder="ㅊㅍㄹ">을 내렸다.`,
      q4_html: `전우치를 시기한 <input class="inline-input" id="q4-1" type="text" placeholder="ㄱㅅ">들이 거짓 음모를 꾸며
                그에게 <input class="inline-input" id="q4-2" type="text" placeholder="ㄴㅁ">을 씌웠다.`,
      q3_1_ph: 'ㄱㅈ', q3_2_ph: 'ㅊㅍㄹ', q4_1_ph: 'ㄱㅅ', q4_2_ph: 'ㄴㅁ',
      q5_text: '전우치가 세상의 시비에서 벗어나 태백산으로 들어간 이유를 본문 내용을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['가장'], q3_2:['체포령'], q4_1:['간신'], q4_2:['누명'] },
    essayKeywords: ['누명','간신','시기','억울','도','수련','은둔','벗어나다','세상','시비'],
    explain: {
      q1:'해설: 전우치는 곤궁한 백성들에게 나누어 주기 위해 황금을 거두었습니다.',
      q2:'해설: 백성 구제 → 체포령 → 관직 → 누명 → 서화담 제자 → 태백산 은둔 순서입니다.',
      q3:'해설: 전우치는 선관으로 가장하여 궁궐에 나타났고, 왕은 체포령을 내렸습니다.',
      q4:'해설: 간신들이 거짓 음모를 꾸며 전우치에게 누명을 씌웠습니다.',
      q5:'예시: 전우치는 간신들의 거짓 음모로 억울한 누명을 쓰게 되었고, 세상의 시비에서 벗어나 더욱 깊이 도를 닦기 위해 태백산으로 들어갔습니다.'
    },
    creative: {
      title: '내가 만약 전우치라면',
      topic: '내가 전우치처럼 신비한 도술을 가졌다면, 오늘날 사회에서 어떤 문제를 해결하고 싶은지 써 보세요.',
      hint: '환경 문제, 빈곤, 불공정 등 현대 사회의 문제를 떠올려 보세요.',
      examples: [
        '예시 1) 나는 도술로 쓰레기를 순식간에 재활용 자원으로 바꿔 환경 오염을 해결하겠다.',
        '예시 2) 끼니를 걱정하는 사람들에게 도술로 음식을 만들어 나눠 주겠다.',
        '예시 3) 불공정한 일을 당한 사람들의 억울함을 도술로 밝혀내 정의를 실현하겠다.'
      ]
    }
  },

  /* ===== classic_05 : "숙향의 기이한 탄생과 잃어버린 어린 시절" (숙향전) ===== */
  classic_05: {
    labelNo: '05',
    title: '🐢 숙향의 기이한 탄생과 잃어버린 어린 시절',
    passage: [
      '옛 송나라에 김전이라는 선비가 살고 있었어요. 그는 어느 날 어부에게 잡혀 죽을 위기에 놓인 거북을 사서 놓아주었고, 그 일을 곧 잊고 지냈지요. 하지만 훗날 큰 홍수가 나 김전이 급류에 휩쓸렸을 때, 바로 그 거북이 나타나 등을 내어 주며 그의 목숨을 <b>구출했다</b>. 김전과 그의 아내 장씨는 오랫동안 아이를 얻지 못했지만 정성스런 기도 끝에 딸 숙향을 품게 되었어요. 그러나 숙향이 다섯 살이 되던 해, 난리를 피해 달아나는 과정에서 부부는 아이를 잃어버리고 맙니다. 길을 헤매던 숙향은 신비로운 사슴의 안내로 장 승상의 집에 이르게 되었고, 승상은 숙향을 신임하여 양녀로 삼아 집안 일을 맡겼습니다.',
      '새로운 삶을 살던 숙향에게도 시련은 찾아왔습니다. 승상의 시비 사향이 숙향을 질투해 갖가지 <b>모함</b>을 꾸민 것이지요. 결국 숙향은 억울한 <b>누명</b>을 쓰고 쫓겨나 강물에 몸을 던지려 했지만, 용궁에서 온 용녀가 나타나 그녀를 건져냈습니다. 이후에도 숙향은 여러 차례 위기에 처했는데, 불길 속에서 화덕의 신에게 구출되기도 했고, 험한 물길에서 죽을 위기에는 천태산의 마고할미가 나타나 그녀를 데리고 산속에서 살게 해주었어요. 숙향은 할미와 지내며 바느질 솜씨를 익혔고, 하루는 꿈속에서 <b>천상</b>에서 노니는 자신을 보고 그 모습을 수놓아 남겼습니다. 이후 그 수가 시장에 팔려 나가게 되고, 문장에 밝기로 유명한 이선이 그 수를 보며 숙향의 <b>비범한</b> 기운을 알아차립니다.',
      '수의 주인을 찾던 이선은 할미와 숙향을 찾아가 숙향을 아내로 맞아들입니다. 이 사실을 들은 이상서는 이선의 혼인을 탐탁지 않게 여겨 숙향을 옥에 가두라고 명합니다. 우연히 김전이 그 일을 맡게 되었지만 그는 죄인의 신원을 알지 못한 채 벌을 내리려 하다가 이상하게도 <b>형리</b>의 팔이 움직이지 않는 <b>기이한</b> 일을 겪습니다. 장씨가 꿈에서 숙향을 보게 되면서 이 죄인이 혹시 잃어버린 딸일지도 모른다고 의심하고, 결국 숙향의 정체가 밝혀집니다. 시간이 흐른 뒤 이선이 장원급제하여 벼슬에 오르게 되고, 부부는 마침내 평온하고 화목한 삶을 이루게 됩니다.'
    ],
    vocab: [
      ['구출하다','위험한 상황에서 구조하여 살려내다'],
      ['누명','사실이 아닌데 억울하게 뒤집어쓴 죄'],
      ['모함','상대를 해치려고 거짓을 꾸며 씌우는 일'],
      ['기이하다','평범하지 않고 신비롭거나 괴이한 상태'],
      ['비범하다','보통과 다르게 뛰어나고 특별한 기운을 지닌'],
      ['형리','예전 형벌을 집행하던 관리'],
      ['천상','하늘나라, 신이나 선녀들이 머문다고 하는 세계'],
      ['통곡하다','감정이 북받쳐 크게 울부짖다']
    ],
    vocabFill: {
      instructions: '[숙향전 어휘]',
      items: [
        { no: 1, text: '위험한 상황에서 구조하여 살려내는 것을 (      )라고 한다.', answer: '구출하다', initials: 'ㄱㅊㅎㄷ', aliases: ['구출하다','구출'] },
        { no: 2, text: '사실이 아닌데 억울하게 뒤집어쓴 죄를 (      )이라고 한다.', answer: '누명', initials: 'ㄴㅁ', aliases: ['누명'] },
        { no: 3, text: '상대를 해치려고 거짓을 꾸며 씌우는 일을 (      )이라 한다.', answer: '모함', initials: 'ㅁㅎ', aliases: ['모함'] },
        { no: 4, text: '평범하지 않고 신비롭거나 괴이한 상태를 (      )라 한다.', answer: '기이하다', initials: 'ㄱㅇㅎㄷ', aliases: ['기이하다','기이'] },
        { no: 5, text: '보통과 다르게 뛰어나고 특별한 기운을 지닌 것을 (      )라고 한다.', answer: '비범하다', initials: 'ㅂㅂㅎㄷ', aliases: ['비범하다','비범'] },
        { no: 6, text: '예전 형벌을 집행하던 관리를 (      )라고 한다.', answer: '형리', initials: 'ㅎㄹ', aliases: ['형리'] },
        { no: 7, text: '하늘나라, 신이나 선녀들이 머문다고 하는 세계를 (      )이라고 한다.', answer: '천상', initials: 'ㅊㅅ', aliases: ['천상'] },
        { no: 8, text: '감정이 북받쳐 크게 울부짖는 것을 (      )라고 한다.', answer: '통곡하다', initials: 'ㅌㄱㅎㄷ', aliases: ['통곡하다','통곡'] }
      ]
    },
    quiz: {
      q1_text: '김전이 홍수에서 목숨을 건질 수 있었던 이유로 가장 알맞은 것은?',
      q1_opts: [
        '① 수영을 잘해서 스스로 헤엄쳐 나왔기 때문에',
        '② 지나가던 어부가 배로 구해주었기 때문에',
        '③ 예전에 놓아준 거북이 나타나 등을 내어 주었기 때문에',
        '④ 용왕이 보낸 용녀가 도와주었기 때문에'
      ],
      q2_text: '이 글의 서사 구조를 바르게 설명한 것은?',
      q2_opts: [
        '① 주인공이 처음부터 끝까지 행복하게 사는 이야기이다.',
        '② 주인공이 시련을 겪지만 초월적 존재의 도움으로 위기를 극복하는 구조이다.',
        '③ 여러 인물의 시점이 번갈아 나타나는 다시점 구조이다.',
        '④ 결말에서 주인공이 비극적으로 죽는 구조이다.'
      ],
      q3_1_ph: 'ㅁㅎ', q3_2_ph: 'ㄴㅁ',
      q4_1_ph: 'ㅊㅅ', q4_2_ph: 'ㅂㅂㅎ',
      q5_text: '숙향이 여러 번 위기에서 살아남을 수 있었던 이유를 본문 내용을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['모함'], q3_2:['누명'], q4_1:['천상'], q4_2:['비범한','비범'] },
    essayKeywords: ['거북','용녀','마고할미','화덕','신','도움','초월','신비','구출'],
    explain: {
      q1:'해설: 김전이 예전에 놓아준 거북이 홍수 때 나타나 등을 내어 주어 목숨을 구했다.',
      q2:'해설: 숙향은 여러 시련을 겪지만 거북, 용녀, 화덕의 신, 마고할미 등 초월적 존재들의 도움으로 위기를 극복한다.',
      q3:'해설: 사향이 숙향을 모함하여 억울한 누명을 씌웠다.',
      q4:'해설: 숙향은 꿈에서 천상에서 노니는 자신을 보았고, 이선은 수를 보고 숙향의 비범한 기운을 알아차렸다.',
      q5:'예시: 숙향은 거북, 용녀, 화덕의 신, 마고할미 등 초월적 존재들의 도움을 받아 여러 위기에서 살아남을 수 있었다.'
    },
    creative: {
      title: '🐢 숙향을 도운 신비로운 존재 소개서 만들기',
      topic: '숙향을 도운 신비로운 존재들(거북, 용녀, 화덕의 신, 마고할미) 중 하나를 골라 그 존재를 소개하는 글을 써 보세요.',
      hint: '💡 힌트) 그 존재가 어떤 모습인지, 어떤 능력이 있는지, 숙향을 어떻게 도왔는지 등을 상상해서 써 보세요.',
      examples: [
        '예시 1) 마고할미는 천태산에 사는 신비로운 할머니입니다. 바느질 솜씨가 뛰어나고, 위험에 처한 숙향을 데려와 산속에서 돌봐 주었습니다.',
        '예시 2) 용녀는 용궁에서 온 신비로운 여인입니다. 강물에 빠진 숙향을 건져내어 목숨을 구해 주었습니다.',
        '예시 3) 거북은 김전이 예전에 살려준 은혜를 갚기 위해 홍수 때 나타났습니다. 등을 내어 주어 김전을 안전한 곳으로 데려다 주었습니다.'
      ]
    }
  },

  /* ===== classic_06 : "지도를 보고 길을 찾아가다" (샘플 데이터) ===== */
  classic_06: {
    labelNo: '06',
    title: '🗺️ 지도를 보고 길을 찾아가다',
    passage: [
      '낯선 장소에 갔을 때 가장 먼저 하는 일은 지도를 확인하는 것입니다. 지도는 <b>방향</b>과 <b>거리</b>를 알려주어 목적지까지 안전하게 도달할 수 있게 합니다.',
      '지도를 읽을 때는 <b>축척</b>, <b>방위표</b>, <b>범례</b> 등을 이해해야 합니다. 이러한 정보를 활용하면 실제 공간에서 길을 찾는 데 큰 도움이 됩니다.',
      '요즘은 스마트폰의 <b>GPS</b> 기능으로 실시간 위치를 확인하며 길을 찾을 수 있지만, 종이 지도를 읽는 능력도 여전히 중요합니다.'
    ],
    vocab: [
      ['방향','동서남북 등 나아가는 쪽'],
      ['거리','두 지점 사이의 길이'],
      ['축척','실제와 지도의 크기 비율'],
      ['방위표','지도에서 방향을 나타내는 표시'],
      ['범례','지도 기호의 의미를 설명한 것'],
      ['GPS','위성을 이용한 위치 확인 시스템'],
      ['실시간','바로 지금 이 순간'],
      ['목적지','가고자 하는 곳'],
      ['경로','출발지에서 목적지까지의 길']
    ],
    vocabFill: {
      instructions: '[지도 읽기 어휘]',
      items: [
        { no: 1, text: '동서남북 등 나아가는 쪽을 (      )이라고 한다.', answer: '방향', initials: 'ㅂㅎ', aliases: ['방향'] },
        { no: 2, text: '두 지점 사이의 길이를 (      )라고 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 3, text: '실제와 지도의 크기 비율을 (      )이라 한다.', answer: '축척', initials: 'ㅊㅊ', aliases: ['축척'] },
        { no: 4, text: '지도에서 방향을 나타내는 표시를 (      )라 한다.', answer: '방위표', initials: 'ㅂㅇㅍ', aliases: ['방위표'] },
        { no: 5, text: '지도 기호의 의미를 설명한 것을 (      )라 한다.', answer: '범례', initials: 'ㅂㄹ', aliases: ['범례'] },
        { no: 6, text: '위성을 이용한 위치 확인 시스템을 (   )라 한다.', answer: 'GPS', initials: 'ㅈㅍㅅ', aliases: ['GPS','지피에스'] },
        { no: 7, text: '바로 지금 이 순간을 (      )이라고 한다.', answer: '실시간', initials: 'ㅅㅅㄱ', aliases: ['실시간'] },
        { no: 8, text: '가고자 하는 곳을 (      )라고 한다.', answer: '목적지', initials: 'ㅁㅈㅈ', aliases: ['목적지'] },
        { no: 9, text: '출발지에서 목적지까지의 길을 (      )라고 한다.', answer: '경로', initials: 'ㄱㄹ', aliases: ['경로'] }
      ]
    },
    quiz: {
      q1_text: '지도를 읽을 때 가장 중요한 요소는 무엇인가요?',
      q1_opts: ['① 지도의 색깔', '② 축척, 방위표, 범례', '③ 지도의 크기', '④ 지도를 만든 사람'],
      q2_text: 'GPS의 장점은 무엇인가요?',
      q2_opts: ['① 종이가 필요 없다', '② 실시간으로 위치를 확인할 수 있다', '③ 배터리가 필요 없다', '④ 항상 정확하다'],
      q3_1_ph: 'ㅊㅊ', q3_2_ph: 'ㅂㅇㅍ',
      q4_1_ph: 'ㅈㅍㅅ', q4_2_ph: 'ㅅㅅㄱ',
      q5_text: '종이 지도와 디지털 지도의 장단점을 비교하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['축척'], q3_2:['방위표'], q4_1:['GPS','지피에스'], q4_2:['실시간'] },
    essayKeywords: ['지도','종이','디지털','GPS','장점','단점'],
    explain: {
      q1:'해설: 축척, 방위표, 범례는 지도 읽기의 핵심 요소.',
      q2:'해설: GPS는 실시간 위치 확인이 가능함.',
      q3:'해설: 축척으로 거리를, 방위표로 방향을 알 수 있음.',
      q4:'해설: GPS는 실시간 위치 추적 가능.',
      q5:'예시: 종이 지도는 배터리 불필요, 디지털은 실시간 업데이트 가능.'
    }
  },

  /* ===== classic_07 : "세계 여러 나라의 위치와 특징" (샘플 데이터) ===== */
  classic_07: {
    labelNo: '07',
    title: '🌍 세계 여러 나라의 위치와 특징',
    passage: [
      '지구에는 약 200개가 넘는 나라가 있으며, 각 나라는 고유한 <b>지리적 위치</b>와 <b>문화</b>를 가지고 있습니다.',
      '나라의 위치는 그 나라의 <b>기후</b>, <b>산업</b>, <b>생활 방식</b>에 큰 영향을 미칩니다. 예를 들어 적도 근처 나라는 더운 날씨, 북극 근처 나라는 추운 날씨를 보입니다.',
      '세계 지도를 통해 각 나라의 위치를 파악하고, 그 특징을 이해하는 것은 <b>국제 이해</b>의 첫걸음입니다.'
    ],
    vocab: [
      ['지리적 위치','지구상에서 특정 지점이 있는 자리'],
      ['문화','한 사회의 생활 양식과 전통'],
      ['기후','어떤 지역의 평균적인 날씨'],
      ['산업','물건을 만들거나 서비스를 제공하는 일'],
      ['생활 방식','사람들이 살아가는 방법'],
      ['적도','지구의 중심을 가로지르는 가상의 선'],
      ['국제 이해','여러 나라를 이해하고 존중하는 태도'],
      ['대륙','지구를 이루는 큰 땅덩어리'],
      ['해양','지구를 둘러싼 넓은 바다']
    ],
    vocabFill: {
      instructions: '[세계 지리 어휘]',
      items: [
        { no: 1, text: '지구상에서 특정 지점이 있는 자리를 (        )라고 한다.', answer: '지리적 위치', initials: 'ㅈㄹㅈ ㅇㅊ', aliases: ['지리적위치'] },
        { no: 2, text: '한 사회의 생활 양식과 전통을 (      )라고 한다.', answer: '문화', initials: 'ㅁㅎ', aliases: ['문화'] },
        { no: 3, text: '어떤 지역의 평균적인 날씨를 (      )라고 한다.', answer: '기후', initials: 'ㄱㅎ', aliases: ['기후'] },
        { no: 4, text: '물건을 만들거나 서비스를 제공하는 일을 (      )이라 한다.', answer: '산업', initials: 'ㅅㅇ', aliases: ['산업'] },
        { no: 5, text: '사람들이 살아가는 방법을 (        )이라 한다.', answer: '생활 방식', initials: 'ㅅㅎ ㅂㅅ', aliases: ['생활방식'] },
        { no: 6, text: '지구의 중심을 가로지르는 가상의 선을 (      )라 한다.', answer: '적도', initials: 'ㅈㄷ', aliases: ['적도'] },
        { no: 7, text: '여러 나라를 이해하고 존중하는 태도를 (        )라 한다.', answer: '국제 이해', initials: 'ㄱㅈ ㅇㅎ', aliases: ['국제이해'] },
        { no: 8, text: '지구를 이루는 큰 땅덩어리를 (      )라고 한다.', answer: '대륙', initials: 'ㄷㄹ', aliases: ['대륙'] },
        { no: 9, text: '지구를 둘러싼 넓은 바다를 (      )라고 한다.', answer: '해양', initials: 'ㅎㅇ', aliases: ['해양'] }
      ]
    },
    quiz: {
      q1_text: '나라의 위치가 그 나라에 미치는 영향으로 가장 알맞은 것은?',
      q1_opts: ['① 위치는 기후와 산업에 영향을 준다', '② 위치는 아무 영향이 없다', '③ 위치는 문화와 무관하다', '④ 모든 나라의 위치는 같다'],
      q2_text: '국제 이해가 중요한 이유는 무엇인가요?',
      q2_opts: ['① 다른 나라를 비판하기 위해', '② 여러 나라를 이해하고 존중하기 위해', '③ 우리나라만 발전시키기 위해', '④ 세계 지도를 외우기 위해'],
      q3_1_ph: 'ㄱㅎ', q3_2_ph: 'ㅅㅇ',
      q4_1_ph: 'ㅈㄷ', q4_2_ph: 'ㄷㄹ',
      q5_text: '세계 여러 나라의 위치를 아는 것이 왜 중요한지 설명해 보세요.'
    },
    answerKey: { q1:'1', q2:'2', q3_1:['기후'], q3_2:['산업'], q4_1:['적도'], q4_2:['대륙'] },
    essayKeywords: ['세계','나라','위치','이해','기후','문화'],
    explain: {
      q1:'해설: 위치는 기후, 산업, 생활 방식에 영향을 미침.',
      q2:'해설: 국제 이해는 다양성 존중의 기초.',
      q3:'해설: 위치에 따라 기후와 산업이 달라짐.',
      q4:'해설: 적도 근처는 더운 기후, 대륙별로 특징 다름.',
      q5:'예시: 각 나라의 문화와 생활을 이해하고 존중하기 위해 필요함.'
    }
  },

  /* ===== classic_08 : "우리나라의 지리적 특성 이해하기" (샘플 데이터) ===== */
  classic_08: {
    labelNo: '08',
    title: '🇰🇷 우리나라의 지리적 특성 이해하기',
    passage: [
      '우리나라는 <b>한반도</b>에 위치하며, 삼면이 바다로 둘러싸여 있습니다. <b>동해</b>, <b>서해</b>, <b>남해</b>가 각각 다른 특징을 가지고 있습니다.',
      '국토의 약 70%가 산지로 이루어져 있어 <b>산악 지형</b>이 발달했습니다. 이로 인해 계곡과 분지가 많으며, 평야는 주로 서해안에 분포합니다.',
      '우리나라는 <b>사계절</b>이 뚜렷하여 계절마다 다른 풍경과 생활 모습을 보입니다.'
    ],
    vocab: [
      ['한반도','우리나라가 위치한 반도'],
      ['동해','한반도 동쪽의 바다'],
      ['서해','한반도 서쪽의 바다'],
      ['남해','한반도 남쪽의 바다'],
      ['산악 지형','산이 많은 땅의 모양'],
      ['평야','넓고 평평한 땅'],
      ['사계절','봄, 여름, 가을, 겨울'],
      ['계곡','산과 산 사이의 골짜기'],
      ['분지','주위가 산으로 둘러싸인 평지']
    ],
    vocabFill: {
      instructions: '[우리나라 지리 어휘]',
      items: [
        { no: 1, text: '우리나라가 위치한 반도를 (      )라고 한다.', answer: '한반도', initials: 'ㅎㅂㄷ', aliases: ['한반도'] },
        { no: 2, text: '한반도 동쪽의 바다를 (      )라고 한다.', answer: '동해', initials: 'ㄷㅎ', aliases: ['동해'] },
        { no: 3, text: '한반도 서쪽의 바다를 (      )라고 한다.', answer: '서해', initials: 'ㅅㅎ', aliases: ['서해'] },
        { no: 4, text: '한반도 남쪽의 바다를 (      )라고 한다.', answer: '남해', initials: 'ㄴㅎ', aliases: ['남해'] },
        { no: 5, text: '산이 많은 땅의 모양을 (        )이라 한다.', answer: '산악 지형', initials: 'ㅅㅇ ㅈㅎ', aliases: ['산악지형'] },
        { no: 6, text: '넓고 평평한 땅을 (      )라고 한다.', answer: '평야', initials: 'ㅍㅇ', aliases: ['평야'] },
        { no: 7, text: '봄, 여름, 가을, 겨울을 (      )이라 한다.', answer: '사계절', initials: 'ㅅㄱㅈ', aliases: ['사계절'] },
        { no: 8, text: '산과 산 사이의 골짜기를 (      )라고 한다.', answer: '계곡', initials: 'ㄱㄱ', aliases: ['계곡'] },
        { no: 9, text: '주위가 산으로 둘러싸인 평지를 (      )라고 한다.', answer: '분지', initials: 'ㅂㅈ', aliases: ['분지'] }
      ]
    },
    quiz: {
      q1_text: '우리나라의 지리적 특징으로 가장 알맞은 것은?',
      q1_opts: ['① 사면이 바다로 둘러싸임', '② 삼면이 바다, 산지 많음', '③ 평야만 있음', '④ 사막이 많음'],
      q2_text: '사계절이 뚜렷한 이유는 무엇인가요?',
      q2_opts: ['① 위도와 기후의 영향', '② 바다가 많아서', '③ 산이 많아서', '④ 인구가 많아서'],
      q3_1_ph: 'ㅎㅂㄷ', q3_2_ph: 'ㅅㅇ ㅈㅎ',
      q4_1_ph: 'ㅅㄱㅈ', q4_2_ph: 'ㅍㅇ',
      q5_text: '우리나라의 지리적 특징이 우리 생활에 미치는 영향을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['한반도'], q3_2:['산악지형','산악 지형'], q4_1:['사계절'], q4_2:['평야'] },
    essayKeywords: ['한반도','산','바다','사계절','평야','생활'],
    explain: {
      q1:'해설: 삼면이 바다, 국토의 70%가 산지.',
      q2:'해설: 위도와 기후의 영향으로 사계절 뚜렷.',
      q3:'해설: 한반도는 산악 지형이 발달.',
      q4:'해설: 사계절과 평야가 농업에 영향.',
      q5:'예시: 산지는 등산 문화, 바다는 어업, 사계절은 다양한 계절 행사.'
    }
  },

  /* ===== classic_09 : "자연재해와 인간의 대응" (샘플 데이터) ===== */
  classic_09: {
    labelNo: '09',
    title: '⚠️ 자연재해와 인간의 대응',
    passage: [
      '자연재해는 <b>지진</b>, <b>태풍</b>, <b>홍수</b>, <b>가뭄</b> 등 자연 현상으로 인해 발생하는 피해를 말합니다.',
      '이러한 재해는 인간의 생명과 재산에 큰 피해를 주지만, 사전에 철저히 <b>대비</b>하고 <b>대응</b>하면 피해를 줄일 수 있습니다.',
      '최근에는 <b>재해 예측 시스템</b>과 <b>대피 훈련</b>을 통해 피해를 최소화하려는 노력이 이루어지고 있습니다.'
    ],
    vocab: [
      ['자연재해','자연 현상으로 인한 큰 피해'],
      ['지진','땅이 흔들리는 현상'],
      ['태풍','강한 바람과 비를 동반하는 열대 저기압'],
      ['홍수','물이 넘쳐 피해를 주는 현상'],
      ['가뭄','오랫동안 비가 오지 않는 현상'],
      ['대비','미리 준비하는 것'],
      ['대응','상황에 맞게 행동하는 것'],
      ['재해 예측 시스템','재해를 미리 알려주는 기술'],
      ['대피 훈련','위험 상황에서 안전하게 피하는 연습']
    ],
    vocabFill: {
      instructions: '[자연재해 어휘]',
      items: [
        { no: 1, text: '자연 현상으로 인한 큰 피해를 (        )라고 한다.', answer: '자연재해', initials: 'ㅈㅇ ㅈㅎ', aliases: ['자연재해'] },
        { no: 2, text: '땅이 흔들리는 현상을 (      )이라고 한다.', answer: '지진', initials: 'ㅈㅈ', aliases: ['지진'] },
        { no: 3, text: '강한 바람과 비를 동반하는 열대 저기압을 (      )이라 한다.', answer: '태풍', initials: 'ㅌㅍ', aliases: ['태풍'] },
        { no: 4, text: '물이 넘쳐 피해를 주는 현상을 (      )라고 한다.', answer: '홍수', initials: 'ㅎㅅ', aliases: ['홍수'] },
        { no: 5, text: '오랫동안 비가 오지 않는 현상을 (      )이라 한다.', answer: '가뭄', initials: 'ㄱㅁ', aliases: ['가뭄'] },
        { no: 6, text: '미리 준비하는 것을 (      )라고 한다.', answer: '대비', initials: 'ㄷㅂ', aliases: ['대비'] },
        { no: 7, text: '상황에 맞게 행동하는 것을 (      )라고 한다.', answer: '대응', initials: 'ㄷㅇ', aliases: ['대응'] },
        { no: 8, text: '재해를 미리 알려주는 기술을 (            )이라 한다.', answer: '재해 예측 시스템', initials: 'ㅈㅎ ㅇㅊ ㅅㅅㅌ', aliases: ['재해예측시스템'] },
        { no: 9, text: '위험 상황에서 안전하게 피하는 연습을 (        )이라 한다.', answer: '대피 훈련', initials: 'ㄷㅍ ㅎㄹ', aliases: ['대피훈련'] }
      ]
    },
    quiz: {
      q1_text: '자연재해 피해를 줄이는 방법으로 가장 알맞은 것은?',
      q1_opts: ['① 아무것도 하지 않기', '② 사전 대비와 대응', '③ 재해 후에만 행동', '④ 무조건 피하기'],
      q2_text: '대피 훈련이 중요한 이유는 무엇인가요?',
      q2_opts: ['① 재미있어서', '② 위험 상황에서 빠르게 대응하기 위해', '③ 시간을 보내기 위해', '④ 법으로 정해져서'],
      q3_1_ph: 'ㅈㅈ', q3_2_ph: 'ㅌㅍ',
      q4_1_ph: 'ㄷㅂ', q4_2_ph: 'ㄷㅇ',
      q5_text: '자연재해가 발생했을 때 우리가 해야 할 행동을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['지진'], q3_2:['태풍'], q4_1:['대비'], q4_2:['대응'] },
    essayKeywords: ['재해','대비','대응','안전','대피','예방'],
    explain: {
      q1:'해설: 사전 대비와 신속한 대응이 피해를 줄임.',
      q2:'해설: 대피 훈련은 실제 상황에서 생명을 구함.',
      q3:'해설: 지진, 태풍 등 다양한 자연재해 존재.',
      q4:'해설: 미리 대비하고 상황에 맞게 대응해야 함.',
      q5:'예시: 안전한 곳으로 대피하고, 긴급 연락망을 확인하며, 침착하게 행동.'
    }
  },

  /* ===== classic_10 : "환경 문제와 지속 가능한 발전" (샘플 데이터) ===== */
  classic_10: {
    labelNo: '10',
    title: '🌱 환경 문제와 지속 가능한 발전',
    passage: [
      '현대 사회는 <b>환경 오염</b>, <b>지구 온난화</b>, <b>생물 다양성 감소</b> 등 심각한 환경 문제에 직면해 있습니다.',
      '이러한 문제를 해결하기 위해서는 <b>재생 에너지</b> 사용, <b>재활용</b>, <b>탄소 배출 감소</b> 등의 노력이 필요합니다.',
      '<b>지속 가능한 발전</b>은 현재 세대의 필요를 충족하면서도 미래 세대의 환경을 보호하는 것을 의미합니다.'
    ],
    vocab: [
      ['환경 오염','공기, 물, 토양이 더러워지는 것'],
      ['지구 온난화','지구의 평균 기온이 높아지는 현상'],
      ['생물 다양성','여러 종류의 생물이 존재하는 것'],
      ['재생 에너지','다시 만들어 쓸 수 있는 에너지'],
      ['재활용','쓴 물건을 다시 사용하는 것'],
      ['탄소 배출','이산화탄소를 내보내는 것'],
      ['지속 가능한 발전','미래를 위한 균형 잡힌 발전'],
      ['온실가스','지구를 덥게 만드는 기체'],
      ['친환경','환경을 보호하는']
    ],
    vocabFill: {
      instructions: '[환경과 발전 어휘]',
      items: [
        { no: 1, text: '공기, 물, 토양이 더러워지는 것을 (        )이라 한다.', answer: '환경 오염', initials: 'ㅎㄱ ㅇㅇ', aliases: ['환경오염'] },
        { no: 2, text: '지구의 평균 기온이 높아지는 현상을 (          )이라 한다.', answer: '지구 온난화', initials: 'ㅈㄱ ㅇㄴㅎ', aliases: ['지구온난화'] },
        { no: 3, text: '여러 종류의 생물이 존재하는 것을 (          )이라 한다.', answer: '생물 다양성', initials: 'ㅅㅁ ㄷㅇㅅ', aliases: ['생물다양성'] },
        { no: 4, text: '다시 만들어 쓸 수 있는 에너지를 (        )라 한다.', answer: '재생 에너지', initials: 'ㅈㅅ ㅇㄴㅈ', aliases: ['재생에너지'] },
        { no: 5, text: '쓴 물건을 다시 사용하는 것을 (      )이라 한다.', answer: '재활용', initials: 'ㅈㅎㅇ', aliases: ['재활용'] },
        { no: 6, text: '이산화탄소를 내보내는 것을 (        )이라 한다.', answer: '탄소 배출', initials: 'ㅌㅅ ㅂㅊ', aliases: ['탄소배출'] },
        { no: 7, text: '미래를 위한 균형 잡힌 발전을 (            )이라 한다.', answer: '지속 가능한 발전', initials: 'ㅈㅅ ㄱㄴㅎ ㅂㅈ', aliases: ['지속가능한발전'] },
        { no: 8, text: '지구를 덥게 만드는 기체를 (      )라고 한다.', answer: '온실가스', initials: 'ㅇㅅㄱㅅ', aliases: ['온실가스'] },
        { no: 9, text: '환경을 보호하는 것을 (      )이라고 한다.', answer: '친환경', initials: 'ㅊㅎㄱ', aliases: ['친환경'] }
      ]
    },
    quiz: {
      q1_text: '지속 가능한 발전의 의미로 가장 알맞은 것은?',
      q1_opts: ['① 현재만 생각', '② 미래 세대도 고려', '③ 개발 중단', '④ 환경 파괴'],
      q2_text: '환경 보호를 위해 우리가 할 수 있는 일은?',
      q2_opts: ['① 일회용품 많이 쓰기', '② 재활용하기', '③ 에너지 낭비', '④ 쓰레기 버리기'],
      q3_1_ph: 'ㅎㄱ ㅇㅇ', q3_2_ph: 'ㅈㄱ ㅇㄴㅎ',
      q4_1_ph: 'ㅈㅎㅇ', q4_2_ph: 'ㅈㅅ ㅇㄴㅈ',
      q5_text: '지속 가능한 발전을 위해 개인이 실천할 수 있는 방법을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['환경오염','환경 오염'], q3_2:['지구온난화','지구 온난화'], q4_1:['재활용'], q4_2:['재생에너지','재생 에너지'] },
    essayKeywords: ['환경','재활용','에너지','탄소','지속','실천'],
    explain: {
      q1:'해설: 지속 가능한 발전은 미래 세대를 고려한 균형 발전.',
      q2:'해설: 재활용은 환경 보호의 기본 실천.',
      q3:'해설: 환경 오염과 지구 온난화는 현대의 주요 문제.',
      q4:'해설: 재활용과 재생 에너지가 핵심 해결책.',
      q5:'예시: 일회용품 줄이기, 분리수거, 대중교통 이용, 에너지 절약.'
    }
  },

  /* ===== classic_11 ~ classic_20 샘플 데이터 (더 간략하게) ===== */

  classic_11: {
    labelNo: '11',
    title: '🏙️ 도시와 농촌의 차이',
    passage: ['도시는 인구가 많고 다양한 산업이 발달한 곳입니다.','농촌은 자연과 가까우며 농업이 중심입니다.','각각의 특징을 이해하고 조화롭게 발전해야 합니다.'],
    vocab: [['도시','인구와 시설이 밀집한 곳'],['농촌','농업 중심의 시골 지역'],['인구 밀집','사람이 많이 모여 사는 것'],['산업','생산과 서비스 활동'],['농업','농사를 짓는 일'],['교통','이동 수단과 시스템'],['인프라','기반 시설'],['생활 환경','사람들이 사는 조건'],['조화','균형 있게 어울림']],
    vocabFill: { instructions: '[도시와 농촌]', items: [
      {no:1,text:'인구와 시설이 밀집한 곳을 (   )라고 한다.',answer:'도시',initials:'ㄷㅅ',aliases:['도시']},
      {no:2,text:'농업 중심의 시골 지역을 (   )이라 한다.',answer:'농촌',initials:'ㄴㅊ',aliases:['농촌']},
      {no:3,text:'사람이 많이 모여 사는 것을 (      )이라 한다.',answer:'인구 밀집',initials:'ㅇㄱ ㅁㅈ',aliases:['인구밀집']},
      {no:4,text:'생산과 서비스 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:5,text:'농사를 짓는 일을 (   )이라 한다.',answer:'농업',initials:'ㄴㅇ',aliases:['농업']},
      {no:6,text:'이동 수단과 시스템을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:7,text:'기반 시설을 (     )라고 한다.',answer:'인프라',initials:'ㅇㅍㄹ',aliases:['인프라']},
      {no:8,text:'사람들이 사는 조건을 (      )이라 한다.',answer:'생활 환경',initials:'ㅅㅎ ㅎㄱ',aliases:['생활환경']},
      {no:9,text:'균형 있게 어울림을 (   )라고 한다.',answer:'조화',initials:'ㅈㅎ',aliases:['조화']}
    ]},
    quiz: {q1_text:'도시의 특징은?',q1_opts:['① 인구 많음','② 인구 적음','③ 농업만','④ 시설 없음'],q2_text:'농촌의 장점은?',q2_opts:['① 자연과 가까움','② 시설 많음','③ 인구 많음','④ 공기 나쁨'],q3_1_ph:'ㄷㅅ',q3_2_ph:'ㄴㅊ',q4_1_ph:'ㅅㅇ',q4_2_ph:'ㄴㅇ',q5_text:'도시와 농촌이 조화롭게 발전하려면 어떻게 해야 할까요?'},
    answerKey: {q1:'1',q2:'1',q3_1:['도시'],q3_2:['농촌'],q4_1:['산업'],q4_2:['농업']},
    essayKeywords: ['도시','농촌','조화','발전','균형'],
    explain: {q1:'해설: 도시는 인구와 시설이 밀집.',q2:'해설: 농촌은 자연환경이 좋음.',q3:'해설: 도시와 농촌 각각의 특징.',q4:'해설: 도시=산업, 농촌=농업.',q5:'예시: 상호 교류와 균형 발전 필요.'}
  },

  classic_12: {
    labelNo: '12',
    title: '🚄 교통과 통신의 발달',
    passage: ['교통은 사람과 물건을 옮기는 수단입니다.','통신은 정보를 주고받는 방법입니다.','둘 다 현대 사회를 연결하는 중요한 역할을 합니다.'],
    vocab: [['교통','이동 수단'],['통신','정보 전달'],['발달','발전하여 나아감'],['연결','이어 붙임'],['정보','알아야 할 내용'],['수단','방법이나 도구'],['네트워크','연결망'],['기술','과학적 방법'],['현대','지금의 시대']],
    vocabFill: { instructions: '[교통과 통신]', items: [
      {no:1,text:'이동 수단을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:2,text:'정보 전달을 (   )이라 한다.',answer:'통신',initials:'ㅌㅅ',aliases:['통신']},
      {no:3,text:'발전하여 나아감을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:4,text:'이어 붙임을 (   )이라 한다.',answer:'연결',initials:'ㅇㄱ',aliases:['연결']},
      {no:5,text:'알아야 할 내용을 (   )이라 한다.',answer:'정보',initials:'ㅈㅂ',aliases:['정보']},
      {no:6,text:'방법이나 도구를 (   )이라 한다.',answer:'수단',initials:'ㅅㄷ',aliases:['수단']},
      {no:7,text:'연결망을 (     )라고 한다.',answer:'네트워크',initials:'ㄴㅌㅇㅋ',aliases:['네트워크']},
      {no:8,text:'과학적 방법을 (   )이라 한다.',answer:'기술',initials:'ㄱㅅ',aliases:['기술']},
      {no:9,text:'지금의 시대를 (   )라고 한다.',answer:'현대',initials:'ㅎㄷ',aliases:['현대']}
    ]},
    quiz: {q1_text:'교통 발달의 영향은?',q1_opts:['① 이동 빨라짐','② 느려짐','③ 정보만 전달','④ 변화 없음'],q2_text:'통신의 중요성은?',q2_opts:['① 정보 빠르게 전달','② 필요 없음','③ 이동만 가능','④ 느림'],q3_1_ph:'ㄱㅌ',q3_2_ph:'ㅌㅅ',q4_1_ph:'ㅂㄷ',q4_2_ph:'ㄱㅅ',q5_text:'교통과 통신의 발달이 우리 생활에 미친 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['교통'],q3_2:['통신'],q4_1:['발달'],q4_2:['기술']},
    essayKeywords: ['교통','통신','발달','연결','편리','생활'],
    explain: {q1:'해설: 교통 발달로 이동 시간 단축.',q2:'해설: 통신으로 정보 신속 전달.',q3:'해설: 교통과 통신의 정의.',q4:'해설: 기술 발달이 핵심.',q5:'예시: 빠른 이동, 즉각적 정보 교환, 세계화 촉진.'}
  },

  classic_13: {
    labelNo: '13',
    title: '👨‍👩‍👧‍👦 인구 분포와 이동',
    passage: ['인구는 사람들이 사는 지역에 따라 분포가 다릅니다.','일자리와 생활 환경을 찾아 사람들이 이동합니다.','인구 분포와 이동은 지역 발전에 영향을 줍니다.'],
    vocab: [['인구','사람의 수'],['분포','퍼져 있는 상태'],['이동','장소를 옮김'],['도시화','도시로 인구 집중'],['일자리','직업과 고용'],['환경','주변 조건'],['밀도','단위 면적당 수'],['이촌향도','농촌→도시'],['정주','한곳에 머무름']],
    vocabFill: { instructions: '[인구 분포와 이동]', items: [
      {no:1,text:'사람의 수를 (   )라고 한다.',answer:'인구',initials:'ㅇㄱ',aliases:['인구']},
      {no:2,text:'퍼져 있는 상태를 (   )라 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:3,text:'장소를 옮김을 (   )이라 한다.',answer:'이동',initials:'ㅇㄷ',aliases:['이동']},
      {no:4,text:'도시로 인구가 집중되는 것을 (    )라고 한다.',answer:'도시화',initials:'ㄷㅅㅎ',aliases:['도시화']},
      {no:5,text:'직업과 고용을 (    )라고 한다.',answer:'일자리',initials:'ㅇㅈㄹ',aliases:['일자리']},
      {no:6,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:7,text:'단위 면적당 수를 (   )라고 한다.',answer:'밀도',initials:'ㅁㄷ',aliases:['밀도']},
      {no:8,text:'농촌에서 도시로 이동을 (      )라고 한다.',answer:'이촌향도',initials:'ㅇㅊㅎㄷ',aliases:['이촌향도']},
      {no:9,text:'한곳에 머무름을 (   )라고 한다.',answer:'정주',initials:'ㅈㅈ',aliases:['정주']}
    ]},
    quiz: {q1_text:'인구 이동의 주요 원인은?',q1_opts:['① 일자리','② 무관심','③ 강제','④ 여행'],q2_text:'도시화의 문제점은?',q2_opts:['① 인구 집중','② 인구 감소','③ 발전 없음','④ 농업 증가'],q3_1_ph:'ㅇㄱ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅇㄷ',q4_2_ph:'ㄷㅅㅎ',q5_text:'인구 이동이 지역에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['인구'],q3_2:['분포'],q4_1:['이동'],q4_2:['도시화']},
    essayKeywords: ['인구','이동','분포','도시','일자리','영향'],
    explain: {q1:'해설: 일자리를 찾아 이동.',q2:'해설: 도시 인구 집중 문제.',q3:'해설: 인구와 분포 정의.',q4:'해설: 이동과 도시화.',q5:'예시: 도시는 과밀, 농촌은 과소화.'}
  },

  classic_14: {
    labelNo: '14',
    title: '🏭 산업의 발달과 지역 변화',
    passage: ['산업이 발달하면서 지역의 모습이 크게 변했습니다.','공업 지역과 상업 지역이 생겨났습니다.','산업 발달은 경제 성장을 가져오지만 환경 문제도 발생합니다.'],
    vocab: [['산업','생산 활동'],['공업','제품 제조'],['상업','물건 사고파는 일'],['발달','성장하여 발전'],['경제','재화와 서비스'],['지역','특정한 장소'],['성장','커지고 발전'],['환경 문제','자연 훼손'],['균형 발전','골고루 발전']],
    vocabFill: { instructions: '[산업과 지역]', items: [
      {no:1,text:'생산 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:2,text:'제품 제조를 (   )이라 한다.',answer:'공업',initials:'ㄱㅇ',aliases:['공업']},
      {no:3,text:'물건 사고파는 일을 (   )이라 한다.',answer:'상업',initials:'ㅅㅇ',aliases:['상업']},
      {no:4,text:'성장하여 발전함을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:5,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:6,text:'특정한 장소를 (   )라고 한다.',answer:'지역',initials:'ㅈㅇ',aliases:['지역']},
      {no:7,text:'커지고 발전함을 (   )이라 한다.',answer:'성장',initials:'ㅅㅈ',aliases:['성장']},
      {no:8,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:9,text:'골고루 발전을 (      )이라 한다.',answer:'균형 발전',initials:'ㄱㅎ ㅂㅈ',aliases:['균형발전']}
    ]},
    quiz: {q1_text:'산업 발달의 긍정적 영향은?',q1_opts:['① 경제 성장','② 환경 파괴','③ 인구 감소','④ 후퇴'],q2_text:'산업 발달의 문제점은?',q2_opts:['① 환경 오염','② 발전 없음','③ 인구 증가','④ 기술 퇴보'],q3_1_ph:'ㅅㅇ',q3_2_ph:'ㄱㅇ',q4_1_ph:'ㄱㅈ',q4_2_ph:'ㅎㄱ',q5_text:'산업 발달이 지역에 미친 변화를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['산업'],q3_2:['공업'],q4_1:['경제'],q4_2:['환경']},
    essayKeywords: ['산업','발달','지역','경제','환경','변화'],
    explain: {q1:'해설: 산업 발달로 경제 성장.',q2:'해설: 환경 오염 발생.',q3:'해설: 산업과 공업.',q4:'해설: 경제와 환경.',q5:'예시: 도시 형성, 일자리 증가, 환경 오염.'}
  },

  classic_15: {
    labelNo: '15',
    title: '🌦️ 세계의 다양한 기후',
    passage: ['세계 각지는 다양한 기후를 가지고 있습니다.','기후는 그 지역의 생활과 문화에 영향을 줍니다.','열대, 온대, 한대 등 기후대가 있습니다.'],
    vocab: [['기후','평균 날씨'],['열대','매우 더운 지역'],['온대','따뜻한 지역'],['한대','매우 추운 지역'],['기후대','기후 구분 영역'],['강수량','비 오는 양'],['기온','공기의 온도'],['계절','시간에 따른 날씨 변화'],['영향','결과에 미치는 힘']],
    vocabFill: { instructions: '[세계 기후]', items: [
      {no:1,text:'평균 날씨를 (   )라고 한다.',answer:'기후',initials:'ㄱㅎ',aliases:['기후']},
      {no:2,text:'매우 더운 지역을 (   )라고 한다.',answer:'열대',initials:'ㅇㄷ',aliases:['열대']},
      {no:3,text:'따뜻한 지역을 (   )라고 한다.',answer:'온대',initials:'ㅇㄷ',aliases:['온대']},
      {no:4,text:'매우 추운 지역을 (   )라고 한다.',answer:'한대',initials:'ㅎㄷ',aliases:['한대']},
      {no:5,text:'기후 구분 영역을 (    )라고 한다.',answer:'기후대',initials:'ㄱㅎㄷ',aliases:['기후대']},
      {no:6,text:'비 오는 양을 (    )라고 한다.',answer:'강수량',initials:'ㄱㅅㄹ',aliases:['강수량']},
      {no:7,text:'공기의 온도를 (   )이라 한다.',answer:'기온',initials:'ㄱㅇ',aliases:['기온']},
      {no:8,text:'시간에 따른 날씨 변화를 (   )이라 한다.',answer:'계절',initials:'ㄱㅈ',aliases:['계절']},
      {no:9,text:'결과에 미치는 힘을 (   )이라 한다.',answer:'영향',initials:'ㅇㅎ',aliases:['영향']}
    ]},
    quiz: {q1_text:'기후가 생활에 미치는 영향은?',q1_opts:['① 의식주 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'열대 기후의 특징은?',q2_opts:['① 매우 더움','② 매우 추움','③ 사계절 뚜렷','④ 비 안 옴'],q3_1_ph:'ㄱㅎ',q3_2_ph:'ㅇㄷ',q4_1_ph:'ㄱㅎㄷ',q4_2_ph:'ㄱㅅㄹ',q5_text:'기후가 지역 문화에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['기후'],q3_2:['열대'],q4_1:['기후대'],q4_2:['강수량']},
    essayKeywords: ['기후','열대','온대','한대','생활','문화'],
    explain: {q1:'해설: 기후가 의식주 결정.',q2:'해설: 열대는 매우 더움.',q3:'해설: 기후와 열대.',q4:'해설: 기후대와 강수량.',q5:'예시: 더운 지역은 가벼운 옷, 추운 지역은 두꺼운 옷.'}
  },

  classic_16: {
    labelNo: '16',
    title: '⛏️ 자원의 분포와 이용',
    passage: ['자원은 인간에게 필요한 물질입니다.','석유, 석탄, 광물 등이 있습니다.','자원은 지역마다 분포가 다르며 한정적입니다.'],
    vocab: [['자원','필요한 물질'],['석유','연료 원료'],['석탄','연료 광물'],['광물','땅속 자원'],['분포','퍼진 상태'],['한정적','제한된'],['이용','사용함'],['채굴','캐냄'],['보존','아껴 지킴']],
    vocabFill: { instructions: '[자원 분포와 이용]', items: [
      {no:1,text:'필요한 물질을 (   )이라 한다.',answer:'자원',initials:'ㅈㅇ',aliases:['자원']},
      {no:2,text:'연료 원료를 (   )라고 한다.',answer:'석유',initials:'ㅅㅇ',aliases:['석유']},
      {no:3,text:'연료 광물을 (   )이라 한다.',answer:'석탄',initials:'ㅅㅌ',aliases:['석탄']},
      {no:4,text:'땅속 자원을 (   )이라 한다.',answer:'광물',initials:'ㄱㅁ',aliases:['광물']},
      {no:5,text:'퍼진 상태를 (   )라고 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:6,text:'제한된 것을 (    )이라고 한다.',answer:'한정적',initials:'ㅎㅈㅈ',aliases:['한정적']},
      {no:7,text:'사용함을 (   )이라 한다.',answer:'이용',initials:'ㅇㅇ',aliases:['이용']},
      {no:8,text:'캐냄을 (   )이라 한다.',answer:'채굴',initials:'ㅊㄱ',aliases:['채굴']},
      {no:9,text:'아껴 지킴을 (   )이라 한다.',answer:'보존',initials:'ㅂㅈ',aliases:['보존']}
    ]},
    quiz: {q1_text:'자원이 한정적인 이유는?',q1_opts:['① 다시 안 만들어짐','② 무한함','③ 필요 없음','④ 항상 생김'],q2_text:'자원 보존 방법은?',q2_opts:['① 아껴 쓰기','② 많이 쓰기','③ 버리기','④ 무시하기'],q3_1_ph:'ㅈㅇ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅎㅈㅈ',q4_2_ph:'ㅂㅈ',q5_text:'자원을 아껴 써야 하는 이유를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['자원'],q3_2:['분포'],q4_1:['한정적'],q4_2:['보존']},
    essayKeywords: ['자원','한정','보존','이용','미래'],
    explain: {q1:'해설: 자원은 다시 안 만들어짐.',q2:'해설: 아껴 쓰는 것이 보존.',q3:'해설: 자원과 분포.',q4:'해설: 한정적이므로 보존 필요.',q5:'예시: 미래 세대를 위해 자원 절약 필요.'}
  },

  classic_17: {
    labelNo: '17',
    title: '🎭 문화와 지리적 특성',
    passage: ['지리적 환경은 문화 형성에 영향을 줍니다.','산지, 해안, 평야 등에 따라 다른 문화가 발달합니다.','문화는 지역의 정체성을 만듭니다.'],
    vocab: [['문화','생활 양식'],['지리적','땅과 관련된'],['환경','주변 조건'],['정체성','고유한 특성'],['전통','옛것을 이어옴'],['풍습','관습과 습관'],['의식주','옷,음식,집'],['다양성','여러 가지'],['공존','함께 존재']],
    vocabFill: { instructions: '[문화와 지리]', items: [
      {no:1,text:'생활 양식을 (   )이라 한다.',answer:'문화',initials:'ㅁㅎ',aliases:['문화']},
      {no:2,text:'땅과 관련된 것을 (    )이라고 한다.',answer:'지리적',initials:'ㅈㄹㅈ',aliases:['지리적']},
      {no:3,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:4,text:'고유한 특성을 (    )이라 한다.',answer:'정체성',initials:'ㅈㅊㅅ',aliases:['정체성']},
      {no:5,text:'옛것을 이어옴을 (   )이라 한다.',answer:'전통',initials:'ㅈㅌ',aliases:['전통']},
      {no:6,text:'관습과 습관을 (   )이라 한다.',answer:'풍습',initials:'ㅍㅅ',aliases:['풍습']},
      {no:7,text:'옷,음식,집을 (    )라고 한다.',answer:'의식주',initials:'ㅇㅅㅈ',aliases:['의식주']},
      {no:8,text:'여러 가지를 (    )라고 한다.',answer:'다양성',initials:'ㄷㅇㅅ',aliases:['다양성']},
      {no:9,text:'함께 존재함을 (   )이라 한다.',answer:'공존',initials:'ㄱㅈ',aliases:['공존']}
    ]},
    quiz: {q1_text:'지리적 환경이 문화에 미치는 영향은?',q1_opts:['① 생활 방식 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'문화 다양성의 의미는?',q2_opts:['① 여러 문화 존중','② 한 가지만','③ 무시함','④ 통일'],q3_1_ph:'ㅁㅎ',q3_2_ph:'ㅈㄹㅈ',q4_1_ph:'ㅈㅊㅅ',q4_2_ph:'ㄷㅇㅅ',q5_text:'지리적 환경이 문화 형성에 어떤 영향을 주는지 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['문화'],q3_2:['지리적'],q4_1:['정체성'],q4_2:['다양성']},
    essayKeywords: ['문화','지리','환경','다양성','정체성'],
    explain: {q1:'해설: 환경이 생활 방식 결정.',q2:'해설: 다양성은 여러 문화 존중.',q3:'해설: 문화와 지리적.',q4:'해설: 정체성과 다양성.',q5:'예시: 산지는 산림 문화, 해안은 어업 문화 발달.'}
  },

  classic_18: {
    labelNo: '18',
    title: '🌐 국제 무역과 경제 협력',
    passage: ['국가 간 물건을 사고파는 것을 무역이라 합니다.','무역은 경제 발전에 도움을 줍니다.','국제 협력으로 함께 발전할 수 있습니다.'],
    vocab: [['무역','국가 간 거래'],['수출','물건 팔기'],['수입','물건 사기'],['경제','재화와 서비스'],['협력','함께 도움'],['국제','나라 사이'],['발전','성장함'],['교류','주고받음'],['상호 의존','서로 의지']],
    vocabFill: { instructions: '[국제 무역]', items: [
      {no:1,text:'국가 간 거래를 (   )라고 한다.',answer:'무역',initials:'ㅁㅇ',aliases:['무역']},
      {no:2,text:'물건 팔기를 (   )라고 한다.',answer:'수출',initials:'ㅅㅊ',aliases:['수출']},
      {no:3,text:'물건 사기를 (   )라고 한다.',answer:'수입',initials:'ㅅㅇ',aliases:['수입']},
      {no:4,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:5,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:6,text:'나라 사이를 (   )라고 한다.',answer:'국제',initials:'ㄱㅈ',aliases:['국제']},
      {no:7,text:'성장함을 (   )이라 한다.',answer:'발전',initials:'ㅂㅈ',aliases:['발전']},
      {no:8,text:'주고받음을 (   )이라 한다.',answer:'교류',initials:'ㄱㄹ',aliases:['교류']},
      {no:9,text:'서로 의지함을 (      )라고 한다.',answer:'상호 의존',initials:'ㅅㅎ ㅇㅈ',aliases:['상호의존']}
    ]},
    quiz: {q1_text:'무역의 장점은?',q1_opts:['① 경제 성장','② 고립','③ 감소','④ 중단'],q2_text:'국제 협력이 중요한 이유는?',q2_opts:['① 함께 발전','② 경쟁만','③ 단절','④ 무시'],q3_1_ph:'ㅁㅇ',q3_2_ph:'ㅅㅊ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㄱㅈ',q5_text:'국제 무역이 경제에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['무역'],q3_2:['수출'],q4_1:['협력'],q4_2:['국제']},
    essayKeywords: ['무역','수출','수입','협력','발전'],
    explain: {q1:'해설: 무역으로 경제 성장.',q2:'해설: 협력으로 함께 발전.',q3:'해설: 무역과 수출.',q4:'해설: 협력과 국제.',q5:'예시: 필요한 물건 교환, 경제 활성화, 상호 발전.'}
  },

  classic_19: {
    labelNo: '19',
    title: '🌏 지구촌 문제와 해결 방안',
    passage: ['지구촌은 전 세계가 하나로 연결된 것입니다.','환경, 빈곤, 전쟁 등 공동 문제가 있습니다.','협력하여 함께 해결해야 합니다.'],
    vocab: [['지구촌','세계가 하나로'],['환경 문제','자연 훼손'],['빈곤','가난한 상태'],['전쟁','무력 충돌'],['해결','문제 풀기'],['협력','함께 도움'],['공동','함께 하는'],['지속 가능','미래도 유지'],['연대','함께 뭉침']],
    vocabFill: { instructions: '[지구촌 문제]', items: [
      {no:1,text:'세계가 하나로 연결된 것을 (    )라고 한다.',answer:'지구촌',initials:'ㅈㄱㅊ',aliases:['지구촌']},
      {no:2,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:3,text:'가난한 상태를 (   )이라 한다.',answer:'빈곤',initials:'ㅂㄱ',aliases:['빈곤']},
      {no:4,text:'무력 충돌을 (   )이라 한다.',answer:'전쟁',initials:'ㅈㅈ',aliases:['전쟁']},
      {no:5,text:'문제 풀기를 (   )이라 한다.',answer:'해결',initials:'ㅎㄱ',aliases:['해결']},
      {no:6,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:7,text:'함께 하는 것을 (   )이라 한다.',answer:'공동',initials:'ㄱㄷ',aliases:['공동']},
      {no:8,text:'미래도 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'함께 뭉침을 (   )라고 한다.',answer:'연대',initials:'ㅇㄷ',aliases:['연대']}
    ]},
    quiz: {q1_text:'지구촌 문제 해결 방법은?',q1_opts:['① 국제 협력','② 무시','③ 방치','④ 혼자 해결'],q2_text:'지속 가능 발전이 중요한 이유는?',q2_opts:['① 미래 세대 위해','② 현재만','③ 개발만','④ 파괴'],q3_1_ph:'ㅈㄱㅊ',q3_2_ph:'ㅎㄱ ㅁㅈ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㅎㄱ',q5_text:'지구촌 문제를 해결하기 위해 우리가 할 수 있는 일을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['지구촌'],q3_2:['환경문제','환경 문제'],q4_1:['협력'],q4_2:['해결']},
    essayKeywords: ['지구촌','협력','환경','해결','지속'],
    explain: {q1:'해설: 국제 협력으로 해결.',q2:'해설: 미래 세대를 위해.',q3:'해설: 지구촌과 환경 문제.',q4:'해설: 협력과 해결.',q5:'예시: 환경 보호, 기부, 봉사, 평화 노력.'}
  },

  classic_20: {
    labelNo: '20',
    title: '🔮 미래의 지리적 변화와 전망',
    passage: ['미래에는 기후 변화와 기술 발전이 지리를 바꿀 것입니다.','새로운 도시와 교통 수단이 생길 것입니다.','우리는 미래를 준비하고 대비해야 합니다.'],
    vocab: [['미래','앞으로의 시간'],['전망','예상과 예측'],['변화','달라짐'],['기술 발전','과학 진보'],['기후 변화','날씨 변동'],['대비','준비함'],['예측','미리 짐작'],['지속 가능','미래 유지'],['혁신','새로운 변화']],
    vocabFill: { instructions: '[미래 전망]', items: [
      {no:1,text:'앞으로의 시간을 (   )라고 한다.',answer:'미래',initials:'ㅁㄹ',aliases:['미래']},
      {no:2,text:'예상과 예측을 (   )이라 한다.',answer:'전망',initials:'ㅈㅁ',aliases:['전망']},
      {no:3,text:'달라짐을 (   )이라 한다.',answer:'변화',initials:'ㅂㅎ',aliases:['변화']},
      {no:4,text:'과학 진보를 (      )이라 한다.',answer:'기술 발전',initials:'ㄱㅅ ㅂㅈ',aliases:['기술발전']},
      {no:5,text:'날씨 변동을 (      )이라 한다.',answer:'기후 변화',initials:'ㄱㅎ ㅂㅎ',aliases:['기후변화']},
      {no:6,text:'준비함을 (   )라고 한다.',answer:'대비',initials:'ㄷㅂ',aliases:['대비']},
      {no:7,text:'미리 짐작함을 (   )이라 한다.',answer:'예측',initials:'ㅇㅊ',aliases:['예측']},
      {no:8,text:'미래 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'새로운 변화를 (   )이라 한다.',answer:'혁신',initials:'ㅎㅅ',aliases:['혁신']}
    ]},
    quiz: {q1_text:'미래 지리 변화의 주요 요인은?',q1_opts:['① 기후·기술','② 변화 없음','③ 과거만','④ 무관심'],q2_text:'미래를 준비하는 방법은?',q2_opts:['① 지속 가능 발전','② 방치','③ 무시','④ 파괴'],q3_1_ph:'ㅁㄹ',q3_2_ph:'ㅂㅎ',q4_1_ph:'ㄱㅅ ㅂㅈ',q4_2_ph:'ㄷㅂ',q5_text:'미래의 지리적 변화를 예측하고 우리가 준비해야 할 것을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['미래'],q3_2:['변화'],q4_1:['기술발전','기술 발전'],q4_2:['대비']},
    essayKeywords: ['미래','변화','기술','기후','준비','지속'],
    explain: {q1:'해설: 기후 변화와 기술 발전이 주요 요인.',q2:'해설: 지속 가능한 발전으로 준비.',q3:'해설: 미래와 변화.',q4:'해설: 기술 발전에 대비.',q5:'예시: 환경 보호, 새 기술 학습, 적응력 키우기.'}
  }
});

/* ===============================
   ★ 어휘 빈칸 렌더러 & 탭 이벤트
=================================*/
function getCurrentUnit() {
  return (window.CUR_UNIT || 'classic_01');
}

window.renderVocabFill = function () {
  const unit = window.CUR_UNIT || 'classic_01';
  const pack = window.CONTENTS?.[unit];
  const root = document.getElementById('vocab-fill') 
            || document.querySelector('.vocab-fill-text');

  if (!root || !pack?.vocabFill?.items?.length) {
    console.warn('[vocab] root or items missing:', { root: !!root, unit, items: pack?.vocabFill?.items?.length });
    return;
  }

  const html = (pack.vocabFill.items || []).map(({ no, text, answer, initials }) => {
    const slot = `
      <span class="blank-wrap" data-answer="${answer}">
        <span class="blank-icon">${no}</span>
        <span class="blank-mark"></span>
        <input type="text" class="blank-input" placeholder="${initials || ''}">
      </span>
    `;
    const p = text.replace(/\(\s*[-＿—\u00A0]*\s*\)/, slot);
    return `<p>${p}</p>`;
  }).join('');

  root.innerHTML = `
    <div class="vocab-instruction">${pack.vocabFill.instructions || ''}</div>
    <div class="vocab-inline">${html}</div>
  `;

  (function ensureVocabInlineStyle(){
    if (document.getElementById('vocab-inline-style')) return;
    const st = document.createElement('style');
    st.id = 'vocab-inline-style';
    st.textContent = `
      /* vocab 영역에서만 줄글 처리 */
      .vocab-box .vocab-inline > p { display:inline !important; margin:0 !important; }
      .vocab-box .vocab-inline > p + p::before { content:" "; }

      #vocab-fill .vocab-inline > p,
      .vocab-fill-text .vocab-inline > p { display:inline !important; margin:0 !important; }
      #vocab-fill .vocab-inline > p + p::before,
      .vocab-fill-text .vocab-inline > p + p::before { content:" "; }

      /* 🔶 줄 간격 조정 */
      .vocab-inline { line-height: 5.0 !important; }
    `;
    document.head.appendChild(st);
  })();

  window.reportState = window.reportState || {};
  window.reportState.vocabTotal = pack.vocabFill.items.length;

  // ✅ 어휘 렌더링 직후 상태 복원
  setTimeout(() => {
    // 1. localStorage에서 복원
    if (typeof window.loadVocabState === 'function') {
      window.loadVocabState();
    }
    // 2. 서버 데이터가 있으면 서버 데이터로 복원 (우선순위 높음)
    if (typeof window.restoreVocabFromServerData === 'function') {
      window.restoreVocabFromServerData();
    }
  }, 100);
};

// ✅ 이벤트 리스너 중복 방지를 위한 플래그
let _tabEventsInitialized = false;

function _bindTabEvents() {
  // 이미 초기화되었으면 건너뛰기
  if (_tabEventsInitialized) return;
  _tabEventsInitialized = true;

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-tab]');
    if (!btn) return;
    const tab = btn.getAttribute('data-tab');
    if (tab === 'vocab') renderVocabFill();
  });
}

/* ===== 텍스트 주입 (HTML 구조/ids 유지) ===== */
function applyContentPack(unitKey) {
  console.log('[applyContentPack] 호출됨, unitKey:', unitKey);
  const pack = window.CONTENTS[unitKey];
  if (!pack) {
    console.error('[applyContentPack] pack이 없음! unitKey:', unitKey, 'CONTENTS:', window.CONTENTS);
    return;
  }

  const labelNoEl = document.querySelector('.passage-label strong');
  const titleEl   = document.querySelector('.passage-title');
  if (labelNoEl) labelNoEl.textContent = pack.labelNo;
  if (titleEl)   titleEl.innerHTML = pack.title;

  const passageBox = document.querySelector('.passage-text');
  console.log('[applyContentPack] passageBox:', passageBox, 'pack.passage:', pack.passage);
  if (passageBox) {
    const html = pack.passage.map(p => `<p>${p}</p>`).join('');
    console.log('[applyContentPack] 생성된 HTML 길이:', html.length);
    passageBox.innerHTML = html;
    console.log('[applyContentPack] passageBox.innerHTML 설정 완료');
  }

  const vocabBox = document.querySelector('.passage-vocab ol');
  if (vocabBox)  vocabBox.innerHTML = pack.vocab.map(([w,d]) => `<li><b>${w}</b>: ${d}</li>`).join('');

  const blocks = Array.from(document.querySelectorAll('#tab-reading .quiz-block'));

  // Q1
  if (blocks[0]) {
    const q1Text = blocks[0].querySelector('.quiz-q');
    const q1Lis  = blocks[0].querySelectorAll('.quiz-options li');
    if (q1Text) q1Text.textContent = pack.quiz.q1_text;
    if (q1Lis.length === 4) {
      q1Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q1" value="${i+1}"><span>${pack.quiz.q1_opts[i]}</span></label>`);
    }
  }

  // Q2
  if (blocks[1]) {
    const q2Text = blocks[1].querySelector('.quiz-q');
    const q2Lis  = blocks[1].querySelectorAll('.quiz-options li');
    if (q2Text) q2Text.textContent = pack.quiz.q2_text;
    if (q2Lis.length === 4) {
      q2Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q2" value="${i+1}"><span>${pack.quiz.q2_opts[i]}</span></label>`);
    }
  }

  // Q3
  if (blocks[2]) {
    const q3P = blocks[2].querySelector('.quiz-q');
    if (q3P && pack.quiz.q3_html) q3P.innerHTML = pack.quiz.q3_html;
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    if (q3_1 && pack.quiz.q3_1_ph) q3_1.placeholder = pack.quiz.q3_1_ph;
    if (q3_2 && pack.quiz.q3_2_ph) q3_2.placeholder = pack.quiz.q3_2_ph;
  }

  // Q4
  if (blocks[3]) {
    const q4P = blocks[3].querySelector('.quiz-q');
    if (q4P && pack.quiz.q4_html) q4P.innerHTML = pack.quiz.q4_html;
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    if (q4_1 && pack.quiz.q4_1_ph) q4_1.placeholder = pack.quiz.q4_1_ph;
    if (q4_2 && pack.quiz.q4_2_ph) q4_2.placeholder = pack.quiz.q4_2_ph;
  }

  // Q5
  if (blocks[4]) {
    const q5Text = blocks[4].querySelector('.quiz-q');
    if (q5Text && pack.quiz.q5_text) q5Text.textContent = pack.quiz.q5_text;
  }

  // ✅ 모든 콘텐츠 로드 완료 후 로딩 오버레이 숨기기
  requestAnimationFrame(() => {
    const loadingOverlay = document.getElementById('loadingOverlay');
    if (loadingOverlay) {
      // 분석리포트 탭일 경우 1.3초 후에 숨기기
      const unit = window.CUR_UNIT || 'classic_01';
      const savedTab = localStorage.getItem(`current-geo-tab:${unit}`);
      const delay = (savedTab === 'report') ? 1300 : 0;

      setTimeout(() => {
        loadingOverlay.classList.remove('show');
        console.log('[applyContentPack] 로딩 오버레이 숨김 완료');
      }, delay);
    }
  });
}

/* ==== 본문학습 상태 저장/복원 (✅ 학생별 분리 저장) ==== */

/* 🔐 현재 로그인 학생 정보 가져오기 */
function getCurrentStudentForReading() {
  const saved = localStorage.getItem('currentStudent');
  if (!saved) return null;
  try { return JSON.parse(saved); } catch (e) { return null; }
}

/* 🔐 학생키 만들기: 학년_이름_전화숫자 */
function buildStudentKeyForReading(stu) {
  const cleanPhone = (stu.phone || '').replace(/\D/g, '');
  const cleanName  = (stu.name  || '').trim();
  const cleanGrade = (stu.grade || '').trim();
  return `${cleanGrade}_${cleanName}_${cleanPhone}`;
}

// ✅ 현재 로그인한 학생 키를 공용으로 쓰는 함수 (메뉴/단원 페이지 공유)
window.getStudentKey = function () {
  const stu = getCurrentStudent();
  if (!stu) return '';
  return buildStudentKey(stu);   // "학년_이름_전화번호" 형태
};

/* 🔐 단원별 + 학생별 로컬스토리지 키 */
function getReadingStateKey(unit) {
  const stu = getCurrentStudentForReading();
  if (!stu) {
    // 로그인 안 되어 있으면 예전처럼 단원 단독 키 사용
    return `dan-reading-state:${unit}`;
  }
  const studentKey = buildStudentKeyForReading(stu);
  return `dan-reading-state:${studentKey}:${unit}`;
}

function saveReadingState() {
  try {
    const unit = window.CUR_UNIT || 'classic_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키

    const q1   = document.querySelector('input[name="q1"]:checked');
    const q2   = document.querySelector('input[name="q2"]:checked');
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    const state = {
      graded: true,
      q1:   q1   ? q1.value   : '',
      q2:   q2   ? q2.value   : '',
      q3_1: q3_1 ? q3_1.value : '',
      q3_2: q3_2 ? q3_2.value : '',
      q4_1: q4_1 ? q4_1.value : '',
      q4_2: q4_2 ? q4_2.value : '',
      q5:   q5   ? q5.value   : ''
    };

    localStorage.setItem(key, JSON.stringify(state));
  } catch (e) {
    console.warn('saveReadingState error', e);
  }
}

function loadReadingState() {
  try {
    const unit = window.CUR_UNIT || 'classic_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키
    const raw  = localStorage.getItem(key);
    if (!raw) return;

    const state = JSON.parse(raw);
    if (!state) return;

    if (state.q1) {
      const r1 = document.querySelector(`input[name="q1"][value="${state.q1}"]`);
      if (r1) r1.checked = true;
    }
    if (state.q2) {
      const r2 = document.querySelector(`input[name="q2"][value="${state.q2}"]`);
      if (r2) r2.checked = true;
    }

    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    if (q3_1 && state.q3_1 !== undefined) q3_1.value = state.q3_1;
    if (q3_2 && state.q3_2 !== undefined) q3_2.value = state.q3_2;
    if (q4_1 && state.q4_1 !== undefined) q4_1.value = state.q4_1;
    if (q4_2 && state.q4_2 !== undefined) q4_2.value = state.q4_2;
    if (q5   && state.q5   !== undefined) q5.value   = state.q5;

    if (state.graded && typeof window.gradeQuiz === 'function') {
      setTimeout(() => {
        try { window.gradeQuiz(); } catch (e) {
          console.warn('auto re-grade reading error', e);
        }
      }, 0);
    }
  } catch (e) {
    console.warn('loadReadingState error', e);
  }
}

/* ===== 통합 채점기 ===== */
window.gradeQuiz = function () {
  const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.classic_01;
  const A = pack.answerKey;
  const EX = pack.explain;

  const quizBlocks = document.querySelectorAll('#tab-reading .quiz-block');
  const numLabels = ["01","02","03","04","05"];
  quizBlocks.forEach((block, idx) => {
    const numEl = block.querySelector('.quiz-num');
    if (!numEl) return;
    let markEl = numEl.querySelector('.mark');
    if (!markEl) {
      markEl = document.createElement('div');
      markEl.className = 'mark';
      numEl.appendChild(markEl);
    }
    numEl.textContent = numLabels[idx];
    numEl.appendChild(markEl);
    numEl.classList.remove('correct','wrong');
    markEl.textContent = '';
  });

  let score = 0;
  const totalAuto = 4;
  const shortMsgs = [];
  const fullMsgs = [];

  function norm(s){ return (s||'').toString().replace(/\s+/g,'').toLowerCase(); }
  function mark(idx, ok, label, ex, isEssay=false){
    const num = quizBlocks[idx]?.querySelector('.quiz-num');
    const markEl = num?.querySelector('.mark');
    if (ok) {
      score++;
      num?.classList.add('correct');
      if(markEl) markEl.textContent='⭕';
      shortMsgs.push(`${label} 정답 ✅`);
      fullMsgs.push(`${label} 정답 ✅ ${ex||''}`);
    } else {
      num?.classList.add('wrong');
      if(markEl) markEl.textContent='✖';
      shortMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌`);
      fullMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌ ${ex||''}`);
    }
  }

  // 1
  const q1 = document.querySelector('input[name="q1"]:checked');
  const q1ok = (q1 && q1.value === A.q1);
  mark(0, q1ok, '①', EX.q1);

  // 2
  const q2 = document.querySelector('input[name="q2"]:checked');
  const q2ok = (q2 && q2.value === A.q2);
  mark(1, q2ok, '②', EX.q2);

  // 3
  const q3New = document.getElementById('q3');
  const q3Old1 = document.getElementById('q3-1');
  const q3Old2 = document.getElementById('q3-2');
  const q3Text1 = q3New ? q3New.value.trim() : (q3Old1?.value || '').trim();
  const q3Text2 = q3New ? '' : (q3Old2?.value || '').trim();
  const ok3_1 = A.q3_1.some(a => norm(a) === norm(q3Text1));
  const ok3_2 = A.q3_2 ? A.q3_2.some(a => norm(a) === norm(q3Text2)) : true;
  const q3ok = ok3_1 && ok3_2;
  mark(2, q3ok, '③', EX.q3);

  // 4
  const q4New = document.getElementById('q4');
  const q4Old1 = document.getElementById('q4-1');
  const q4Old2 = document.getElementById('q4-2');
  const q4Text1 = q4New ? q4New.value.trim() : (q4Old1?.value || '').trim();
  const q4Text2 = q4New ? '' : (q4Old2?.value || '').trim();
  const ok4_1 = A.q4_1.some(a => norm(a) === norm(q4Text1));
  const ok4_2 = A.q4_2 ? A.q4_2.some(a => norm(a) === norm(q4Text2)) : true;
  const q4ok = ok4_1 && ok4_2;
  mark(3, q4ok, '④', EX.q4);

  // 5 (서술형)
  const essay = (document.getElementById('q5')?.value || '').trim().toLowerCase();
  const keys = (pack.essayKeywords && Array.isArray(pack.essayKeywords) && pack.essayKeywords.length)
    ? pack.essayKeywords
    : ["등고선","간격","좁","넓","급경사","완만","경사"];
  let hit = 0;
  keys.forEach(k => { if (essay.includes(k)) hit++; });
  const q5ok = essay.length && hit >= 2;
  mark(4, q5ok, '⑤', EX.q5, true);

  const box = document.getElementById('grade-result');
  if (box) {
    box.style.display = 'block';
    box.innerHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + shortMsgs.map(m => `<p>${m}</p>`).join('');
  }
  window.fullResultHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + fullMsgs.map(m => `<p>${m}</p>`).join('');

  const g=document.getElementById('grade-btn');
  const r=document.getElementById('reset-btn');
  const s=document.getElementById('submit-btn');
  if (g) g.style.display='inline-block';
  if (r) r.style.display='inline-block';
  if (s) s.style.display='inline-block';

  window.reportState = window.reportState || {};
  window.reportState.q1ok=q1ok;
  window.reportState.q2ok=q2ok;
  window.reportState.q3ok=q3ok;
  window.reportState.q4ok=q4ok;
  window.reportState.q5ok=q5ok;

  if (typeof updateReportPanel==='function') {
    const lexicalRatio = (typeof window.reportState.vocabScoreRatio==='number') ? window.reportState.vocabScoreRatio : 0;
    const lexicalOk = lexicalRatio >= 0.7;
    updateReportPanel({
      q1ok,q2ok,q3ok,q4ok,q5ok,
      messages:[
        "① 핵심 이해력: " + (q1ok?"좋아요! ✅":"보완 필요 ❗"),
        "② 구조 파악력: " + (q2ok?"좋아요! ✅":"보완 필요 ❗"),
        "③ 어휘 맥락력: " + (lexicalOk?"좋아요! ✅":"어휘 복습 필요 ❗"),
        "④ 추론·통합력: " + (q4ok?"좋아요! ✅":"보완 필요 ❗"),
        "⑤ 비판·적용력: " + (q5ok?"좋아요! ✅":"보완 필요 ❗")
      ]
    });
  }

  // ✅ 레이더 점수 객체로 빼두기
  const radarScores = {
    literal:     q1ok ? 10 : 6,
    structural:  q2ok ? 10 : 6,
    lexical:     q3ok ? 10 : 6,
    inferential: q4ok ? 10 : 6,
    critical:    q5ok ? 10 : 6
  };

  // ✅ 서버로 보낼 마지막 레이더 점수 기억해 두기 (전역)
  window._lastRadar = radarScores;

  // ✅ 화면 레이더 차트 그리기
  if (typeof updateRadarChart === 'function') {
    updateRadarChart(radarScores);
  }
  if (typeof drawRadarChart === 'function') {
    drawRadarChart(radarScores);
  }

  // ✅ 서버 로그용으로도 보관 (옵션)
  window.reportState = window.reportState || {};
  window.reportState.radarScores = radarScores;

  if (typeof saveReadingState === 'function') {
    saveReadingState();
  }
};

/* === 정답·해설 패널 렌더러 === */
function renderSolutions(pack) {
  const A = pack.answerKey, EX = pack.explain;
  const q1Text = pack.quiz.q1_opts[Number(A.q1) - 1] || '';
  const q2Text = pack.quiz.q2_opts[Number(A.q2) - 1] || '';

  // grade-result (점수 박스) 안의 하단에 해설 추가
  const gradeResult = document.getElementById('grade-result');
  if (!gradeResult) return;

  // 기존 solutions-box가 있으면 제거
  let box = document.getElementById('solutions-box');
  if (box) box.remove();

  // 새로운 solutions-box를 grade-result 내부 하단에 추가
  box = document.createElement('div');
  box.id = 'solutions-box';
  box.style.marginTop = '16px';
  box.style.paddingTop = '12px';
  box.style.borderTop = '1px dashed #e5d4c1';
  box.style.lineHeight = '1.6';

  box.innerHTML = `
    <h3 style="margin:0 0 10px; font-size:16px; color:#8b2f2f;">정답 · 해설</h3>
    <ol style="margin:0; padding-left:18px;">
      <li style="margin-bottom:8px;">
        <b>① 정답:</b> ${A.q1} — ${q1Text}<br>
        <span style="color:#6b5a48;">${EX.q1 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>② 정답:</b> ${A.q2} — ${q2Text}<br>
        <span style="color:#6b5a48;">${EX.q2 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>③ 정답(두 칸):</b> ${Array.isArray(A.q3_1)?A.q3_1[0]:A.q3_1} / ${Array.isArray(A.q3_2)?A.q3_2[0]:A.q3_2}<br>
        <span style="color:#6b5a48;">${EX.q3 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>④ 정답(두 칸):</b> ${Array.isArray(A.q4_1)?A.q4_1[0]:A.q4_1} / ${Array.isArray(A.q4_2)?A.q4_2[0]:A.q4_2}<br>
        <span style="color:#6b5a48;">${EX.q4 || ''}</span>
      </li>
      <li>
        <b>⑤ 서술형 예시:</b> <span style="color:#6b5a48;">${EX.q5 || '핵심어 2개 이상 포함 시 정답 처리'}</span>
      </li>
    </ol>
  `;

  // grade-result 내부 하단에 추가
  gradeResult.appendChild(box);
}

/* ========== 공통 진행도 매니저 (단일화 호환) ========== */
window.DanDan = window.DanDan || {};

(function () {
  // 이미 정의돼 있으면 다시 만들지 않기
  if (window.DanDan.ProgressManager) return;

  /* ✅ 단원 감지: classic_01, classic_02 ... */
  function detectUnit() {
    let unitParam = new URLSearchParams(location.search).get('unit');
    if (!unitParam) {
      const m = location.pathname.match(/classic_(\d+)\.html/i);
      if (m) unitParam = `classic_${m[1].padStart(2, '0')}`;
    }
    return (unitParam || (window.CUR_UNIT || 'classic_01')).toLowerCase();
  }

  /* ✅ 학생키: 학년_이름_전화숫자 */
  function buildStudentKey(stu) {
    const cleanPhone = (stu.phone || '').replace(/\D/g, '');
    const cleanName  = (stu.name  || '').trim();
    const cleanGrade = (stu.grade || '').trim();
    return `${cleanGrade}_${cleanName}_${cleanPhone}`;
  }

  /* ✅ 현재 로그인 학생 */
  function getCurrentStudent() {
    const saved = localStorage.getItem('currentStudent');
    if (!saved) return null;
    try { return JSON.parse(saved); } catch { return null; }
  }

  /* ✅ 특정 학생 + 단원 기준 진행도 key 만들기
     → dan-progress:학년_이름_전화:classic_04 */
  function buildProgressKey(stu, unit) {
    const studentKey = buildStudentKey(stu);
    return `dan-progress:${studentKey}:${unit}`;
  }

  /* ✅ 현재 학생의 완료된 단원 목록 읽기 */
  function readDoneList() {
    const stu = getCurrentStudent();
    if (!stu) return { keyPrefix: null, list: [] };

    const unitList = [];
    const studentKey = buildStudentKey(stu);
    const prefix = `dan-progress:${studentKey}:`; // 단원별 prefix

    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k || !k.startsWith(prefix)) continue;
      const unit = k.slice(prefix.length);  // classic_01, classic_02 ...
      const val  = localStorage.getItem(k);
      if (val) unitList.push(unit);
    }
    return { keyPrefix: prefix, list: unitList };
  }

  const ProgressManager = {
    /* 현재 단원 unit (classic_01 등) */
    getUnit: detectUnit,

    /* ✅ 이 단원을 "학습완료"로 표시 */
    markComplete() {
      const stu  = getCurrentStudent();
      if (!stu) return null;

      const unit = detectUnit();                  // classic_04
      const key  = buildProgressKey(stu, unit);   // dan-progress:학생키:classic_04

      localStorage.setItem(key, '1');             // 값은 그냥 '1'로 저장
      return key;
    },

    /* ✅ 이 단원이 완료됐는지 확인 */
    isCompleted(unitOptional) {
      const stu = getCurrentStudent();
      if (!stu) return false;
      const unit = (unitOptional || detectUnit());
      const key  = buildProgressKey(stu, unit);
      return !!localStorage.getItem(key);
    },

    /* ✅ 현재 학생의 완료 단원 리스트 얻기 (classic_01, classic_03 ...) */
    getStudentProgress() {
      return readDoneList();   // { keyPrefix, list }
    }
  };

  window.DanDan.ProgressManager = ProgressManager;

  /* ✅ 제출하기 훅: 완료처리 + 로그 전송 */
  (function hookSubmitReport() {
    const original = window.submitReport;

    window.submitReport = async function (...args) {
      const stu = getCurrentStudent();
      if (!stu) {
        alert('로그인한 학생 정보가 없습니다. 먼저 로그인 해주세요.');
        return;
      }

      // 1) 기존 제출 로직(PDF 등) 실행
      if (typeof original === 'function') {
        await original.apply(this, args);
      } else if (typeof window.captureElementToPDF === 'function') {
        await captureElementToPDF(
          'capture-report',
          '단단국어_분석리포트.pdf',
          { withStudentInfo: true }
        );
      }

      // 2) ✅ 진행도: 학생 + 단원 기준으로 학습완료 저장
      const key = ProgressManager.markComplete();

      if (typeof window.showSubmitSuccess === 'function') {
        showSubmitSuccess('분석리포트');
      } else {
        console.log(`학습완료 처리됨: ${key}`);
      }

      // 3) 서버 학습 이력 로그
      if (typeof window.sendLearningLog === 'function') {
        try {
          await window.sendLearningLog();
        } catch (e) {
          console.warn('[submitReport] sendLearningLog 실패', e);
        }
      }
    };
  })();
})();

/* ===========================
 * ✅ 창의활동 제출 → PDF 내보내기
 *   textarea 전체 내용을 div로 복사해서 캡처
 * =========================== */
window.submitCreative = async function () {
  const textarea   = document.getElementById('creative-input');
  const renderBox  = document.getElementById('creative-render');
  const captureBox = document.getElementById('capture-creative');

  if (!textarea || !renderBox || !captureBox) {
    console.warn('[submitCreative] 요소를 찾을 수 없음', {
      textarea: !!textarea,
      renderBox: !!renderBox,
      captureBox: !!captureBox,
    });
    alert('창의활동 영역을 찾을 수 없습니다.');
    return;
  }

  try {
    // 1) textarea 내용 → 렌더 박스로 복사
    renderBox.textContent = textarea.value || '';

    // 2) 캡처할 동안 textarea 숨기고 렌더 박스만 보이게
    textarea.style.display  = 'none';
    renderBox.style.display = 'block';

    // 3) 공통 함수가 있으면 그걸 사용 (captureElementToPDF)
    if (typeof window.captureElementToPDF === 'function') {
      await window.captureElementToPDF(
        'capture-creative',
        '단단국어_창의활동.pdf',
        { withStudentInfo: true }
      );
    }
    // 4) 없으면 html2canvas + jsPDF 직접 사용 (백업)
    else if (window.html2canvas && window.jsPDF) {
      const canvas = await html2canvas(captureBox);
      const imgData = canvas.toDataURL('image/png');

      const pdf = new jsPDF('p', 'mm', 'a4');
      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = (canvas.height * pageW) / canvas.width;

      pdf.addImage(imgData, 'PNG', 0, 0, pageW, pageH);
      pdf.save('단단국어_창의활동.pdf');
    } else {
      alert('PDF 모듈을 찾을 수 없습니다. (html2canvas / jsPDF 확인)');
    }

    // (원하면 여기에서 창의활동도 showSubmitSuccess 호출 가능)
    if (typeof window.showSubmitSuccess === 'function') {
      window.showSubmitSuccess('창의활동');
    }
  } catch (e) {
    console.warn('submitCreative error', e);
    alert('창의활동 PDF 생성 중 오류가 발생했습니다.');
  } finally {
    // 5) 화면 복구: textarea 다시 보이게, 렌더 박스 숨김
    if (textarea)   textarea.style.display  = 'block';
    if (renderBox)  renderBox.style.display = 'none';
  }
};

/* ===========================
 * ✅ 학습 이력 서버로 보내기 (테스트 버전)
 * =========================== */
/* ===== 🔄 서버에서 완료 상태 가져오기 ===== */
window.loadCompletionStatus = async function () {
  try {
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[loadCompletionStatus] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[loadCompletionStatus] 학생 정보 없음 → 스킵');
      return;
    }

    const params = new URLSearchParams({
      grade: stu.grade || '',
      name: stu.name || '',
      series: 'BRAIN업'
    });

    const res = await fetch(`/api/completion-status?${params}`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' }
    });

    if (!res.ok) {
      console.warn('[loadCompletionStatus] 서버 응답 오류:', res.status);
      return;
    }

    const data = await res.json();
    console.log('[loadCompletionStatus] 서버 응답:', data);

    if (data.ok && Array.isArray(data.completedUnits)) {
      // 학생 키 생성 (buildProgressKey 함수와 동일한 로직)
      const cleanPhone = (stu.phone || '').replace(/\D/g, '');
      const cleanName  = (stu.name  || '').trim();
      const cleanGrade = (stu.grade || '').trim();
      const studentKey = `${cleanGrade}_${cleanName}_${cleanPhone}`;
      const keyPrefix = `dan-progress:${studentKey}:`;

      console.log('[loadCompletionStatus] studentKey:', studentKey);
      console.log('[loadCompletionStatus] keyPrefix:', keyPrefix);

      data.completedUnits.forEach(unit => {
        const key = keyPrefix + unit;  // "dan-progress:학생키:classic_01"
        localStorage.setItem(key, '1');
        console.log('[loadCompletionStatus] 저장:', key);
      });

      console.log('[loadCompletionStatus] 완료 상태 동기화 완료:', data.completedUnits);
    }
  } catch (e) {
    console.warn('[loadCompletionStatus] 오류', e);
  }
};

window.sendLearningLog = async function () {
  try {
    const unit = window.CUR_UNIT || 'classic_02';

    // 1) localStorage 에서 현재 로그인 학생 가져오기
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[sendLearningLog] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[sendLearningLog] 학생 정보 없음 → 로그 전송 스킵');
      return;
    }

    // ✅ gradeQuiz 에서 저장해 둔 레이더 점수 꺼내기
    const radar =
      (window.reportState && window.reportState.radarScores)
      ? window.reportState.radarScores
      : null;

    const payload = {
      grade:  stu.grade  || '',
      name:   stu.name   || '',
      school: stu.school || '',
      series: 'BRAIN업',      // 필요하면 '정조편' 등으로 바꿔도 됨
      unit:   unit,
      radar:  radar,       // ✅ 여기 추가!
      completed: true      // ✅ 학습 완료 표시
    };

    console.log('[sendLearningLog] payload =', payload);

    const res = await fetch('/api/log', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    let data = {};
    try {
      data = await res.json();
    } catch (_) {
      data = {};
    }
    console.log('[sendLearningLog] result =', data);
  } catch (e) {
    console.warn('sendLearningLog outer error', e);
  }
};




/* ===== 로드 시 실행 + 버튼 타입 안전패치 ===== */
document.addEventListener('DOMContentLoaded', async () => {
  // 0) 🔄 서버에서 학습 완료 상태 동기화
  if (typeof window.loadCompletionStatus === 'function') {
    await loadCompletionStatus();
  }

  // 1) 본문 내용 채우기
  applyContentPack(window.CUR_UNIT);

  // 2) 탭 이벤트 + 어휘 자동 렌더
  _bindTabEvents();
  if (location.hash.includes('어휘학습') || document.querySelector('#vocab-fill')) {
    renderVocabFill();
  }

  // 3) 버튼 type=button 통일
  ['grade-btn','reset-btn','submit-btn'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.type = 'button';
  });

  // 4) 제출하기 = 채점 + 해설 표시 (한 번만 등록)
  const submitBtn = document.getElementById('submit-btn');
  if (submitBtn) {
    submitBtn.addEventListener('click', () => {
      try {
        if (typeof window.gradeQuiz === 'function') {
          gradeQuiz();
        }
        const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.classic_01;
        renderSolutions(pack);
      } catch (e) {
        console.warn('submit-btn handler error', e);
      }
    });
  }

    // 🔶 창의활동 제출 버튼 → submitCreative 연결
  const creativeBtn = document.getElementById('creative-submit-btn');
  if (creativeBtn && typeof window.submitCreative === 'function') {
    creativeBtn.type = 'button';
    creativeBtn.addEventListener('click', () => {
      submitCreative();
    });
  }


  // 5) 지난번 채점/입력 상태 복원 (✅ 학생별로 분리된 키 기준)
  if (typeof loadReadingState === 'function') {
    loadReadingState();
  }

});