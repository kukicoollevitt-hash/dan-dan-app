/**
 * ✅ 단원 자동 인식 (강화)
 * 우선순위: ?unit=physics_XX → 파일명 physics_XX.html → 제목 숫자
 * ⚠️ HTML에서 이미 CUR_UNIT 설정했으면 덮어쓰지 않음
 */
(function () {
  // 이미 설정된 CUR_UNIT이 있고, physics_로 시작하면 덮어쓰지 않음
  if (window.CUR_UNIT && window.CUR_UNIT.startsWith('physics_')) {
    console.log('[physics_content.js] CUR_UNIT 이미 설정됨:', window.CUR_UNIT);
    return;
  }

  const qs = new URLSearchParams(location.search).get('unit');
  let unit = null;

  if (qs) {
    const m = qs.toLowerCase().match(/physics[_-]?(\d{1,2})/);
    if (m) unit = `physics_${m[1].padStart(2, '0')}`;
  }

  if (!unit) {
    const m2 = location.pathname.toLowerCase().match(/physics[_-]?(\d{1,2})\.html/);
    if (m2) unit = `physics_${m2[1].padStart(2, '0')}`;
  }

  if (!unit && document.title) {
    const m3 = document.title.match(/(\d{1,2})/);
    if (m3) unit = `physics_${m3[1].padStart(2, '0')}`;
  }

  window.CUR_UNIT = unit || 'physics_01';
})();

/* ===============================
   ✅ 전역 CONTENTS 준비 (단일화)
   =============================== */
window.CONTENTS = window.CONTENTS || {};

/* ===== 콘텐츠 팩: 단원별 지문/어휘/문제/정답 =====
   ✅ 기존 const CONTENTS = {...} → window.CONTENTS 에 합치기
*/
window.CONTENTS = Object.assign(window.CONTENTS, {
  /* ===== physics_01 : "힘이 세면 뭐든지 바꿀 수 있을까?" ===== */
  physics_01: {
    labelNo: '01',
    title: '💪 힘이 세면 뭐든지 바꿀 수 있을까?',
    passage: [
      '옛날 그리스 신화에 나오는 헤라클레스는 힘이 아주 셌어요. 무거운 괴물을 번쩍 들고, 괴물들이 몰려와도 손으로 밀어 버렸지요. 이처럼 무언가의 모양이나 움직임을 바꾸는 것을 과학에서는 "<b>힘</b>이 작용한다"라고 해요.',
      '공을 손으로 눌러 찌그러뜨리거나 멈춰 있던 공을 발로 차서 굴리는 것도 모두 힘이 하는 일이에요. 우리 주변에는 보이지 않지만 여러 힘이 작용하고 있어요.',
      '우리가 땅 위에 설 수 있는 건 <b>중력</b> 덕분이에요. 중력은 지구가 물체를 자기 중심으로 끌어당기는 힘이에요. 또, 미끄러지지 않고 걸을 수 있는 건 <b>마찰력</b>이 있기 때문이에요. 마찰력은 물체가 닿을 때 움직임을 방해하는 힘이에요. 얼음 위가 미끄러운 건 마찰력이 작기 때문이지요.',
      '고무줄이 원래대로 돌아오는 건 <b>탄성력</b>, 전기를 띤 물체끼리 서로 끌리거나 밀어내는 건 <b>전기력</b>, 자석끼리 서로 끌리거나 미는 건 <b>자기력</b> 때문이에요.'
    ],
    vocab: [
      ['힘','물체의 모양이나 움직임을 바꾸는 작용'],
      ['작용하다','어떤 현상이나 변화를 일으키다'],
      ['중력','지구가 물체를 중심으로 끌어당기는 힘'],
      ['마찰력','물체가 닿을 때 움직임을 방해하는 힘'],
      ['탄성력','늘어나거나 줄어든 물체가 원래대로 돌아오려는 힘'],
      ['전기력','전기를 띤 물체끼리 끌리거나 밀어내는 힘'],
      ['자기력','자석끼리 끌리거나 밀어내는 힘'],
      ['끌어당기다','자기 쪽으로 잡아 가까이 오게 하다']
    ],
    vocabFill: {
      instructions: '',
      items: [
        { no: 1, text: '물체의 모양이나 움직임을 바꾸는 작용을 (      )이라고 해요.', answer: '힘', initials: 'ㅎ', aliases: ['힘'] },
        { no: 2, text: '어떤 현상이나 변화를 일으키는 것을 (        )라고 해요.', answer: '작용하다', initials: 'ㅈㅇㅎㄷ', aliases: ['작용하다','작용'] },
        { no: 3, text: '지구가 물체를 중심으로 끌어당기는 힘을 (      )이라고 해요.', answer: '중력', initials: 'ㅈㄹ', aliases: ['중력'] },
        { no: 4, text: '물체가 닿을 때 움직임을 방해하는 힘을 (      )이라고 해요.', answer: '마찰력', initials: 'ㅁㅊㄹ', aliases: ['마찰력'] },
        { no: 5, text: '늘어나거나 줄어든 물체가 원래대로 돌아오려는 힘을 (      )이라고 해요.', answer: '탄성력', initials: 'ㅌㅅㄹ', aliases: ['탄성력'] },
        { no: 6, text: '전기를 띤 물체끼리 끌리거나 밀어내는 힘을 (      )이라고 해요.', answer: '전기력', initials: 'ㅈㄱㄹ', aliases: ['전기력'] },
        { no: 7, text: '자석끼리 끌리거나 밀어내는 힘을 (      )이라고 해요.', answer: '자기력', initials: 'ㅈㄱㄹ', aliases: ['자기력'] },
        { no: 8, text: '자기 쪽으로 잡아 가까이 오게 하는 것을 (        )라고 해요.', answer: '끌어당기다', initials: 'ㄲㅇㄷㄱㄷ', aliases: ['끌어당기다','끌어당김'] }
      ]
    },
    quiz: {
      q1_text: '다음 중 "힘이 작용한다"의 의미로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 물체가 스스로 움직이는 것이다.',
        '② 물체의 모양이나 움직임이 바뀌는 것이다.',
        '③ 물체가 사라지는 것이다.',
        '④ 물체의 색깔이 변하는 것이다.'
      ],
      q2_text: '얼음 위가 미끄러운 이유로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 중력이 크기 때문이다.',
        '② 탄성력이 크기 때문이다.',
        '③ 마찰력이 작기 때문이다.',
        '④ 전기력이 작용하기 때문이다.'
      ],
      q3_1_ph: 'ㅈㄹ', q3_2_ph: 'ㄲㅇㄷㄱㄷ',
      q4_1_ph: 'ㅌㅅㄹ', q4_2_ph: 'ㅈㄱㄹ',
      q5_text: '우리 생활에서 힘이 작용하는 예를 두 가지 이상 들고, 어떤 힘인지 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'3', q3_1:['중력'], q3_2:['끌어당기다','끌어당기는','끌어당김'], q4_1:['탄성력'], q4_2:['자기력'] },
    essayKeywords: ['중력','마찰력','탄성력','전기력','자기력','힘','작용'],
    explain: {
      q1:'해설: 힘이 작용하면 물체의 모양이나 움직임이 바뀌어요.',
      q2:'해설: 얼음 위는 마찰력이 작아서 미끄러워요.',
      q3:'해설: 중력은 지구가 물체를 끌어당기는 힘이에요.',
      q4:'해설: 고무줄이 돌아오는 건 탄성력, 자석이 붙는 건 자기력이에요.',
      q5:'예시: 공을 차면 공이 움직이는 것은 힘이 작용한 것이고, 지우개로 글씨를 지울 때는 마찰력이 작용해요. 자석이 냉장고에 붙는 것은 자기력 때문이에요.'
    }
  },

  /* ===== physics_02 : “지도에 담긴 약속과 표현” ===== */
  physics_02: {
    labelNo: '02',
    title: '🌍 보이지 않는 힘, 중력의 비밀',
    passage: [
      '우리가 땅 위에 서 있을 수 있는 것은 <b>중력(gravity)</b> 덕분이다. 중력은 지구가 모든 물체를 자신의 중심으로 끌어당기는 힘이다. 사과가 나무에서 떨어지고, 던진 공이 다시 땅으로 내려오는 이유도 모두 중력 때문이다. 중력은 눈에 보이지 않지만 항상 우리를 지구 표면에 붙들어 두며, <b>지각(crust)</b> 위에서 걷고, 뛰고, 생활할 수 있게 해 준다.',
      '중력은 지구뿐 아니라 우주 전체에서 작용한다. 달이 지구 주위를 돌고, 지구가 태양 주위를 도는 것도 <b>궤도(orbit)</b>를 따라 서로 끌어당기기 때문이다. 특히 달의 중력은 바닷물을 끌어당겨 <b>조석 현상(tidal phenomenon)</b>을 일으킨다. 하루 두 번 밀물과 썰물이 생기는 것도 이 힘 덕분이다.',
      '뉴턴은 이런 중력의 원리를 <b>만유인력(universal gravitation)</b>이라 불렀다. "모든 <b>질량(mass)</b>을 가진 물체는 서로 끌어당긴다"는 뜻이다. 이 원리를 통해 인류는 인공위성을 띄우고, 달에 착륙하며, 다른 <b>천체(celestial body)</b>를 탐사하고 있다. 중력이 없다면 우주의 수많은 <b>현상(phenomenon)</b>을 이해하기 어려웠을 것이다.'
    ],
    vocab: [
      ['중력','지구가 물체를 끌어당기는 힘'],
      ['지각','지구의 가장 바깥쪽 단단한 껍질'],
      ['궤도','천체가 다른 천체 주위를 도는 길'],
      ['조석 현상','달의 중력으로 바닷물이 밀물과 썰물을 반복하는 현상'],
      ['만유인력','모든 물체가 서로 끌어당기는 힘'],
      ['질량','물체가 가진 물질의 양'],
      ['천체','우주에 있는 별, 행성, 달 등'],
      ['현상','눈에 보이거나 관찰되는 일']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[중력과 만유인력 어휘].',
      items: [
        { no: 1, text: '지구가 모든 물체를 끌어당기는 힘을 (      )이라고 한다.', answer: '중력', initials: 'ㅈㄹ', aliases: ['중력','gravity'] },
        { no: 2, text: '지구의 가장 바깥쪽 단단한 껍질을 (      )이라고 한다.', answer: '지각', initials: 'ㅈㄱ', aliases: ['지각','crust'] },
        { no: 3, text: '천체가 다른 천체 주위를 도는 길을 (      )라고 한다.', answer: '궤도', initials: 'ㄱㄷ', aliases: ['궤도','orbit'] },
        { no: 4, text: '달의 중력으로 밀물과 썰물이 반복되는 것을 (      )이라 한다.', answer: '조석 현상', initials: 'ㅈㅅ ㅎㅅ', aliases: ['조석현상','조석'] },
        { no: 5, text: '모든 물체가 서로 끌어당기는 힘을 (      )이라 한다.', answer: '만유인력', initials: 'ㅁㅇㅇㄹ', aliases: ['만유인력'] },
        { no: 6, text: '물체가 가진 물질의 양을 (      )이라 한다.', answer: '질량', initials: 'ㅈㄹ', aliases: ['질량','mass'] },
        { no: 7, text: '우주에 있는 별, 행성, 달 등을 통틀어 (      )라 한다.', answer: '천체', initials: 'ㅊㅊ', aliases: ['천체'] },
        { no: 8, text: '눈에 보이거나 관찰되는 일을 (      )이라 한다.', answer: '현상', initials: 'ㅎㅅ', aliases: ['현상'] }
      ]
    },
    quiz: {
      q1_text: '중력에 대한 설명으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 중력은 지구에서만 작용하고 우주에서는 작용하지 않는다.',
        '② 중력은 지구가 물체를 밀어내는 힘이다.',
        '③ 중력은 지구가 물체를 중심으로 끌어당기는 힘이다.',
        '④ 중력은 물체의 색깔에 따라 다르게 작용한다.'
      ],
      q2_text: '다음 중 조석 현상에 대한 설명으로 가장 적절한 것은 무엇인가요?',
      q2_opts: [
        '① 태양의 열이 바닷물을 증발시켜 생기는 현상이다.',
        '② 달의 중력이 바닷물을 끌어당겨 밀물과 썰물이 생긴다.',
        '③ 지구의 자전으로 바닷물이 한쪽으로 쏠리는 현상이다.',
        '④ 바람이 바닷물을 밀어서 생기는 파도와 같은 현상이다.'
      ],
      q3_html: `사과가 나무에서 떨어지는 이유는 지구가 물체를 끌어당기는
                <input class="inline-input" id="q3-1" type="text" placeholder="ㅈㄹ"> 때문입니다.
                이 힘 덕분에 우리는 <input class="inline-input" id="q3-2" type="text" placeholder="ㅈㄱ"> 위에서 생활할 수 있습니다.`,
      q4_html: `달이 지구 주위를 도는 길을
                <input class="inline-input" id="q4-1" type="text" placeholder="ㄱㄷ"> 라고 합니다.
                달의 중력은 <input class="inline-input" id="q4-2" type="text" placeholder="ㅈㅅ ㅎㅅ"> 을 일으킵니다.`,
      q3_1_ph: 'ㅈㄹ', q3_2_ph: 'ㅈㄱ',
      q4_1_ph: 'ㄱㄷ', q4_2_ph: 'ㅈㅅ ㅎㅅ',
      q5_text: '만약 지구에 중력이 없다면 우리 생활에 어떤 변화가 생길지 자신의 말로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['중력'], q3_2:['지각'], q4_1:['궤도'], q4_2:['조석 현상','조석현상','조석'] },
    essayKeywords: ['중력','떠다니','걷다','물','공기','떨어지다','붙잡다','우주','무중력'],
    explain: {
      q1:'해설: 중력은 지구가 물체를 중심으로 끌어당기는 힘.',
      q2:'해설: 조석 현상은 달의 중력이 바닷물을 끌어당겨 발생.',
      q3:'해설: 중력 덕분에 지각 위에서 생활 가능.',
      q4:'해설: 궤도는 천체가 도는 길, 조석 현상은 밀물썰물.',
      q5:'예시: 중력이 없으면 물체가 떠다니고 걷기 어려움.'
    }
  },

  /* ===== physics_03 : "지구와 달에서 다른 몸무게의 비밀" ===== */
  physics_03: {
    labelNo: '03',
    title: '🌙 지구와 달에서 다른 몸무게의 비밀',
    passage: [
      '코끼리는 아주 무겁게 느껴지고, 생쥐는 손바닥에 올려도 가벼운 이유가 있어요. 모래 한 알과 커다란 조약돌을 비교해도 차이가 금방 느껴지지요. 이렇게 물체가 더 무겁거나 가볍게 느껴지는 까닭은 물체가 받는 <b>무게</b>가 다르기 때문입니다. 무게는 지구가 물체를 끌어당기는 힘, 즉 <b>중력</b>의 크기와 관련이 있어요. 지구는 거대한 몸집과 큰 <b>질량</b>을 가지고 있기 때문에, 그 위에 있는 모든 물체를 중심 방향으로 당기는 힘을 끊임없이 작용시키고 있습니다. 우리가 발을 땅에 붙여 서 있을 수 있는 것도 바로 이 <b>힘</b> 덕분이에요.',
      '그런데 이 무게는 장소에 따라 달라질 수 있어요. 달이나 화성처럼 지구와 <b>중력 세기</b>가 다른 곳에서는 같은 물체라도 무게가 다르게 나타납니다. 예를 들어 지구에서 60kgf으로 <b>측정</b>되는 사람이 달에서는 약 10kgf 정도밖에 되지 않아요. 이는 달의 중력이 지구의 약 6분의 1 수준이기 때문이지요. 즉, 물체가 가진 \'양\'은 그대로여도 중력이 약한 곳에서는 덜 끌려 내려가므로 더 가볍게 느껴지는 거예요. 마치 같은 사람이라도 다른 행성에서는 전혀 다른 몸무게를 가지는 것처럼 보이는 셈이지요.',
      '반면 질량은 물체 속에 들어 있는 \'물질의 양\'을 뜻해요. 이 값은 장소가 바뀌어도 변하지 않는 특징이 있습니다. 지구든 달이든, 바다 속이든 우주 정거장이든 물체의 질량은 항상 같아요. 다만 무게는 중력의 영향을 받기 때문에 <b>천체</b>마다 다르게 측정될 뿐이지요. 무게는 N(뉴턴)이나 kgf 같은 \'힘\'의 <b>단위</b>로 표시하고, 질량은 kg이나 g처럼 \'양\'을 나타내는 단위로 나타냅니다. 이처럼 무게는 상황에 따라 달라지지만, 질량은 언제나 일정한 값이라는 점이 가장 큰 차이예요.'
    ],
    vocab: [
      ['중력', '물체를 서로 끌어당기는 자연의 힘'],
      ['무게', '중력에 의해 물체가 받는 힘의 크기'],
      ['질량', '물체가 가지고 있는 물질의 양'],
      ['중력 세기', '중력이 작용하는 정도'],
      ['천체', '우주에 존재하는 모든 별과 행성'],
      ['단위', '양을 나타내는 기준 기호'],
      ['측정', '크기나 양을 재는 과정'],
      ['힘', '물체를 움직이거나 멈추게 하는 작용']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[중력과 무게·질량 어휘]',
      items: [
        { no: 1, text: '물체를 서로 끌어당기는 자연의 힘을 (      )이라고 한다.', answer: '중력', initials: 'ㅈㄹ', aliases: ['중력','gravity'] },
        { no: 2, text: '중력에 의해 물체가 받는 힘의 크기를 (      )라고 한다.', answer: '무게', initials: 'ㅁㄱ', aliases: ['무게','weight'] },
        { no: 3, text: '물체가 가지고 있는 물질의 양을 (      )이라고 한다.', answer: '질량', initials: 'ㅈㄹ', aliases: ['질량','mass'] },
        { no: 4, text: '중력이 작용하는 정도를 (        )라고 한다.', answer: '중력 세기', initials: 'ㅈㄹ ㅅㄱ', aliases: ['중력세기','중력의 세기'] },
        { no: 5, text: '우주에 존재하는 모든 별과 행성을 (      )라고 한다.', answer: '천체', initials: 'ㅊㅊ', aliases: ['천체'] },
        { no: 6, text: '양을 나타내는 기준 기호를 (      )라고 한다.', answer: '단위', initials: 'ㄷㅇ', aliases: ['단위'] },
        { no: 7, text: '크기나 양을 재는 과정을 (      )이라고 한다.', answer: '측정', initials: 'ㅊㅈ', aliases: ['측정'] },
        { no: 8, text: '물체를 움직이거나 멈추게 하는 작용을 (   )이라고 한다.', answer: '힘', initials: 'ㅎ', aliases: ['힘','force'] }
      ]
    },
    quiz: {
      /* 01 핵심 이해력 */
      q1_text: '이 글에서 물체가 무겁거나 가볍게 느껴지는 까닭으로 설명한 것은 무엇인가요?',
      q1_opts: [
        '① 물체의 색깔이 다르기 때문이다.',
        '② 물체가 받는 무게, 즉 중력의 크기가 다르기 때문이다.',
        '③ 물체의 온도가 다르기 때문이다.',
        '④ 물체의 모양이 다르기 때문이다.'
      ],
      /* 02 구조 파악력 */
      q2_text: '이 글의 문단 구성에 대한 설명으로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 첫째 문단에서 무게와 중력의 관계를 설명하고, 둘째 문단에서 장소에 따른 무게 변화를 설명하고 있다.',
        '② 첫째 문단에서 질량을 설명하고, 둘째 문단에서 무게를 설명하고 있다.',
        '③ 모든 문단에서 달의 중력만 반복하여 설명하고 있다.',
        '④ 각 문단에서 서로 다른 동물의 무게를 비교하고 있다.'
      ],
      /* 03 어휘 맥락력 빈칸 */
      q3_html: `지구가 물체를 끌어당기는 힘을 <input class="inline-input" id="q3-1" type="text" placeholder="ㅈㄹ">이라 하며, 이 힘에 의해 물체가 받는 크기를 <input class="inline-input" id="q3-2" type="text" placeholder="ㅁㄱ">라고 합니다.`,
      q3_1_ph: 'ㅈㄹ', q3_2_ph: 'ㅁㄱ',
      /* 04 추론통합력 빈칸 */
      q4_html: `달의 중력은 지구의 약 <input class="inline-input" id="q4-1" type="text" placeholder="숫자">분의 1 수준이기 때문에, 같은 사람이라도 달에서는 무게가 더 <input class="inline-input" id="q4-2" type="text" placeholder="ㄱㅂ">게 측정됩니다.`,
      q4_1_ph: '6', q4_2_ph: 'ㄱㅂ',
      /* 05 비판적용력 서술형 */
      q5_text: '지구에서 60kg인 사람이 달에 가면 몸무게가 어떻게 변할지 예상하고, 그 이유를 질량과 무게의 차이를 이용하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['중력'], q3_2:['무게'], q4_1:['6','육','여섯'], q4_2:['가볍','가벼'] },
    essayKeywords: ['질량','무게','중력','변하지 않','달','6분의 1','10kg','가볍','같다','다르다'],
    explain: {
      q1:'해설: 물체가 무겁거나 가볍게 느껴지는 이유는 물체가 받는 무게, 즉 중력의 크기가 다르기 때문입니다.',
      q2:'해설: 첫째 문단은 무게와 중력의 관계, 둘째 문단은 장소(달/화성)에 따른 무게 변화, 셋째 문단은 질량과 무게의 차이를 설명하는 구조입니다.',
      q3:'해설: 중력은 지구가 물체를 끌어당기는 힘이고, 무게는 그 힘의 크기입니다.',
      q4:'해설: 달의 중력은 지구의 약 6분의 1이므로 달에서는 무게가 더 가볍게 측정됩니다.',
      q5:'예시: 지구에서 60kg인 사람은 달에서 약 10kg으로 측정됩니다. 왜냐하면 질량(물질의 양)은 60kg으로 변하지 않지만, 달의 중력이 지구의 6분의 1이므로 무게(중력에 의한 힘)는 6분의 1로 줄어들기 때문입니다.'
    },
    /* ✅ 창의활동 */
    creative: {
      topic: '중력이 다른 천체에서의 무게 변화 탐구하기',
      hint: '지구, 달, 화성 등 여러 천체의 중력 차이를 이용해 무게 변화를 계산해 보세요.',
      examples: [
        '예시 1: 지구에서 60kg인 사람이 달(중력 1/6)에 가면 약 10kg으로 측정되어, 높이뛰기에서 6배 더 높이 뛸 수 있어요.',
        '예시 2: 화성(중력 약 2/5)에서는 같은 사람이 약 24kg이 되어, 무거운 짐도 쉽게 들 수 있지만 걷는 것이 불안정할 수 있어요.',
        '예시 3: 목성(중력 약 2.5배)에서는 150kg이 되어, 서 있는 것조차 힘들고 뼈와 근육에 큰 부담이 가요.'
      ]
    }
  },

  /* ===== physics_04 : "시소에서 크레인까지, 균형의 원리" ===== */
  physics_04: {
    labelNo: '04',
    title: '⚖️ 시소에서 크레인까지, 균형의 원리',
    passage: [
      '천장에 걸린 모빌은 여러 개의 조각이 모두 다른 모양과 무게를 가지고 있는데도 신기하게 한쪽으로 기울지 않고 공중에서 부드럽게 흔들립니다. 이는 단순히 장식이 예쁘게 만들어져서가 아니라, 각각의 조각이 서로의 힘을 <b>균형</b> 있게 주고받고 있기 때문이에요. 이렇게 어느 한쪽으로도 치우치지 않은 상태를 <b>수평</b>이라고 합니다. 수평은 보이는 모양뿐 아니라, 물체를 잡아 주는 힘과 물체가 아래로 끌리는 힘이 서로 맞춰져 만들어지는 안정된 상태예요.',
      '물체가 수평을 이루기 위해서는 몇 가지 중요한 요소가 작용합니다. 첫 번째는 물체를 지탱하는 <b>받침점</b>, 두 번째는 물체 자체의 무게, 세 번째는 물체가 받침점에서 떨어진 <b>거리</b>입니다. 두 물체의 무게가 같다면 받침점에서 같은 거리에 있어야 균형이 맞아요. 하지만 무게가 다르면 무거운 물체는 받침점 가까이에 있어야 하고, 가벼운 물체는 더 멀리 있어야 합니다. 이렇게 해야 두 물체가 받침점에 주는 영향이 같아져 한쪽으로 기울지 않게 됩니다. 이 원리는 <b>지렛대 원리</b>와도 깊은 관련이 있지요.',
      '이런 균형의 법칙은 모빌뿐 아니라 우리 주변의 여러 <b>구조물</b>에도 널리 활용됩니다. 놀이터의 시소가 양쪽에 있는 사람의 몸무게에 맞춰 움직일 수 있는 이유, 저울이 물건의 무게를 정확하게 측정할 수 있는 이유, 크레인과 다리가 무거운 <b>하중</b>을 견디면서도 쓰러지지 않는 이유도 바로 이 균형 원리를 적용했기 때문이에요. 즉, 수평은 아무 힘도 없는 상태가 아니라, 서로 반대 방향에서 작용하는 힘이 같은 크기로 유지되어 안정된 상태라는 뜻입니다.'
    ],
    vocab: [
      ['수평', '한쪽으로 기울지 않고 안정된 상태'],
      ['균형(밸런스)', '서로 반대 방향의 힘이 같은 크기로 작용하는 상태'],
      ['받침점(지렛점)', '물체가 회전하거나 지탱하는 중심 부분'],
      ['거리', '물체와 받침점 사이의 간격'],
      ['하중', '구조물이 견뎌야 하는 무게나 힘'],
      ['지렛대 원리', '거리와 힘의 비율로 균형을 맞추는 물리 법칙'],
      ['구조물', '특정 목적을 위해 만들어진 건축물이나 기계 장치'],
      ['중심축', '물체가 회전하거나 균형을 이루는 기준선 또는 기준점']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[균형과 수평 관련 어휘]',
      items: [
        { no: 1, text: '한쪽으로 기울지 않고 안정된 상태를 (      )이라고 한다.', answer: '수평', initials: 'ㅅㅍ', aliases: ['수평'] },
        { no: 2, text: '서로 반대 방향의 힘이 같은 크기로 작용하는 상태를 (      )이라고 한다.', answer: '균형', initials: 'ㄱㅎ', aliases: ['균형','밸런스'] },
        { no: 3, text: '물체가 회전하거나 지탱하는 중심 부분을 (      )이라고 한다.', answer: '받침점', initials: 'ㅂㅊㅈ', aliases: ['받침점','지렛점'] },
        { no: 4, text: '물체와 받침점 사이의 간격을 (      )라고 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 5, text: '구조물이 견뎌야 하는 무게나 힘을 (      )이라고 한다.', answer: '하중', initials: 'ㅎㅈ', aliases: ['하중'] },
        { no: 6, text: '거리와 힘의 비율로 균형을 맞추는 물리 법칙을 (      )라고 한다.', answer: '지렛대 원리', initials: 'ㅈㄹㄷ ㅇㄹ', aliases: ['지렛대원리','지렛대의 원리'] },
        { no: 7, text: '특정 목적을 위해 만들어진 건축물이나 기계 장치를 (      )라고 한다.', answer: '구조물', initials: 'ㄱㅈㅁ', aliases: ['구조물'] },
        { no: 8, text: '물체가 회전하거나 균형을 이루는 기준선을 (      )이라고 한다.', answer: '중심축', initials: 'ㅈㅅㅊ', aliases: ['중심축'] }
      ]
    },
    quiz: {
      q1_text: '본문에서 설명하는 "수평"의 의미로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 물체가 아래로 떨어지려는 상태',
        '② 물체에 아무런 힘도 작용하지 않는 상태',
        '③ 서로 반대 방향의 힘이 같은 크기로 작용하여 안정된 상태',
        '④ 물체가 빠르게 회전하고 있는 상태'
      ],
      q2_text: '본문의 구조를 가장 잘 설명한 것은 무엇인가요?',
      q2_opts: [
        '① 균형의 역사를 시대 순서대로 나열하고 있다.',
        '② 균형의 개념, 원리, 실생활 적용 순서로 설명하고 있다.',
        '③ 여러 나라의 균형 실험 사례를 비교하고 있다.',
        '④ 균형을 이루지 못한 사고 사례를 분석하고 있다.'
      ],
      q3_html: `물체가 수평을 이루려면 <input class="inline-input" id="q3-1" type="text" placeholder="ㅂㅊㅈ">과
                무게, <input class="inline-input" id="q3-2" type="text" placeholder="ㄱㄹ">가 중요하다.`,
      q4_html: `무거운 물체는 받침점 <input class="inline-input" id="q4-1" type="text" placeholder="ㄱㄱㅇ">에,
                가벼운 물체는 받침점에서 더 <input class="inline-input" id="q4-2" type="text" placeholder="ㅁㄹ"> 있어야 균형이 맞는다.`,
      q3_1_ph: 'ㅂㅊㅈ', q3_2_ph: 'ㄱㄹ', q4_1_ph: 'ㄱㄱㅇ', q4_2_ph: 'ㅁㄹ',
      q5_text: '시소, 저울, 크레인이 모두 같은 균형 원리를 사용한다고 할 때, 이 원리가 무엇인지 본문 내용을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['받침점','지렛점'], q3_2:['거리'], q4_1:['가까이','가까운 곳'], q4_2:['멀리','먼 곳'] },
    essayKeywords: ['받침점','거리','무게','균형','지렛대','반대 방향','같은 크기'],
    explain: {
      q1:'해설: 수평은 서로 반대 방향의 힘이 같은 크기로 유지되어 안정된 상태이다.',
      q2:'해설: 본문은 균형의 개념(1문단) → 원리(2문단) → 실생활 적용(3문단) 순서로 구성되어 있다.',
      q3:'해설: 수평을 이루려면 받침점, 무게, 거리가 중요하다.',
      q4:'해설: 무거운 물체는 받침점 가까이, 가벼운 물체는 멀리 있어야 균형이 맞는다.',
      q5:'예시: 시소, 저울, 크레인은 모두 받침점을 중심으로 무게와 거리의 비율을 맞춰 균형을 이루는 지렛대 원리를 사용한다.'
    },
    creative: {
      title: '⚖️ 시소에서 크레인까지, 균형의 원리 - 나만의 모빌 설계하기',
      instruction: '균형의 원리를 활용하여 나만의 모빌을 설계해 봅시다.',
      steps: [
        {
          step: 1,
          title: '🎨 모빌 조각 정하기',
          content: '모빌에 달고 싶은 조각 4개를 정하고, 각각의 무게를 가볍다(1), 보통(2), 무겁다(3)로 표시해 보세요.',
          example: '예: 별(1), 달(2), 해(3), 구름(1)'
        },
        {
          step: 2,
          title: '📏 균형 계획하기',
          content: '무거운 조각은 받침점 가까이, 가벼운 조각은 멀리 배치하는 계획을 세워 보세요.',
          table: {
            headers: ['조각 이름', '무게', '받침점에서 거리'],
            rows: [
              ['', '', ''],
              ['', '', ''],
              ['', '', ''],
              ['', '', '']
            ]
          }
        },
        {
          step: 3,
          title: '✍️ 모빌 설명서 쓰기',
          content: '내가 설계한 모빌이 어떻게 균형을 이루는지 설명하는 글을 써 보세요.',
          example: '예: 내 모빌은 가장 무거운 해를 중심 가까이에 달고, 가벼운 별과 구름은 양 끝에 멀리 달아 균형을 맞췄습니다.'
        }
      ],
      reflection: '무게와 거리의 관계를 생각하며 모빌을 설계해 보니, 균형의 원리가 어떻게 작용하는지 이해할 수 있었나요?'
    }
  },

  /* ===== physics_05 : "움직임을 이해하는 세 가지 열쇠" ===== */
  physics_05: {
    labelNo: '05',
    title: '🚗 움직임을 이해하는 세 가지 열쇠',
    passage: [
      '우리가 흔히 말하는 운동은 달리기, 점프, 줄넘기처럼 몸을 움직이는 활동을 떠올리지만, 과학에서 말하는 \'<b>운동</b>\'은 전혀 다른 의미를 가지고 있어요. 과학에서는 어떤 물체가 시간이 지남에 따라 위치가 변하는 현상을 운동이라 합니다. 즉, 사람이 뛰지 않아도, 자동차·공·로봇처럼 물체가 조금이라도 다른 위치로 옮겨 갔다면 그것은 모두 운동에 해당하지요. 따라서 운동을 이해하려면 물체가 어느 시점에서 어디로, 얼마나 이동했는지를 살펴봐야 합니다.',
      '운동을 판단하기 위해서는 \'<b>기준점</b>\'이 매우 중요합니다. 기준점은 물체가 움직였는지 비교할 기준이 되는 위치예요. 예를 들어, 검은 자동차가 집을 기준점으로 삼고 동쪽 <b>방향</b> 400미터 떨어진 건물까지 2분 동안 이동했다고 해볼까요? 이때 자동차는 집에서 점점 멀어졌기 때문에 분명 운동한 상태라고 볼 수 있습니다. 하지만 자동차 내부에 앉아 있는 사람의 관점에서는 주변 풍경이 움직이는 것처럼 보이기도 하죠. 이렇게 운동은 기준점에 따라 다르게 보일 수 있기 때문에 <b>관찰자</b>의 위치가 매우 중요해요.',
      '과학에서는 물체의 운동을 정확하게 설명하기 위해 세 가지 요소가 필요해요. 첫 번째는 기준점, 즉 \'어디에서부터 변화가 시작되었는가\'를 알려주는 출발점입니다. 두 번째는 방향, 물체가 어느 쪽으로 이동했는지를 나타내지요. 마지막은 <b>거리</b>, 물체가 움직이며 실제로 얼마나 이동했는지를 말합니다. 이 세 요소를 함께 사용하면 운동의 크기뿐 아니라 방향까지 정확하게 표현할 수 있어요. 이것이 바로 과학에서 \'운동\'을 정의하고 분석하는 기본 방법입니다.'
    ],
    vocab: [
      ['운동(運動)', '시간이 지나며 물체의 위치가 달라지는 현상'],
      ['기준점', '움직임을 판단하기 위한 비교 기준이 되는 위치'],
      ['방향', '물체가 이동하는 쪽 또는 경로'],
      ['거리', '이동한 길이 또는 떨어져 있는 정도'],
      ['관찰자', '움직임이나 현상을 바라보는 사람'],
      ['위치 변화', '한 지점에서 다른 지점으로 이동하는 것'],
      ['이동 경로', '물체가 지나간 길'],
      ['현상', '자연에서 일어나는 일이나 변화']
    ],
    vocabFill: {
      instructions: '[운동과 위치 관련 어휘]',
      items: [
        { no: 1, text: '시간이 지나며 물체의 위치가 달라지는 현상을 (      )이라고 한다.', answer: '운동', initials: 'ㅇㄷ', aliases: ['운동'] },
        { no: 2, text: '움직임을 판단하기 위한 비교 기준이 되는 위치를 (      )이라고 한다.', answer: '기준점', initials: 'ㄱㅈㅈ', aliases: ['기준점'] },
        { no: 3, text: '물체가 이동하는 쪽 또는 경로를 (      )이라 한다.', answer: '방향', initials: 'ㅂㅎ', aliases: ['방향'] },
        { no: 4, text: '이동한 길이 또는 떨어져 있는 정도를 (      )라 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 5, text: '움직임이나 현상을 바라보는 사람을 (      )라고 한다.', answer: '관찰자', initials: 'ㄱㅊㅈ', aliases: ['관찰자'] },
        { no: 6, text: '한 지점에서 다른 지점으로 이동하는 것을 (        )라고 한다.', answer: '위치 변화', initials: 'ㅇㅊ ㅂㅎ', aliases: ['위치변화','위치 변화'] },
        { no: 7, text: '물체가 지나간 길을 (        )라고 한다.', answer: '이동 경로', initials: 'ㅇㄷ ㄱㄹ', aliases: ['이동경로','이동 경로'] },
        { no: 8, text: '자연에서 일어나는 일이나 변화를 (      )이라고 한다.', answer: '현상', initials: 'ㅎㅅ', aliases: ['현상'] }
      ]
    },
    quiz: {
      q1_text: '과학에서 말하는 "운동"의 의미로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 달리기, 점프, 줄넘기처럼 몸을 움직이는 활동이다.',
        '② 물체가 빠르게 움직이는 것만을 의미한다.',
        '③ 시간이 지남에 따라 물체의 위치가 변하는 현상이다.',
        '④ 사람이 운동장에서 하는 체육 활동이다.'
      ],
      q2_text: '이 글의 전개 구조로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 문제 제기 → 원인 분석 → 해결 방안 제시',
        '② 운동의 과학적 정의 → 기준점의 중요성 → 운동의 세 가지 요소',
        '③ 과거 사례 → 현재 비교 → 미래 전망',
        '④ 주장 제시 → 반론 검토 → 결론 요약'
      ],
      q3_html: `운동을 판단하려면 비교 기준이 되는 <input class="inline-input" id="q3-1" type="text" placeholder="ㄱㅈㅈ">이 중요하고, 같은 운동도 <input class="inline-input" id="q3-2" type="text" placeholder="ㄱㅊㅈ">의 위치에 따라 다르게 보일 수 있습니다.`,
      q4_html: `과학에서 운동을 설명하려면 기준점, <input class="inline-input" id="q4-1" type="text" placeholder="ㅂㅎ">, <input class="inline-input" id="q4-2" type="text" placeholder="ㄱㄹ"> 세 가지 요소가 필요합니다.`,
      q3_1_ph: 'ㄱㅈㅈ', q3_2_ph: 'ㄱㅊㅈ', q4_1_ph: 'ㅂㅎ', q4_2_ph: 'ㄱㄹ',
      q5_text: '자동차 안에 탄 사람과 길가에 서 있는 사람이 같은 자동차의 움직임을 다르게 느끼는 이유를 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['기준점'], q3_2:['관찰자'], q4_1:['방향'], q4_2:['거리'] },
    essayKeywords: ['기준점','관찰자','위치','운동','방향','거리','다르게','보다','느끼다','관점'],
    explain: {
      q1:'해설: 과학에서 운동은 시간이 지남에 따라 물체의 위치가 변하는 현상을 의미합니다.',
      q2:'해설: 본문은 운동의 과학적 정의 → 기준점의 중요성 → 운동의 세 가지 요소 순서로 전개됩니다.',
      q3:'해설: 운동을 판단하려면 "기준점"이 중요하고, "관찰자"의 위치에 따라 다르게 보일 수 있습니다.',
      q4:'해설: 과학에서 운동을 설명하려면 기준점, "방향", "거리" 세 가지 요소가 필요합니다.',
      q5:'예시: 자동차 안에 탄 사람은 자신이 멈춰 있고 주변 풍경이 움직이는 것처럼 느끼지만, 길가에 서 있는 사람은 자동차가 움직이는 것으로 봅니다. 이는 관찰자의 기준점이 다르기 때문입니다.'
    },
    creative: {
      title: '나만의 운동 관찰 일기',
      topic: '주변에서 운동하는 물체를 하나 골라, 기준점·방향·거리를 사용해 그 움직임을 설명해 보세요.',
      hint: '💡 힌트) 자동차, 자전거, 비행기, 축구공 등 움직이는 물체를 떠올리고, 어디서(기준점) 어느 쪽으로(방향) 얼마나(거리) 이동했는지 적어 보세요.',
      examples: [
        '예시 1) 버스가 학교(기준점)에서 북쪽 방향으로 500m 떨어진 도서관까지 이동했다.',
        '예시 2) 축구공이 골대(기준점)에서 왼쪽 방향으로 10m 굴러갔다.',
        '예시 3) 비행기가 공항(기준점)에서 동쪽 방향으로 하늘 높이 날아갔다.'
      ]
    }
  },

  /* ===== physics_06 : "지도를 보고 길을 찾아가다" (샘플 데이터) ===== */
  physics_06: {
    labelNo: '06',
    title: '🗺️ 지도를 보고 길을 찾아가다',
    passage: [
      '낯선 장소에 갔을 때 가장 먼저 하는 일은 지도를 확인하는 것입니다. 지도는 <b>방향</b>과 <b>거리</b>를 알려주어 목적지까지 안전하게 도달할 수 있게 합니다.',
      '지도를 읽을 때는 <b>축척</b>, <b>방위표</b>, <b>범례</b> 등을 이해해야 합니다. 이러한 정보를 활용하면 실제 공간에서 길을 찾는 데 큰 도움이 됩니다.',
      '요즘은 스마트폰의 <b>GPS</b> 기능으로 실시간 위치를 확인하며 길을 찾을 수 있지만, 종이 지도를 읽는 능력도 여전히 중요합니다.'
    ],
    vocab: [
      ['방향','동서남북 등 나아가는 쪽'],
      ['거리','두 지점 사이의 길이'],
      ['축척','실제와 지도의 크기 비율'],
      ['방위표','지도에서 방향을 나타내는 표시'],
      ['범례','지도 기호의 의미를 설명한 것'],
      ['GPS','위성을 이용한 위치 확인 시스템'],
      ['실시간','바로 지금 이 순간'],
      ['목적지','가고자 하는 곳'],
      ['경로','출발지에서 목적지까지의 길']
    ],
    vocabFill: {
      instructions: '[지도 읽기 어휘]',
      items: [
        { no: 1, text: '동서남북 등 나아가는 쪽을 (      )이라고 한다.', answer: '방향', initials: 'ㅂㅎ', aliases: ['방향'] },
        { no: 2, text: '두 지점 사이의 길이를 (      )라고 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 3, text: '실제와 지도의 크기 비율을 (      )이라 한다.', answer: '축척', initials: 'ㅊㅊ', aliases: ['축척'] },
        { no: 4, text: '지도에서 방향을 나타내는 표시를 (      )라 한다.', answer: '방위표', initials: 'ㅂㅇㅍ', aliases: ['방위표'] },
        { no: 5, text: '지도 기호의 의미를 설명한 것을 (      )라 한다.', answer: '범례', initials: 'ㅂㄹ', aliases: ['범례'] },
        { no: 6, text: '위성을 이용한 위치 확인 시스템을 (   )라 한다.', answer: 'GPS', initials: 'ㅈㅍㅅ', aliases: ['GPS','지피에스'] },
        { no: 7, text: '바로 지금 이 순간을 (      )이라고 한다.', answer: '실시간', initials: 'ㅅㅅㄱ', aliases: ['실시간'] },
        { no: 8, text: '가고자 하는 곳을 (      )라고 한다.', answer: '목적지', initials: 'ㅁㅈㅈ', aliases: ['목적지'] },
        { no: 9, text: '출발지에서 목적지까지의 길을 (      )라고 한다.', answer: '경로', initials: 'ㄱㄹ', aliases: ['경로'] }
      ]
    },
    quiz: {
      q1_text: '지도를 읽을 때 가장 중요한 요소는 무엇인가요?',
      q1_opts: ['① 지도의 색깔', '② 축척, 방위표, 범례', '③ 지도의 크기', '④ 지도를 만든 사람'],
      q2_text: 'GPS의 장점은 무엇인가요?',
      q2_opts: ['① 종이가 필요 없다', '② 실시간으로 위치를 확인할 수 있다', '③ 배터리가 필요 없다', '④ 항상 정확하다'],
      q3_1_ph: 'ㅊㅊ', q3_2_ph: 'ㅂㅇㅍ',
      q4_1_ph: 'ㅈㅍㅅ', q4_2_ph: 'ㅅㅅㄱ',
      q5_text: '종이 지도와 디지털 지도의 장단점을 비교하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['축척'], q3_2:['방위표'], q4_1:['GPS','지피에스'], q4_2:['실시간'] },
    essayKeywords: ['지도','종이','디지털','GPS','장점','단점'],
    explain: {
      q1:'해설: 축척, 방위표, 범례는 지도 읽기의 핵심 요소.',
      q2:'해설: GPS는 실시간 위치 확인이 가능함.',
      q3:'해설: 축척으로 거리를, 방위표로 방향을 알 수 있음.',
      q4:'해설: GPS는 실시간 위치 추적 가능.',
      q5:'예시: 종이 지도는 배터리 불필요, 디지털은 실시간 업데이트 가능.'
    }
  },

  /* ===== physics_07 : "세계 여러 나라의 위치와 특징" (샘플 데이터) ===== */
  physics_07: {
    labelNo: '07',
    title: '🌍 세계 여러 나라의 위치와 특징',
    passage: [
      '지구에는 약 200개가 넘는 나라가 있으며, 각 나라는 고유한 <b>지리적 위치</b>와 <b>문화</b>를 가지고 있습니다.',
      '나라의 위치는 그 나라의 <b>기후</b>, <b>산업</b>, <b>생활 방식</b>에 큰 영향을 미칩니다. 예를 들어 적도 근처 나라는 더운 날씨, 북극 근처 나라는 추운 날씨를 보입니다.',
      '세계 지도를 통해 각 나라의 위치를 파악하고, 그 특징을 이해하는 것은 <b>국제 이해</b>의 첫걸음입니다.'
    ],
    vocab: [
      ['지리적 위치','지구상에서 특정 지점이 있는 자리'],
      ['문화','한 사회의 생활 양식과 전통'],
      ['기후','어떤 지역의 평균적인 날씨'],
      ['산업','물건을 만들거나 서비스를 제공하는 일'],
      ['생활 방식','사람들이 살아가는 방법'],
      ['적도','지구의 중심을 가로지르는 가상의 선'],
      ['국제 이해','여러 나라를 이해하고 존중하는 태도'],
      ['대륙','지구를 이루는 큰 땅덩어리'],
      ['해양','지구를 둘러싼 넓은 바다']
    ],
    vocabFill: {
      instructions: '[세계 지리 어휘]',
      items: [
        { no: 1, text: '지구상에서 특정 지점이 있는 자리를 (        )라고 한다.', answer: '지리적 위치', initials: 'ㅈㄹㅈ ㅇㅊ', aliases: ['지리적위치'] },
        { no: 2, text: '한 사회의 생활 양식과 전통을 (      )라고 한다.', answer: '문화', initials: 'ㅁㅎ', aliases: ['문화'] },
        { no: 3, text: '어떤 지역의 평균적인 날씨를 (      )라고 한다.', answer: '기후', initials: 'ㄱㅎ', aliases: ['기후'] },
        { no: 4, text: '물건을 만들거나 서비스를 제공하는 일을 (      )이라 한다.', answer: '산업', initials: 'ㅅㅇ', aliases: ['산업'] },
        { no: 5, text: '사람들이 살아가는 방법을 (        )이라 한다.', answer: '생활 방식', initials: 'ㅅㅎ ㅂㅅ', aliases: ['생활방식'] },
        { no: 6, text: '지구의 중심을 가로지르는 가상의 선을 (      )라 한다.', answer: '적도', initials: 'ㅈㄷ', aliases: ['적도'] },
        { no: 7, text: '여러 나라를 이해하고 존중하는 태도를 (        )라 한다.', answer: '국제 이해', initials: 'ㄱㅈ ㅇㅎ', aliases: ['국제이해'] },
        { no: 8, text: '지구를 이루는 큰 땅덩어리를 (      )라고 한다.', answer: '대륙', initials: 'ㄷㄹ', aliases: ['대륙'] },
        { no: 9, text: '지구를 둘러싼 넓은 바다를 (      )라고 한다.', answer: '해양', initials: 'ㅎㅇ', aliases: ['해양'] }
      ]
    },
    quiz: {
      q1_text: '나라의 위치가 그 나라에 미치는 영향으로 가장 알맞은 것은?',
      q1_opts: ['① 위치는 기후와 산업에 영향을 준다', '② 위치는 아무 영향이 없다', '③ 위치는 문화와 무관하다', '④ 모든 나라의 위치는 같다'],
      q2_text: '국제 이해가 중요한 이유는 무엇인가요?',
      q2_opts: ['① 다른 나라를 비판하기 위해', '② 여러 나라를 이해하고 존중하기 위해', '③ 우리나라만 발전시키기 위해', '④ 세계 지도를 외우기 위해'],
      q3_1_ph: 'ㄱㅎ', q3_2_ph: 'ㅅㅇ',
      q4_1_ph: 'ㅈㄷ', q4_2_ph: 'ㄷㄹ',
      q5_text: '세계 여러 나라의 위치를 아는 것이 왜 중요한지 설명해 보세요.'
    },
    answerKey: { q1:'1', q2:'2', q3_1:['기후'], q3_2:['산업'], q4_1:['적도'], q4_2:['대륙'] },
    essayKeywords: ['세계','나라','위치','이해','기후','문화'],
    explain: {
      q1:'해설: 위치는 기후, 산업, 생활 방식에 영향을 미침.',
      q2:'해설: 국제 이해는 다양성 존중의 기초.',
      q3:'해설: 위치에 따라 기후와 산업이 달라짐.',
      q4:'해설: 적도 근처는 더운 기후, 대륙별로 특징 다름.',
      q5:'예시: 각 나라의 문화와 생활을 이해하고 존중하기 위해 필요함.'
    }
  },

  /* ===== physics_08 : "우리나라의 지리적 특성 이해하기" (샘플 데이터) ===== */
  physics_08: {
    labelNo: '08',
    title: '🇰🇷 우리나라의 지리적 특성 이해하기',
    passage: [
      '우리나라는 <b>한반도</b>에 위치하며, 삼면이 바다로 둘러싸여 있습니다. <b>동해</b>, <b>서해</b>, <b>남해</b>가 각각 다른 특징을 가지고 있습니다.',
      '국토의 약 70%가 산지로 이루어져 있어 <b>산악 지형</b>이 발달했습니다. 이로 인해 계곡과 분지가 많으며, 평야는 주로 서해안에 분포합니다.',
      '우리나라는 <b>사계절</b>이 뚜렷하여 계절마다 다른 풍경과 생활 모습을 보입니다.'
    ],
    vocab: [
      ['한반도','우리나라가 위치한 반도'],
      ['동해','한반도 동쪽의 바다'],
      ['서해','한반도 서쪽의 바다'],
      ['남해','한반도 남쪽의 바다'],
      ['산악 지형','산이 많은 땅의 모양'],
      ['평야','넓고 평평한 땅'],
      ['사계절','봄, 여름, 가을, 겨울'],
      ['계곡','산과 산 사이의 골짜기'],
      ['분지','주위가 산으로 둘러싸인 평지']
    ],
    vocabFill: {
      instructions: '[우리나라 지리 어휘]',
      items: [
        { no: 1, text: '우리나라가 위치한 반도를 (      )라고 한다.', answer: '한반도', initials: 'ㅎㅂㄷ', aliases: ['한반도'] },
        { no: 2, text: '한반도 동쪽의 바다를 (      )라고 한다.', answer: '동해', initials: 'ㄷㅎ', aliases: ['동해'] },
        { no: 3, text: '한반도 서쪽의 바다를 (      )라고 한다.', answer: '서해', initials: 'ㅅㅎ', aliases: ['서해'] },
        { no: 4, text: '한반도 남쪽의 바다를 (      )라고 한다.', answer: '남해', initials: 'ㄴㅎ', aliases: ['남해'] },
        { no: 5, text: '산이 많은 땅의 모양을 (        )이라 한다.', answer: '산악 지형', initials: 'ㅅㅇ ㅈㅎ', aliases: ['산악지형'] },
        { no: 6, text: '넓고 평평한 땅을 (      )라고 한다.', answer: '평야', initials: 'ㅍㅇ', aliases: ['평야'] },
        { no: 7, text: '봄, 여름, 가을, 겨울을 (      )이라 한다.', answer: '사계절', initials: 'ㅅㄱㅈ', aliases: ['사계절'] },
        { no: 8, text: '산과 산 사이의 골짜기를 (      )라고 한다.', answer: '계곡', initials: 'ㄱㄱ', aliases: ['계곡'] },
        { no: 9, text: '주위가 산으로 둘러싸인 평지를 (      )라고 한다.', answer: '분지', initials: 'ㅂㅈ', aliases: ['분지'] }
      ]
    },
    quiz: {
      q1_text: '우리나라의 지리적 특징으로 가장 알맞은 것은?',
      q1_opts: ['① 사면이 바다로 둘러싸임', '② 삼면이 바다, 산지 많음', '③ 평야만 있음', '④ 사막이 많음'],
      q2_text: '사계절이 뚜렷한 이유는 무엇인가요?',
      q2_opts: ['① 위도와 기후의 영향', '② 바다가 많아서', '③ 산이 많아서', '④ 인구가 많아서'],
      q3_1_ph: 'ㅎㅂㄷ', q3_2_ph: 'ㅅㅇ ㅈㅎ',
      q4_1_ph: 'ㅅㄱㅈ', q4_2_ph: 'ㅍㅇ',
      q5_text: '우리나라의 지리적 특징이 우리 생활에 미치는 영향을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['한반도'], q3_2:['산악지형','산악 지형'], q4_1:['사계절'], q4_2:['평야'] },
    essayKeywords: ['한반도','산','바다','사계절','평야','생활'],
    explain: {
      q1:'해설: 삼면이 바다, 국토의 70%가 산지.',
      q2:'해설: 위도와 기후의 영향으로 사계절 뚜렷.',
      q3:'해설: 한반도는 산악 지형이 발달.',
      q4:'해설: 사계절과 평야가 농업에 영향.',
      q5:'예시: 산지는 등산 문화, 바다는 어업, 사계절은 다양한 계절 행사.'
    }
  },

  /* ===== physics_09 : "자연재해와 인간의 대응" (샘플 데이터) ===== */
  physics_09: {
    labelNo: '09',
    title: '⚠️ 자연재해와 인간의 대응',
    passage: [
      '자연재해는 <b>지진</b>, <b>태풍</b>, <b>홍수</b>, <b>가뭄</b> 등 자연 현상으로 인해 발생하는 피해를 말합니다.',
      '이러한 재해는 인간의 생명과 재산에 큰 피해를 주지만, 사전에 철저히 <b>대비</b>하고 <b>대응</b>하면 피해를 줄일 수 있습니다.',
      '최근에는 <b>재해 예측 시스템</b>과 <b>대피 훈련</b>을 통해 피해를 최소화하려는 노력이 이루어지고 있습니다.'
    ],
    vocab: [
      ['자연재해','자연 현상으로 인한 큰 피해'],
      ['지진','땅이 흔들리는 현상'],
      ['태풍','강한 바람과 비를 동반하는 열대 저기압'],
      ['홍수','물이 넘쳐 피해를 주는 현상'],
      ['가뭄','오랫동안 비가 오지 않는 현상'],
      ['대비','미리 준비하는 것'],
      ['대응','상황에 맞게 행동하는 것'],
      ['재해 예측 시스템','재해를 미리 알려주는 기술'],
      ['대피 훈련','위험 상황에서 안전하게 피하는 연습']
    ],
    vocabFill: {
      instructions: '[자연재해 어휘]',
      items: [
        { no: 1, text: '자연 현상으로 인한 큰 피해를 (        )라고 한다.', answer: '자연재해', initials: 'ㅈㅇ ㅈㅎ', aliases: ['자연재해'] },
        { no: 2, text: '땅이 흔들리는 현상을 (      )이라고 한다.', answer: '지진', initials: 'ㅈㅈ', aliases: ['지진'] },
        { no: 3, text: '강한 바람과 비를 동반하는 열대 저기압을 (      )이라 한다.', answer: '태풍', initials: 'ㅌㅍ', aliases: ['태풍'] },
        { no: 4, text: '물이 넘쳐 피해를 주는 현상을 (      )라고 한다.', answer: '홍수', initials: 'ㅎㅅ', aliases: ['홍수'] },
        { no: 5, text: '오랫동안 비가 오지 않는 현상을 (      )이라 한다.', answer: '가뭄', initials: 'ㄱㅁ', aliases: ['가뭄'] },
        { no: 6, text: '미리 준비하는 것을 (      )라고 한다.', answer: '대비', initials: 'ㄷㅂ', aliases: ['대비'] },
        { no: 7, text: '상황에 맞게 행동하는 것을 (      )라고 한다.', answer: '대응', initials: 'ㄷㅇ', aliases: ['대응'] },
        { no: 8, text: '재해를 미리 알려주는 기술을 (            )이라 한다.', answer: '재해 예측 시스템', initials: 'ㅈㅎ ㅇㅊ ㅅㅅㅌ', aliases: ['재해예측시스템'] },
        { no: 9, text: '위험 상황에서 안전하게 피하는 연습을 (        )이라 한다.', answer: '대피 훈련', initials: 'ㄷㅍ ㅎㄹ', aliases: ['대피훈련'] }
      ]
    },
    quiz: {
      q1_text: '자연재해 피해를 줄이는 방법으로 가장 알맞은 것은?',
      q1_opts: ['① 아무것도 하지 않기', '② 사전 대비와 대응', '③ 재해 후에만 행동', '④ 무조건 피하기'],
      q2_text: '대피 훈련이 중요한 이유는 무엇인가요?',
      q2_opts: ['① 재미있어서', '② 위험 상황에서 빠르게 대응하기 위해', '③ 시간을 보내기 위해', '④ 법으로 정해져서'],
      q3_1_ph: 'ㅈㅈ', q3_2_ph: 'ㅌㅍ',
      q4_1_ph: 'ㄷㅂ', q4_2_ph: 'ㄷㅇ',
      q5_text: '자연재해가 발생했을 때 우리가 해야 할 행동을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['지진'], q3_2:['태풍'], q4_1:['대비'], q4_2:['대응'] },
    essayKeywords: ['재해','대비','대응','안전','대피','예방'],
    explain: {
      q1:'해설: 사전 대비와 신속한 대응이 피해를 줄임.',
      q2:'해설: 대피 훈련은 실제 상황에서 생명을 구함.',
      q3:'해설: 지진, 태풍 등 다양한 자연재해 존재.',
      q4:'해설: 미리 대비하고 상황에 맞게 대응해야 함.',
      q5:'예시: 안전한 곳으로 대피하고, 긴급 연락망을 확인하며, 침착하게 행동.'
    }
  },

  /* ===== physics_10 : "환경 문제와 지속 가능한 발전" (샘플 데이터) ===== */
  physics_10: {
    labelNo: '10',
    title: '🌱 환경 문제와 지속 가능한 발전',
    passage: [
      '현대 사회는 <b>환경 오염</b>, <b>지구 온난화</b>, <b>생물 다양성 감소</b> 등 심각한 환경 문제에 직면해 있습니다.',
      '이러한 문제를 해결하기 위해서는 <b>재생 에너지</b> 사용, <b>재활용</b>, <b>탄소 배출 감소</b> 등의 노력이 필요합니다.',
      '<b>지속 가능한 발전</b>은 현재 세대의 필요를 충족하면서도 미래 세대의 환경을 보호하는 것을 의미합니다.'
    ],
    vocab: [
      ['환경 오염','공기, 물, 토양이 더러워지는 것'],
      ['지구 온난화','지구의 평균 기온이 높아지는 현상'],
      ['생물 다양성','여러 종류의 생물이 존재하는 것'],
      ['재생 에너지','다시 만들어 쓸 수 있는 에너지'],
      ['재활용','쓴 물건을 다시 사용하는 것'],
      ['탄소 배출','이산화탄소를 내보내는 것'],
      ['지속 가능한 발전','미래를 위한 균형 잡힌 발전'],
      ['온실가스','지구를 덥게 만드는 기체'],
      ['친환경','환경을 보호하는']
    ],
    vocabFill: {
      instructions: '[환경과 발전 어휘]',
      items: [
        { no: 1, text: '공기, 물, 토양이 더러워지는 것을 (        )이라 한다.', answer: '환경 오염', initials: 'ㅎㄱ ㅇㅇ', aliases: ['환경오염'] },
        { no: 2, text: '지구의 평균 기온이 높아지는 현상을 (          )이라 한다.', answer: '지구 온난화', initials: 'ㅈㄱ ㅇㄴㅎ', aliases: ['지구온난화'] },
        { no: 3, text: '여러 종류의 생물이 존재하는 것을 (          )이라 한다.', answer: '생물 다양성', initials: 'ㅅㅁ ㄷㅇㅅ', aliases: ['생물다양성'] },
        { no: 4, text: '다시 만들어 쓸 수 있는 에너지를 (        )라 한다.', answer: '재생 에너지', initials: 'ㅈㅅ ㅇㄴㅈ', aliases: ['재생에너지'] },
        { no: 5, text: '쓴 물건을 다시 사용하는 것을 (      )이라 한다.', answer: '재활용', initials: 'ㅈㅎㅇ', aliases: ['재활용'] },
        { no: 6, text: '이산화탄소를 내보내는 것을 (        )이라 한다.', answer: '탄소 배출', initials: 'ㅌㅅ ㅂㅊ', aliases: ['탄소배출'] },
        { no: 7, text: '미래를 위한 균형 잡힌 발전을 (            )이라 한다.', answer: '지속 가능한 발전', initials: 'ㅈㅅ ㄱㄴㅎ ㅂㅈ', aliases: ['지속가능한발전'] },
        { no: 8, text: '지구를 덥게 만드는 기체를 (      )라고 한다.', answer: '온실가스', initials: 'ㅇㅅㄱㅅ', aliases: ['온실가스'] },
        { no: 9, text: '환경을 보호하는 것을 (      )이라고 한다.', answer: '친환경', initials: 'ㅊㅎㄱ', aliases: ['친환경'] }
      ]
    },
    quiz: {
      q1_text: '지속 가능한 발전의 의미로 가장 알맞은 것은?',
      q1_opts: ['① 현재만 생각', '② 미래 세대도 고려', '③ 개발 중단', '④ 환경 파괴'],
      q2_text: '환경 보호를 위해 우리가 할 수 있는 일은?',
      q2_opts: ['① 일회용품 많이 쓰기', '② 재활용하기', '③ 에너지 낭비', '④ 쓰레기 버리기'],
      q3_1_ph: 'ㅎㄱ ㅇㅇ', q3_2_ph: 'ㅈㄱ ㅇㄴㅎ',
      q4_1_ph: 'ㅈㅎㅇ', q4_2_ph: 'ㅈㅅ ㅇㄴㅈ',
      q5_text: '지속 가능한 발전을 위해 개인이 실천할 수 있는 방법을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['환경오염','환경 오염'], q3_2:['지구온난화','지구 온난화'], q4_1:['재활용'], q4_2:['재생에너지','재생 에너지'] },
    essayKeywords: ['환경','재활용','에너지','탄소','지속','실천'],
    explain: {
      q1:'해설: 지속 가능한 발전은 미래 세대를 고려한 균형 발전.',
      q2:'해설: 재활용은 환경 보호의 기본 실천.',
      q3:'해설: 환경 오염과 지구 온난화는 현대의 주요 문제.',
      q4:'해설: 재활용과 재생 에너지가 핵심 해결책.',
      q5:'예시: 일회용품 줄이기, 분리수거, 대중교통 이용, 에너지 절약.'
    }
  },

  /* ===== physics_11 ~ physics_20 샘플 데이터 (더 간략하게) ===== */

  physics_11: {
    labelNo: '11',
    title: '🏙️ 도시와 농촌의 차이',
    passage: ['도시는 인구가 많고 다양한 산업이 발달한 곳입니다.','농촌은 자연과 가까우며 농업이 중심입니다.','각각의 특징을 이해하고 조화롭게 발전해야 합니다.'],
    vocab: [['도시','인구와 시설이 밀집한 곳'],['농촌','농업 중심의 시골 지역'],['인구 밀집','사람이 많이 모여 사는 것'],['산업','생산과 서비스 활동'],['농업','농사를 짓는 일'],['교통','이동 수단과 시스템'],['인프라','기반 시설'],['생활 환경','사람들이 사는 조건'],['조화','균형 있게 어울림']],
    vocabFill: { instructions: '[도시와 농촌]', items: [
      {no:1,text:'인구와 시설이 밀집한 곳을 (   )라고 한다.',answer:'도시',initials:'ㄷㅅ',aliases:['도시']},
      {no:2,text:'농업 중심의 시골 지역을 (   )이라 한다.',answer:'농촌',initials:'ㄴㅊ',aliases:['농촌']},
      {no:3,text:'사람이 많이 모여 사는 것을 (      )이라 한다.',answer:'인구 밀집',initials:'ㅇㄱ ㅁㅈ',aliases:['인구밀집']},
      {no:4,text:'생산과 서비스 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:5,text:'농사를 짓는 일을 (   )이라 한다.',answer:'농업',initials:'ㄴㅇ',aliases:['농업']},
      {no:6,text:'이동 수단과 시스템을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:7,text:'기반 시설을 (     )라고 한다.',answer:'인프라',initials:'ㅇㅍㄹ',aliases:['인프라']},
      {no:8,text:'사람들이 사는 조건을 (      )이라 한다.',answer:'생활 환경',initials:'ㅅㅎ ㅎㄱ',aliases:['생활환경']},
      {no:9,text:'균형 있게 어울림을 (   )라고 한다.',answer:'조화',initials:'ㅈㅎ',aliases:['조화']}
    ]},
    quiz: {q1_text:'도시의 특징은?',q1_opts:['① 인구 많음','② 인구 적음','③ 농업만','④ 시설 없음'],q2_text:'농촌의 장점은?',q2_opts:['① 자연과 가까움','② 시설 많음','③ 인구 많음','④ 공기 나쁨'],q3_1_ph:'ㄷㅅ',q3_2_ph:'ㄴㅊ',q4_1_ph:'ㅅㅇ',q4_2_ph:'ㄴㅇ',q5_text:'도시와 농촌이 조화롭게 발전하려면 어떻게 해야 할까요?'},
    answerKey: {q1:'1',q2:'1',q3_1:['도시'],q3_2:['농촌'],q4_1:['산업'],q4_2:['농업']},
    essayKeywords: ['도시','농촌','조화','발전','균형'],
    explain: {q1:'해설: 도시는 인구와 시설이 밀집.',q2:'해설: 농촌은 자연환경이 좋음.',q3:'해설: 도시와 농촌 각각의 특징.',q4:'해설: 도시=산업, 농촌=농업.',q5:'예시: 상호 교류와 균형 발전 필요.'}
  },

  physics_12: {
    labelNo: '12',
    title: '🚄 교통과 통신의 발달',
    passage: ['교통은 사람과 물건을 옮기는 수단입니다.','통신은 정보를 주고받는 방법입니다.','둘 다 현대 사회를 연결하는 중요한 역할을 합니다.'],
    vocab: [['교통','이동 수단'],['통신','정보 전달'],['발달','발전하여 나아감'],['연결','이어 붙임'],['정보','알아야 할 내용'],['수단','방법이나 도구'],['네트워크','연결망'],['기술','과학적 방법'],['현대','지금의 시대']],
    vocabFill: { instructions: '[교통과 통신]', items: [
      {no:1,text:'이동 수단을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:2,text:'정보 전달을 (   )이라 한다.',answer:'통신',initials:'ㅌㅅ',aliases:['통신']},
      {no:3,text:'발전하여 나아감을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:4,text:'이어 붙임을 (   )이라 한다.',answer:'연결',initials:'ㅇㄱ',aliases:['연결']},
      {no:5,text:'알아야 할 내용을 (   )이라 한다.',answer:'정보',initials:'ㅈㅂ',aliases:['정보']},
      {no:6,text:'방법이나 도구를 (   )이라 한다.',answer:'수단',initials:'ㅅㄷ',aliases:['수단']},
      {no:7,text:'연결망을 (     )라고 한다.',answer:'네트워크',initials:'ㄴㅌㅇㅋ',aliases:['네트워크']},
      {no:8,text:'과학적 방법을 (   )이라 한다.',answer:'기술',initials:'ㄱㅅ',aliases:['기술']},
      {no:9,text:'지금의 시대를 (   )라고 한다.',answer:'현대',initials:'ㅎㄷ',aliases:['현대']}
    ]},
    quiz: {q1_text:'교통 발달의 영향은?',q1_opts:['① 이동 빨라짐','② 느려짐','③ 정보만 전달','④ 변화 없음'],q2_text:'통신의 중요성은?',q2_opts:['① 정보 빠르게 전달','② 필요 없음','③ 이동만 가능','④ 느림'],q3_1_ph:'ㄱㅌ',q3_2_ph:'ㅌㅅ',q4_1_ph:'ㅂㄷ',q4_2_ph:'ㄱㅅ',q5_text:'교통과 통신의 발달이 우리 생활에 미친 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['교통'],q3_2:['통신'],q4_1:['발달'],q4_2:['기술']},
    essayKeywords: ['교통','통신','발달','연결','편리','생활'],
    explain: {q1:'해설: 교통 발달로 이동 시간 단축.',q2:'해설: 통신으로 정보 신속 전달.',q3:'해설: 교통과 통신의 정의.',q4:'해설: 기술 발달이 핵심.',q5:'예시: 빠른 이동, 즉각적 정보 교환, 세계화 촉진.'}
  },

  physics_13: {
    labelNo: '13',
    title: '👨‍👩‍👧‍👦 인구 분포와 이동',
    passage: ['인구는 사람들이 사는 지역에 따라 분포가 다릅니다.','일자리와 생활 환경을 찾아 사람들이 이동합니다.','인구 분포와 이동은 지역 발전에 영향을 줍니다.'],
    vocab: [['인구','사람의 수'],['분포','퍼져 있는 상태'],['이동','장소를 옮김'],['도시화','도시로 인구 집중'],['일자리','직업과 고용'],['환경','주변 조건'],['밀도','단위 면적당 수'],['이촌향도','농촌→도시'],['정주','한곳에 머무름']],
    vocabFill: { instructions: '[인구 분포와 이동]', items: [
      {no:1,text:'사람의 수를 (   )라고 한다.',answer:'인구',initials:'ㅇㄱ',aliases:['인구']},
      {no:2,text:'퍼져 있는 상태를 (   )라 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:3,text:'장소를 옮김을 (   )이라 한다.',answer:'이동',initials:'ㅇㄷ',aliases:['이동']},
      {no:4,text:'도시로 인구가 집중되는 것을 (    )라고 한다.',answer:'도시화',initials:'ㄷㅅㅎ',aliases:['도시화']},
      {no:5,text:'직업과 고용을 (    )라고 한다.',answer:'일자리',initials:'ㅇㅈㄹ',aliases:['일자리']},
      {no:6,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:7,text:'단위 면적당 수를 (   )라고 한다.',answer:'밀도',initials:'ㅁㄷ',aliases:['밀도']},
      {no:8,text:'농촌에서 도시로 이동을 (      )라고 한다.',answer:'이촌향도',initials:'ㅇㅊㅎㄷ',aliases:['이촌향도']},
      {no:9,text:'한곳에 머무름을 (   )라고 한다.',answer:'정주',initials:'ㅈㅈ',aliases:['정주']}
    ]},
    quiz: {q1_text:'인구 이동의 주요 원인은?',q1_opts:['① 일자리','② 무관심','③ 강제','④ 여행'],q2_text:'도시화의 문제점은?',q2_opts:['① 인구 집중','② 인구 감소','③ 발전 없음','④ 농업 증가'],q3_1_ph:'ㅇㄱ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅇㄷ',q4_2_ph:'ㄷㅅㅎ',q5_text:'인구 이동이 지역에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['인구'],q3_2:['분포'],q4_1:['이동'],q4_2:['도시화']},
    essayKeywords: ['인구','이동','분포','도시','일자리','영향'],
    explain: {q1:'해설: 일자리를 찾아 이동.',q2:'해설: 도시 인구 집중 문제.',q3:'해설: 인구와 분포 정의.',q4:'해설: 이동과 도시화.',q5:'예시: 도시는 과밀, 농촌은 과소화.'}
  },

  physics_14: {
    labelNo: '14',
    title: '🏭 산업의 발달과 지역 변화',
    passage: ['산업이 발달하면서 지역의 모습이 크게 변했습니다.','공업 지역과 상업 지역이 생겨났습니다.','산업 발달은 경제 성장을 가져오지만 환경 문제도 발생합니다.'],
    vocab: [['산업','생산 활동'],['공업','제품 제조'],['상업','물건 사고파는 일'],['발달','성장하여 발전'],['경제','재화와 서비스'],['지역','특정한 장소'],['성장','커지고 발전'],['환경 문제','자연 훼손'],['균형 발전','골고루 발전']],
    vocabFill: { instructions: '[산업과 지역]', items: [
      {no:1,text:'생산 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:2,text:'제품 제조를 (   )이라 한다.',answer:'공업',initials:'ㄱㅇ',aliases:['공업']},
      {no:3,text:'물건 사고파는 일을 (   )이라 한다.',answer:'상업',initials:'ㅅㅇ',aliases:['상업']},
      {no:4,text:'성장하여 발전함을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:5,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:6,text:'특정한 장소를 (   )라고 한다.',answer:'지역',initials:'ㅈㅇ',aliases:['지역']},
      {no:7,text:'커지고 발전함을 (   )이라 한다.',answer:'성장',initials:'ㅅㅈ',aliases:['성장']},
      {no:8,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:9,text:'골고루 발전을 (      )이라 한다.',answer:'균형 발전',initials:'ㄱㅎ ㅂㅈ',aliases:['균형발전']}
    ]},
    quiz: {q1_text:'산업 발달의 긍정적 영향은?',q1_opts:['① 경제 성장','② 환경 파괴','③ 인구 감소','④ 후퇴'],q2_text:'산업 발달의 문제점은?',q2_opts:['① 환경 오염','② 발전 없음','③ 인구 증가','④ 기술 퇴보'],q3_1_ph:'ㅅㅇ',q3_2_ph:'ㄱㅇ',q4_1_ph:'ㄱㅈ',q4_2_ph:'ㅎㄱ',q5_text:'산업 발달이 지역에 미친 변화를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['산업'],q3_2:['공업'],q4_1:['경제'],q4_2:['환경']},
    essayKeywords: ['산업','발달','지역','경제','환경','변화'],
    explain: {q1:'해설: 산업 발달로 경제 성장.',q2:'해설: 환경 오염 발생.',q3:'해설: 산업과 공업.',q4:'해설: 경제와 환경.',q5:'예시: 도시 형성, 일자리 증가, 환경 오염.'}
  },

  physics_15: {
    labelNo: '15',
    title: '🌦️ 세계의 다양한 기후',
    passage: ['세계 각지는 다양한 기후를 가지고 있습니다.','기후는 그 지역의 생활과 문화에 영향을 줍니다.','열대, 온대, 한대 등 기후대가 있습니다.'],
    vocab: [['기후','평균 날씨'],['열대','매우 더운 지역'],['온대','따뜻한 지역'],['한대','매우 추운 지역'],['기후대','기후 구분 영역'],['강수량','비 오는 양'],['기온','공기의 온도'],['계절','시간에 따른 날씨 변화'],['영향','결과에 미치는 힘']],
    vocabFill: { instructions: '[세계 기후]', items: [
      {no:1,text:'평균 날씨를 (   )라고 한다.',answer:'기후',initials:'ㄱㅎ',aliases:['기후']},
      {no:2,text:'매우 더운 지역을 (   )라고 한다.',answer:'열대',initials:'ㅇㄷ',aliases:['열대']},
      {no:3,text:'따뜻한 지역을 (   )라고 한다.',answer:'온대',initials:'ㅇㄷ',aliases:['온대']},
      {no:4,text:'매우 추운 지역을 (   )라고 한다.',answer:'한대',initials:'ㅎㄷ',aliases:['한대']},
      {no:5,text:'기후 구분 영역을 (    )라고 한다.',answer:'기후대',initials:'ㄱㅎㄷ',aliases:['기후대']},
      {no:6,text:'비 오는 양을 (    )라고 한다.',answer:'강수량',initials:'ㄱㅅㄹ',aliases:['강수량']},
      {no:7,text:'공기의 온도를 (   )이라 한다.',answer:'기온',initials:'ㄱㅇ',aliases:['기온']},
      {no:8,text:'시간에 따른 날씨 변화를 (   )이라 한다.',answer:'계절',initials:'ㄱㅈ',aliases:['계절']},
      {no:9,text:'결과에 미치는 힘을 (   )이라 한다.',answer:'영향',initials:'ㅇㅎ',aliases:['영향']}
    ]},
    quiz: {q1_text:'기후가 생활에 미치는 영향은?',q1_opts:['① 의식주 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'열대 기후의 특징은?',q2_opts:['① 매우 더움','② 매우 추움','③ 사계절 뚜렷','④ 비 안 옴'],q3_1_ph:'ㄱㅎ',q3_2_ph:'ㅇㄷ',q4_1_ph:'ㄱㅎㄷ',q4_2_ph:'ㄱㅅㄹ',q5_text:'기후가 지역 문화에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['기후'],q3_2:['열대'],q4_1:['기후대'],q4_2:['강수량']},
    essayKeywords: ['기후','열대','온대','한대','생활','문화'],
    explain: {q1:'해설: 기후가 의식주 결정.',q2:'해설: 열대는 매우 더움.',q3:'해설: 기후와 열대.',q4:'해설: 기후대와 강수량.',q5:'예시: 더운 지역은 가벼운 옷, 추운 지역은 두꺼운 옷.'}
  },

  physics_16: {
    labelNo: '16',
    title: '⛏️ 자원의 분포와 이용',
    passage: ['자원은 인간에게 필요한 물질입니다.','석유, 석탄, 광물 등이 있습니다.','자원은 지역마다 분포가 다르며 한정적입니다.'],
    vocab: [['자원','필요한 물질'],['석유','연료 원료'],['석탄','연료 광물'],['광물','땅속 자원'],['분포','퍼진 상태'],['한정적','제한된'],['이용','사용함'],['채굴','캐냄'],['보존','아껴 지킴']],
    vocabFill: { instructions: '[자원 분포와 이용]', items: [
      {no:1,text:'필요한 물질을 (   )이라 한다.',answer:'자원',initials:'ㅈㅇ',aliases:['자원']},
      {no:2,text:'연료 원료를 (   )라고 한다.',answer:'석유',initials:'ㅅㅇ',aliases:['석유']},
      {no:3,text:'연료 광물을 (   )이라 한다.',answer:'석탄',initials:'ㅅㅌ',aliases:['석탄']},
      {no:4,text:'땅속 자원을 (   )이라 한다.',answer:'광물',initials:'ㄱㅁ',aliases:['광물']},
      {no:5,text:'퍼진 상태를 (   )라고 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:6,text:'제한된 것을 (    )이라고 한다.',answer:'한정적',initials:'ㅎㅈㅈ',aliases:['한정적']},
      {no:7,text:'사용함을 (   )이라 한다.',answer:'이용',initials:'ㅇㅇ',aliases:['이용']},
      {no:8,text:'캐냄을 (   )이라 한다.',answer:'채굴',initials:'ㅊㄱ',aliases:['채굴']},
      {no:9,text:'아껴 지킴을 (   )이라 한다.',answer:'보존',initials:'ㅂㅈ',aliases:['보존']}
    ]},
    quiz: {q1_text:'자원이 한정적인 이유는?',q1_opts:['① 다시 안 만들어짐','② 무한함','③ 필요 없음','④ 항상 생김'],q2_text:'자원 보존 방법은?',q2_opts:['① 아껴 쓰기','② 많이 쓰기','③ 버리기','④ 무시하기'],q3_1_ph:'ㅈㅇ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅎㅈㅈ',q4_2_ph:'ㅂㅈ',q5_text:'자원을 아껴 써야 하는 이유를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['자원'],q3_2:['분포'],q4_1:['한정적'],q4_2:['보존']},
    essayKeywords: ['자원','한정','보존','이용','미래'],
    explain: {q1:'해설: 자원은 다시 안 만들어짐.',q2:'해설: 아껴 쓰는 것이 보존.',q3:'해설: 자원과 분포.',q4:'해설: 한정적이므로 보존 필요.',q5:'예시: 미래 세대를 위해 자원 절약 필요.'}
  },

  physics_17: {
    labelNo: '17',
    title: '🎭 문화와 지리적 특성',
    passage: ['지리적 환경은 문화 형성에 영향을 줍니다.','산지, 해안, 평야 등에 따라 다른 문화가 발달합니다.','문화는 지역의 정체성을 만듭니다.'],
    vocab: [['문화','생활 양식'],['지리적','땅과 관련된'],['환경','주변 조건'],['정체성','고유한 특성'],['전통','옛것을 이어옴'],['풍습','관습과 습관'],['의식주','옷,음식,집'],['다양성','여러 가지'],['공존','함께 존재']],
    vocabFill: { instructions: '[문화와 지리]', items: [
      {no:1,text:'생활 양식을 (   )이라 한다.',answer:'문화',initials:'ㅁㅎ',aliases:['문화']},
      {no:2,text:'땅과 관련된 것을 (    )이라고 한다.',answer:'지리적',initials:'ㅈㄹㅈ',aliases:['지리적']},
      {no:3,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:4,text:'고유한 특성을 (    )이라 한다.',answer:'정체성',initials:'ㅈㅊㅅ',aliases:['정체성']},
      {no:5,text:'옛것을 이어옴을 (   )이라 한다.',answer:'전통',initials:'ㅈㅌ',aliases:['전통']},
      {no:6,text:'관습과 습관을 (   )이라 한다.',answer:'풍습',initials:'ㅍㅅ',aliases:['풍습']},
      {no:7,text:'옷,음식,집을 (    )라고 한다.',answer:'의식주',initials:'ㅇㅅㅈ',aliases:['의식주']},
      {no:8,text:'여러 가지를 (    )라고 한다.',answer:'다양성',initials:'ㄷㅇㅅ',aliases:['다양성']},
      {no:9,text:'함께 존재함을 (   )이라 한다.',answer:'공존',initials:'ㄱㅈ',aliases:['공존']}
    ]},
    quiz: {q1_text:'지리적 환경이 문화에 미치는 영향은?',q1_opts:['① 생활 방식 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'문화 다양성의 의미는?',q2_opts:['① 여러 문화 존중','② 한 가지만','③ 무시함','④ 통일'],q3_1_ph:'ㅁㅎ',q3_2_ph:'ㅈㄹㅈ',q4_1_ph:'ㅈㅊㅅ',q4_2_ph:'ㄷㅇㅅ',q5_text:'지리적 환경이 문화 형성에 어떤 영향을 주는지 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['문화'],q3_2:['지리적'],q4_1:['정체성'],q4_2:['다양성']},
    essayKeywords: ['문화','지리','환경','다양성','정체성'],
    explain: {q1:'해설: 환경이 생활 방식 결정.',q2:'해설: 다양성은 여러 문화 존중.',q3:'해설: 문화와 지리적.',q4:'해설: 정체성과 다양성.',q5:'예시: 산지는 산림 문화, 해안은 어업 문화 발달.'}
  },

  physics_18: {
    labelNo: '18',
    title: '🌐 국제 무역과 경제 협력',
    passage: ['국가 간 물건을 사고파는 것을 무역이라 합니다.','무역은 경제 발전에 도움을 줍니다.','국제 협력으로 함께 발전할 수 있습니다.'],
    vocab: [['무역','국가 간 거래'],['수출','물건 팔기'],['수입','물건 사기'],['경제','재화와 서비스'],['협력','함께 도움'],['국제','나라 사이'],['발전','성장함'],['교류','주고받음'],['상호 의존','서로 의지']],
    vocabFill: { instructions: '[국제 무역]', items: [
      {no:1,text:'국가 간 거래를 (   )라고 한다.',answer:'무역',initials:'ㅁㅇ',aliases:['무역']},
      {no:2,text:'물건 팔기를 (   )라고 한다.',answer:'수출',initials:'ㅅㅊ',aliases:['수출']},
      {no:3,text:'물건 사기를 (   )라고 한다.',answer:'수입',initials:'ㅅㅇ',aliases:['수입']},
      {no:4,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:5,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:6,text:'나라 사이를 (   )라고 한다.',answer:'국제',initials:'ㄱㅈ',aliases:['국제']},
      {no:7,text:'성장함을 (   )이라 한다.',answer:'발전',initials:'ㅂㅈ',aliases:['발전']},
      {no:8,text:'주고받음을 (   )이라 한다.',answer:'교류',initials:'ㄱㄹ',aliases:['교류']},
      {no:9,text:'서로 의지함을 (      )라고 한다.',answer:'상호 의존',initials:'ㅅㅎ ㅇㅈ',aliases:['상호의존']}
    ]},
    quiz: {q1_text:'무역의 장점은?',q1_opts:['① 경제 성장','② 고립','③ 감소','④ 중단'],q2_text:'국제 협력이 중요한 이유는?',q2_opts:['① 함께 발전','② 경쟁만','③ 단절','④ 무시'],q3_1_ph:'ㅁㅇ',q3_2_ph:'ㅅㅊ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㄱㅈ',q5_text:'국제 무역이 경제에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['무역'],q3_2:['수출'],q4_1:['협력'],q4_2:['국제']},
    essayKeywords: ['무역','수출','수입','협력','발전'],
    explain: {q1:'해설: 무역으로 경제 성장.',q2:'해설: 협력으로 함께 발전.',q3:'해설: 무역과 수출.',q4:'해설: 협력과 국제.',q5:'예시: 필요한 물건 교환, 경제 활성화, 상호 발전.'}
  },

  physics_19: {
    labelNo: '19',
    title: '🌏 지구촌 문제와 해결 방안',
    passage: ['지구촌은 전 세계가 하나로 연결된 것입니다.','환경, 빈곤, 전쟁 등 공동 문제가 있습니다.','협력하여 함께 해결해야 합니다.'],
    vocab: [['지구촌','세계가 하나로'],['환경 문제','자연 훼손'],['빈곤','가난한 상태'],['전쟁','무력 충돌'],['해결','문제 풀기'],['협력','함께 도움'],['공동','함께 하는'],['지속 가능','미래도 유지'],['연대','함께 뭉침']],
    vocabFill: { instructions: '[지구촌 문제]', items: [
      {no:1,text:'세계가 하나로 연결된 것을 (    )라고 한다.',answer:'지구촌',initials:'ㅈㄱㅊ',aliases:['지구촌']},
      {no:2,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:3,text:'가난한 상태를 (   )이라 한다.',answer:'빈곤',initials:'ㅂㄱ',aliases:['빈곤']},
      {no:4,text:'무력 충돌을 (   )이라 한다.',answer:'전쟁',initials:'ㅈㅈ',aliases:['전쟁']},
      {no:5,text:'문제 풀기를 (   )이라 한다.',answer:'해결',initials:'ㅎㄱ',aliases:['해결']},
      {no:6,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:7,text:'함께 하는 것을 (   )이라 한다.',answer:'공동',initials:'ㄱㄷ',aliases:['공동']},
      {no:8,text:'미래도 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'함께 뭉침을 (   )라고 한다.',answer:'연대',initials:'ㅇㄷ',aliases:['연대']}
    ]},
    quiz: {q1_text:'지구촌 문제 해결 방법은?',q1_opts:['① 국제 협력','② 무시','③ 방치','④ 혼자 해결'],q2_text:'지속 가능 발전이 중요한 이유는?',q2_opts:['① 미래 세대 위해','② 현재만','③ 개발만','④ 파괴'],q3_1_ph:'ㅈㄱㅊ',q3_2_ph:'ㅎㄱ ㅁㅈ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㅎㄱ',q5_text:'지구촌 문제를 해결하기 위해 우리가 할 수 있는 일을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['지구촌'],q3_2:['환경문제','환경 문제'],q4_1:['협력'],q4_2:['해결']},
    essayKeywords: ['지구촌','협력','환경','해결','지속'],
    explain: {q1:'해설: 국제 협력으로 해결.',q2:'해설: 미래 세대를 위해.',q3:'해설: 지구촌과 환경 문제.',q4:'해설: 협력과 해결.',q5:'예시: 환경 보호, 기부, 봉사, 평화 노력.'}
  },

  physics_20: {
    labelNo: '20',
    title: '🔮 미래의 지리적 변화와 전망',
    passage: ['미래에는 기후 변화와 기술 발전이 지리를 바꿀 것입니다.','새로운 도시와 교통 수단이 생길 것입니다.','우리는 미래를 준비하고 대비해야 합니다.'],
    vocab: [['미래','앞으로의 시간'],['전망','예상과 예측'],['변화','달라짐'],['기술 발전','과학 진보'],['기후 변화','날씨 변동'],['대비','준비함'],['예측','미리 짐작'],['지속 가능','미래 유지'],['혁신','새로운 변화']],
    vocabFill: { instructions: '[미래 전망]', items: [
      {no:1,text:'앞으로의 시간을 (   )라고 한다.',answer:'미래',initials:'ㅁㄹ',aliases:['미래']},
      {no:2,text:'예상과 예측을 (   )이라 한다.',answer:'전망',initials:'ㅈㅁ',aliases:['전망']},
      {no:3,text:'달라짐을 (   )이라 한다.',answer:'변화',initials:'ㅂㅎ',aliases:['변화']},
      {no:4,text:'과학 진보를 (      )이라 한다.',answer:'기술 발전',initials:'ㄱㅅ ㅂㅈ',aliases:['기술발전']},
      {no:5,text:'날씨 변동을 (      )이라 한다.',answer:'기후 변화',initials:'ㄱㅎ ㅂㅎ',aliases:['기후변화']},
      {no:6,text:'준비함을 (   )라고 한다.',answer:'대비',initials:'ㄷㅂ',aliases:['대비']},
      {no:7,text:'미리 짐작함을 (   )이라 한다.',answer:'예측',initials:'ㅇㅊ',aliases:['예측']},
      {no:8,text:'미래 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'새로운 변화를 (   )이라 한다.',answer:'혁신',initials:'ㅎㅅ',aliases:['혁신']}
    ]},
    quiz: {q1_text:'미래 지리 변화의 주요 요인은?',q1_opts:['① 기후·기술','② 변화 없음','③ 과거만','④ 무관심'],q2_text:'미래를 준비하는 방법은?',q2_opts:['① 지속 가능 발전','② 방치','③ 무시','④ 파괴'],q3_1_ph:'ㅁㄹ',q3_2_ph:'ㅂㅎ',q4_1_ph:'ㄱㅅ ㅂㅈ',q4_2_ph:'ㄷㅂ',q5_text:'미래의 지리적 변화를 예측하고 우리가 준비해야 할 것을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['미래'],q3_2:['변화'],q4_1:['기술발전','기술 발전'],q4_2:['대비']},
    essayKeywords: ['미래','변화','기술','기후','준비','지속'],
    explain: {q1:'해설: 기후 변화와 기술 발전이 주요 요인.',q2:'해설: 지속 가능한 발전으로 준비.',q3:'해설: 미래와 변화.',q4:'해설: 기술 발전에 대비.',q5:'예시: 환경 보호, 새 기술 학습, 적응력 키우기.'}
  }
});

/* ===============================
   ★ 어휘 빈칸 렌더러 & 탭 이벤트
=================================*/
function getCurrentUnit() {
  return (window.CUR_UNIT || 'physics_01');
}

let _vocabFillRendered = false;

window.renderVocabFill = function () {
  // 이미 렌더링되었으면 다시 렌더링하지 않음 (탭 전환 시 상태 유지)
  if (_vocabFillRendered) {
    console.log('[renderVocabFill] 이미 렌더링됨, 건너뛰기');
    return;
  }

  const unit = window.CUR_UNIT || 'physics_01';
  const pack = window.CONTENTS?.[unit];
  const root = document.getElementById('vocab-fill')
            || document.querySelector('.vocab-fill-text');

  if (!root || !pack?.vocabFill?.items?.length) {
    console.warn('[vocab] root or items missing:', { root: !!root, unit, items: pack?.vocabFill?.items?.length });
    return;
  }

  const html = (pack.vocabFill.items || []).map(({ no, text, answer, initials }) => {
    const slot = `
      <span class="blank-wrap" data-answer="${answer}">
        <span class="blank-icon">${no}</span>
        <span class="blank-mark"></span>
        <input type="text" class="blank-input" placeholder="${initials || ''}">
      </span>
    `;
    const p = text.replace(/\(\s*[-＿—\u00A0]*\s*\)/, slot);
    return `<p>${p}</p>`;
  }).join('');

  root.innerHTML = `
    <div class="vocab-instruction">${pack.vocabFill.instructions || ''}</div>
    <div class="vocab-inline">${html}</div>
  `;

  // 렌더링 완료 표시
  _vocabFillRendered = true;

  (function ensureVocabInlineStyle(){
    if (document.getElementById('vocab-inline-style')) return;
    const st = document.createElement('style');
    st.id = 'vocab-inline-style';
    st.textContent = `
      /* vocab 영역에서만 줄글 처리 */
      .vocab-box .vocab-inline > p { display:inline !important; margin:0 !important; }
      .vocab-box .vocab-inline > p + p::before { content:" "; }

      #vocab-fill .vocab-inline > p,
      .vocab-fill-text .vocab-inline > p { display:inline !important; margin:0 !important; }
      #vocab-fill .vocab-inline > p + p::before,
      .vocab-fill-text .vocab-inline > p + p::before { content:" "; }

      /* 🔶 줄 간격 조정 */
      .vocab-inline { line-height: 5.0 !important; }
    `;
    document.head.appendChild(st);
  })();

  window.reportState = window.reportState || {};
  window.reportState.vocabTotal = pack.vocabFill.items.length;

  // ✅ 어휘 렌더링 직후 상태 복원
  setTimeout(() => {
    // 1. localStorage에서 복원
    if (typeof window.loadVocabState === 'function') {
      window.loadVocabState();
    }
    // 2. 서버 데이터가 있으면 서버 데이터로 복원 (우선순위 높음)
    if (typeof window.restoreVocabFromServerData === 'function') {
      window.restoreVocabFromServerData();
    }
  }, 100);
};

// ✅ 이벤트 리스너 중복 방지를 위한 플래그
let _tabEventsInitialized = false;

function _bindTabEvents() {
  // 이미 초기화되었으면 건너뛰기
  if (_tabEventsInitialized) return;
  _tabEventsInitialized = true;

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-tab]');
    if (!btn) return;
    const tab = btn.getAttribute('data-tab');
    if (tab === 'vocab') renderVocabFill();
  });
}

/* ===== 텍스트 주입 (HTML 구조/ids 유지) ===== */
function applyContentPack(unitKey) {
  console.log('[applyContentPack] 호출됨, unitKey:', unitKey);
  const pack = window.CONTENTS[unitKey];
  if (!pack) {
    console.error('[applyContentPack] pack이 없음! unitKey:', unitKey, 'CONTENTS:', window.CONTENTS);
    return;
  }

  const labelNoEl = document.querySelector('.passage-label strong');
  const titleEl   = document.querySelector('.passage-title');
  if (labelNoEl) labelNoEl.textContent = pack.labelNo;
  if (titleEl)   titleEl.innerHTML = pack.title;

  const passageBox = document.querySelector('.passage-text');
  console.log('[applyContentPack] passageBox:', passageBox, 'pack.passage:', pack.passage);
  if (passageBox) {
    const html = pack.passage.map(p => `<p>${p}</p>`).join('');
    console.log('[applyContentPack] 생성된 HTML 길이:', html.length);
    passageBox.innerHTML = html;
    console.log('[applyContentPack] passageBox.innerHTML 설정 완료');
  }

  const vocabBox = document.querySelector('.passage-vocab ol');
  if (vocabBox)  vocabBox.innerHTML = pack.vocab.map(([w,d]) => `<li><b>${w}</b>: ${d}</li>`).join('');

  const blocks = Array.from(document.querySelectorAll('#tab-reading .quiz-block'));

  // Q1
  if (blocks[0]) {
    const q1Text = blocks[0].querySelector('.quiz-q');
    const q1Lis  = blocks[0].querySelectorAll('.quiz-options li');
    if (q1Text) q1Text.textContent = pack.quiz.q1_text;
    if (q1Lis.length === 4) {
      q1Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q1" value="${i+1}"><span>${pack.quiz.q1_opts[i]}</span></label>`);
    }
  }

  // Q2
  if (blocks[1]) {
    const q2Text = blocks[1].querySelector('.quiz-q');
    const q2Lis  = blocks[1].querySelectorAll('.quiz-options li');
    if (q2Text) q2Text.textContent = pack.quiz.q2_text;
    if (q2Lis.length === 4) {
      q2Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q2" value="${i+1}"><span>${pack.quiz.q2_opts[i]}</span></label>`);
    }
  }

  // Q3
  if (blocks[2]) {
    const q3P = blocks[2].querySelector('.quiz-q');
    if (q3P && pack.quiz.q3_html) q3P.innerHTML = pack.quiz.q3_html;
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    if (q3_1 && pack.quiz.q3_1_ph) q3_1.placeholder = pack.quiz.q3_1_ph;
    if (q3_2 && pack.quiz.q3_2_ph) q3_2.placeholder = pack.quiz.q3_2_ph;
  }

  // Q4
  if (blocks[3]) {
    const q4P = blocks[3].querySelector('.quiz-q');
    if (q4P && pack.quiz.q4_html) q4P.innerHTML = pack.quiz.q4_html;
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    if (q4_1 && pack.quiz.q4_1_ph) q4_1.placeholder = pack.quiz.q4_1_ph;
    if (q4_2 && pack.quiz.q4_2_ph) q4_2.placeholder = pack.quiz.q4_2_ph;
  }

  // Q5
  if (blocks[4]) {
    const q5Text = blocks[4].querySelector('.quiz-q');
    if (q5Text && pack.quiz.q5_text) q5Text.textContent = pack.quiz.q5_text;
  }

  // ✅ 모든 콘텐츠 로드 완료 후 로딩 오버레이 숨기기
  requestAnimationFrame(() => {
    const loadingOverlay = document.getElementById('loadingOverlay');
    if (loadingOverlay) {
      // 분석리포트 탭일 경우 1.3초 후에 숨기기
      const unit = window.CUR_UNIT || 'physics_01';
      const savedTab = localStorage.getItem(`current-geo-tab:${unit}`);
      const delay = (savedTab === 'report') ? 1300 : 0;

      setTimeout(() => {
        loadingOverlay.classList.remove('show');
        console.log('[applyContentPack] 로딩 오버레이 숨김 완료');
      }, delay);
    }
  });
}

/* ==== 본문학습 상태 저장/복원 (✅ 학생별 분리 저장) ==== */

/* 🔐 현재 로그인 학생 정보 가져오기 */
function getCurrentStudentForReading() {
  const saved = localStorage.getItem('currentStudent');
  if (!saved) return null;
  try { return JSON.parse(saved); } catch (e) { return null; }
}

/* 🔐 학생키 만들기: 학년_이름_전화숫자 */
function buildStudentKeyForReading(stu) {
  const cleanPhone = (stu.phone || '').replace(/\D/g, '');
  const cleanName  = (stu.name  || '').trim();
  const cleanGrade = (stu.grade || '').trim();
  return `${cleanGrade}_${cleanName}_${cleanPhone}`;
}

// ✅ 현재 로그인한 학생 키를 공용으로 쓰는 함수 (메뉴/단원 페이지 공유)
window.getStudentKey = function () {
  const stu = getCurrentStudent();
  if (!stu) return '';
  return buildStudentKey(stu);   // "학년_이름_전화번호" 형태
};

/* 🔐 단원별 + 학생별 로컬스토리지 키 */
function getReadingStateKey(unit) {
  const stu = getCurrentStudentForReading();
  if (!stu) {
    // 로그인 안 되어 있으면 예전처럼 단원 단독 키 사용
    return `dan-reading-state:${unit}`;
  }
  const studentKey = buildStudentKeyForReading(stu);
  return `dan-reading-state:${studentKey}:${unit}`;
}

function saveReadingState() {
  try {
    const unit = window.CUR_UNIT || 'physics_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키

    const q1   = document.querySelector('input[name="q1"]:checked');
    const q2   = document.querySelector('input[name="q2"]:checked');
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    const state = {
      graded: true,
      q1:   q1   ? q1.value   : '',
      q2:   q2   ? q2.value   : '',
      q3_1: q3_1 ? q3_1.value : '',
      q3_2: q3_2 ? q3_2.value : '',
      q4_1: q4_1 ? q4_1.value : '',
      q4_2: q4_2 ? q4_2.value : '',
      q5:   q5   ? q5.value   : ''
    };

    localStorage.setItem(key, JSON.stringify(state));
  } catch (e) {
    console.warn('saveReadingState error', e);
  }
}

function loadReadingState() {
  try {
    const unit = window.CUR_UNIT || 'physics_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키
    const raw  = localStorage.getItem(key);
    if (!raw) return;

    const state = JSON.parse(raw);
    if (!state) return;

    if (state.q1) {
      const r1 = document.querySelector(`input[name="q1"][value="${state.q1}"]`);
      if (r1) r1.checked = true;
    }
    if (state.q2) {
      const r2 = document.querySelector(`input[name="q2"][value="${state.q2}"]`);
      if (r2) r2.checked = true;
    }

    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    if (q3_1 && state.q3_1 !== undefined) q3_1.value = state.q3_1;
    if (q3_2 && state.q3_2 !== undefined) q3_2.value = state.q3_2;
    if (q4_1 && state.q4_1 !== undefined) q4_1.value = state.q4_1;
    if (q4_2 && state.q4_2 !== undefined) q4_2.value = state.q4_2;
    if (q5   && state.q5   !== undefined) q5.value   = state.q5;

    if (state.graded && typeof window.gradeQuiz === 'function') {
      setTimeout(() => {
        try { window.gradeQuiz(); } catch (e) {
          console.warn('auto re-grade reading error', e);
        }
      }, 0);
    }
  } catch (e) {
    console.warn('loadReadingState error', e);
  }
}

/* ===== 통합 채점기 ===== */
window.gradeQuiz = function () {
  const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.physics_01;
  const A = pack.answerKey;
  const EX = pack.explain;

  const quizBlocks = document.querySelectorAll('#tab-reading .quiz-block');
  const numLabels = ["01","02","03","04","05"];
  quizBlocks.forEach((block, idx) => {
    const numEl = block.querySelector('.quiz-num');
    if (!numEl) return;
    let markEl = numEl.querySelector('.mark');
    if (!markEl) {
      markEl = document.createElement('div');
      markEl.className = 'mark';
      numEl.appendChild(markEl);
    }
    numEl.textContent = numLabels[idx];
    numEl.appendChild(markEl);
    numEl.classList.remove('correct','wrong');
    markEl.textContent = '';
  });

  let score = 0;
  const totalAuto = 4;
  const shortMsgs = [];
  const fullMsgs = [];

  function norm(s){ return (s||'').toString().replace(/\s+/g,'').toLowerCase(); }
  function mark(idx, ok, label, ex, isEssay=false){
    const num = quizBlocks[idx]?.querySelector('.quiz-num');
    const markEl = num?.querySelector('.mark');
    if (ok) {
      score++;
      num?.classList.add('correct');
      if(markEl) markEl.textContent='⭕';
      shortMsgs.push(`${label} 정답 ✅`);
      fullMsgs.push(`${label} 정답 ✅ ${ex||''}`);
    } else {
      num?.classList.add('wrong');
      if(markEl) markEl.textContent='✖';
      shortMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌`);
      fullMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌ ${ex||''}`);
    }
  }

  // 1
  const q1 = document.querySelector('input[name="q1"]:checked');
  const q1ok = (q1 && q1.value === A.q1);
  mark(0, q1ok, '①', EX.q1);

  // 2
  const q2 = document.querySelector('input[name="q2"]:checked');
  const q2ok = (q2 && q2.value === A.q2);
  mark(1, q2ok, '②', EX.q2);

  // 3
  const q3New = document.getElementById('q3');
  const q3Old1 = document.getElementById('q3-1');
  const q3Old2 = document.getElementById('q3-2');
  const q3Text1 = q3New ? q3New.value.trim() : (q3Old1?.value || '').trim();
  const q3Text2 = q3New ? '' : (q3Old2?.value || '').trim();
  const ok3_1 = A.q3_1.some(a => norm(a) === norm(q3Text1));
  const ok3_2 = A.q3_2 ? A.q3_2.some(a => norm(a) === norm(q3Text2)) : true;
  const q3ok = ok3_1 && ok3_2;
  mark(2, q3ok, '③', EX.q3);

  // 4
  const q4New = document.getElementById('q4');
  const q4Old1 = document.getElementById('q4-1');
  const q4Old2 = document.getElementById('q4-2');
  const q4Text1 = q4New ? q4New.value.trim() : (q4Old1?.value || '').trim();
  const q4Text2 = q4New ? '' : (q4Old2?.value || '').trim();
  const ok4_1 = A.q4_1.some(a => norm(a) === norm(q4Text1));
  const ok4_2 = A.q4_2 ? A.q4_2.some(a => norm(a) === norm(q4Text2)) : true;
  const q4ok = ok4_1 && ok4_2;
  mark(3, q4ok, '④', EX.q4);

  // 5 (서술형)
  const essay = (document.getElementById('q5')?.value || '').trim().toLowerCase();
  const keys = (pack.essayKeywords && Array.isArray(pack.essayKeywords) && pack.essayKeywords.length)
    ? pack.essayKeywords
    : ["등고선","간격","좁","넓","급경사","완만","경사"];
  let hit = 0;
  keys.forEach(k => { if (essay.includes(k)) hit++; });
  const q5ok = essay.length && hit >= 2;
  mark(4, q5ok, '⑤', EX.q5, true);

  const box = document.getElementById('grade-result');
  if (box) {
    box.style.display = 'block';
    box.innerHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + shortMsgs.map(m => `<p>${m}</p>`).join('');
  }
  window.fullResultHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + fullMsgs.map(m => `<p>${m}</p>`).join('');

  const g=document.getElementById('grade-btn');
  const r=document.getElementById('reset-btn');
  const s=document.getElementById('submit-btn');
  if (g) g.style.display='inline-block';
  if (r) r.style.display='inline-block';
  if (s) s.style.display='inline-block';

  window.reportState = window.reportState || {};
  window.reportState.q1ok=q1ok;
  window.reportState.q2ok=q2ok;
  window.reportState.q3ok=q3ok;
  window.reportState.q4ok=q4ok;
  window.reportState.q5ok=q5ok;

  if (typeof updateReportPanel==='function') {
    const lexicalRatio = (typeof window.reportState.vocabScoreRatio==='number') ? window.reportState.vocabScoreRatio : 0;
    const lexicalOk = lexicalRatio >= 0.7;
    updateReportPanel({
      q1ok,q2ok,q3ok,q4ok,q5ok,
      messages:[
        "① 핵심 이해력: " + (q1ok?"좋아요! ✅":"보완 필요 ❗"),
        "② 구조 파악력: " + (q2ok?"좋아요! ✅":"보완 필요 ❗"),
        "③ 어휘 맥락력: " + (lexicalOk?"좋아요! ✅":"어휘 복습 필요 ❗"),
        "④ 추론·통합력: " + (q4ok?"좋아요! ✅":"보완 필요 ❗"),
        "⑤ 비판·적용력: " + (q5ok?"좋아요! ✅":"보완 필요 ❗")
      ]
    });
  }

  // ✅ 레이더 점수 객체로 빼두기
  const radarScores = {
    literal:     q1ok ? 10 : 6,
    structural:  q2ok ? 10 : 6,
    lexical:     q3ok ? 10 : 6,
    inferential: q4ok ? 10 : 6,
    critical:    q5ok ? 10 : 6
  };

  // ✅ 서버로 보낼 마지막 레이더 점수 기억해 두기 (전역)
  window._lastRadar = radarScores;

  // ✅ 화면 레이더 차트 그리기
  if (typeof updateRadarChart === 'function') {
    updateRadarChart(radarScores);
  }
  if (typeof drawRadarChart === 'function') {
    drawRadarChart(radarScores);
  }

  // ✅ 서버 로그용으로도 보관 (옵션)
  window.reportState = window.reportState || {};
  window.reportState.radarScores = radarScores;

  if (typeof saveReadingState === 'function') {
    saveReadingState();
  }
};

/* === 정답·해설 패널 렌더러 === */
function renderSolutions(pack) {
  const A = pack.answerKey, EX = pack.explain;
  const q1Text = pack.quiz.q1_opts[Number(A.q1) - 1] || '';
  const q2Text = pack.quiz.q2_opts[Number(A.q2) - 1] || '';

  // grade-result (점수 박스) 안의 하단에 해설 추가
  const gradeResult = document.getElementById('grade-result');
  if (!gradeResult) return;

  // 기존 solutions-box가 있으면 제거
  let box = document.getElementById('solutions-box');
  if (box) box.remove();

  // 새로운 solutions-box를 grade-result 내부 하단에 추가
  box = document.createElement('div');
  box.id = 'solutions-box';
  box.style.marginTop = '16px';
  box.style.paddingTop = '12px';
  box.style.borderTop = '1px dashed #e5d4c1';
  box.style.lineHeight = '1.6';

  box.innerHTML = `
    <h3 style="margin:0 0 10px; font-size:15px; color:#8b2f2f;">정답 · 해설</h3>
    <ol style="margin:0; padding-left:18px; font-size:13px;">
      <li style="margin-bottom:8px;">
        <b>① 정답:</b> ${A.q1} — ${q1Text}<br>
        <span style="color:#6b5a48;">${EX.q1 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>② 정답:</b> ${A.q2} — ${q2Text}<br>
        <span style="color:#6b5a48;">${EX.q2 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>③ 정답(두 칸):</b> ${Array.isArray(A.q3_1)?A.q3_1[0]:A.q3_1} / ${Array.isArray(A.q3_2)?A.q3_2[0]:A.q3_2}<br>
        <span style="color:#6b5a48;">${EX.q3 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>④ 정답(두 칸):</b> ${Array.isArray(A.q4_1)?A.q4_1[0]:A.q4_1} / ${Array.isArray(A.q4_2)?A.q4_2[0]:A.q4_2}<br>
        <span style="color:#6b5a48;">${EX.q4 || ''}</span>
      </li>
      <li>
        <b>⑤ 서술형 예시:</b> <span style="color:#6b5a48;">${EX.q5 || '핵심어 2개 이상 포함 시 정답 처리'}</span>
      </li>
    </ol>
  `;

  // grade-result 내부 하단에 추가
  gradeResult.appendChild(box);
}

/* ========== 공통 진행도 매니저 (단일화 호환) ========== */
window.DanDan = window.DanDan || {};

(function () {
  // 이미 정의돼 있으면 다시 만들지 않기
  if (window.DanDan.ProgressManager) return;

  /* ✅ 단원 감지: physics_01, physics_02 ... */
  function detectUnit() {
    let unitParam = new URLSearchParams(location.search).get('unit');
    if (!unitParam) {
      const m = location.pathname.match(/physics_(\d+)\.html/i);
      if (m) unitParam = `physics_${m[1].padStart(2, '0')}`;
    }
    return (unitParam || (window.CUR_UNIT || 'physics_01')).toLowerCase();
  }

  /* ✅ 학생키: 학년_이름_전화숫자 */
  function buildStudentKey(stu) {
    const cleanPhone = (stu.phone || '').replace(/\D/g, '');
    const cleanName  = (stu.name  || '').trim();
    const cleanGrade = (stu.grade || '').trim();
    return `${cleanGrade}_${cleanName}_${cleanPhone}`;
  }

  /* ✅ 현재 로그인 학생 */
  function getCurrentStudent() {
    const saved = localStorage.getItem('currentStudent');
    if (!saved) return null;
    try { return JSON.parse(saved); } catch { return null; }
  }

  /* ✅ 특정 학생 + 단원 기준 진행도 key 만들기
     → dan-progress:학년_이름_전화:physics_04 */
  function buildProgressKey(stu, unit) {
    const studentKey = buildStudentKey(stu);
    return `dan-progress:${studentKey}:${unit}`;
  }

  /* ✅ 현재 학생의 완료된 단원 목록 읽기 */
  function readDoneList() {
    const stu = getCurrentStudent();
    if (!stu) return { keyPrefix: null, list: [] };

    const unitList = [];
    const studentKey = buildStudentKey(stu);
    const prefix = `dan-progress:${studentKey}:`; // 단원별 prefix

    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k || !k.startsWith(prefix)) continue;
      const unit = k.slice(prefix.length);  // physics_01, physics_02 ...
      const val  = localStorage.getItem(k);
      if (val) unitList.push(unit);
    }
    return { keyPrefix: prefix, list: unitList };
  }

  const ProgressManager = {
    /* 현재 단원 unit (physics_01 등) */
    getUnit: detectUnit,

    /* ✅ 이 단원을 "학습완료"로 표시 */
    markComplete() {
      const stu  = getCurrentStudent();
      if (!stu) return null;

      const unit = detectUnit();                  // physics_04
      const key  = buildProgressKey(stu, unit);   // dan-progress:학생키:physics_04

      localStorage.setItem(key, '1');             // 값은 그냥 '1'로 저장
      return key;
    },

    /* ✅ 이 단원이 완료됐는지 확인 */
    isCompleted(unitOptional) {
      const stu = getCurrentStudent();
      if (!stu) return false;
      const unit = (unitOptional || detectUnit());
      const key  = buildProgressKey(stu, unit);
      return !!localStorage.getItem(key);
    },

    /* ✅ 현재 학생의 완료 단원 리스트 얻기 (physics_01, physics_03 ...) */
    getStudentProgress() {
      return readDoneList();   // { keyPrefix, list }
    }
  };

  window.DanDan.ProgressManager = ProgressManager;

  /* ✅ 제출하기 훅: 완료처리 + 로그 전송 */
  (function hookSubmitReport() {
    const original = window.submitReport;

    window.submitReport = async function (...args) {
      const stu = getCurrentStudent();
      if (!stu) {
        alert('로그인한 학생 정보가 없습니다. 먼저 로그인 해주세요.');
        return;
      }

      // 1) 기존 제출 로직(PDF 등) 실행
      if (typeof original === 'function') {
        await original.apply(this, args);
      } else if (typeof window.captureElementToPDF === 'function') {
        await captureElementToPDF(
          'capture-report',
          '단단국어_분석리포트.pdf',
          { withStudentInfo: true }
        );
      }

      // 2) ✅ 진행도: 학생 + 단원 기준으로 학습완료 저장
      const key = ProgressManager.markComplete();

      if (typeof window.showSubmitSuccess === 'function') {
        showSubmitSuccess('분석리포트');
      } else {
        console.log(`학습완료 처리됨: ${key}`);
      }

      // 3) 서버 학습 이력 로그
      if (typeof window.sendLearningLog === 'function') {
        try {
          await window.sendLearningLog();
        } catch (e) {
          console.warn('[submitReport] sendLearningLog 실패', e);
        }
      }
    };
  })();
})();

/* ===========================
 * ✅ 창의활동 제출 → PDF 내보내기
 *   textarea 전체 내용을 div로 복사해서 캡처
 * =========================== */
window.submitCreative = async function () {
  const textarea   = document.getElementById('creative-input');
  const renderBox  = document.getElementById('creative-render');
  const captureBox = document.getElementById('capture-creative');

  if (!textarea || !renderBox || !captureBox) {
    console.warn('[submitCreative] 요소를 찾을 수 없음', {
      textarea: !!textarea,
      renderBox: !!renderBox,
      captureBox: !!captureBox,
    });
    alert('창의활동 영역을 찾을 수 없습니다.');
    return;
  }

  try {
    // 1) textarea 내용 → 렌더 박스로 복사
    renderBox.textContent = textarea.value || '';

    // 2) 캡처할 동안 textarea 숨기고 렌더 박스만 보이게
    textarea.style.display  = 'none';
    renderBox.style.display = 'block';

    // 3) 공통 함수가 있으면 그걸 사용 (captureElementToPDF)
    if (typeof window.captureElementToPDF === 'function') {
      await window.captureElementToPDF(
        'capture-creative',
        '단단국어_창의활동.pdf',
        { withStudentInfo: true }
      );
    }
    // 4) 없으면 html2canvas + jsPDF 직접 사용 (백업)
    else if (window.html2canvas && window.jsPDF) {
      const canvas = await html2canvas(captureBox);
      const imgData = canvas.toDataURL('image/png');

      const pdf = new jsPDF('p', 'mm', 'a4');
      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = (canvas.height * pageW) / canvas.width;

      pdf.addImage(imgData, 'PNG', 0, 0, pageW, pageH);
      pdf.save('단단국어_창의활동.pdf');
    } else {
      alert('PDF 모듈을 찾을 수 없습니다. (html2canvas / jsPDF 확인)');
    }

    // (원하면 여기에서 창의활동도 showSubmitSuccess 호출 가능)
    if (typeof window.showSubmitSuccess === 'function') {
      window.showSubmitSuccess('창의활동');
    }
  } catch (e) {
    console.warn('submitCreative error', e);
    alert('창의활동 PDF 생성 중 오류가 발생했습니다.');
  } finally {
    // 5) 화면 복구: textarea 다시 보이게, 렌더 박스 숨김
    if (textarea)   textarea.style.display  = 'block';
    if (renderBox)  renderBox.style.display = 'none';
  }
};

/* ===========================
 * ✅ 학습 이력 서버로 보내기 (테스트 버전)
 * =========================== */
/* ===== 🔄 서버에서 완료 상태 가져오기 ===== */
window.loadCompletionStatus = async function () {
  try {
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[loadCompletionStatus] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[loadCompletionStatus] 학생 정보 없음 → 스킵');
      return;
    }

    const params = new URLSearchParams({
      grade: stu.grade || '',
      name: stu.name || '',
      series: 'BRAIN업'
    });

    const res = await fetch(`/api/completion-status?${params}`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' }
    });

    if (!res.ok) {
      console.warn('[loadCompletionStatus] 서버 응답 오류:', res.status);
      return;
    }

    const data = await res.json();
    console.log('[loadCompletionStatus] 서버 응답:', data);

    if (data.ok && Array.isArray(data.completedUnits)) {
      // 학생 키 생성 (buildProgressKey 함수와 동일한 로직)
      const cleanPhone = (stu.phone || '').replace(/\D/g, '');
      const cleanName  = (stu.name  || '').trim();
      const cleanGrade = (stu.grade || '').trim();
      const studentKey = `${cleanGrade}_${cleanName}_${cleanPhone}`;
      const keyPrefix = `dan-progress:${studentKey}:`;

      console.log('[loadCompletionStatus] studentKey:', studentKey);
      console.log('[loadCompletionStatus] keyPrefix:', keyPrefix);

      data.completedUnits.forEach(unit => {
        const key = keyPrefix + unit;  // "dan-progress:학생키:physics_01"
        localStorage.setItem(key, '1');
        console.log('[loadCompletionStatus] 저장:', key);
      });

      console.log('[loadCompletionStatus] 완료 상태 동기화 완료:', data.completedUnits);
    }
  } catch (e) {
    console.warn('[loadCompletionStatus] 오류', e);
  }
};

window.sendLearningLog = async function () {
  try {
    const unit = window.CUR_UNIT || 'physics_02';

    // 1) localStorage 에서 현재 로그인 학생 가져오기
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[sendLearningLog] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[sendLearningLog] 학생 정보 없음 → 로그 전송 스킵');
      return;
    }

    // ✅ gradeQuiz 에서 저장해 둔 레이더 점수 꺼내기
    const radar =
      (window.reportState && window.reportState.radarScores)
      ? window.reportState.radarScores
      : null;

    const payload = {
      grade:  stu.grade  || '',
      name:   stu.name   || '',
      school: stu.school || '',
      series: 'BRAIN업',      // 필요하면 '정조편' 등으로 바꿔도 됨
      unit:   unit,
      radar:  radar,       // ✅ 여기 추가!
      completed: true      // ✅ 학습 완료 표시
    };

    console.log('[sendLearningLog] payload =', payload);

    const res = await fetch('/api/log', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    let data = {};
    try {
      data = await res.json();
    } catch (_) {
      data = {};
    }
    console.log('[sendLearningLog] result =', data);
  } catch (e) {
    console.warn('sendLearningLog outer error', e);
  }
};




/* ===== 로드 시 실행 + 버튼 타입 안전패치 ===== */
document.addEventListener('DOMContentLoaded', async () => {
  // 0) 🔄 서버에서 학습 완료 상태 동기화
  if (typeof window.loadCompletionStatus === 'function') {
    await loadCompletionStatus();
  }

  // 1) 본문 내용 채우기
  applyContentPack(window.CUR_UNIT);

  // 2) 탭 이벤트 + 어휘 자동 렌더
  _bindTabEvents();
  if (location.hash.includes('어휘학습') || document.querySelector('#vocab-fill')) {
    renderVocabFill();
  }

  // 3) 버튼 type=button 통일
  ['grade-btn','reset-btn','submit-btn'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.type = 'button';
  });

  // 4) 제출하기 = 채점 + 해설 표시 (한 번만 등록)
  const submitBtn = document.getElementById('submit-btn');
  if (submitBtn) {
    submitBtn.addEventListener('click', () => {
      try {
        if (typeof window.gradeQuiz === 'function') {
          gradeQuiz();
        }
        const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.physics_01;
        renderSolutions(pack);
      } catch (e) {
        console.warn('submit-btn handler error', e);
      }
    });
  }

    // 🔶 창의활동 제출 버튼 → submitCreative 연결
  const creativeBtn = document.getElementById('creative-submit-btn');
  if (creativeBtn && typeof window.submitCreative === 'function') {
    creativeBtn.type = 'button';
    creativeBtn.addEventListener('click', () => {
      submitCreative();
    });
  }


  // 5) 지난번 채점/입력 상태 복원 (✅ 학생별로 분리된 키 기준)
  if (typeof loadReadingState === 'function') {
    loadReadingState();
  }

});