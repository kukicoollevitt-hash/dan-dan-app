/**
 * ✅ 단원 자동 인식 (강화)
 * 우선순위: ?unit=soc_XX → 파일명 soc_XX.html → 제목 숫자
 * ⚠️ HTML에서 이미 CUR_UNIT 설정했으면 덮어쓰지 않음
 */
(function () {
  // 이미 설정된 CUR_UNIT이 있고, soc_로 시작하면 덮어쓰지 않음
  if (window.CUR_UNIT && window.CUR_UNIT.startsWith('soc_')) {
    console.log('[soc_content.js] CUR_UNIT 이미 설정됨:', window.CUR_UNIT);
    return;
  }

  const qs = new URLSearchParams(location.search).get('unit');
  let unit = null;

  if (qs) {
    const m = qs.toLowerCase().match(/soc[_-]?(\d{1,2})/);
    if (m) unit = `soc_${m[1].padStart(2, '0')}`;
  }

  if (!unit) {
    const m2 = location.pathname.toLowerCase().match(/soc[_-]?(\d{1,2})\.html/);
    if (m2) unit = `soc_${m2[1].padStart(2, '0')}`;
  }

  if (!unit && document.title) {
    const m3 = document.title.match(/(\d{1,2})/);
    if (m3) unit = `soc_${m3[1].padStart(2, '0')}`;
  }

  window.CUR_UNIT = unit || 'soc_01';
})();

/* ===============================
   ✅ 전역 CONTENTS 준비 (단일화)
   =============================== */
window.CONTENTS = window.CONTENTS || {};

/* ===== 콘텐츠 팩: 단원별 지문/어휘/문제/정답 =====
   ✅ 기존 const CONTENTS = {...} → window.CONTENTS 에 합치기
*/
window.CONTENTS = Object.assign(window.CONTENTS, {
  /* ===== soc_01 : "우리 가족은 어떻게 이루어질까요?" ===== */
  soc_01: {
    labelNo: '01',
    title: '👨‍👩‍👧‍👦 우리 가족은 어떻게 이루어질까요?',
    passage: [
      '여러분은 누구누구와 함께 살고 있나요? 아버지, 어머니, 형, 언니 또는 동생과 함께 사나요? 가족은 보통 <b>혼인</b>으로 맺어진 부부를 중심으로 이루어져요. 그러다 부부가 자식을 낳으면 부모와 자식, 형제자매처럼 <b>혈연</b>으로 이루어진 사람들이 관계를 맺고 살게 되지요. 멀리 떨어져서 살아도 가족으로서 <b>책임</b>을 지고 집안에서 벌어지는 일에 관심을 두는 사람도 가족이라 할 수 있어요.',
      '요즘은 <b>입양</b>이나 <b>재혼</b>을 통해 이루어지는 가족도 많아졌어요. 꼭 피를 나눈 사이가 아니어도 함께 마음을 나누고 살아가면 얼마든지 가족이 될 수 있답니다. 그러니까 가족은 서로에게 힘이 되는 가깝고 소중한 사람들이에요.',
      '대부분의 사람들은 <b>가족 구성원</b>으로서 <b>가정</b>이라는 <b>울타리</b> 안에서 함께 살아가요. 여기에서 가정은 가족 구성원이 생활하는 공간이자, 가족처럼 사회를 이루는 가장 기본 단위를 뜻해요. 가족과 가정 없이는 사회와 나라도 생겨날 수 없어요. 또한 가정이 기능을 제대로 잘해야 사회와 나라도 건강하게 발전할 수 있답니다.'
    ],
    vocab: [
      ['혼인','남녀가 부부가 되는 일, 결혼.'],
      ['혈연','피를 나눈 관계, 같은 핏줄로 연결된 관계.'],
      ['입양','친부모가 아닌 사람이 법적으로 자녀를 들이는 일.'],
      ['재혼','한 번 결혼했던 사람이 다시 결혼하는 것.'],
      ['가족 구성원','한 가정을 이루는 사람들.'],
      ['가정','가족이 함께 생활하는 공간이자 사회의 기본 단위.'],
      ['책임','맡은 일이나 관계에 대해 의무를 지고 해야 하는 것.'],
      ['울타리','보호해 주는 경계나 공간을 비유적으로 나타낸 말.']
    ],
    vocabFill: {
      instructions: '',
      items: [
        { no: 1, text: '가족은 보통 (      )으로 맺어진 부부를 중심으로 이루어져요.', answer: '혼인', initials: 'ㅎㅇ', aliases: ['혼인','결혼'] },
        { no: 2, text: '부모와 자식, 형제자매처럼 (      )으로 이루어진 사람들이 관계를 맺어요.', answer: '혈연', initials: 'ㅎㅇ', aliases: ['혈연'] },
        { no: 3, text: '친부모가 아닌 사람이 법적으로 자녀를 들이는 일을 (      )이라고 해요.', answer: '입양', initials: 'ㅇㅇ', aliases: ['입양'] },
        { no: 4, text: '한 번 결혼했던 사람이 다시 결혼하는 것을 (      )이라고 해요.', answer: '재혼', initials: 'ㅈㅎ', aliases: ['재혼'] },
        { no: 5, text: '한 가정을 이루는 사람들을 (          )이라고 해요.', answer: '가족 구성원', initials: 'ㄱㅈ ㄱㅅㅇ', aliases: ['가족구성원','가족 구성원'] },
        { no: 6, text: '가족이 함께 생활하는 공간이자 사회의 기본 단위를 (      )이라고 해요.', answer: '가정', initials: 'ㄱㅈ', aliases: ['가정'] },
        { no: 7, text: '맡은 일이나 관계에 대해 의무를 지고 해야 하는 것을 (      )이라고 해요.', answer: '책임', initials: 'ㅊㅇ', aliases: ['책임'] },
        { no: 8, text: '가정은 가족을 보호해 주는 (      ) 역할을 해요.', answer: '울타리', initials: 'ㅇㅌㄹ', aliases: ['울타리'] }
      ]
    },
    quiz: {
      q1_text: '이 글에서 설명하는 가족의 특징으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 가족은 반드시 피를 나눈 사람들끼리만 이루어진다.',
        '② 가족은 혼인, 혈연뿐 아니라 입양이나 재혼으로도 이루어질 수 있다.',
        '③ 가족은 반드시 한집에 함께 살아야만 가족이라 할 수 있다.',
        '④ 가족은 사회와 나라의 발전에 영향을 주지 않는다.'
      ],
      q2_text: '글에서 \'가정\'에 대한 설명으로 가장 적절한 것은 무엇인가요?',
      q2_opts: [
        '① 가정은 가족이 함께 살지 않아도 되는 공간이다.',
        '② 가정은 사회를 이루는 가장 큰 단위이다.',
        '③ 가정은 가족 구성원이 생활하는 공간이자 사회의 기본 단위이다.',
        '④ 가정은 가족과 전혀 관련이 없는 개념이다.'
      ],
      q3_1_ph: 'ㅎㅇ', q3_2_ph: 'ㅎㅇ',
      q4_1_ph: 'ㅇㅇ', q4_2_ph: 'ㅈㅎ',
      q5_text: '글에서 "가정이 기능을 제대로 잘해야 사회와 나라도 건강하게 발전할 수 있다"고 했습니다. 이 말이 어떤 의미인지 자신의 말로 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'3', q3_1:['혼인','결혼'], q3_2:['혈연'], q4_1:['입양'], q4_2:['재혼'] },
    essayKeywords: ['가정','사회','나라','발전','기본','단위','건강','기능'],
    explain: {
      q1:'해설: 가족은 혼인, 혈연뿐 아니라 입양이나 재혼을 통해서도 이루어질 수 있다고 본문에서 설명함.',
      q2:'해설: 가정은 가족 구성원이 생활하는 공간이자 사회의 기본 단위라고 본문에서 설명함.',
      q3:'해설: 가족은 혼인으로 맺어진 부부를 중심으로, 혈연으로 이루어진 사람들이 관계를 맺음.',
      q4:'해설: 요즘은 입양이나 재혼을 통해 이루어지는 가족도 많아졌다고 본문에서 언급함.',
      q5:'예시: 가정은 사회의 가장 기본적인 단위이므로, 가정에서 사랑과 책임을 배운 사람들이 모여 건강한 사회와 나라를 만들 수 있다는 의미입니다.'
    },
    /* 창의활동 */
    creative: {
      title: '우리 가족 소개하기',
      instructions: '아래 활동을 통해 우리 가족에 대해 생각해 보세요.',
      tasks: [
        { no: 1, task: '우리 가족 구성원을 모두 적어 보세요. (예: 아버지, 어머니, 나, 동생)' },
        { no: 2, task: '가족 중 한 명을 선택해서 그 사람이 우리 가정에서 어떤 역할을 하는지 적어 보세요.' },
        { no: 3, task: '우리 가족이 함께 할 때 가장 행복한 순간은 언제인지 적어 보세요.' },
        { no: 4, task: '내가 가족을 위해 할 수 있는 일을 3가지 적어 보세요.' }
      ]
    }
  },

  /* ===== soc_02 : “지도에 담긴 약속과 표현” ===== */
  soc_02: {
    labelNo: '02',
    title: '👨‍👩‍👧 시대에 따라 달라진 가족 이야기',
    passage: [
      '옛날 우리 조상들은 대부분 농사를 지으며 가족 모두가 힘을 모아 생활했어요. 그때는 할아버지와 할머니, 부모님, 자녀가 한집에 모여 사는 <b>확대 가족</b>이 흔했지요. 집 안에서는 여러 세대가 함께 지내며 서로 도우며 살았습니다. 어른들은 아이들에게 생활 지혜와 예절을 가르치고, 젊은이들은 농사일이나 집안일을 맡아 어른들을 돌보며 서로 기대며 살아갔어요. 가족 구성원들은 각자의 역할을 지키며 공동체처럼 함께 생활했답니다.',
      '하지만 시간이 지나 산업이 발달하면서 공장과 회사가 생기고, 많은 사람이 일자리를 찾아 도시로 <b>이동</b>하게 되었어요. 농촌을 떠나 도시에서 살게 되면서 예전처럼 여러 세대가 함께 모여 살기 어려워졌지요. 이때부터 부모님과 자녀로만 이루어진 <b>핵가족</b>이 점차 늘어나기 시작했습니다. 핵가족은 가족 수가 적어 생활이 간단해지는 장점이 있지만, 서로 도울 사람이 줄어 어려운 일이 생기면 부담이 커지는 특징도 있어요. 이처럼 <b>산업화</b>는 가족 형태에 큰 변화를 가져왔습니다.',
      '오늘날에는 사회가 더 복잡해지고 생활 방식이 다양해지면서 가족의 형태도 매우 다양해졌어요. 할머니와 손주가 함께 사는 <b>조손 가족</b>, 부모 중 한쪽만 자녀를 돌보는 <b>한부모 가족</b>, 서로 다른 나라에서 온 부모와 아이가 함께 사는 <b>다문화 가족</b>이 점점 많아지고 있습니다. 또한 혼자 생활하는 1인 <b>가구</b>도 빠른 속도로 증가하고 있어요. 지금은 어떤 모습이든 서로를 돌보고 책임지며 함께 살아가는 모든 형태를 가족으로 인정하고 존중하는 사회가 되어가고 있답니다.'
    ],
    vocab: [
      ['확대 가족','여러 세대가 한집에서 함께 사는 가족 형태'],
      ['핵가족','부모와 자녀로만 이루어진 가족 형태'],
      ['조손 가족','조부모와 손주가 함께 사는 가족'],
      ['한부모 가족','부모 중 한 명이 자녀를 돌보는 가족'],
      ['다문화 가족','서로 다른 나라 출신 부모가 이루는 가족'],
      ['이동','한곳에서 다른 곳으로 옮겨 가는 일'],
      ['산업화','산업이 발달하고 생활 방식이 바뀌는 과정'],
      ['가구','한집에서 함께 사는 사람들의 집단']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[가족 형태 어휘].',
      items: [
        { no: 1, text: '여러 세대가 한집에서 함께 사는 가족 형태를 (      )이라고 한다.', answer: '확대 가족', initials: 'ㅎㄷ ㄱㅈ', aliases: ['확대가족','확대 가족'] },
        { no: 2, text: '부모와 자녀로만 이루어진 가족 형태를 (      )이라고 한다.', answer: '핵가족', initials: 'ㅎㄱㅈ', aliases: ['핵가족'] },
        { no: 3, text: '조부모와 손주가 함께 사는 가족을 (      )이라고 한다.', answer: '조손 가족', initials: 'ㅈㅅ ㄱㅈ', aliases: ['조손가족','조손 가족'] },
        { no: 4, text: '부모 중 한 명이 자녀를 돌보는 가족을 (      )이라고 한다.', answer: '한부모 가족', initials: 'ㅎㅂㅁ ㄱㅈ', aliases: ['한부모가족','한부모 가족'] },
        { no: 5, text: '서로 다른 나라 출신 부모가 이루는 가족을 (      )이라고 한다.', answer: '다문화 가족', initials: 'ㄷㅁㅎ ㄱㅈ', aliases: ['다문화가족','다문화 가족'] },
        { no: 6, text: '한곳에서 다른 곳으로 옮겨 가는 일을 (      )이라 한다.', answer: '이동', initials: 'ㅇㄷ', aliases: ['이동'] },
        { no: 7, text: '산업이 발달하고 생활 방식이 바뀌는 과정을 (      )이라 한다.', answer: '산업화', initials: 'ㅅㅇㅎ', aliases: ['산업화'] },
        { no: 8, text: '한집에서 함께 사는 사람들의 집단을 (      )라고 한다.', answer: '가구', initials: 'ㄱㄱ', aliases: ['가구'] }
      ]
    },
    quiz: {
      q1_text: '확대 가족에 대한 설명으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 부모와 자녀로만 이루어진 가족 형태이다.',
        '② 여러 세대가 한집에 모여 함께 사는 가족 형태이다.',
        '③ 혼자서 생활하는 1인 가구를 말한다.',
        '④ 서로 다른 나라에서 온 부모가 이루는 가족이다.'
      ],
      q2_text: '이 글의 구조를 보았을 때, 가족 형태의 변화를 설명하는 방식으로 가장 적절한 것은 무엇인가요?',
      q2_opts: [
        '① 옛날부터 현재까지 시간 순서에 따라 변화를 설명했다.',
        '② 여러 나라의 가족 형태를 비교하여 설명했다.',
        '③ 가족의 장점과 단점을 나열하여 설명했다.',
        '④ 전문가들의 다양한 의견을 소개하며 설명했다.'
      ],
      q3_html: `옛날에는 여러 세대가 함께 사는
                <input class="inline-input" id="q3-1" type="text" placeholder="ㅎㄷ ㄱㅈ">이 많았지만,
                산업화 이후에는 <input class="inline-input" id="q3-2" type="text" placeholder="ㅎㄱㅈ">이 늘어났습니다.`,
      q4_html: `오늘날에는 조손 가족, 한부모 가족,
                <input class="inline-input" id="q4-1" type="text" placeholder="ㄷㅁㅎ ㄱㅈ"> 등 다양한 형태가 있고,
                혼자 사는 1인 <input class="inline-input" id="q4-2" type="text" placeholder="ㄱㄱ">도 증가하고 있습니다.`,
      q3_1_ph: 'ㅎㄷ ㄱㅈ', q3_2_ph: 'ㅎㄱㅈ',
      q4_1_ph: 'ㄷㅁㅎ ㄱㅈ', q4_2_ph: 'ㄱㄱ',
      q5_text: '다양한 가족 형태가 늘어나는 오늘날, 우리가 가족을 대하는 올바른 태도는 무엇일지 자신의 생각을 써 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['확대 가족','확대가족'], q3_2:['핵가족'], q4_1:['다문화 가족','다문화가족'], q4_2:['가구'] },
    essayKeywords: ['존중','인정','다양','배려','이해','사랑','돌봄','책임'],
    explain: {
      q1:'해설: 확대 가족은 여러 세대가 한집에 모여 사는 형태.',
      q2:'해설: 옛날→산업화→오늘날 시간 순서로 변화를 설명함.',
      q3:'해설: 확대 가족에서 핵가족으로 변화함.',
      q4:'해설: 다문화 가족, 1인 가구 등 다양한 형태 증가.',
      q5:'예시: 어떤 형태든 서로 존중하고 배려하는 태도가 필요함.'
    }
  },

  /* ===== soc_03 : "배려로 완성되는 가족 관계" ===== */
  soc_03: {
    labelNo: '03',
    title: '💕 배려로 완성되는 가족 관계',
    passage: [
      '지금과 달리 옛날에는 가족 구성원의 역할이 성별과 나이에 따라 뚜렷하게 나뉘어 있었어요. 할아버지는 집안의 큰 어른으로서 중요한 일을 결정했고, 할머니는 <b>살림</b>을 챙기며 손주들을 돌보았지요. 아버지는 가족이 살아가는 데 필요한 돈을 벌거나 농사를 지었고, 어머니는 집안일을 맡아 밥을 하고 빨래와 청소를 하며 가족을 보살폈어요. 자녀들도 자연스럽게 정해진 <b>역할</b>을 따랐는데, 남자아이들은 글 공부나 농사일을 배우고, 여자아이들은 바느질이나 살림하는 법을 익히며 자랐습니다.',
      '하지만 시대가 흐르면서 가족의 모습도 크게 변화했어요. 이제는 남녀에 상관없이 가족 구성원 모두가 집안일과 바깥일을 함께 나누어 합니다. 아버지가 요리를 하거나 청소를 맡기도 하고, 어머니가 직장에 나가 일을 하며 가족의 <b>생계</b>를 돕기도 하지요. 아이들 역시 설거지, 정리정돈, 쓰레기 버리기처럼 집안의 작은 일부터 함께하며 스스로 책임감을 키워 갑니다. 이런 변화는 가족이 서로를 더 돕고 이해하는 방향으로 나아가고 있다는 뜻이기도 해요.',
      '가족이 함께 생활하다 보면 생각이 다르거나 마음이 상해 <b>갈등</b>이 생길 수도 있어요. 이런 상황에서는 서로의 말을 귀 기울여 듣고, <b>가족회의</b>나 대화를 통해 문제를 해결하려는 노력이 필요합니다. 무엇보다 중요한 것은 서로를 <b>존중</b>하고 <b>배려</b>하는 마음이에요. 비록 서로의 생각이 달라도, 상대를 이해하려는 마음이 있을 때 가족의 관계는 한층 더 단단해지고 가까워질 수 있답니다. 결국 가족을 이루는 힘은 서로를 소중히 여기는 마음에서 시작돼요.'
    ],
    vocab: [
      ['생계', '살아가는 데 필요한 살림살이를 꾸려 가는 일'],
      ['살림', '집안에서 이루어지는 모든 일'],
      ['갈등', '생각이나 의견이 달라 생기는 다툼이나 충돌'],
      ['존중', '상대를 귀하게 여기고 대하는 마음'],
      ['배려', '남을 위해 마음을 쓰고 살피는 태도'],
      ['가족회의', '가족이 함께 모여 의견을 나누는 자리'],
      ['역할', '맡아서 해야 하는 일이나 책임'],
      ['분담', '여러 사람이 일을 나누어 맡는 것']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[가족 관계 관련 어휘]',
      items: [
        { no: 1, text: '살아가는 데 필요한 살림살이를 꾸려 가는 일을 (      )라고 한다.', answer: '생계', initials: 'ㅅㄱ', aliases: ['생계'] },
        { no: 2, text: '집안에서 이루어지는 모든 일을 (      )이라고 한다.', answer: '살림', initials: 'ㅅㄹ', aliases: ['살림'] },
        { no: 3, text: '생각이나 의견이 달라 생기는 다툼이나 충돌을 (      )이라 한다.', answer: '갈등', initials: 'ㄱㄷ', aliases: ['갈등'] },
        { no: 4, text: '상대를 귀하게 여기고 대하는 마음을 (      )이라고 한다.', answer: '존중', initials: 'ㅈㅈ', aliases: ['존중'] },
        { no: 5, text: '남을 위해 마음을 쓰고 살피는 태도를 (      )라고 한다.', answer: '배려', initials: 'ㅂㄹ', aliases: ['배려'] },
        { no: 6, text: '가족이 함께 모여 의견을 나누는 자리를 (      )라고 한다.', answer: '가족회의', initials: 'ㄱㅈㅎㅇ', aliases: ['가족회의','가족 회의'] },
        { no: 7, text: '맡아서 해야 하는 일이나 책임을 (      )이라 한다.', answer: '역할', initials: 'ㅇㅎ', aliases: ['역할'] },
        { no: 8, text: '여러 사람이 일을 나누어 맡는 것을 (      )이라고 한다.', answer: '분담', initials: 'ㅂㄷ', aliases: ['분담'] }
      ]
    },
    quiz: {
      q1_text: '이 글에서 설명하는 현대 가족의 특징으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 가족 구성원의 역할이 성별에 따라 정해져 있다.',
        '② 남녀에 상관없이 가족 모두가 집안일을 함께 나눈다.',
        '③ 아이들은 집안일을 하지 않아도 된다.',
        '④ 아버지만 바깥일을 하고 어머니는 집안일만 한다.'
      ],
      q2_text: '이 글의 구조를 보았을 때, 가장 적절한 설명은 무엇인가요?',
      q2_opts: [
        '① 옛날과 현재의 가족 역할 변화를 비교하며 설명했다.',
        '② 여러 나라의 가족 형태를 나열하여 설명했다.',
        '③ 가족 갈등의 원인만을 자세히 분석했다.',
        '④ 전문가들의 다양한 의견을 인용하여 설명했다.'
      ],
      q3_html: `가족 사이에 생각이 달라 <input class="inline-input" id="q3-1" type="text" placeholder="ㄱㄷ">이 생기면,
                <input class="inline-input" id="q3-2" type="text" placeholder="ㄱㅈㅎㅇ">나 대화를 통해 해결해야 합니다.`,
      q4_html: `가족 관계에서 가장 중요한 것은 서로를 <input class="inline-input" id="q4-1" type="text" placeholder="ㅈㅈ">하고
                <input class="inline-input" id="q4-2" type="text" placeholder="ㅂㄹ">하는 마음입니다.`,
      q3_1_ph: 'ㄱㄷ', q3_2_ph: 'ㄱㅈㅎㅇ', q4_1_ph: 'ㅈㅈ', q4_2_ph: 'ㅂㄹ',
      q5_text: '가족 간에 갈등이 생겼을 때 어떻게 해결하면 좋을지 자신의 생각을 써 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['갈등'], q3_2:['가족회의','가족 회의'], q4_1:['존중'], q4_2:['배려'] },
    essayKeywords: ['대화','존중','배려','이해','양보','타협','경청','사과','화해','가족회의'],
    explain: {
      q1:'해설: 현대 가족은 남녀 구분 없이 모두가 집안일과 바깥일을 함께 나눈다.',
      q2:'해설: 옛날 가족 역할과 현재의 변화된 모습을 비교하며 설명함.',
      q3:'해설: 갈등이 생기면 가족회의나 대화를 통해 해결해야 한다.',
      q4:'해설: 가족 관계에서 가장 중요한 것은 존중과 배려이다.',
      q5:'예시: 서로의 이야기를 끝까지 듣고, 가족회의를 통해 모두가 납득할 수 있는 해결 방법을 찾으면 좋겠습니다.'
    },
    /* 창의활동 */
    creative: {
      title: '우리 가족만의 특별한 점 소개하기',
      instructions: '아래 활동을 통해 우리 가족에 대해 생각해 보세요.',
      topic: '"우리 가족만의 특별한 점이나 행복한 순간을 소개해 보자."',
      hint: '💡 힌트) \'우리 가족만의 특별한 규칙\', \'가장 기억에 남는 가족 여행\', \'우리 집에서만 하는 재미있는 놀이\', \'가족과 함께할 때 가장 행복한 순간\' 등 한 가지 주제로 쓰면 좋아요.',
      examples: [
        '우리 가족은 매주 일요일 저녁에 다 같이 모여 보드게임을 하는 특별한 규칙이 있다. 이 시간이 일주일 중 가장 기다려지는 순간이다.',
        '작년 여름 할머니 댁에 갔을 때 온 가족이 함께 수박을 먹으며 별을 본 것이 가장 행복한 기억이다.',
        '우리 집에서는 매일 아침 가족끼리 서로 하이파이브를 하고 "오늘도 파이팅!"이라고 외친다.'
      ]
    }
  },

  /* ===== soc_04 : “지도의 좌표와 경위도” ===== */
  soc_04: {
    labelNo: '04',
    title: '🚂 시간을 단축한 발명들, 더 넓어진 생활권',
    passage: [
      '지금처럼 빠르게 움직일 수 있는 <b>교통수단</b>이 없던 시절, 사람들은 먼 지역을 오가는 데 많은 시간과 노력이 필요했어요. 말을 타거나 당나귀에 짐을 싣고 걸어가며 길을 따라 천천히 이동했지요. 큰 강을 건널 때는 나룻배를 이용했는데, 날씨가 좋지 않으면 며칠씩 기다려야 할 때도 있었습니다. 목적지에 도착하기까지 일주일, 혹은 한 달 이상이 걸리는 일도 흔했고, 여행은 늘 위험과 불편을 감수해야 하는 일이었어요. 당시 사람들에게 장거리 이동은 매우 큰 결심이 필요한 일이었습니다.',
      '그러나 시간이 흐르면서 과학기술이 발전하고 새로운 원리를 이용한 교통수단이 등장했습니다. 전기를 이용해 움직이는 <b>전차</b>는 도시를 빠르게 연결해 주었고, 뜨거운 수증기의 힘을 이용한 <b>증기선</b>은 강과 바다를 훨씬 빠르게 건널 수 있게 했어요. 이후 자동차, 버스, 기차, 비행기가 보급되면서 우리의 생활은 더욱 달라졌습니다. 이제 사람들은 하루 만에 전국을 이동할 수 있고, 비행기를 이용하면 반나절 만에 해외에도 갈 수 있게 되었지요. 교통의 발달은 시간과 거리의 제한을 크게 줄여 주었습니다.',
      '<b>통신</b>의 변화도 우리 삶에 큰 변화를 가져왔습니다. 옛날에는 급한 소식이 있어도 <b>파발꾼</b>이 직접 달려가 전달해야 했기 때문에, 정보가 도착하는 데 며칠 이상 걸리는 일이 흔했지요. 하지만 전신과 전화가 등장하면서 멀리 떨어진 사람들에게도 빠르게 소식을 전할 수 있게 되었고, 오늘날에는 휴대전화, 이메일, 인터넷을 통해 세계 반대편 사람과도 몇 초 만에 대화를 나눌 수 있습니다. 교통과 통신의 발달은 사람들 사이의 거리감을 줄이고, 지역과 나라 사이의 <b>교류</b>를 활발하게 만들며 우리 사회를 더욱 가깝게 연결해 주고 있어요.'
    ],
    vocab: [
      ['교통수단', '사람이나 물건을 이동시키는 도구나 방법'],
      ['전차', '전기를 이용해 선로 위를 달리는 차량'],
      ['증기선', '수증기의 힘으로 움직이는 배'],
      ['통신', '멀리 있는 사람과 정보를 주고받는 것'],
      ['파발꾼', '옛날에 급한 소식을 전달하던 사람'],
      ['생활권', '사람이 생활할 수 있는 범위나 활동 영역'],
      ['교류', '사람·지역·문화 등이 서로 소통하고 영향을 주고받는 것'],
      ['혁신', '이전과 비교해 크게 발전하거나 새롭게 바뀌는 것']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[교통과 통신 관련 어휘]',
      items: [
        { no: 1, text: '사람이나 물건을 이동시키는 도구나 방법을 (        )이라고 한다.', answer: '교통수단', initials: 'ㄱㅌㅅㄷ', aliases: ['교통수단'] },
        { no: 2, text: '전기를 이용해 선로 위를 달리는 차량을 (      )라고 한다.', answer: '전차', initials: 'ㅈㅊ', aliases: ['전차'] },
        { no: 3, text: '수증기의 힘으로 움직이는 배를 (        )이라고 한다.', answer: '증기선', initials: 'ㅈㄱㅅ', aliases: ['증기선'] },
        { no: 4, text: '멀리 있는 사람과 정보를 주고받는 것을 (      )이라고 한다.', answer: '통신', initials: 'ㅌㅅ', aliases: ['통신'] },
        { no: 5, text: '옛날에 급한 소식을 전달하던 사람을 (        )이라고 한다.', answer: '파발꾼', initials: 'ㅍㅂㄲ', aliases: ['파발꾼'] },
        { no: 6, text: '사람이 생활할 수 있는 범위나 활동 영역을 (        )이라고 한다.', answer: '생활권', initials: 'ㅅㅎㄱ', aliases: ['생활권'] },
        { no: 7, text: '사람·지역·문화 등이 서로 소통하고 영향을 주고받는 것을 (      )라고 한다.', answer: '교류', initials: 'ㄱㄹ', aliases: ['교류'] },
        { no: 8, text: '이전과 비교해 크게 발전하거나 새롭게 바뀌는 것을 (      )이라고 한다.', answer: '혁신', initials: 'ㅎㅅ', aliases: ['혁신'] }
      ]
    },
    quiz: {
      q1_text: '본문에서 설명하는 옛날 여행의 특징으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 빠른 교통수단 덕분에 편리하게 이동할 수 있었다.',
        '② 날씨에 상관없이 언제나 이동이 가능했다.',
        '③ 장거리 이동에 많은 시간과 노력이 필요했다.',
        '④ 비행기를 타고 해외여행을 즐겼다.'
      ],
      q2_text: '본문의 구조를 가장 바르게 설명한 것은 무엇인가요?',
      q2_opts: [
        '① 교통의 역사 → 통신의 역사 → 미래의 기술 예측',
        '② 옛날 이동의 어려움 → 교통수단의 발달 → 통신의 변화와 사회 연결',
        '③ 전차의 원리 → 증기선의 원리 → 비행기의 원리',
        '④ 파발꾼의 생활 → 전화의 발명 → 인터넷의 등장'
      ],
      q3_html: `전기를 이용해 도시를 빠르게 연결한 교통수단은 <input class="inline-input" id="q3-1" type="text" placeholder="ㅈㅊ">이고,
                수증기의 힘으로 강과 바다를 건넌 교통수단은 <input class="inline-input" id="q3-2" type="text" placeholder="ㅈㄱㅅ">이다.`,
      q4_html: `옛날에 급한 소식을 전달하던 사람을 <input class="inline-input" id="q4-1" type="text" placeholder="ㅍㅂㄲ">이라 하고,
                교통과 통신의 발달로 사람들의 활동 범위인 <input class="inline-input" id="q4-2" type="text" placeholder="ㅅㅎㄱ">이 넓어졌다.`,
      q3_1_ph: 'ㅈㅊ', q3_2_ph: 'ㅈㄱㅅ', q4_1_ph: 'ㅍㅂㄲ', q4_2_ph: 'ㅅㅎㄱ',
      q5_text: '교통과 통신의 발달이 우리 생활에 가져온 변화를 본문을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['전차'], q3_2:['증기선'], q4_1:['파발꾼'], q4_2:['생활권'] },
    essayKeywords: ['교통','통신','시간','거리','생활권','교류','연결','발달'],
    explain: {
      q1:'해설: 옛날에는 장거리 이동에 많은 시간과 노력이 필요했다.',
      q2:'해설: 본문은 옛날 이동의 어려움 → 교통수단의 발달 → 통신의 변화와 사회 연결 순서로 구성되어 있다.',
      q3:'해설: 전차는 전기로 도시를 연결하고, 증기선은 수증기의 힘으로 강과 바다를 건넜다.',
      q4:'해설: 파발꾼은 옛날 소식 전달자이고, 생활권은 사람들의 활동 범위이다.',
      q5:'예시: 교통과 통신의 발달로 이동 시간이 단축되고, 멀리 있는 사람과도 빠르게 소통할 수 있게 되어 생활권이 넓어지고 교류가 활발해졌다.'
    },
    creative: {
      title: '미래의 교통·통신 발명품 상상하기',
      topic: '"내가 발명가라면 어떤 교통수단이나 통신 도구를 만들고 싶은가?"',
      hint: '💡 힌트) 더 빠르고, 더 편리하고, 환경을 보호하는 미래의 발명품을 상상해 보세요!',
      examples: [
        '예시 1) 생각만으로 목적지에 도착하는 순간이동 장치를 발명해서 교통체증을 없애고 싶다.',
        '예시 2) 하늘을 나는 자동차를 만들어 도로 없이도 어디든 갈 수 있게 하고 싶다.',
        '예시 3) 다른 나라 사람과 말할 때 자동으로 번역해주는 이어폰을 만들어 언어 장벽을 없애고 싶다.'
      ]
    }
  },

  /* ===== soc_05 : "우리 동네 문제, 함께 해결해요" ===== */
  soc_05: {
    labelNo: '05',
    title: '🏘️ 우리 동네 문제, 함께 해결해요',
    passage: [
      '학급에서 문제가 생기면 전교생이 모여 의견을 나누는 것처럼, 지역 사회에서도 주민들이 직접 참여해 문제를 해결하려는 노력이 중요해요. 주민들은 자신이 사는 곳의 상황을 가장 잘 알고 있기 때문에, 어떤 문제가 생겼을 때 해결책을 찾는 데 큰 역할을 합니다. 또한 지역 문제는 주민들의 생활과 안전에 직접적인 영향을 주므로, 많은 사람들이 의견을 모아 적극적으로 참여하는 것이 필요하지요.',
      '주민들이 의견을 낼 수 있는 방법은 생각보다 다양해요. 시청이나 도청 누리집에 접속해 의견을 제출할 수도 있고, 공공 기관의 <b>민원</b>실을 직접 찾아가 문제 상황을 설명하기도 합니다. 또 정책을 만들기 전에 열리는 <b>공청회</b>에 참석해 자신의 의견을 공개적으로 말할 수 있으며, <b>서명 운동</b>에 참여해 특정 주장에 찬성한다는 뜻을 나타낼 수도 있어요. 이런 활동들은 사회가 더 민주적으로 운영되도록 돕는 중요한 과정이에요.',
      '일부 주민들은 보다 적극적으로 지역 발전에 기여하기 위해 <b>시민 단체</b>에서 활동하기도 합니다. 시민 단체는 환경 보호, 교육 지원, 역사 보존, 복지 봉사 등 다양한 분야에서 지역 사회를 돕고 있어요. 예를 들어, 환경 관련 단체는 오염을 막기 위한 캠페인을 하고, 봉사 단체는 도움이 필요한 이웃에게 생활품을 전달하거나 교통 정리를 맡기도 합니다. 이처럼 주민들이 힘을 모아 움직이면 정부나 <b>지방 자치 단체</b>가 미처 해결하지 못한 문제들을 찾아 개선할 수 있고, 결국 모두가 더 편안하고 안전하게 살 수 있는 지역을 만드는 데 기여하게 되는 것이랍니다.'
    ],
    vocab: [
      ['주민 참여','지역 문제 해결을 위해 주민이 의견을 내고 행동하는 활동'],
      ['민원','주민이 공공 기관에 요청하거나 불편을 알려 해결을 요구하는 일'],
      ['공청회','정책을 결정하기 전에 주민 의견을 듣기 위해 공개적으로 여는 회의'],
      ['서명 운동','특정 주장에 찬성하거나 반대한다는 뜻을 나타내기 위해 서명을 모으는 활동'],
      ['시민 단체','공익을 위해 자발적으로 모인 단체'],
      ['지방 자치 단체','지역 행정을 맡아 운영하는 기관(시·군·구 등)'],
      ['정책','문제 해결을 위해 정부나 기관이 세우는 계획'],
      ['예산','공공 기관이 쓸 돈을 계획해서 정해 놓은 것']
    ],
    vocabFill: {
      instructions: '[주민 참여 관련 어휘]',
      items: [
        { no: 1, text: '지역 문제 해결을 위해 주민이 의견을 내고 행동하는 활동을 (         )라고 한다.', answer: '주민 참여', initials: 'ㅈㅁㅊㅇ', aliases: ['주민 참여','주민참여'] },
        { no: 2, text: '주민이 공공 기관에 요청하거나 불편을 알려 해결을 요구하는 일을 (      )이라고 한다.', answer: '민원', initials: 'ㅁㅇ', aliases: ['민원'] },
        { no: 3, text: '정책을 결정하기 전에 주민 의견을 듣기 위해 공개적으로 여는 회의를 (      )라고 한다.', answer: '공청회', initials: 'ㄱㅊㅎ', aliases: ['공청회'] },
        { no: 4, text: '특정 주장에 찬성하거나 반대한다는 뜻을 나타내기 위해 서명을 모으는 활동을 (         )이라고 한다.', answer: '서명 운동', initials: 'ㅅㅁㅇㄷ', aliases: ['서명 운동','서명운동'] },
        { no: 5, text: '공익을 위해 자발적으로 모인 단체를 (         )라고 한다.', answer: '시민 단체', initials: 'ㅅㅁㄷㅊ', aliases: ['시민 단체','시민단체'] },
        { no: 6, text: '지역 행정을 맡아 운영하는 기관을 (            )라고 한다.', answer: '지방 자치 단체', initials: 'ㅈㅂㅈㅊㄷㅊ', aliases: ['지방 자치 단체','지방자치단체'] },
        { no: 7, text: '문제 해결을 위해 정부나 기관이 세우는 계획을 (      )이라고 한다.', answer: '정책', initials: 'ㅈㅊ', aliases: ['정책'] },
        { no: 8, text: '공공 기관이 쓸 돈을 계획해서 정해 놓은 것을 (      )이라고 한다.', answer: '예산', initials: 'ㅇㅅ', aliases: ['예산'] }
      ]
    },
    quiz: {
      q1_text: '[핵심이해력] 지역 문제 해결에 주민 참여가 중요한 이유로 가장 알맞은 것은?',
      q1_opts: [
        '① 정부가 모든 문제를 해결할 수 없기 때문이다.',
        '② 주민들이 자신이 사는 곳의 상황을 가장 잘 알고 있기 때문이다.',
        '③ 법으로 주민 참여가 의무화되어 있기 때문이다.',
        '④ 주민들이 공무원보다 능력이 뛰어나기 때문이다.'
      ],
      q2_text: '[구조파악력] 이 글에서 설명하는 내용의 순서로 알맞은 것은?',
      q2_opts: ['① 시민 단체 소개 → 주민 참여 방법 → 참여의 중요성', '② 주민 참여의 중요성 → 참여 방법 소개 → 시민 단체의 역할', '③ 참여 방법 → 시민 단체 역할 → 참여의 중요성', '④ 지방 자치 단체 소개 → 민원 방법 → 서명 운동 설명'],
      q3_1_ph: 'ㅁㅇ', q3_2_ph: 'ㄱㅊㅎ',
      q4_1_ph: 'ㅅㅁㄷㅊ', q4_2_ph: 'ㅈㅂㅈㅊㄷㅊ',
      q5_text: '[비판적용력] 우리 동네에서 개선이 필요한 문제를 하나 찾고, 주민으로서 어떻게 참여할 수 있을지 구체적으로 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['민원'], q3_2:['공청회'], q4_1:['시민 단체','시민단체'], q4_2:['지방 자치 단체','지방자치단체'] },
    essayKeywords: ['문제','참여','주민','의견','해결','민원','공청회','시민','단체','지역'],
    explain: {
      q1:'해설: 주민들이 자신이 사는 곳의 상황을 가장 잘 알고 있기 때문에 문제 해결에 큰 역할을 합니다.',
      q2:'해설: 본문은 주민 참여의 중요성 → 다양한 참여 방법 → 시민 단체의 역할과 참여 확장 순서로 설명합니다.',
      q3:'해설: 공공 기관에 불편을 알려 해결을 요구하는 것이 민원이고, 정책 결정 전 주민 의견을 듣는 회의가 공청회입니다.',
      q4:'해설: 공익을 위해 자발적으로 모인 단체가 시민 단체이고, 지역 행정을 맡아 운영하는 기관이 지방 자치 단체입니다.',
      q5:'예시: 우리 동네 횡단보도에 신호등이 없어 위험하므로, 시청 누리집에 민원을 제출하거나 서명 운동을 통해 개선을 요청할 수 있다.'
    },
    creative: {
      title: '🏘️ 우리 동네 문제 해결 제안서',
      topic: '내가 우리 동네 주민 대표라면 어떤 문제를 해결하고 싶은지 제안서를 작성해 보세요.',
      hint: '💡 힌트) 통학로 안전, 쓰레기 문제, 놀이 공간 부족, 버스 노선 불편 등 일상에서 느끼는 불편함을 떠올려 보세요.',
      examples: [
        '예시 1) 학교 앞 횡단보도에 신호등이 없어 위험하므로, 시청에 민원을 넣어 신호등 설치를 요청하겠다.',
        '예시 2) 우리 동네에 도서관이 없어서 공청회에 참석해 작은 도서관 설치를 제안하겠다.',
        '예시 3) 마을버스 배차 간격이 너무 길어 불편하므로, 서명 운동을 통해 배차 간격 단축을 요청하겠다.'
      ]
    }
  },

  /* ===== soc_06 : "지도를 보고 길을 찾아가다" (샘플 데이터) ===== */
  soc_06: {
    labelNo: '06',
    title: '💭 가치관과 규범의 형성',
    passage: [
      '낯선 장소에 갔을 때 가장 먼저 하는 일은 지도를 확인하는 것입니다. 지도는 <b>방향</b>과 <b>거리</b>를 알려주어 목적지까지 안전하게 도달할 수 있게 합니다.',
      '지도를 읽을 때는 <b>축척</b>, <b>방위표</b>, <b>범례</b> 등을 이해해야 합니다. 이러한 정보를 활용하면 실제 공간에서 길을 찾는 데 큰 도움이 됩니다.',
      '요즘은 스마트폰의 <b>GPS</b> 기능으로 실시간 위치를 확인하며 길을 찾을 수 있지만, 종이 지도를 읽는 능력도 여전히 중요합니다.'
    ],
    vocab: [
      ['방향','동서남북 등 나아가는 쪽'],
      ['거리','두 지점 사이의 길이'],
      ['축척','실제와 지도의 크기 비율'],
      ['방위표','지도에서 방향을 나타내는 표시'],
      ['범례','지도 기호의 의미를 설명한 것'],
      ['GPS','위성을 이용한 위치 확인 시스템'],
      ['실시간','바로 지금 이 순간'],
      ['목적지','가고자 하는 곳'],
      ['경로','출발지에서 목적지까지의 길']
    ],
    vocabFill: {
      instructions: '[지도 읽기 어휘]',
      items: [
        { no: 1, text: '동서남북 등 나아가는 쪽을 (      )이라고 한다.', answer: '방향', initials: 'ㅂㅎ', aliases: ['방향'] },
        { no: 2, text: '두 지점 사이의 길이를 (      )라고 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 3, text: '실제와 지도의 크기 비율을 (      )이라 한다.', answer: '축척', initials: 'ㅊㅊ', aliases: ['축척'] },
        { no: 4, text: '지도에서 방향을 나타내는 표시를 (      )라 한다.', answer: '방위표', initials: 'ㅂㅇㅍ', aliases: ['방위표'] },
        { no: 5, text: '지도 기호의 의미를 설명한 것을 (      )라 한다.', answer: '범례', initials: 'ㅂㄹ', aliases: ['범례'] },
        { no: 6, text: '위성을 이용한 위치 확인 시스템을 (   )라 한다.', answer: 'GPS', initials: 'ㅈㅍㅅ', aliases: ['GPS','지피에스'] },
        { no: 7, text: '바로 지금 이 순간을 (      )이라고 한다.', answer: '실시간', initials: 'ㅅㅅㄱ', aliases: ['실시간'] },
        { no: 8, text: '가고자 하는 곳을 (      )라고 한다.', answer: '목적지', initials: 'ㅁㅈㅈ', aliases: ['목적지'] },
        { no: 9, text: '출발지에서 목적지까지의 길을 (      )라고 한다.', answer: '경로', initials: 'ㄱㄹ', aliases: ['경로'] }
      ]
    },
    quiz: {
      q1_text: '지도를 읽을 때 가장 중요한 요소는 무엇인가요?',
      q1_opts: ['① 지도의 색깔', '② 축척, 방위표, 범례', '③ 지도의 크기', '④ 지도를 만든 사람'],
      q2_text: 'GPS의 장점은 무엇인가요?',
      q2_opts: ['① 종이가 필요 없다', '② 실시간으로 위치를 확인할 수 있다', '③ 배터리가 필요 없다', '④ 항상 정확하다'],
      q3_1_ph: 'ㅊㅊ', q3_2_ph: 'ㅂㅇㅍ',
      q4_1_ph: 'ㅈㅍㅅ', q4_2_ph: 'ㅅㅅㄱ',
      q5_text: '종이 지도와 디지털 지도의 장단점을 비교하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['축척'], q3_2:['방위표'], q4_1:['GPS','지피에스'], q4_2:['실시간'] },
    essayKeywords: ['지도','종이','디지털','GPS','장점','단점'],
    explain: {
      q1:'해설: 축척, 방위표, 범례는 지도 읽기의 핵심 요소.',
      q2:'해설: GPS는 실시간 위치 확인이 가능함.',
      q3:'해설: 축척으로 거리를, 방위표로 방향을 알 수 있음.',
      q4:'해설: GPS는 실시간 위치 추적 가능.',
      q5:'예시: 종이 지도는 배터리 불필요, 디지털은 실시간 업데이트 가능.'
    }
  },

  /* ===== soc_07 : "세계 여러 나라의 위치와 특징" (샘플 데이터) ===== */
  soc_07: {
    labelNo: '07',
    title: '🧑‍🎓 청소년과 사회 참여',
    passage: [
      '지구에는 약 200개가 넘는 나라가 있으며, 각 나라는 고유한 <b>지리적 위치</b>와 <b>문화</b>를 가지고 있습니다.',
      '나라의 위치는 그 나라의 <b>기후</b>, <b>산업</b>, <b>생활 방식</b>에 큰 영향을 미칩니다. 예를 들어 적도 근처 나라는 더운 날씨, 북극 근처 나라는 추운 날씨를 보입니다.',
      '세계 지도를 통해 각 나라의 위치를 파악하고, 그 특징을 이해하는 것은 <b>국제 이해</b>의 첫걸음입니다.'
    ],
    vocab: [
      ['지리적 위치','지구상에서 특정 지점이 있는 자리'],
      ['문화','한 사회의 생활 양식과 전통'],
      ['기후','어떤 지역의 평균적인 날씨'],
      ['산업','물건을 만들거나 서비스를 제공하는 일'],
      ['생활 방식','사람들이 살아가는 방법'],
      ['적도','지구의 중심을 가로지르는 가상의 선'],
      ['국제 이해','여러 나라를 이해하고 존중하는 태도'],
      ['대륙','지구를 이루는 큰 땅덩어리'],
      ['해양','지구를 둘러싼 넓은 바다']
    ],
    vocabFill: {
      instructions: '[세계 지리 어휘]',
      items: [
        { no: 1, text: '지구상에서 특정 지점이 있는 자리를 (        )라고 한다.', answer: '지리적 위치', initials: 'ㅈㄹㅈ ㅇㅊ', aliases: ['지리적위치'] },
        { no: 2, text: '한 사회의 생활 양식과 전통을 (      )라고 한다.', answer: '문화', initials: 'ㅁㅎ', aliases: ['문화'] },
        { no: 3, text: '어떤 지역의 평균적인 날씨를 (      )라고 한다.', answer: '기후', initials: 'ㄱㅎ', aliases: ['기후'] },
        { no: 4, text: '물건을 만들거나 서비스를 제공하는 일을 (      )이라 한다.', answer: '산업', initials: 'ㅅㅇ', aliases: ['산업'] },
        { no: 5, text: '사람들이 살아가는 방법을 (        )이라 한다.', answer: '생활 방식', initials: 'ㅅㅎ ㅂㅅ', aliases: ['생활방식'] },
        { no: 6, text: '지구의 중심을 가로지르는 가상의 선을 (      )라 한다.', answer: '적도', initials: 'ㅈㄷ', aliases: ['적도'] },
        { no: 7, text: '여러 나라를 이해하고 존중하는 태도를 (        )라 한다.', answer: '국제 이해', initials: 'ㄱㅈ ㅇㅎ', aliases: ['국제이해'] },
        { no: 8, text: '지구를 이루는 큰 땅덩어리를 (      )라고 한다.', answer: '대륙', initials: 'ㄷㄹ', aliases: ['대륙'] },
        { no: 9, text: '지구를 둘러싼 넓은 바다를 (      )라고 한다.', answer: '해양', initials: 'ㅎㅇ', aliases: ['해양'] }
      ]
    },
    quiz: {
      q1_text: '나라의 위치가 그 나라에 미치는 영향으로 가장 알맞은 것은?',
      q1_opts: ['① 위치는 기후와 산업에 영향을 준다', '② 위치는 아무 영향이 없다', '③ 위치는 문화와 무관하다', '④ 모든 나라의 위치는 같다'],
      q2_text: '국제 이해가 중요한 이유는 무엇인가요?',
      q2_opts: ['① 다른 나라를 비판하기 위해', '② 여러 나라를 이해하고 존중하기 위해', '③ 우리나라만 발전시키기 위해', '④ 세계 지도를 외우기 위해'],
      q3_1_ph: 'ㄱㅎ', q3_2_ph: 'ㅅㅇ',
      q4_1_ph: 'ㅈㄷ', q4_2_ph: 'ㄷㄹ',
      q5_text: '세계 여러 나라의 위치를 아는 것이 왜 중요한지 설명해 보세요.'
    },
    answerKey: { q1:'1', q2:'2', q3_1:['기후'], q3_2:['산업'], q4_1:['적도'], q4_2:['대륙'] },
    essayKeywords: ['세계','나라','위치','이해','기후','문화'],
    explain: {
      q1:'해설: 위치는 기후, 산업, 생활 방식에 영향을 미침.',
      q2:'해설: 국제 이해는 다양성 존중의 기초.',
      q3:'해설: 위치에 따라 기후와 산업이 달라짐.',
      q4:'해설: 적도 근처는 더운 기후, 대륙별로 특징 다름.',
      q5:'예시: 각 나라의 문화와 생활을 이해하고 존중하기 위해 필요함.'
    }
  },

  /* ===== soc_08 : "우리나라의 지리적 특성 이해하기" (샘플 데이터) ===== */
  soc_08: {
    labelNo: '08',
    title: '⚖️ 인권과 평등의 확장',
    passage: [
      '우리나라는 <b>한반도</b>에 위치하며, 삼면이 바다로 둘러싸여 있습니다. <b>동해</b>, <b>서해</b>, <b>남해</b>가 각각 다른 특징을 가지고 있습니다.',
      '국토의 약 70%가 산지로 이루어져 있어 <b>산악 지형</b>이 발달했습니다. 이로 인해 계곡과 분지가 많으며, 평야는 주로 서해안에 분포합니다.',
      '우리나라는 <b>사계절</b>이 뚜렷하여 계절마다 다른 풍경과 생활 모습을 보입니다.'
    ],
    vocab: [
      ['한반도','우리나라가 위치한 반도'],
      ['동해','한반도 동쪽의 바다'],
      ['서해','한반도 서쪽의 바다'],
      ['남해','한반도 남쪽의 바다'],
      ['산악 지형','산이 많은 땅의 모양'],
      ['평야','넓고 평평한 땅'],
      ['사계절','봄, 여름, 가을, 겨울'],
      ['계곡','산과 산 사이의 골짜기'],
      ['분지','주위가 산으로 둘러싸인 평지']
    ],
    vocabFill: {
      instructions: '[우리나라 지리 어휘]',
      items: [
        { no: 1, text: '우리나라가 위치한 반도를 (      )라고 한다.', answer: '한반도', initials: 'ㅎㅂㄷ', aliases: ['한반도'] },
        { no: 2, text: '한반도 동쪽의 바다를 (      )라고 한다.', answer: '동해', initials: 'ㄷㅎ', aliases: ['동해'] },
        { no: 3, text: '한반도 서쪽의 바다를 (      )라고 한다.', answer: '서해', initials: 'ㅅㅎ', aliases: ['서해'] },
        { no: 4, text: '한반도 남쪽의 바다를 (      )라고 한다.', answer: '남해', initials: 'ㄴㅎ', aliases: ['남해'] },
        { no: 5, text: '산이 많은 땅의 모양을 (        )이라 한다.', answer: '산악 지형', initials: 'ㅅㅇ ㅈㅎ', aliases: ['산악지형'] },
        { no: 6, text: '넓고 평평한 땅을 (      )라고 한다.', answer: '평야', initials: 'ㅍㅇ', aliases: ['평야'] },
        { no: 7, text: '봄, 여름, 가을, 겨울을 (      )이라 한다.', answer: '사계절', initials: 'ㅅㄱㅈ', aliases: ['사계절'] },
        { no: 8, text: '산과 산 사이의 골짜기를 (      )라고 한다.', answer: '계곡', initials: 'ㄱㄱ', aliases: ['계곡'] },
        { no: 9, text: '주위가 산으로 둘러싸인 평지를 (      )라고 한다.', answer: '분지', initials: 'ㅂㅈ', aliases: ['분지'] }
      ]
    },
    quiz: {
      q1_text: '우리나라의 지리적 특징으로 가장 알맞은 것은?',
      q1_opts: ['① 사면이 바다로 둘러싸임', '② 삼면이 바다, 산지 많음', '③ 평야만 있음', '④ 사막이 많음'],
      q2_text: '사계절이 뚜렷한 이유는 무엇인가요?',
      q2_opts: ['① 위도와 기후의 영향', '② 바다가 많아서', '③ 산이 많아서', '④ 인구가 많아서'],
      q3_1_ph: 'ㅎㅂㄷ', q3_2_ph: 'ㅅㅇ ㅈㅎ',
      q4_1_ph: 'ㅅㄱㅈ', q4_2_ph: 'ㅍㅇ',
      q5_text: '우리나라의 지리적 특징이 우리 생활에 미치는 영향을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['한반도'], q3_2:['산악지형','산악 지형'], q4_1:['사계절'], q4_2:['평야'] },
    essayKeywords: ['한반도','산','바다','사계절','평야','생활'],
    explain: {
      q1:'해설: 삼면이 바다, 국토의 70%가 산지.',
      q2:'해설: 위도와 기후의 영향으로 사계절 뚜렷.',
      q3:'해설: 한반도는 산악 지형이 발달.',
      q4:'해설: 사계절과 평야가 농업에 영향.',
      q5:'예시: 산지는 등산 문화, 바다는 어업, 사계절은 다양한 계절 행사.'
    }
  },

  /* ===== soc_09 : "자연재해와 인간의 대응" (샘플 데이터) ===== */
  soc_09: {
    labelNo: '09',
    title: '🤝 갈등과 해결의 방법',
    passage: [
      '자연재해는 <b>지진</b>, <b>태풍</b>, <b>홍수</b>, <b>가뭄</b> 등 자연 현상으로 인해 발생하는 피해를 말합니다.',
      '이러한 재해는 인간의 생명과 재산에 큰 피해를 주지만, 사전에 철저히 <b>대비</b>하고 <b>대응</b>하면 피해를 줄일 수 있습니다.',
      '최근에는 <b>재해 예측 시스템</b>과 <b>대피 훈련</b>을 통해 피해를 최소화하려는 노력이 이루어지고 있습니다.'
    ],
    vocab: [
      ['자연재해','자연 현상으로 인한 큰 피해'],
      ['지진','땅이 흔들리는 현상'],
      ['태풍','강한 바람과 비를 동반하는 열대 저기압'],
      ['홍수','물이 넘쳐 피해를 주는 현상'],
      ['가뭄','오랫동안 비가 오지 않는 현상'],
      ['대비','미리 준비하는 것'],
      ['대응','상황에 맞게 행동하는 것'],
      ['재해 예측 시스템','재해를 미리 알려주는 기술'],
      ['대피 훈련','위험 상황에서 안전하게 피하는 연습']
    ],
    vocabFill: {
      instructions: '[자연재해 어휘]',
      items: [
        { no: 1, text: '자연 현상으로 인한 큰 피해를 (        )라고 한다.', answer: '자연재해', initials: 'ㅈㅇ ㅈㅎ', aliases: ['자연재해'] },
        { no: 2, text: '땅이 흔들리는 현상을 (      )이라고 한다.', answer: '지진', initials: 'ㅈㅈ', aliases: ['지진'] },
        { no: 3, text: '강한 바람과 비를 동반하는 열대 저기압을 (      )이라 한다.', answer: '태풍', initials: 'ㅌㅍ', aliases: ['태풍'] },
        { no: 4, text: '물이 넘쳐 피해를 주는 현상을 (      )라고 한다.', answer: '홍수', initials: 'ㅎㅅ', aliases: ['홍수'] },
        { no: 5, text: '오랫동안 비가 오지 않는 현상을 (      )이라 한다.', answer: '가뭄', initials: 'ㄱㅁ', aliases: ['가뭄'] },
        { no: 6, text: '미리 준비하는 것을 (      )라고 한다.', answer: '대비', initials: 'ㄷㅂ', aliases: ['대비'] },
        { no: 7, text: '상황에 맞게 행동하는 것을 (      )라고 한다.', answer: '대응', initials: 'ㄷㅇ', aliases: ['대응'] },
        { no: 8, text: '재해를 미리 알려주는 기술을 (            )이라 한다.', answer: '재해 예측 시스템', initials: 'ㅈㅎ ㅇㅊ ㅅㅅㅌ', aliases: ['재해예측시스템'] },
        { no: 9, text: '위험 상황에서 안전하게 피하는 연습을 (        )이라 한다.', answer: '대피 훈련', initials: 'ㄷㅍ ㅎㄹ', aliases: ['대피훈련'] }
      ]
    },
    quiz: {
      q1_text: '자연재해 피해를 줄이는 방법으로 가장 알맞은 것은?',
      q1_opts: ['① 아무것도 하지 않기', '② 사전 대비와 대응', '③ 재해 후에만 행동', '④ 무조건 피하기'],
      q2_text: '대피 훈련이 중요한 이유는 무엇인가요?',
      q2_opts: ['① 재미있어서', '② 위험 상황에서 빠르게 대응하기 위해', '③ 시간을 보내기 위해', '④ 법으로 정해져서'],
      q3_1_ph: 'ㅈㅈ', q3_2_ph: 'ㅌㅍ',
      q4_1_ph: 'ㄷㅂ', q4_2_ph: 'ㄷㅇ',
      q5_text: '자연재해가 발생했을 때 우리가 해야 할 행동을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['지진'], q3_2:['태풍'], q4_1:['대비'], q4_2:['대응'] },
    essayKeywords: ['재해','대비','대응','안전','대피','예방'],
    explain: {
      q1:'해설: 사전 대비와 신속한 대응이 피해를 줄임.',
      q2:'해설: 대피 훈련은 실제 상황에서 생명을 구함.',
      q3:'해설: 지진, 태풍 등 다양한 자연재해 존재.',
      q4:'해설: 미리 대비하고 상황에 맞게 대응해야 함.',
      q5:'예시: 안전한 곳으로 대피하고, 긴급 연락망을 확인하며, 침착하게 행동.'
    }
  },

  /* ===== soc_10 : "환경 문제와 지속 가능한 발전" (샘플 데이터) ===== */
  soc_10: {
    labelNo: '10',
    title: '🌐 세계화 시대의 사회문화',
    passage: [
      '현대 사회는 <b>환경 오염</b>, <b>지구 온난화</b>, <b>생물 다양성 감소</b> 등 심각한 환경 문제에 직면해 있습니다.',
      '이러한 문제를 해결하기 위해서는 <b>재생 에너지</b> 사용, <b>재활용</b>, <b>탄소 배출 감소</b> 등의 노력이 필요합니다.',
      '<b>지속 가능한 발전</b>은 현재 세대의 필요를 충족하면서도 미래 세대의 환경을 보호하는 것을 의미합니다.'
    ],
    vocab: [
      ['환경 오염','공기, 물, 토양이 더러워지는 것'],
      ['지구 온난화','지구의 평균 기온이 높아지는 현상'],
      ['생물 다양성','여러 종류의 생물이 존재하는 것'],
      ['재생 에너지','다시 만들어 쓸 수 있는 에너지'],
      ['재활용','쓴 물건을 다시 사용하는 것'],
      ['탄소 배출','이산화탄소를 내보내는 것'],
      ['지속 가능한 발전','미래를 위한 균형 잡힌 발전'],
      ['온실가스','지구를 덥게 만드는 기체'],
      ['친환경','환경을 보호하는']
    ],
    vocabFill: {
      instructions: '[환경과 발전 어휘]',
      items: [
        { no: 1, text: '공기, 물, 토양이 더러워지는 것을 (        )이라 한다.', answer: '환경 오염', initials: 'ㅎㄱ ㅇㅇ', aliases: ['환경오염'] },
        { no: 2, text: '지구의 평균 기온이 높아지는 현상을 (          )이라 한다.', answer: '지구 온난화', initials: 'ㅈㄱ ㅇㄴㅎ', aliases: ['지구온난화'] },
        { no: 3, text: '여러 종류의 생물이 존재하는 것을 (          )이라 한다.', answer: '생물 다양성', initials: 'ㅅㅁ ㄷㅇㅅ', aliases: ['생물다양성'] },
        { no: 4, text: '다시 만들어 쓸 수 있는 에너지를 (        )라 한다.', answer: '재생 에너지', initials: 'ㅈㅅ ㅇㄴㅈ', aliases: ['재생에너지'] },
        { no: 5, text: '쓴 물건을 다시 사용하는 것을 (      )이라 한다.', answer: '재활용', initials: 'ㅈㅎㅇ', aliases: ['재활용'] },
        { no: 6, text: '이산화탄소를 내보내는 것을 (        )이라 한다.', answer: '탄소 배출', initials: 'ㅌㅅ ㅂㅊ', aliases: ['탄소배출'] },
        { no: 7, text: '미래를 위한 균형 잡힌 발전을 (            )이라 한다.', answer: '지속 가능한 발전', initials: 'ㅈㅅ ㄱㄴㅎ ㅂㅈ', aliases: ['지속가능한발전'] },
        { no: 8, text: '지구를 덥게 만드는 기체를 (      )라고 한다.', answer: '온실가스', initials: 'ㅇㅅㄱㅅ', aliases: ['온실가스'] },
        { no: 9, text: '환경을 보호하는 것을 (      )이라고 한다.', answer: '친환경', initials: 'ㅊㅎㄱ', aliases: ['친환경'] }
      ]
    },
    quiz: {
      q1_text: '지속 가능한 발전의 의미로 가장 알맞은 것은?',
      q1_opts: ['① 현재만 생각', '② 미래 세대도 고려', '③ 개발 중단', '④ 환경 파괴'],
      q2_text: '환경 보호를 위해 우리가 할 수 있는 일은?',
      q2_opts: ['① 일회용품 많이 쓰기', '② 재활용하기', '③ 에너지 낭비', '④ 쓰레기 버리기'],
      q3_1_ph: 'ㅎㄱ ㅇㅇ', q3_2_ph: 'ㅈㄱ ㅇㄴㅎ',
      q4_1_ph: 'ㅈㅎㅇ', q4_2_ph: 'ㅈㅅ ㅇㄴㅈ',
      q5_text: '지속 가능한 발전을 위해 개인이 실천할 수 있는 방법을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['환경오염','환경 오염'], q3_2:['지구온난화','지구 온난화'], q4_1:['재활용'], q4_2:['재생에너지','재생 에너지'] },
    essayKeywords: ['환경','재활용','에너지','탄소','지속','실천'],
    explain: {
      q1:'해설: 지속 가능한 발전은 미래 세대를 고려한 균형 발전.',
      q2:'해설: 재활용은 환경 보호의 기본 실천.',
      q3:'해설: 환경 오염과 지구 온난화는 현대의 주요 문제.',
      q4:'해설: 재활용과 재생 에너지가 핵심 해결책.',
      q5:'예시: 일회용품 줄이기, 분리수거, 대중교통 이용, 에너지 절약.'
    }
  },

  /* ===== soc_11 ~ soc_20 샘플 데이터 (더 간략하게) ===== */

  soc_11: {
    labelNo: '11',
    title: '📚 사회 제도와 사회화',
    passage: ['도시는 인구가 많고 다양한 산업이 발달한 곳입니다.','농촌은 자연과 가까우며 농업이 중심입니다.','각각의 특징을 이해하고 조화롭게 발전해야 합니다.'],
    vocab: [['도시','인구와 시설이 밀집한 곳'],['농촌','농업 중심의 시골 지역'],['인구 밀집','사람이 많이 모여 사는 것'],['산업','생산과 서비스 활동'],['농업','농사를 짓는 일'],['교통','이동 수단과 시스템'],['인프라','기반 시설'],['생활 환경','사람들이 사는 조건'],['조화','균형 있게 어울림']],
    vocabFill: { instructions: '[도시와 농촌]', items: [
      {no:1,text:'인구와 시설이 밀집한 곳을 (   )라고 한다.',answer:'도시',initials:'ㄷㅅ',aliases:['도시']},
      {no:2,text:'농업 중심의 시골 지역을 (   )이라 한다.',answer:'농촌',initials:'ㄴㅊ',aliases:['농촌']},
      {no:3,text:'사람이 많이 모여 사는 것을 (      )이라 한다.',answer:'인구 밀집',initials:'ㅇㄱ ㅁㅈ',aliases:['인구밀집']},
      {no:4,text:'생산과 서비스 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:5,text:'농사를 짓는 일을 (   )이라 한다.',answer:'농업',initials:'ㄴㅇ',aliases:['농업']},
      {no:6,text:'이동 수단과 시스템을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:7,text:'기반 시설을 (     )라고 한다.',answer:'인프라',initials:'ㅇㅍㄹ',aliases:['인프라']},
      {no:8,text:'사람들이 사는 조건을 (      )이라 한다.',answer:'생활 환경',initials:'ㅅㅎ ㅎㄱ',aliases:['생활환경']},
      {no:9,text:'균형 있게 어울림을 (   )라고 한다.',answer:'조화',initials:'ㅈㅎ',aliases:['조화']}
    ]},
    quiz: {q1_text:'도시의 특징은?',q1_opts:['① 인구 많음','② 인구 적음','③ 농업만','④ 시설 없음'],q2_text:'농촌의 장점은?',q2_opts:['① 자연과 가까움','② 시설 많음','③ 인구 많음','④ 공기 나쁨'],q3_1_ph:'ㄷㅅ',q3_2_ph:'ㄴㅊ',q4_1_ph:'ㅅㅇ',q4_2_ph:'ㄴㅇ',q5_text:'도시와 농촌이 조화롭게 발전하려면 어떻게 해야 할까요?'},
    answerKey: {q1:'1',q2:'1',q3_1:['도시'],q3_2:['농촌'],q4_1:['산업'],q4_2:['농업']},
    essayKeywords: ['도시','농촌','조화','발전','균형'],
    explain: {q1:'해설: 도시는 인구와 시설이 밀집.',q2:'해설: 농촌은 자연환경이 좋음.',q3:'해설: 도시와 농촌 각각의 특징.',q4:'해설: 도시=산업, 농촌=농업.',q5:'예시: 상호 교류와 균형 발전 필요.'}
  },

  soc_12: {
    labelNo: '12',
    title: '💼 직업의 세계와 진로',
    passage: ['교통은 사람과 물건을 옮기는 수단입니다.','통신은 정보를 주고받는 방법입니다.','둘 다 현대 사회를 연결하는 중요한 역할을 합니다.'],
    vocab: [['교통','이동 수단'],['통신','정보 전달'],['발달','발전하여 나아감'],['연결','이어 붙임'],['정보','알아야 할 내용'],['수단','방법이나 도구'],['네트워크','연결망'],['기술','과학적 방법'],['현대','지금의 시대']],
    vocabFill: { instructions: '[교통과 통신]', items: [
      {no:1,text:'이동 수단을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:2,text:'정보 전달을 (   )이라 한다.',answer:'통신',initials:'ㅌㅅ',aliases:['통신']},
      {no:3,text:'발전하여 나아감을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:4,text:'이어 붙임을 (   )이라 한다.',answer:'연결',initials:'ㅇㄱ',aliases:['연결']},
      {no:5,text:'알아야 할 내용을 (   )이라 한다.',answer:'정보',initials:'ㅈㅂ',aliases:['정보']},
      {no:6,text:'방법이나 도구를 (   )이라 한다.',answer:'수단',initials:'ㅅㄷ',aliases:['수단']},
      {no:7,text:'연결망을 (     )라고 한다.',answer:'네트워크',initials:'ㄴㅌㅇㅋ',aliases:['네트워크']},
      {no:8,text:'과학적 방법을 (   )이라 한다.',answer:'기술',initials:'ㄱㅅ',aliases:['기술']},
      {no:9,text:'지금의 시대를 (   )라고 한다.',answer:'현대',initials:'ㅎㄷ',aliases:['현대']}
    ]},
    quiz: {q1_text:'교통 발달의 영향은?',q1_opts:['① 이동 빨라짐','② 느려짐','③ 정보만 전달','④ 변화 없음'],q2_text:'통신의 중요성은?',q2_opts:['① 정보 빠르게 전달','② 필요 없음','③ 이동만 가능','④ 느림'],q3_1_ph:'ㄱㅌ',q3_2_ph:'ㅌㅅ',q4_1_ph:'ㅂㄷ',q4_2_ph:'ㄱㅅ',q5_text:'교통과 통신의 발달이 우리 생활에 미친 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['교통'],q3_2:['통신'],q4_1:['발달'],q4_2:['기술']},
    essayKeywords: ['교통','통신','발달','연결','편리','생활'],
    explain: {q1:'해설: 교통 발달로 이동 시간 단축.',q2:'해설: 통신으로 정보 신속 전달.',q3:'해설: 교통과 통신의 정의.',q4:'해설: 기술 발달이 핵심.',q5:'예시: 빠른 이동, 즉각적 정보 교환, 세계화 촉진.'}
  },

  soc_13: {
    labelNo: '13',
    title: '🎨 문화 예술과 사회',
    passage: ['인구는 사람들이 사는 지역에 따라 분포가 다릅니다.','일자리와 생활 환경을 찾아 사람들이 이동합니다.','인구 분포와 이동은 지역 발전에 영향을 줍니다.'],
    vocab: [['인구','사람의 수'],['분포','퍼져 있는 상태'],['이동','장소를 옮김'],['도시화','도시로 인구 집중'],['일자리','직업과 고용'],['환경','주변 조건'],['밀도','단위 면적당 수'],['이촌향도','농촌→도시'],['정주','한곳에 머무름']],
    vocabFill: { instructions: '[인구 분포와 이동]', items: [
      {no:1,text:'사람의 수를 (   )라고 한다.',answer:'인구',initials:'ㅇㄱ',aliases:['인구']},
      {no:2,text:'퍼져 있는 상태를 (   )라 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:3,text:'장소를 옮김을 (   )이라 한다.',answer:'이동',initials:'ㅇㄷ',aliases:['이동']},
      {no:4,text:'도시로 인구가 집중되는 것을 (    )라고 한다.',answer:'도시화',initials:'ㄷㅅㅎ',aliases:['도시화']},
      {no:5,text:'직업과 고용을 (    )라고 한다.',answer:'일자리',initials:'ㅇㅈㄹ',aliases:['일자리']},
      {no:6,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:7,text:'단위 면적당 수를 (   )라고 한다.',answer:'밀도',initials:'ㅁㄷ',aliases:['밀도']},
      {no:8,text:'농촌에서 도시로 이동을 (      )라고 한다.',answer:'이촌향도',initials:'ㅇㅊㅎㄷ',aliases:['이촌향도']},
      {no:9,text:'한곳에 머무름을 (   )라고 한다.',answer:'정주',initials:'ㅈㅈ',aliases:['정주']}
    ]},
    quiz: {q1_text:'인구 이동의 주요 원인은?',q1_opts:['① 일자리','② 무관심','③ 강제','④ 여행'],q2_text:'도시화의 문제점은?',q2_opts:['① 인구 집중','② 인구 감소','③ 발전 없음','④ 농업 증가'],q3_1_ph:'ㅇㄱ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅇㄷ',q4_2_ph:'ㄷㅅㅎ',q5_text:'인구 이동이 지역에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['인구'],q3_2:['분포'],q4_1:['이동'],q4_2:['도시화']},
    essayKeywords: ['인구','이동','분포','도시','일자리','영향'],
    explain: {q1:'해설: 일자리를 찾아 이동.',q2:'해설: 도시 인구 집중 문제.',q3:'해설: 인구와 분포 정의.',q4:'해설: 이동과 도시화.',q5:'예시: 도시는 과밀, 농촌은 과소화.'}
  },

  soc_14: {
    labelNo: '14',
    title: '💰 경제생활과 합리적 선택',
    passage: ['산업이 발달하면서 지역의 모습이 크게 변했습니다.','공업 지역과 상업 지역이 생겨났습니다.','산업 발달은 경제 성장을 가져오지만 환경 문제도 발생합니다.'],
    vocab: [['산업','생산 활동'],['공업','제품 제조'],['상업','물건 사고파는 일'],['발달','성장하여 발전'],['경제','재화와 서비스'],['지역','특정한 장소'],['성장','커지고 발전'],['환경 문제','자연 훼손'],['균형 발전','골고루 발전']],
    vocabFill: { instructions: '[산업과 지역]', items: [
      {no:1,text:'생산 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:2,text:'제품 제조를 (   )이라 한다.',answer:'공업',initials:'ㄱㅇ',aliases:['공업']},
      {no:3,text:'물건 사고파는 일을 (   )이라 한다.',answer:'상업',initials:'ㅅㅇ',aliases:['상업']},
      {no:4,text:'성장하여 발전함을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:5,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:6,text:'특정한 장소를 (   )라고 한다.',answer:'지역',initials:'ㅈㅇ',aliases:['지역']},
      {no:7,text:'커지고 발전함을 (   )이라 한다.',answer:'성장',initials:'ㅅㅈ',aliases:['성장']},
      {no:8,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:9,text:'골고루 발전을 (      )이라 한다.',answer:'균형 발전',initials:'ㄱㅎ ㅂㅈ',aliases:['균형발전']}
    ]},
    quiz: {q1_text:'산업 발달의 긍정적 영향은?',q1_opts:['① 경제 성장','② 환경 파괴','③ 인구 감소','④ 후퇴'],q2_text:'산업 발달의 문제점은?',q2_opts:['① 환경 오염','② 발전 없음','③ 인구 증가','④ 기술 퇴보'],q3_1_ph:'ㅅㅇ',q3_2_ph:'ㄱㅇ',q4_1_ph:'ㄱㅈ',q4_2_ph:'ㅎㄱ',q5_text:'산업 발달이 지역에 미친 변화를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['산업'],q3_2:['공업'],q4_1:['경제'],q4_2:['환경']},
    essayKeywords: ['산업','발달','지역','경제','환경','변화'],
    explain: {q1:'해설: 산업 발달로 경제 성장.',q2:'해설: 환경 오염 발생.',q3:'해설: 산업과 공업.',q4:'해설: 경제와 환경.',q5:'예시: 도시 형성, 일자리 증가, 환경 오염.'}
  },

  soc_15: {
    labelNo: '15',
    title: '🏛️ 민주주의와 정치 참여',
    passage: ['세계 각지는 다양한 기후를 가지고 있습니다.','기후는 그 지역의 생활과 문화에 영향을 줍니다.','열대, 온대, 한대 등 기후대가 있습니다.'],
    vocab: [['기후','평균 날씨'],['열대','매우 더운 지역'],['온대','따뜻한 지역'],['한대','매우 추운 지역'],['기후대','기후 구분 영역'],['강수량','비 오는 양'],['기온','공기의 온도'],['계절','시간에 따른 날씨 변화'],['영향','결과에 미치는 힘']],
    vocabFill: { instructions: '[세계 기후]', items: [
      {no:1,text:'평균 날씨를 (   )라고 한다.',answer:'기후',initials:'ㄱㅎ',aliases:['기후']},
      {no:2,text:'매우 더운 지역을 (   )라고 한다.',answer:'열대',initials:'ㅇㄷ',aliases:['열대']},
      {no:3,text:'따뜻한 지역을 (   )라고 한다.',answer:'온대',initials:'ㅇㄷ',aliases:['온대']},
      {no:4,text:'매우 추운 지역을 (   )라고 한다.',answer:'한대',initials:'ㅎㄷ',aliases:['한대']},
      {no:5,text:'기후 구분 영역을 (    )라고 한다.',answer:'기후대',initials:'ㄱㅎㄷ',aliases:['기후대']},
      {no:6,text:'비 오는 양을 (    )라고 한다.',answer:'강수량',initials:'ㄱㅅㄹ',aliases:['강수량']},
      {no:7,text:'공기의 온도를 (   )이라 한다.',answer:'기온',initials:'ㄱㅇ',aliases:['기온']},
      {no:8,text:'시간에 따른 날씨 변화를 (   )이라 한다.',answer:'계절',initials:'ㄱㅈ',aliases:['계절']},
      {no:9,text:'결과에 미치는 힘을 (   )이라 한다.',answer:'영향',initials:'ㅇㅎ',aliases:['영향']}
    ]},
    quiz: {q1_text:'기후가 생활에 미치는 영향은?',q1_opts:['① 의식주 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'열대 기후의 특징은?',q2_opts:['① 매우 더움','② 매우 추움','③ 사계절 뚜렷','④ 비 안 옴'],q3_1_ph:'ㄱㅎ',q3_2_ph:'ㅇㄷ',q4_1_ph:'ㄱㅎㄷ',q4_2_ph:'ㄱㅅㄹ',q5_text:'기후가 지역 문화에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['기후'],q3_2:['열대'],q4_1:['기후대'],q4_2:['강수량']},
    essayKeywords: ['기후','열대','온대','한대','생활','문화'],
    explain: {q1:'해설: 기후가 의식주 결정.',q2:'해설: 열대는 매우 더움.',q3:'해설: 기후와 열대.',q4:'해설: 기후대와 강수량.',q5:'예시: 더운 지역은 가벼운 옷, 추운 지역은 두꺼운 옷.'}
  },

  soc_16: {
    labelNo: '16',
    title: '🌍 국제사회와 글로벌 이슈',
    passage: ['자원은 인간에게 필요한 물질입니다.','석유, 석탄, 광물 등이 있습니다.','자원은 지역마다 분포가 다르며 한정적입니다.'],
    vocab: [['자원','필요한 물질'],['석유','연료 원료'],['석탄','연료 광물'],['광물','땅속 자원'],['분포','퍼진 상태'],['한정적','제한된'],['이용','사용함'],['채굴','캐냄'],['보존','아껴 지킴']],
    vocabFill: { instructions: '[자원 분포와 이용]', items: [
      {no:1,text:'필요한 물질을 (   )이라 한다.',answer:'자원',initials:'ㅈㅇ',aliases:['자원']},
      {no:2,text:'연료 원료를 (   )라고 한다.',answer:'석유',initials:'ㅅㅇ',aliases:['석유']},
      {no:3,text:'연료 광물을 (   )이라 한다.',answer:'석탄',initials:'ㅅㅌ',aliases:['석탄']},
      {no:4,text:'땅속 자원을 (   )이라 한다.',answer:'광물',initials:'ㄱㅁ',aliases:['광물']},
      {no:5,text:'퍼진 상태를 (   )라고 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:6,text:'제한된 것을 (    )이라고 한다.',answer:'한정적',initials:'ㅎㅈㅈ',aliases:['한정적']},
      {no:7,text:'사용함을 (   )이라 한다.',answer:'이용',initials:'ㅇㅇ',aliases:['이용']},
      {no:8,text:'캐냄을 (   )이라 한다.',answer:'채굴',initials:'ㅊㄱ',aliases:['채굴']},
      {no:9,text:'아껴 지킴을 (   )이라 한다.',answer:'보존',initials:'ㅂㅈ',aliases:['보존']}
    ]},
    quiz: {q1_text:'자원이 한정적인 이유는?',q1_opts:['① 다시 안 만들어짐','② 무한함','③ 필요 없음','④ 항상 생김'],q2_text:'자원 보존 방법은?',q2_opts:['① 아껴 쓰기','② 많이 쓰기','③ 버리기','④ 무시하기'],q3_1_ph:'ㅈㅇ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅎㅈㅈ',q4_2_ph:'ㅂㅈ',q5_text:'자원을 아껴 써야 하는 이유를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['자원'],q3_2:['분포'],q4_1:['한정적'],q4_2:['보존']},
    essayKeywords: ['자원','한정','보존','이용','미래'],
    explain: {q1:'해설: 자원은 다시 안 만들어짐.',q2:'해설: 아껴 쓰는 것이 보존.',q3:'해설: 자원과 분포.',q4:'해설: 한정적이므로 보존 필요.',q5:'예시: 미래 세대를 위해 자원 절약 필요.'}
  },

  soc_17: {
    labelNo: '17',
    title: '🔬 과학기술과 사회 변화',
    passage: ['지리적 환경은 문화 형성에 영향을 줍니다.','산지, 해안, 평야 등에 따라 다른 문화가 발달합니다.','문화는 지역의 정체성을 만듭니다.'],
    vocab: [['문화','생활 양식'],['지리적','땅과 관련된'],['환경','주변 조건'],['정체성','고유한 특성'],['전통','옛것을 이어옴'],['풍습','관습과 습관'],['의식주','옷,음식,집'],['다양성','여러 가지'],['공존','함께 존재']],
    vocabFill: { instructions: '[문화와 지리]', items: [
      {no:1,text:'생활 양식을 (   )이라 한다.',answer:'문화',initials:'ㅁㅎ',aliases:['문화']},
      {no:2,text:'땅과 관련된 것을 (    )이라고 한다.',answer:'지리적',initials:'ㅈㄹㅈ',aliases:['지리적']},
      {no:3,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:4,text:'고유한 특성을 (    )이라 한다.',answer:'정체성',initials:'ㅈㅊㅅ',aliases:['정체성']},
      {no:5,text:'옛것을 이어옴을 (   )이라 한다.',answer:'전통',initials:'ㅈㅌ',aliases:['전통']},
      {no:6,text:'관습과 습관을 (   )이라 한다.',answer:'풍습',initials:'ㅍㅅ',aliases:['풍습']},
      {no:7,text:'옷,음식,집을 (    )라고 한다.',answer:'의식주',initials:'ㅇㅅㅈ',aliases:['의식주']},
      {no:8,text:'여러 가지를 (    )라고 한다.',answer:'다양성',initials:'ㄷㅇㅅ',aliases:['다양성']},
      {no:9,text:'함께 존재함을 (   )이라 한다.',answer:'공존',initials:'ㄱㅈ',aliases:['공존']}
    ]},
    quiz: {q1_text:'지리적 환경이 문화에 미치는 영향은?',q1_opts:['① 생활 방식 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'문화 다양성의 의미는?',q2_opts:['① 여러 문화 존중','② 한 가지만','③ 무시함','④ 통일'],q3_1_ph:'ㅁㅎ',q3_2_ph:'ㅈㄹㅈ',q4_1_ph:'ㅈㅊㅅ',q4_2_ph:'ㄷㅇㅅ',q5_text:'지리적 환경이 문화 형성에 어떤 영향을 주는지 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['문화'],q3_2:['지리적'],q4_1:['정체성'],q4_2:['다양성']},
    essayKeywords: ['문화','지리','환경','다양성','정체성'],
    explain: {q1:'해설: 환경이 생활 방식 결정.',q2:'해설: 다양성은 여러 문화 존중.',q3:'해설: 문화와 지리적.',q4:'해설: 정체성과 다양성.',q5:'예시: 산지는 산림 문화, 해안은 어업 문화 발달.'}
  },

  soc_18: {
    labelNo: '18',
    title: '🏥 복지와 사회안전망',
    passage: ['국가 간 물건을 사고파는 것을 무역이라 합니다.','무역은 경제 발전에 도움을 줍니다.','국제 협력으로 함께 발전할 수 있습니다.'],
    vocab: [['무역','국가 간 거래'],['수출','물건 팔기'],['수입','물건 사기'],['경제','재화와 서비스'],['협력','함께 도움'],['국제','나라 사이'],['발전','성장함'],['교류','주고받음'],['상호 의존','서로 의지']],
    vocabFill: { instructions: '[국제 무역]', items: [
      {no:1,text:'국가 간 거래를 (   )라고 한다.',answer:'무역',initials:'ㅁㅇ',aliases:['무역']},
      {no:2,text:'물건 팔기를 (   )라고 한다.',answer:'수출',initials:'ㅅㅊ',aliases:['수출']},
      {no:3,text:'물건 사기를 (   )라고 한다.',answer:'수입',initials:'ㅅㅇ',aliases:['수입']},
      {no:4,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:5,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:6,text:'나라 사이를 (   )라고 한다.',answer:'국제',initials:'ㄱㅈ',aliases:['국제']},
      {no:7,text:'성장함을 (   )이라 한다.',answer:'발전',initials:'ㅂㅈ',aliases:['발전']},
      {no:8,text:'주고받음을 (   )이라 한다.',answer:'교류',initials:'ㄱㄹ',aliases:['교류']},
      {no:9,text:'서로 의지함을 (      )라고 한다.',answer:'상호 의존',initials:'ㅅㅎ ㅇㅈ',aliases:['상호의존']}
    ]},
    quiz: {q1_text:'무역의 장점은?',q1_opts:['① 경제 성장','② 고립','③ 감소','④ 중단'],q2_text:'국제 협력이 중요한 이유는?',q2_opts:['① 함께 발전','② 경쟁만','③ 단절','④ 무시'],q3_1_ph:'ㅁㅇ',q3_2_ph:'ㅅㅊ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㄱㅈ',q5_text:'국제 무역이 경제에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['무역'],q3_2:['수출'],q4_1:['협력'],q4_2:['국제']},
    essayKeywords: ['무역','수출','수입','협력','발전'],
    explain: {q1:'해설: 무역으로 경제 성장.',q2:'해설: 협력으로 함께 발전.',q3:'해설: 무역과 수출.',q4:'해설: 협력과 국제.',q5:'예시: 필요한 물건 교환, 경제 활성화, 상호 발전.'}
  },

  soc_19: {
    labelNo: '19',
    title: '♻️ 환경과 지속가능한 삶',
    passage: ['지구촌은 전 세계가 하나로 연결된 것입니다.','환경, 빈곤, 전쟁 등 공동 문제가 있습니다.','협력하여 함께 해결해야 합니다.'],
    vocab: [['지구촌','세계가 하나로'],['환경 문제','자연 훼손'],['빈곤','가난한 상태'],['전쟁','무력 충돌'],['해결','문제 풀기'],['협력','함께 도움'],['공동','함께 하는'],['지속 가능','미래도 유지'],['연대','함께 뭉침']],
    vocabFill: { instructions: '[지구촌 문제]', items: [
      {no:1,text:'세계가 하나로 연결된 것을 (    )라고 한다.',answer:'지구촌',initials:'ㅈㄱㅊ',aliases:['지구촌']},
      {no:2,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:3,text:'가난한 상태를 (   )이라 한다.',answer:'빈곤',initials:'ㅂㄱ',aliases:['빈곤']},
      {no:4,text:'무력 충돌을 (   )이라 한다.',answer:'전쟁',initials:'ㅈㅈ',aliases:['전쟁']},
      {no:5,text:'문제 풀기를 (   )이라 한다.',answer:'해결',initials:'ㅎㄱ',aliases:['해결']},
      {no:6,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:7,text:'함께 하는 것을 (   )이라 한다.',answer:'공동',initials:'ㄱㄷ',aliases:['공동']},
      {no:8,text:'미래도 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'함께 뭉침을 (   )라고 한다.',answer:'연대',initials:'ㅇㄷ',aliases:['연대']}
    ]},
    quiz: {q1_text:'지구촌 문제 해결 방법은?',q1_opts:['① 국제 협력','② 무시','③ 방치','④ 혼자 해결'],q2_text:'지속 가능 발전이 중요한 이유는?',q2_opts:['① 미래 세대 위해','② 현재만','③ 개발만','④ 파괴'],q3_1_ph:'ㅈㄱㅊ',q3_2_ph:'ㅎㄱ ㅁㅈ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㅎㄱ',q5_text:'지구촌 문제를 해결하기 위해 우리가 할 수 있는 일을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['지구촌'],q3_2:['환경문제','환경 문제'],q4_1:['협력'],q4_2:['해결']},
    essayKeywords: ['지구촌','협력','환경','해결','지속'],
    explain: {q1:'해설: 국제 협력으로 해결.',q2:'해설: 미래 세대를 위해.',q3:'해설: 지구촌과 환경 문제.',q4:'해설: 협력과 해결.',q5:'예시: 환경 보호, 기부, 봉사, 평화 노력.'}
  },

  soc_20: {
    labelNo: '20',
    title: '🔮 미래사회와 시민의 역할',
    passage: ['미래에는 기후 변화와 기술 발전이 지리를 바꿀 것입니다.','새로운 도시와 교통 수단이 생길 것입니다.','우리는 미래를 준비하고 대비해야 합니다.'],
    vocab: [['미래','앞으로의 시간'],['전망','예상과 예측'],['변화','달라짐'],['기술 발전','과학 진보'],['기후 변화','날씨 변동'],['대비','준비함'],['예측','미리 짐작'],['지속 가능','미래 유지'],['혁신','새로운 변화']],
    vocabFill: { instructions: '[미래 전망]', items: [
      {no:1,text:'앞으로의 시간을 (   )라고 한다.',answer:'미래',initials:'ㅁㄹ',aliases:['미래']},
      {no:2,text:'예상과 예측을 (   )이라 한다.',answer:'전망',initials:'ㅈㅁ',aliases:['전망']},
      {no:3,text:'달라짐을 (   )이라 한다.',answer:'변화',initials:'ㅂㅎ',aliases:['변화']},
      {no:4,text:'과학 진보를 (      )이라 한다.',answer:'기술 발전',initials:'ㄱㅅ ㅂㅈ',aliases:['기술발전']},
      {no:5,text:'날씨 변동을 (      )이라 한다.',answer:'기후 변화',initials:'ㄱㅎ ㅂㅎ',aliases:['기후변화']},
      {no:6,text:'준비함을 (   )라고 한다.',answer:'대비',initials:'ㄷㅂ',aliases:['대비']},
      {no:7,text:'미리 짐작함을 (   )이라 한다.',answer:'예측',initials:'ㅇㅊ',aliases:['예측']},
      {no:8,text:'미래 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'새로운 변화를 (   )이라 한다.',answer:'혁신',initials:'ㅎㅅ',aliases:['혁신']}
    ]},
    quiz: {q1_text:'미래 지리 변화의 주요 요인은?',q1_opts:['① 기후·기술','② 변화 없음','③ 과거만','④ 무관심'],q2_text:'미래를 준비하는 방법은?',q2_opts:['① 지속 가능 발전','② 방치','③ 무시','④ 파괴'],q3_1_ph:'ㅁㄹ',q3_2_ph:'ㅂㅎ',q4_1_ph:'ㄱㅅ ㅂㅈ',q4_2_ph:'ㄷㅂ',q5_text:'미래의 지리적 변화를 예측하고 우리가 준비해야 할 것을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['미래'],q3_2:['변화'],q4_1:['기술발전','기술 발전'],q4_2:['대비']},
    essayKeywords: ['미래','변화','기술','기후','준비','지속'],
    explain: {q1:'해설: 기후 변화와 기술 발전이 주요 요인.',q2:'해설: 지속 가능한 발전으로 준비.',q3:'해설: 미래와 변화.',q4:'해설: 기술 발전에 대비.',q5:'예시: 환경 보호, 새 기술 학습, 적응력 키우기.'}
  }
});

/* ===============================
   ★ 어휘 빈칸 렌더러 & 탭 이벤트
=================================*/
function getCurrentUnit() {
  return (window.CUR_UNIT || 'soc_01');
}

window.renderVocabFill = function () {
  const unit = window.CUR_UNIT || 'soc_01';
  const pack = window.CONTENTS?.[unit];
  const root = document.getElementById('vocab-fill') 
            || document.querySelector('.vocab-fill-text');

  if (!root || !pack?.vocabFill?.items?.length) {
    console.warn('[vocab] root or items missing:', { root: !!root, unit, items: pack?.vocabFill?.items?.length });
    return;
  }

  const html = (pack.vocabFill.items || []).map(({ no, text, answer, initials }) => {
    const slot = `
      <span class="blank-wrap" data-answer="${answer}">
        <span class="blank-icon">${no}</span>
        <span class="blank-mark"></span>
        <input type="text" class="blank-input" placeholder="${initials || ''}">
      </span>
    `;
    const p = text.replace(/\(\s*[-＿—\u00A0]*\s*\)/, slot);
    return `<p>${p}</p>`;
  }).join('');

  root.innerHTML = `
    <div class="vocab-instruction">${pack.vocabFill.instructions || ''}</div>
    <div class="vocab-inline">${html}</div>
  `;

  (function ensureVocabInlineStyle(){
    if (document.getElementById('vocab-inline-style')) return;
    const st = document.createElement('style');
    st.id = 'vocab-inline-style';
    st.textContent = `
      /* vocab 영역에서만 줄글 처리 */
      .vocab-box .vocab-inline > p { display:inline !important; margin:0 !important; }
      .vocab-box .vocab-inline > p + p::before { content:" "; }

      #vocab-fill .vocab-inline > p,
      .vocab-fill-text .vocab-inline > p { display:inline !important; margin:0 !important; }
      #vocab-fill .vocab-inline > p + p::before,
      .vocab-fill-text .vocab-inline > p + p::before { content:" "; }

      /* 🔶 줄 간격 조정 */
      .vocab-inline { line-height: 5.0 !important; }
    `;
    document.head.appendChild(st);
  })();

  window.reportState = window.reportState || {};
  window.reportState.vocabTotal = pack.vocabFill.items.length;

  // ✅ 어휘 렌더링 직후 상태 복원 (각 HTML 파일의 loadVocabState 호출)
  setTimeout(() => {
    if (typeof window.loadVocabState === 'function') {
      window.loadVocabState();
    }
    // ✅ 서버 데이터에서 어휘 상태 복원
    if (typeof window.restoreVocabFromServerData === 'function') {
      window.restoreVocabFromServerData();
    }
  }, 100);
};

// ✅ 이벤트 리스너 중복 방지를 위한 플래그
let _tabEventsInitialized = false;

function _bindTabEvents() {
  // 이미 초기화되었으면 건너뛰기
  if (_tabEventsInitialized) return;
  _tabEventsInitialized = true;

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-tab]');
    if (!btn) return;
    const tab = btn.getAttribute('data-tab');
    if (tab === 'vocab') renderVocabFill();
  });
}

/* ===== 텍스트 주입 (HTML 구조/ids 유지) ===== */
function applyContentPack(unitKey) {
  console.log('[applyContentPack] 호출됨, unitKey:', unitKey);
  const pack = window.CONTENTS[unitKey];
  if (!pack) {
    console.error('[applyContentPack] pack이 없음! unitKey:', unitKey, 'CONTENTS:', window.CONTENTS);
    return;
  }

  const labelNoEl = document.querySelector('.passage-label strong');
  const titleEl   = document.querySelector('.passage-title');
  if (labelNoEl) labelNoEl.textContent = pack.labelNo;
  if (titleEl)   titleEl.innerHTML = pack.title;

  const passageBox = document.querySelector('.passage-text');
  console.log('[applyContentPack] passageBox:', passageBox, 'pack.passage:', pack.passage);
  if (passageBox) {
    const html = pack.passage.map(p => `<p>${p}</p>`).join('');
    console.log('[applyContentPack] 생성된 HTML 길이:', html.length);
    passageBox.innerHTML = html;
    console.log('[applyContentPack] passageBox.innerHTML 설정 완료');
  }

  const vocabBox = document.querySelector('.passage-vocab ol');
  if (vocabBox)  vocabBox.innerHTML = pack.vocab.map(([w,d]) => `<li><b>${w}</b>: ${d}</li>`).join('');

  const blocks = Array.from(document.querySelectorAll('#tab-reading .quiz-block'));

  // Q1
  if (blocks[0]) {
    const q1Text = blocks[0].querySelector('.quiz-q');
    const q1Lis  = blocks[0].querySelectorAll('.quiz-options li');
    if (q1Text) q1Text.textContent = pack.quiz.q1_text;
    if (q1Lis.length === 4) {
      q1Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q1" value="${i+1}"><span>${pack.quiz.q1_opts[i]}</span></label>`);
    }
  }

  // Q2
  if (blocks[1]) {
    const q2Text = blocks[1].querySelector('.quiz-q');
    const q2Lis  = blocks[1].querySelectorAll('.quiz-options li');
    if (q2Text) q2Text.textContent = pack.quiz.q2_text;
    if (q2Lis.length === 4) {
      q2Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q2" value="${i+1}"><span>${pack.quiz.q2_opts[i]}</span></label>`);
    }
  }

  // Q3
  if (blocks[2]) {
    const q3P = blocks[2].querySelector('.quiz-q');
    if (q3P && pack.quiz.q3_html) q3P.innerHTML = pack.quiz.q3_html;
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    if (q3_1 && pack.quiz.q3_1_ph) q3_1.placeholder = pack.quiz.q3_1_ph;
    if (q3_2 && pack.quiz.q3_2_ph) q3_2.placeholder = pack.quiz.q3_2_ph;
  }

  // Q4
  if (blocks[3]) {
    const q4P = blocks[3].querySelector('.quiz-q');
    if (q4P && pack.quiz.q4_html) q4P.innerHTML = pack.quiz.q4_html;
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    if (q4_1 && pack.quiz.q4_1_ph) q4_1.placeholder = pack.quiz.q4_1_ph;
    if (q4_2 && pack.quiz.q4_2_ph) q4_2.placeholder = pack.quiz.q4_2_ph;
  }

  // Q5
  if (blocks[4]) {
    const q5Text = blocks[4].querySelector('.quiz-q');
    if (q5Text && pack.quiz.q5_text) q5Text.textContent = pack.quiz.q5_text;
  }

  // ✅ 모든 콘텐츠 로드 완료 후 로딩 오버레이 숨기기
  requestAnimationFrame(() => {
    const loadingOverlay = document.getElementById('loadingOverlay');
    if (loadingOverlay) {
      // 분석리포트 탭일 경우 1.3초 후에 숨기기
      const unit = window.CUR_UNIT || 'soc_01';
      const savedTab = localStorage.getItem(`current-geo-tab:${unit}`);
      const delay = (savedTab === 'report') ? 1300 : 0;

      setTimeout(() => {
        loadingOverlay.classList.remove('show');
        console.log('[applyContentPack] 로딩 오버레이 숨김 완료');
      }, delay);
    }
  });
}

/* ==== 본문학습 상태 저장/복원 (✅ 학생별 분리 저장) ==== */

/* 🔐 현재 로그인 학생 정보 가져오기 */
function getCurrentStudentForReading() {
  const saved = localStorage.getItem('currentStudent');
  if (!saved) return null;
  try { return JSON.parse(saved); } catch (e) { return null; }
}

/* 🔐 학생키 만들기: 학년_이름_전화숫자 */
function buildStudentKeyForReading(stu) {
  const cleanPhone = (stu.phone || '').replace(/\D/g, '');
  const cleanName  = (stu.name  || '').trim();
  const cleanGrade = (stu.grade || '').trim();
  return `${cleanGrade}_${cleanName}_${cleanPhone}`;
}

// ✅ 현재 로그인한 학생 키를 공용으로 쓰는 함수 (메뉴/단원 페이지 공유)
window.getStudentKey = function () {
  const stu = getCurrentStudent();
  if (!stu) return '';
  return buildStudentKey(stu);   // "학년_이름_전화번호" 형태
};

/* 🔐 단원별 + 학생별 로컬스토리지 키 */
function getReadingStateKey(unit) {
  const stu = getCurrentStudentForReading();
  if (!stu) {
    // 로그인 안 되어 있으면 예전처럼 단원 단독 키 사용
    return `dan-reading-state:${unit}`;
  }
  const studentKey = buildStudentKeyForReading(stu);
  return `dan-reading-state:${studentKey}:${unit}`;
}

function saveReadingState() {
  try {
    const unit = window.CUR_UNIT || 'soc_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키

    const q1   = document.querySelector('input[name="q1"]:checked');
    const q2   = document.querySelector('input[name="q2"]:checked');
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    const state = {
      graded: true,
      q1:   q1   ? q1.value   : '',
      q2:   q2   ? q2.value   : '',
      q3_1: q3_1 ? q3_1.value : '',
      q3_2: q3_2 ? q3_2.value : '',
      q4_1: q4_1 ? q4_1.value : '',
      q4_2: q4_2 ? q4_2.value : '',
      q5:   q5   ? q5.value   : ''
    };

    localStorage.setItem(key, JSON.stringify(state));
  } catch (e) {
    console.warn('saveReadingState error', e);
  }
}

function loadReadingState() {
  try {
    const unit = window.CUR_UNIT || 'soc_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키
    const raw  = localStorage.getItem(key);
    if (!raw) return;

    const state = JSON.parse(raw);
    if (!state) return;

    if (state.q1) {
      const r1 = document.querySelector(`input[name="q1"][value="${state.q1}"]`);
      if (r1) r1.checked = true;
    }
    if (state.q2) {
      const r2 = document.querySelector(`input[name="q2"][value="${state.q2}"]`);
      if (r2) r2.checked = true;
    }

    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    if (q3_1 && state.q3_1 !== undefined) q3_1.value = state.q3_1;
    if (q3_2 && state.q3_2 !== undefined) q3_2.value = state.q3_2;
    if (q4_1 && state.q4_1 !== undefined) q4_1.value = state.q4_1;
    if (q4_2 && state.q4_2 !== undefined) q4_2.value = state.q4_2;
    if (q5   && state.q5   !== undefined) q5.value   = state.q5;

    if (state.graded && typeof window.gradeQuiz === 'function') {
      setTimeout(() => {
        try { window.gradeQuiz(); } catch (e) {
          console.warn('auto re-grade reading error', e);
        }
      }, 0);
    }
  } catch (e) {
    console.warn('loadReadingState error', e);
  }
}

/* ===== 통합 채점기 ===== */
window.gradeQuiz = function () {
  const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.soc_01;
  const A = pack.answerKey;
  const EX = pack.explain;

  const quizBlocks = document.querySelectorAll('#tab-reading .quiz-block');
  const numLabels = ["01","02","03","04","05"];
  quizBlocks.forEach((block, idx) => {
    const numEl = block.querySelector('.quiz-num');
    if (!numEl) return;
    let markEl = numEl.querySelector('.mark');
    if (!markEl) {
      markEl = document.createElement('div');
      markEl.className = 'mark';
      numEl.appendChild(markEl);
    }
    numEl.textContent = numLabels[idx];
    numEl.appendChild(markEl);
    numEl.classList.remove('correct','wrong');
    markEl.textContent = '';
  });

  let score = 0;
  const totalAuto = 4;
  const shortMsgs = [];
  const fullMsgs = [];

  function norm(s){ return (s||'').toString().replace(/\s+/g,'').toLowerCase(); }
  function mark(idx, ok, label, ex, isEssay=false){
    const num = quizBlocks[idx]?.querySelector('.quiz-num');
    const markEl = num?.querySelector('.mark');
    if (ok) {
      score++;
      num?.classList.add('correct');
      if(markEl) markEl.textContent='⭕';
      shortMsgs.push(`${label} 정답 ✅`);
      fullMsgs.push(`${label} 정답 ✅ ${ex||''}`);
    } else {
      num?.classList.add('wrong');
      if(markEl) markEl.textContent='✖';
      shortMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌`);
      fullMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌ ${ex||''}`);
    }
  }

  // 1
  const q1 = document.querySelector('input[name="q1"]:checked');
  const q1ok = (q1 && q1.value === A.q1);
  mark(0, q1ok, '①', EX.q1);

  // 2
  const q2 = document.querySelector('input[name="q2"]:checked');
  const q2ok = (q2 && q2.value === A.q2);
  mark(1, q2ok, '②', EX.q2);

  // 3
  const q3New = document.getElementById('q3');
  const q3Old1 = document.getElementById('q3-1');
  const q3Old2 = document.getElementById('q3-2');
  const q3Text1 = q3New ? q3New.value.trim() : (q3Old1?.value || '').trim();
  const q3Text2 = q3New ? '' : (q3Old2?.value || '').trim();
  const ok3_1 = A.q3_1.some(a => norm(a) === norm(q3Text1));
  const ok3_2 = A.q3_2 ? A.q3_2.some(a => norm(a) === norm(q3Text2)) : true;
  const q3ok = ok3_1 && ok3_2;
  mark(2, q3ok, '③', EX.q3);

  // 4
  const q4New = document.getElementById('q4');
  const q4Old1 = document.getElementById('q4-1');
  const q4Old2 = document.getElementById('q4-2');
  const q4Text1 = q4New ? q4New.value.trim() : (q4Old1?.value || '').trim();
  const q4Text2 = q4New ? '' : (q4Old2?.value || '').trim();
  const ok4_1 = A.q4_1.some(a => norm(a) === norm(q4Text1));
  const ok4_2 = A.q4_2 ? A.q4_2.some(a => norm(a) === norm(q4Text2)) : true;
  const q4ok = ok4_1 && ok4_2;
  mark(3, q4ok, '④', EX.q4);

  // 5 (서술형)
  const essay = (document.getElementById('q5')?.value || '').trim().toLowerCase();
  const keys = (pack.essayKeywords && Array.isArray(pack.essayKeywords) && pack.essayKeywords.length)
    ? pack.essayKeywords
    : ["등고선","간격","좁","넓","급경사","완만","경사"];
  let hit = 0;
  keys.forEach(k => { if (essay.includes(k)) hit++; });
  const q5ok = essay.length && hit >= 2;
  mark(4, q5ok, '⑤', EX.q5, true);

  const box = document.getElementById('grade-result');
  if (box) {
    box.style.display = 'block';
    box.innerHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + shortMsgs.map(m => `<p>${m}</p>`).join('');
  }
  window.fullResultHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + fullMsgs.map(m => `<p>${m}</p>`).join('');

  const g=document.getElementById('grade-btn');
  const r=document.getElementById('reset-btn');
  const s=document.getElementById('submit-btn');
  if (g) g.style.display='inline-block';
  if (r) r.style.display='inline-block';
  if (s) s.style.display='inline-block';

  window.reportState = window.reportState || {};
  window.reportState.q1ok=q1ok;
  window.reportState.q2ok=q2ok;
  window.reportState.q3ok=q3ok;
  window.reportState.q4ok=q4ok;
  window.reportState.q5ok=q5ok;

  if (typeof updateReportPanel==='function') {
    const lexicalRatio = (typeof window.reportState.vocabScoreRatio==='number') ? window.reportState.vocabScoreRatio : 0;
    const lexicalOk = lexicalRatio >= 0.7;
    updateReportPanel({
      q1ok,q2ok,q3ok,q4ok,q5ok,
      messages:[
        "① 핵심 이해력: " + (q1ok?"좋아요! ✅":"보완 필요 ❗"),
        "② 구조 파악력: " + (q2ok?"좋아요! ✅":"보완 필요 ❗"),
        "③ 어휘 맥락력: " + (lexicalOk?"좋아요! ✅":"어휘 복습 필요 ❗"),
        "④ 추론·통합력: " + (q4ok?"좋아요! ✅":"보완 필요 ❗"),
        "⑤ 비판·적용력: " + (q5ok?"좋아요! ✅":"보완 필요 ❗")
      ]
    });
  }

  // ✅ 레이더 점수 객체로 빼두기
  const radarScores = {
    literal:     q1ok ? 10 : 6,
    structural:  q2ok ? 10 : 6,
    lexical:     q3ok ? 10 : 6,
    inferential: q4ok ? 10 : 6,
    critical:    q5ok ? 10 : 6
  };

  // ✅ 서버로 보낼 마지막 레이더 점수 기억해 두기 (전역)
  window._lastRadar = radarScores;

  // ✅ 화면 레이더 차트 그리기
  if (typeof updateRadarChart === 'function') {
    updateRadarChart(radarScores);
  }
  if (typeof drawRadarChart === 'function') {
    drawRadarChart(radarScores);
  }

  // ✅ 서버 로그용으로도 보관 (옵션)
  window.reportState = window.reportState || {};
  window.reportState.radarScores = radarScores;

  if (typeof saveReadingState === 'function') {
    saveReadingState();
  }
};

/* === 정답·해설 패널 렌더러 === */
function renderSolutions(pack) {
  const A = pack.answerKey, EX = pack.explain;
  const q1Text = pack.quiz.q1_opts[Number(A.q1) - 1] || '';
  const q2Text = pack.quiz.q2_opts[Number(A.q2) - 1] || '';

  const gradeResult = document.getElementById('grade-result');
  let box = document.getElementById('solutions-box');
  if (!box) {
    box = document.createElement('div');
    box.id = 'solutions-box';
    box.style.marginTop = '16px';
    box.style.background = '#fffaf3';
    box.style.border = '1px solid #e5d4c1';
    box.style.borderRadius = '12px';
    box.style.padding = '16px';
    box.style.lineHeight = '1.6';
  }
  // ✅ grade-result 내부에 추가 (점수 박스 아래)
  if (gradeResult) {
    gradeResult.appendChild(box);
  }

  box.innerHTML = `
    <h3 style="margin:0 0 10px; font-size:16px; color:#8b2f2f;">정답 · 해설</h3>
    <ol style="margin:0; padding-left:18px;">
      <li style="margin-bottom:8px;">
        <b>① 정답:</b> ${A.q1} — ${q1Text}<br>
        <span style="color:#6b5a48;">${EX.q1 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>② 정답:</b> ${A.q2} — ${q2Text}<br>
        <span style="color:#6b5a48;">${EX.q2 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>③ 정답(두 칸):</b> ${Array.isArray(A.q3_1)?A.q3_1[0]:A.q3_1} / ${Array.isArray(A.q3_2)?A.q3_2[0]:A.q3_2}<br>
        <span style="color:#6b5a48;">${EX.q3 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>④ 정답(두 칸):</b> ${Array.isArray(A.q4_1)?A.q4_1[0]:A.q4_1} / ${Array.isArray(A.q4_2)?A.q4_2[0]:A.q4_2}<br>
        <span style="color:#6b5a48;">${EX.q4 || ''}</span>
      </li>
      <li>
        <b>⑤ 서술형 예시:</b> <span style="color:#6b5a48;">${EX.q5 || '핵심어 2개 이상 포함 시 정답 처리'}</span>
      </li>
    </ol>
  `;
  box.style.display = 'block';
}

/* ========== 공통 진행도 매니저 (단일화 호환) ========== */
window.DanDan = window.DanDan || {};

(function () {
  // 이미 정의돼 있으면 다시 만들지 않기
  if (window.DanDan.ProgressManager) return;

  /* ✅ 단원 감지: soc_01, soc_02 ... */
  function detectUnit() {
    let unitParam = new URLSearchParams(location.search).get('unit');
    if (!unitParam) {
      const m = location.pathname.match(/soc_(\d+)\.html/i);
      if (m) unitParam = `soc_${m[1].padStart(2, '0')}`;
    }
    return (unitParam || (window.CUR_UNIT || 'soc_01')).toLowerCase();
  }

  /* ✅ 학생키: 학년_이름_전화숫자 */
  function buildStudentKey(stu) {
    const cleanPhone = (stu.phone || '').replace(/\D/g, '');
    const cleanName  = (stu.name  || '').trim();
    const cleanGrade = (stu.grade || '').trim();
    return `${cleanGrade}_${cleanName}_${cleanPhone}`;
  }

  /* ✅ 현재 로그인 학생 */
  function getCurrentStudent() {
    const saved = localStorage.getItem('currentStudent');
    if (!saved) return null;
    try { return JSON.parse(saved); } catch { return null; }
  }

  /* ✅ 특정 학생 + 단원 기준 진행도 key 만들기
     → dan-progress:학년_이름_전화:soc_04 */
  function buildProgressKey(stu, unit) {
    const studentKey = buildStudentKey(stu);
    return `dan-progress:${studentKey}:${unit}`;
  }

  /* ✅ 현재 학생의 완료된 단원 목록 읽기 */
  function readDoneList() {
    const stu = getCurrentStudent();
    if (!stu) return { keyPrefix: null, list: [] };

    const unitList = [];
    const studentKey = buildStudentKey(stu);
    const prefix = `dan-progress:${studentKey}:`; // 단원별 prefix

    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k || !k.startsWith(prefix)) continue;
      const unit = k.slice(prefix.length);  // soc_01, soc_02 ...
      const val  = localStorage.getItem(k);
      if (val) unitList.push(unit);
    }
    return { keyPrefix: prefix, list: unitList };
  }

  const ProgressManager = {
    /* 현재 단원 unit (soc_01 등) */
    getUnit: detectUnit,

    /* ✅ 이 단원을 "학습완료"로 표시 */
    markComplete() {
      const stu  = getCurrentStudent();
      if (!stu) return null;

      const unit = detectUnit();                  // soc_04
      const key  = buildProgressKey(stu, unit);   // dan-progress:학생키:soc_04

      localStorage.setItem(key, '1');             // 값은 그냥 '1'로 저장
      return key;
    },

    /* ✅ 이 단원이 완료됐는지 확인 */
    isCompleted(unitOptional) {
      const stu = getCurrentStudent();
      if (!stu) return false;
      const unit = (unitOptional || detectUnit());
      const key  = buildProgressKey(stu, unit);
      return !!localStorage.getItem(key);
    },

    /* ✅ 현재 학생의 완료 단원 리스트 얻기 (soc_01, soc_03 ...) */
    getStudentProgress() {
      return readDoneList();   // { keyPrefix, list }
    }
  };

  window.DanDan.ProgressManager = ProgressManager;

  /* ✅ 제출하기 훅: 완료처리 + 로그 전송 */
  (function hookSubmitReport() {
    const original = window.submitReport;

    window.submitReport = async function (...args) {
      const stu = getCurrentStudent();
      if (!stu) {
        alert('로그인한 학생 정보가 없습니다. 먼저 로그인 해주세요.');
        return;
      }

      // 1) 기존 제출 로직(PDF 등) 실행
      if (typeof original === 'function') {
        await original.apply(this, args);
      } else if (typeof window.captureElementToPDF === 'function') {
        await captureElementToPDF(
          'capture-report',
          '단단국어_분석리포트.pdf',
          { withStudentInfo: true }
        );
      }

      // 2) ✅ 진행도: 학생 + 단원 기준으로 학습완료 저장
      const key = ProgressManager.markComplete();

      if (typeof window.showSubmitSuccess === 'function') {
        showSubmitSuccess('분석리포트');
      } else {
        console.log(`학습완료 처리됨: ${key}`);
      }

      // 3) 서버 학습 이력 로그
      if (typeof window.sendLearningLog === 'function') {
        try {
          await window.sendLearningLog();
        } catch (e) {
          console.warn('[submitReport] sendLearningLog 실패', e);
        }
      }
    };
  })();
})();

/* ===========================
 * ✅ 창의활동 제출 → PDF 내보내기
 *   textarea 전체 내용을 div로 복사해서 캡처
 * =========================== */
window.submitCreative = async function () {
  const textarea   = document.getElementById('creative-input');
  const renderBox  = document.getElementById('creative-render');
  const captureBox = document.getElementById('capture-creative');

  if (!textarea || !renderBox || !captureBox) {
    console.warn('[submitCreative] 요소를 찾을 수 없음', {
      textarea: !!textarea,
      renderBox: !!renderBox,
      captureBox: !!captureBox,
    });
    alert('창의활동 영역을 찾을 수 없습니다.');
    return;
  }

  try {
    // 1) textarea 내용 → 렌더 박스로 복사
    renderBox.textContent = textarea.value || '';

    // 2) 캡처할 동안 textarea 숨기고 렌더 박스만 보이게
    textarea.style.display  = 'none';
    renderBox.style.display = 'block';

    // 3) 공통 함수가 있으면 그걸 사용 (captureElementToPDF)
    if (typeof window.captureElementToPDF === 'function') {
      await window.captureElementToPDF(
        'capture-creative',
        '단단국어_창의활동.pdf',
        { withStudentInfo: true }
      );
    }
    // 4) 없으면 html2canvas + jsPDF 직접 사용 (백업)
    else if (window.html2canvas && window.jsPDF) {
      const canvas = await html2canvas(captureBox);
      const imgData = canvas.toDataURL('image/png');

      const pdf = new jsPDF('p', 'mm', 'a4');
      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = (canvas.height * pageW) / canvas.width;

      pdf.addImage(imgData, 'PNG', 0, 0, pageW, pageH);
      pdf.save('단단국어_창의활동.pdf');
    } else {
      alert('PDF 모듈을 찾을 수 없습니다. (html2canvas / jsPDF 확인)');
    }

    // (원하면 여기에서 창의활동도 showSubmitSuccess 호출 가능)
    if (typeof window.showSubmitSuccess === 'function') {
      window.showSubmitSuccess('창의활동');
    }
  } catch (e) {
    console.warn('submitCreative error', e);
    alert('창의활동 PDF 생성 중 오류가 발생했습니다.');
  } finally {
    // 5) 화면 복구: textarea 다시 보이게, 렌더 박스 숨김
    if (textarea)   textarea.style.display  = 'block';
    if (renderBox)  renderBox.style.display = 'none';
  }
};

/* ===========================
 * ✅ 학습 이력 서버로 보내기 (테스트 버전)
 * =========================== */
/* ===== 🔄 서버에서 완료 상태 가져오기 ===== */
window.loadCompletionStatus = async function () {
  try {
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[loadCompletionStatus] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[loadCompletionStatus] 학생 정보 없음 → 스킵');
      return;
    }

    const params = new URLSearchParams({
      grade: stu.grade || '',
      name: stu.name || '',
      series: 'BRAIN업'
    });

    const res = await fetch(`/api/completion-status?${params}`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' }
    });

    if (!res.ok) {
      console.warn('[loadCompletionStatus] 서버 응답 오류:', res.status);
      return;
    }

    const data = await res.json();
    console.log('[loadCompletionStatus] 서버 응답:', data);

    if (data.ok && Array.isArray(data.completedUnits)) {
      // 학생 키 생성 (buildProgressKey 함수와 동일한 로직)
      const cleanPhone = (stu.phone || '').replace(/\D/g, '');
      const cleanName  = (stu.name  || '').trim();
      const cleanGrade = (stu.grade || '').trim();
      const studentKey = `${cleanGrade}_${cleanName}_${cleanPhone}`;
      const keyPrefix = `dan-progress:${studentKey}:`;

      console.log('[loadCompletionStatus] studentKey:', studentKey);
      console.log('[loadCompletionStatus] keyPrefix:', keyPrefix);

      data.completedUnits.forEach(unit => {
        const key = keyPrefix + unit;  // "dan-progress:학생키:soc_01"
        localStorage.setItem(key, '1');
        console.log('[loadCompletionStatus] 저장:', key);
      });

      console.log('[loadCompletionStatus] 완료 상태 동기화 완료:', data.completedUnits);
    }
  } catch (e) {
    console.warn('[loadCompletionStatus] 오류', e);
  }
};

window.sendLearningLog = async function () {
  try {
    const unit = window.CUR_UNIT || 'soc_02';

    // 1) localStorage 에서 현재 로그인 학생 가져오기
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[sendLearningLog] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[sendLearningLog] 학생 정보 없음 → 로그 전송 스킵');
      return;
    }

    // ✅ gradeQuiz 에서 저장해 둔 레이더 점수 꺼내기
    const radar =
      (window.reportState && window.reportState.radarScores)
      ? window.reportState.radarScores
      : null;

    const payload = {
      grade:  stu.grade  || '',
      name:   stu.name   || '',
      school: stu.school || '',
      series: 'BRAIN업',      // 필요하면 '정조편' 등으로 바꿔도 됨
      unit:   unit,
      radar:  radar,       // ✅ 여기 추가!
      completed: true      // ✅ 학습 완료 표시
    };

    console.log('[sendLearningLog] payload =', payload);

    const res = await fetch('/api/log', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    let data = {};
    try {
      data = await res.json();
    } catch (_) {
      data = {};
    }
    console.log('[sendLearningLog] result =', data);
  } catch (e) {
    console.warn('sendLearningLog outer error', e);
  }
};




/* ===== 로드 시 실행 + 버튼 타입 안전패치 ===== */
document.addEventListener('DOMContentLoaded', async () => {
  // 0) 🔄 서버에서 학습 완료 상태 동기화
  if (typeof window.loadCompletionStatus === 'function') {
    await loadCompletionStatus();
  }

  // 1) 본문 내용 채우기
  applyContentPack(window.CUR_UNIT);

  // 2) 탭 이벤트 + 어휘 자동 렌더
  _bindTabEvents();
  if (location.hash.includes('어휘학습') || document.querySelector('#vocab-fill')) {
    renderVocabFill();
  }

  // 3) 버튼 type=button 통일
  ['grade-btn','reset-btn','submit-btn'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.type = 'button';
  });

  // 4) 제출하기 = 채점 + 해설 표시 (한 번만 등록)
  const submitBtn = document.getElementById('submit-btn');
  if (submitBtn) {
    submitBtn.addEventListener('click', () => {
      try {
        if (typeof window.gradeQuiz === 'function') {
          gradeQuiz();
        }
        const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.soc_01;
        renderSolutions(pack);
      } catch (e) {
        console.warn('submit-btn handler error', e);
      }
    });
  }

    // 🔶 창의활동 제출 버튼 → submitCreative 연결
  const creativeBtn = document.getElementById('creative-submit-btn');
  if (creativeBtn && typeof window.submitCreative === 'function') {
    creativeBtn.type = 'button';
    creativeBtn.addEventListener('click', () => {
      submitCreative();
    });
  }


  // 5) 지난번 채점/입력 상태 복원 (✅ 학생별로 분리된 키 기준)
  if (typeof loadReadingState === 'function') {
    loadReadingState();
  }

});