/**
 * ✅ 단원 자동 인식 (강화)
 * 우선순위: ?unit=world1_XX → 파일명 world1_XX.html → 제목 숫자
 */
(function () {
  // 이미 설정된 CUR_UNIT이 있고, world1_로 시작하면 덮어쓰지 않음
  if (window.CUR_UNIT && window.CUR_UNIT.startsWith('world1_')) {
    console.log('[world1_content.js] CUR_UNIT 이미 설정됨:', window.CUR_UNIT);
    return;
  }

  const qs = new URLSearchParams(location.search).get('unit');
  let unit = null;

  if (qs) {
    const m = qs.toLowerCase().match(/world1_(\d{1,2})/);
    if (m) unit = `world1_${m[1].padStart(2, '0')}`;
  }

  if (!unit) {
    const m2 = location.pathname.toLowerCase().match(/world1_(\d{1,2})\.html/);
    if (m2) unit = `world1_${m2[1].padStart(2, '0')}`;
  }

  if (!unit && document.title) {
    const m3 = document.title.match(/(\d{1,2})/);
    if (m3) unit = `world1_${m3[1].padStart(2, '0')}`;
  }

  window.CUR_UNIT = unit || 'world1_01';
})();

/* ===============================
   ✅ 전역 CONTENTS 준비 (단일화)
   =============================== */
window.CONTENTS = window.CONTENTS || {};

/* ===== 콘텐츠 팩: 단원별 지문/어휘/문제/정답 =====
   ✅ 기존 const CONTENTS = {...} → window.CONTENTS 에 합치기
*/
window.CONTENTS = Object.assign(window.CONTENTS, {
  /* ===== world1_01 : "두려움을 넘어선 새로운 시작_데미안" ===== */
  world1_01: {
    labelNo: '01',
    title: '📚 두려움을 넘어선 새로운 시작',
    passage: [
      '나는 늘 <b>두려움</b>에 사로잡혀 살았어요. 학교에서 발표를 할 때마다 목소리가 떨렸고, 새로운 사람을 만나면 무슨 말을 해야 할지 몰라 <b>망설이다</b> 결국 아무 말도 하지 못했지요. 친구들은 나를 조용한 아이라고 생각했지만, 사실 나는 속으로 늘 말하고 싶은 것들이 가득했어요.',
      '어느 날, <b>우연히</b> 도서관에서 「데미안」이라는 책을 발견했어요. 책 속의 주인공 싱클레어는 나처럼 <b>두려움</b>을 안고 살아가다가, 데미안이라는 친구를 만나 조금씩 변해갔어요. 데미안은 싱클레어에게 "새는 알에서 나오려고 투쟁한다"라는 말을 해 주었어요. 그 말은 마치 나에게도 하는 것 같았어요.',
      '나는 용기를 내어 친구 민호에게 <b>고백하기로</b> 마음먹었어요. "나, 사실 발표할 때 너무 떨려서 힘들어." 민호는 웃으며 말했어요. "나도 그래! 우리 같이 연습하자." 그 순간, 내 마음에 작은 <b>구원</b>의 빛이 들어왔어요. 두려움을 나누자 가벼워졌어요.',
      '그날 이후, 나는 <b>낯선 사람</b>에게도 먼저 인사하기 시작했어요. 처음엔 여전히 긴장되었지만, 조금씩 <b>극복하다</b> 보니 세상이 달라 보였어요. 데미안의 말처럼 알을 깨고 나오면 새로운 세상이 펼쳐진다는 것을 깨달았지요.',
      '지금도 가끔 두려울 때가 있어요. 하지만 이제는 그 두려움이 나를 성장시키는 시작점이라는 <b>예감</b>이 들어요. 세상을 향해 첫 발을 내딛는 건 무섭지만, 그만큼 설레는 일이기도 하니까요.'
    ],
    vocab: [
      ['두려움', '무섭거나 불안하여 마음이 움츠러드는 느낌.'],
      ['고백하다', '숨기고 있던 마음이나 사실을 솔직하게 말하다.'],
      ['구원', '어려움이나 위험에서 건져 내어 구해 줌.'],
      ['예감', '어떤 일이 일어날 것 같은 느낌이나 짐작.'],
      ['망설이다', '이러지도 저러지도 못하고 머뭇거리다.'],
      ['극복하다', '어려움이나 장애를 이겨 내다.'],
      ['우연히', '뜻하지 않게 저절로 일어나는 모양.'],
      ['낯선 사람', '한 번도 만난 적이 없어 모르는 사람.']
    ],
    vocabFill: {
      instructions: '',
      items: [
        { no: 1, text: '무섭거나 불안할 때 마음이 움츠러드는 느낌을 (      )이라고 해요.', answer: '두려움', initials: 'ㄷㄹㅇ', aliases: ['두려움'] },
        { no: 2, text: '숨기고 있던 마음이나 사실을 솔직하게 말하는 것을 (        )라고 해요.', answer: '고백하다', initials: 'ㄱㅂㅎㄷ', aliases: ['고백하다','고백'] },
        { no: 3, text: '어려움이나 위험에서 건져 내어 구해 주는 것을 (      )이라고 해요.', answer: '구원', initials: 'ㄱㅇ', aliases: ['구원'] },
        { no: 4, text: '어떤 일이 일어날 것 같은 느낌이나 짐작을 (      )이라고 해요.', answer: '예감', initials: 'ㅇㄱ', aliases: ['예감'] },
        { no: 5, text: '이러지도 저러지도 못하고 머뭇거리는 것을 (        )라고 해요.', answer: '망설이다', initials: 'ㅁㅅㅇㄷ', aliases: ['망설이다','망설임'] },
        { no: 6, text: '어려움이나 장애를 이겨 내는 것을 (        )라고 해요.', answer: '극복하다', initials: 'ㄱㅂㅎㄷ', aliases: ['극복하다','극복'] },
        { no: 7, text: '뜻하지 않게 저절로 일어나는 것을 (      )라고 해요.', answer: '우연히', initials: 'ㅇㅇㅎ', aliases: ['우연히','우연'] },
        { no: 8, text: '한 번도 만난 적이 없어 모르는 사람을 (          )이라고 해요.', answer: '낯선 사람', initials: 'ㄴㅅ ㅅㄹ', aliases: ['낯선사람','낯선 사람'] }
      ]
    },
    quiz: {
      q1_text: '글쓴이가 친구 민호에게 마음을 털어놓은 후 느낀 감정으로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 민호가 자신을 무시할까 봐 더 두려워졌다.',
        '② 두려움을 나누자 마음이 가벼워지고 구원받은 느낌이 들었다.',
        '③ 민호도 같은 고민이 있다는 말에 오히려 실망했다.',
        '④ 혼자 해결해야겠다는 마음이 더 강해졌다.'
      ],
      q2_text: '이 글의 전개 구조로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 문제 상황 → 해결 방법 제시 → 결과 서술',
        '② 두려움 속의 나 → 책과 친구를 통한 깨달음 → 변화와 성장',
        '③ 과거 회상 → 현재 상황 분석 → 미래 계획 설명',
        '④ 주장 제시 → 반론 검토 → 결론 도출'
      ],
      q3_1_ph: 'ㅁㅅㅇㄷ', q3_2_ph: 'ㄱㅂㅎㄱㄹ',
      q4_1_ph: 'ㅇㅇㅎ', q4_2_ph: 'ㄱㅂㅎㄷ',
      q5_text: '데미안이 싱클레어에게 "새는 알에서 나오려고 투쟁한다"라고 말한 이유를 본문 내용과 연결하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['망설이다','망설임'], q3_2:['고백하기로','고백'], q4_1:['우연히','우연'], q4_2:['극복하다','극복'] },
    essayKeywords: ['알','깨다','투쟁','두려움','성장','변화','새로운','시작'],
    explain: {
      q1:'해설: 민호에게 고백한 후 두려움을 나누자 마음이 가벼워지고 구원의 빛이 들어왔다고 표현함.',
      q2:'해설: 글은 \'두려움에 사로잡힌 나 → 책과 친구를 통한 깨달음 → 변화와 성장\'의 순서로 전개됨.',
      q3:'해설: 글쓴이는 망설이다가 용기를 내어 민호에게 고백하기로 마음먹음.',
      q4:'해설: 글쓴이는 우연히 도서관에서 데미안을 발견하고, 이후 두려움을 극복하기 시작함.',
      q5:'예시: 알을 깨는 것은 힘들지만 그래야 새로운 세상으로 나갈 수 있다는 의미로, 두려움을 극복해야 성장할 수 있다는 뜻.'
    }
  },

  /* ===== world1_02 : "섬의 비밀과 소년들의 결심" (15소년 표류기) ===== */
  world1_02: {
    labelNo: '02',
    title: '🏝️ 섬의 비밀과 소년들의 결심',
    passage: [
      '케이트는 자신이 섬에 오게 된 긴 사연을 모두 털어놓고 나서야 겨우 숨을 고를 수 있었어요. 그런데 이야기를 듣던 소년들은 어른 없이 무인도에서 지냈다며 지난 2년 동안의 생활을 조심스럽게 들려주었지요. 나이도 다르고 출신도 제각각인 열다섯 명의 소년이 서로 힘을 모아 살아남은 이야기였어요. 케이트는 그들의 설명을 들으며 어린 나이에 이런 고난을 견뎌냈다는 사실에 가슴이 뭉클해져 눈물을 흘리고 말았습니다. "정말 너희를 만나지 못했다면, 이 섬에 어떤 위험이 숨어 있는지도 모른 채 생활했을 거야…" 케이트는 떨리는 목소리로 말했다.',
      '소년들은 케이트에게 섬 어딘가에 무법자들이 숨어 있다는 사실을 전해 주었어요. 반란을 일으킨 윌스턴과 그의 무리들은 배의 선장과 항해사는 물론, 케이트가 모시던 부인까지 해치고 달아난 사람들이었지요. 그들은 케이트가 파도에 휩쓸려 죽었다고 생각하고 있었기에 더더욱 위험했어요. 고든과 브리앙은 긴장한 표정으로 서로를 바라보며 말했습니다. "저 사람들이 이 섬이 무인도인 줄 알게 되면 우리 은신처를 금방 찾아낼 거야. 무기와 식량까지 있다는 걸 알면 무슨 일이 벌어질지 장담할 수 없어." 소년들의 표정은 걱정으로 가득 차 있었습니다.',
      '브리앙은 더욱 불안했어요. 자신이 프랑스 출신이라는 이유로 드니팬 일행은 늘 그를 못마땅하게 여겼고, 결국 독립을 선언하며 다른 동굴로 이주해 버렸거든요. 문제는 그들이 떠난 방향이 악당들이 이동한 쪽과 아주 비슷하다는 사실이었죠. 지금은 서로 사이가 좋지 않았던 감정 따위를 따질 때가 아니었어요. "내가 가서 드니팬 일행을 데리고 돌아올게. 모코, 우리 같이 호수를 건너가 보자." 브리앙이 결심하자, 고든은 걱정스러운 눈으로 물었습니다. "언제 떠날 생각이야?" 브리앙은 창밖으로 어둑해지는 하늘을 보며 대답했어요. "악당들에게 들키지 않으려면… 밤을 기다리는 수밖에 없어."'
    ],
    vocab: [
      ['표류', '바람이나 물결에 떠밀려 떠다님.'],
      ['무인도', '사람이 살지 않는 섬.'],
      ['반란', '권력을 거스르고 맞서 일어남.'],
      ['항해사', '배에서 항로를 맡아 인도하는 사람.'],
      ['은신처', '숨거나 몸을 피할 수 있는 곳.'],
      ['출두', '관아나 모인 자리로 나아가는 일.'],
      ['결심', '마음을 굳게 정함.'],
      ['위험 인물', '해를 끼칠 수 있어 조심해야 할 사람.']
    ],
    vocabFill: {
      instructions: '[15소년 표류기 어휘]',
      items: [
        { no: 1, text: '바람이나 물결에 떠밀려 떠다니는 것을 (      )라고 해요.', answer: '표류', initials: 'ㅍㄹ', aliases: ['표류'] },
        { no: 2, text: '사람이 살지 않는 섬을 (      )라고 해요.', answer: '무인도', initials: 'ㅁㅇㄷ', aliases: ['무인도'] },
        { no: 3, text: '권력을 거스르고 맞서 일어나는 것을 (      )이라고 해요.', answer: '반란', initials: 'ㅂㄹ', aliases: ['반란'] },
        { no: 4, text: '배에서 항로를 맡아 인도하는 사람을 (      )라고 해요.', answer: '항해사', initials: 'ㅎㅎㅅ', aliases: ['항해사'] },
        { no: 5, text: '숨거나 몸을 피할 수 있는 곳을 (      )라고 해요.', answer: '은신처', initials: 'ㅇㅅㅊ', aliases: ['은신처'] },
        { no: 6, text: '관아나 모인 자리로 나아가는 일을 (      )라고 해요.', answer: '출두', initials: 'ㅊㄷ', aliases: ['출두'] },
        { no: 7, text: '마음을 굳게 정하는 것을 (      )이라고 해요.', answer: '결심', initials: 'ㄱㅅ', aliases: ['결심'] },
        { no: 8, text: '해를 끼칠 수 있어 조심해야 할 사람을 (          )이라고 해요.', answer: '위험 인물', initials: 'ㅇㅎ ㅇㅁ', aliases: ['위험인물','위험 인물'] }
      ]
    },
    quiz: {
      q1_text: '케이트가 소년들의 이야기를 듣고 눈물을 흘린 이유로 가장 알맞은 것은 무엇인가요?',
      q1_opts: [
        '① 자신만 혼자 섬에 남겨질까 봐 두려웠기 때문이다.',
        '② 어린 소년들이 어른 없이 2년간 고난을 견뎌냈다는 사실에 감동했기 때문이다.',
        '③ 소년들이 무법자들과 싸워서 이겼다는 소식을 들었기 때문이다.',
        '④ 소년들이 케이트를 섬에서 쫓아내려고 했기 때문이다.'
      ],
      q2_text: '이 글의 전개 구조로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 문제 제기 → 원인 분석 → 해결책 제시',
        '② 케이트의 사연 공유 → 섬의 위험 상황 전달 → 브리앙의 결심',
        '③ 과거 회상 → 현재 분석 → 미래 예측',
        '④ 주장 → 반론 → 결론'
      ],
      q3_1_ph: 'ㅁㅇㄷ', q3_2_ph: 'ㅇㅅㅊ',
      q4_1_ph: 'ㄱㅅ', q4_2_ph: 'ㅂ',
      q5_text: '브리앙이 드니팬 일행과 사이가 좋지 않았음에도 그들을 데리러 가기로 결심한 이유를 본문 내용을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['무인도'], q3_2:['은신처'], q4_1:['결심'], q4_2:['밤','밤을'] },
    essayKeywords: ['위험','악당','무법자','협력','화합','단결','함께','생존','안전','갈등','해결'],
    explain: {
      q1:'해설: 케이트는 열다섯 명의 소년들이 어린 나이에 2년간 고난을 견뎌냈다는 사실에 가슴이 뭉클해져 눈물을 흘렸습니다.',
      q2:'해설: 글은 \'케이트의 사연 공유 → 섬의 위험 상황(무법자) 전달 → 브리앙의 결심\'의 순서로 전개됩니다.',
      q3:'해설: 소년들이 2년간 살아온 곳은 사람이 살지 않는 \'무인도\'이고, 그들이 숨어 지내는 곳은 \'은신처\'입니다.',
      q4:'해설: 브리앙은 마음을 굳게 정하여(결심) 악당들에게 들키지 않기 위해 \'밤\'을 기다리기로 했습니다.',
      q5:'예시: 악당들이 드니팬 일행이 떠난 방향으로 이동했기 때문에 위험했고, 개인적인 감정보다 모두의 안전이 더 중요했기 때문입니다.'
    }
  },

  /* ===== world1_03 : "꽃의 요정이 이룬 소원" ===== */
  world1_03: {
    labelNo: '03',
    title: '🌸 꽃의 요정이 이룬 소원',
    passage: [
      '마야는 이제 더 이상 작고 연약한 어린 꿀벌이 아니었어요. 여러 곤충들과 함께하며 배운 시간은 마야를 더욱 단단하게 만들었고, 그 과정에서 날개는 빛을 머금은 듯 반짝였고, 스스로를 지킬 수 있는 날카로운 침도 갖추게 되었지요. 숲 속의 위험한 <b>순간</b>들을 여러 번 이겨 내면서 마야는 누구보다 용감하고 똑똑한 꿀벌로 <b>성장</b>했습니다. 마야는 자신이 겪은 경험과 깨달음을 언젠가 꼭 누군가를 위해 사용하고 싶다고 마음속으로 다짐하곤 했지요.',
      '하지만 마야에게는 아직 이루지 못한 바람이 하나 남아 있었어요. 벌집을 떠나온 마야는 언젠가 여왕벌에게 다시 돌아가 용서를 구해야 한다는 사실을 알고 있었지만, 지금은 아직 그럴 수 없었지요. 마야는 \'인간\'을 꼭 직접 만나 보고 싶었기 때문이에요. 숲에서 들려온 인간에 대한 이야기들은 서로 달라 혼란스러웠지만, 마야의 마음속에는 인간이 생각보다 훨씬 지혜롭고 <b>고귀한</b> 존재일지도 모른다는 희미한 믿음이 자리하고 있었습니다. 그래서 마야는 언젠가 인간을 마주할 기회를 <b>간절히</b> 꿈꾸며 하루하루를 보냈지요.',
      '그러던 어느 무더운 여름밤, 마야의 바람은 너무도 뜻밖이고 아름다운 방식으로 이루어졌습니다. 우연히 만난 꽃의 <b>요정</b>이 마야의 마음을 알아채고 소원을 이루어 준 것이었어요. 요정이 가리키는 곳을 바라보자, 달빛 아래에서 한 소년과 소녀가 서로 기대며 조용히 밤하늘을 바라보고 있었지요. 바람의 숨결과 귀뚜라미 소리만이 흐르는 고요한 순간, 마야는 그들의 따스한 <b>애정</b>과 평화로운 모습에 눈을 뗄 수 없었습니다. 소년과 소녀가 서로를 아끼는 모습을 보며 마야는 깨달았어요. \'사람들이 서로를 사랑할 때, 그 순간만큼 아름다운 장면은 없구나.\' 마야의 작은 가슴은 그 따뜻함을 함께 느끼며 오래도록 떨렸습니다.'
    ],
    vocab: [
      ['간절함', '마음속 깊이 바라고 원하는 마음'],
      ['고귀하다', '품격이 높고 가치가 뛰어나다는 뜻'],
      ['요정', '자연 속에서 마법을 다루는 존재로 상상되는 존재'],
      ['황홀함', '너무 아름답거나 감동적이어서 넋을 잃을 정도의 느낌'],
      ['애정', '서로를 아끼고 사랑하는 마음'],
      ['성장', '시간이 지나면서 능력이나 모습이 발달하는 과정'],
      ['위협적', '두려움이나 위험을 주는 듯한 성질'],
      ['순간', '시간이 잠깐 머무는 아주 짧은 때']
    ],
    /* ✅ 어휘학습(빈칸) */
    vocabFill: {
      instructions: '[꿀벌 마야·감정 관련 어휘]',
      items: [
        { no: 1, text: '마음속 깊이 바라고 원하는 마음을 (      )이라고 한다.', answer: '간절함', initials: 'ㄱㅈㅎ', aliases: ['간절함'] },
        { no: 2, text: '품격이 높고 가치가 뛰어나다는 뜻을 (      )라고 한다.', answer: '고귀하다', initials: 'ㄱㄱㅎㄷ', aliases: ['고귀하다','고귀'] },
        { no: 3, text: '자연 속에서 마법을 다루는 상상의 존재를 (      )이라 한다.', answer: '요정', initials: 'ㅇㅈ', aliases: ['요정'] },
        { no: 4, text: '너무 아름답거나 감동적이어서 넋을 잃을 정도의 느낌을 (      )이라 한다.', answer: '황홀함', initials: 'ㅎㅎㅎ', aliases: ['황홀함','황홀'] },
        { no: 5, text: '서로를 아끼고 사랑하는 마음을 (      )이라 한다.', answer: '애정', initials: 'ㅇㅈ', aliases: ['애정'] },
        { no: 6, text: '시간이 지나면서 능력이나 모습이 발달하는 과정을 (      )이라 한다.', answer: '성장', initials: 'ㅅㅈ', aliases: ['성장'] },
        { no: 7, text: '두려움이나 위험을 주는 듯한 성질을 (      )이라 한다.', answer: '위협적', initials: 'ㅇㅎㅈ', aliases: ['위협적'] },
        { no: 8, text: '시간이 잠깐 머무는 아주 짧은 때를 (      )이라 한다.', answer: '순간', initials: 'ㅅㄱ', aliases: ['순간'] }
      ]
    },
    quiz: {
      q1_text: '마야가 인간을 직접 만나고 싶어 한 이유로 가장 적절한 것은 무엇인가요?',
      q1_opts: [
        '① 인간에게 벌꿀을 팔고 싶었기 때문에',
        '② 인간이 위협적인 존재인지 확인하고 싶었기 때문에',
        '③ 인간이 지혜롭고 고귀한 존재일지 모른다는 믿음이 있었기 때문에',
        '④ 여왕벌이 인간을 만나 오라고 명령했기 때문에'
      ],
      q2_text: '이 글의 전개 순서로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 마야의 성장 → 인간을 만나고 싶은 바람 → 요정의 도움으로 소원 실현',
        '② 요정과의 만남 → 마야의 성장 → 인간에 대한 깨달음',
        '③ 인간에 대한 두려움 → 벌집으로 귀환 → 여왕벌의 용서',
        '④ 소년과 소녀의 만남 → 마야의 탄생 → 숲에서의 모험'
      ],
      q3_html: `마야는 여러 경험을 통해 용감하고 똑똑한 꿀벌로 <input class="inline-input" id="q3-1" type="text" placeholder="(1)">했고, 인간을 만나고 싶다는 <input class="inline-input" id="q3-2" type="text" placeholder="(2)"> 바람을 품고 있었다.`,
      q4_html: `꽃의 <input class="inline-input" id="q4-1" type="text" placeholder="(1)">이 마야의 소원을 이루어 주었고, 마야는 소년과 소녀의 <input class="inline-input" id="q4-2" type="text" placeholder="(2)">에 감동받았다.`,
      q3_1_ph: 'ㅅㅈ', q3_2_ph: 'ㄱㅈㅎ', q4_1_ph: 'ㅇㅈ', q4_2_ph: 'ㅇㅈ',
      q5_text: '마야가 소년과 소녀를 보며 느낀 감정과 깨달음을 바탕으로, 사랑이 왜 아름다운지 자신의 생각을 써 보세요.'
    },
    answerKey: { q1:'3', q2:'1', q3_1:['성장'], q3_2:['간절한','간절함'], q4_1:['요정'], q4_2:['애정','사랑'] },
    essayKeywords: ['사랑','애정','따뜻함','평화','아름다움','감동','마음','소중함','행복'],
    explain: {
      q1:'해설: 본문에서 마야는 인간이 지혜롭고 고귀한 존재일지 모른다는 믿음을 갖고 있었다고 나옵니다.',
      q2:'해설: 글은 마야의 성장 → 인간을 만나고 싶은 바람 → 요정의 도움으로 소원이 이루어지는 순서로 전개됩니다.',
      q3:'해설: 마야는 성장했고, 간절한 바람을 품고 있었습니다.',
      q4:'해설: 꽃의 요정이 소원을 이루어 주었고, 마야는 소년과 소녀의 애정에 감동받았습니다.',
      q5:'예시: 서로를 아끼는 마음은 보는 이에게도 따뜻함을 전해주기 때문에 사랑은 아름답습니다.'
    }
  },

  /* ===== world1_04 : "타미노와 파파게노에게 내려진 첫 번째 시험" ===== */
  world1_04: {
    labelNo: '04',
    title: '🎭 타미노와 파파게노에게 내려진 첫 번째 시험',
    passage: [
      '타미노 왕자는 파미나 공주를 구하려다가 태양의 <b>사제</b>로 유명한 자라스트로의 궁전에 들어오게 되었어요. 그는 처음에는 자라스트로를 오해했지만, 곧 이곳이 지혜와 빛을 상징하는 세계라는 사실을 알게 되었죠. 그러나 이곳을 지배하는 모노스타토스가 파미나를 붙잡아 두고 있어 상황은 쉽지 않았습니다. 이때 자라스트로가 두 사람에게 중요한 제안을 했습니다. 타미노와 파미나의 결혼을 허락하되, 먼저 \'<b>침묵</b>의 <b>시험</b>\'을 통과해야 한다는 것이었어요. 타미노는 흔들림 없이 이를 받아들였고, 겁 많은 파파게노도 마지못해 시험에 참여하게 되었죠.',
      '타미노가 시험을 견디는 동안 파미나는 깊은 고민에 잠겨 있었습니다. 그 순간 천둥 같은 소리와 함께 어둠을 다스리는 밤의 여왕이 모습을 드러냈습니다. 파미나는 어머니를 사랑했지만, 밤의 여왕은 딸에게 충격적인 <b>명령</b>을 내렸어요. 바로 자라스트로를 무찌르고 자신이 태양의 왕국을 빼앗아야 한다는 것이었죠. 파미나는 끔찍한 선택을 강요받은 탓에 두려움과 충격에 빠졌습니다. 어머니의 요구를 따르자니 자신의 <b>양심</b>을 배반하는 일이고, 거부하자니 어머니를 잃을까 두려웠기 때문입니다.',
      '자라스트로는 밤의 여왕의 <b>속셈</b>을 이미 알고 있었습니다. 그는 파미나가 어두운 명령에 흔들릴까 걱정했지만, 그녀의 선한 마음을 믿었어요. 그래서 파미나에게 조용히 다가와 말했습니다. "태양과 빛의 왕국에서는 누구에게도 분노나 <b>보복</b>을 허락하지 않는다. 너는 올바른 길을 선택할 것임을 알고 있다." 파미나는 그의 말을 들으며 서서히 마음을 가라앉히고, 타미노가 시험을 잘 견뎌 결혼을 허락받을 날을 기다렸습니다. 비록 두려움은 여전했지만, 그녀는 빛의 세계가 어둠보다 강하다는 것을 느끼기 시작했어요.'
    ],
    vocab: [
      ['시험(試驗)', '능력이나 성품을 확인하기 위해 행하는 검사'],
      ['침묵', '말을 하지 않고 조용히 있는 상태'],
      ['절망감', '희망을 잃고 깊은 슬픔에 빠진 상태'],
      ['명령', '윗사람이 아랫사람에게 강하게 요구하는 말'],
      ['속셈', '겉으로는 드러내지 않은 숨은 의도'],
      ['사제(司祭)', '특정 신앙이나 의식을 담당하는 사람'],
      ['양심', '옳고 그름을 판단하고 바른 행동을 하려는 마음'],
      ['보복', '받은 해를 되갚기 위한 행동']
    ],
    vocabFill: {
      instructions: '[마술피리 어휘]',
      items: [
        { no: 1, text: '능력이나 성품을 확인하기 위해 행하는 검사를 (      )이라 한다.', answer: '시험', initials: 'ㅅㅎ', aliases: ['시험'] },
        { no: 2, text: '말을 하지 않고 조용히 있는 상태를 (      )이라 한다.', answer: '침묵', initials: 'ㅊㅁ', aliases: ['침묵'] },
        { no: 3, text: '희망을 잃고 깊은 슬픔에 빠진 상태를 (      )이라 한다.', answer: '절망감', initials: 'ㅈㅁㄱ', aliases: ['절망감','절망'] },
        { no: 4, text: '윗사람이 아랫사람에게 강하게 요구하는 말을 (      )이라 한다.', answer: '명령', initials: 'ㅁㄹ', aliases: ['명령'] },
        { no: 5, text: '겉으로는 드러내지 않은 숨은 의도를 (      )이라 한다.', answer: '속셈', initials: 'ㅅㅅ', aliases: ['속셈'] },
        { no: 6, text: '특정 신앙이나 의식을 담당하는 사람을 (      )이라 한다.', answer: '사제', initials: 'ㅅㅈ', aliases: ['사제'] },
        { no: 7, text: '옳고 그름을 판단하고 바른 행동을 하려는 마음을 (      )이라 한다.', answer: '양심', initials: 'ㅇㅅ', aliases: ['양심'] },
        { no: 8, text: '받은 해를 되갚기 위한 행동을 (      )이라 한다.', answer: '보복', initials: 'ㅂㅂ', aliases: ['보복'] }
      ]
    },
    quiz: {
      q1_text: '타미노가 파미나와 결혼하기 위해 통과해야 하는 시험은 무엇인가요?',
      q1_opts: [
        '① 용을 물리치는 시험',
        '② 마법 피리를 연주하는 시험',
        '③ 침묵의 시험',
        '④ 미로를 탈출하는 시험'
      ],
      q2_text: '이 글의 전개 순서로 올바른 것은 무엇인가요?',
      q2_opts: [
        '① 밤의 여왕 등장 → 침묵의 시험 → 자라스트로의 조언',
        '② 침묵의 시험 제안 → 밤의 여왕의 명령 → 자라스트로의 조언',
        '③ 자라스트로의 조언 → 밤의 여왕 등장 → 침묵의 시험',
        '④ 파미나의 선택 → 타미노의 도착 → 밤의 여왕의 명령'
      ],
      q3_html: `밤의 여왕은 파미나에게 자라스트로를 무찌르라는 <input class="inline-input" id="q3-1" type="text" placeholder="ㅁㄹ">을 내렸고,
                파미나는 자신의 <input class="inline-input" id="q3-2" type="text" placeholder="ㅇㅅ">을 배반할 수 없어 괴로워했다.`,
      q4_html: `자라스트로는 밤의 여왕의 <input class="inline-input" id="q4-1" type="text" placeholder="ㅅㅅ">을 이미 알고 있었고,
                빛의 왕국에서는 <input class="inline-input" id="q4-2" type="text" placeholder="ㅂㅂ">을 허락하지 않는다고 말했다.`,
      q3_1_ph: 'ㅁㄹ', q3_2_ph: 'ㅇㅅ', q4_1_ph: 'ㅅㅅ', q4_2_ph: 'ㅂㅂ',
      q5_text: '파미나가 어머니의 명령과 자신의 양심 사이에서 괴로워한 이유를 본문 내용을 바탕으로 설명해 보세요.'
    },
    answerKey: { q1:'3', q2:'2', q3_1:['명령'], q3_2:['양심'], q4_1:['속셈'], q4_2:['보복'] },
    essayKeywords: ['양심','어머니','명령','배반','거부','두려움','선택','괴로움','빛','어둠'],
    explain: {
      q1:'해설: 자라스트로는 타미노에게 결혼을 허락하되 침묵의 시험을 통과해야 한다고 했습니다.',
      q2:'해설: 침묵의 시험 제안 → 밤의 여왕의 명령 → 자라스트로의 조언 순서입니다.',
      q3:'해설: 밤의 여왕은 명령을 내렸고, 파미나는 양심을 배반할 수 없어 괴로워했습니다.',
      q4:'해설: 자라스트로는 밤의 여왕의 속셈을 알고 있었고, 빛의 왕국에서는 보복을 허락하지 않는다고 말했습니다.',
      q5:'예시: 파미나는 어머니의 요구를 따르면 자신의 양심을 배반하게 되고, 거부하면 어머니를 잃을까 두려웠기 때문에 두 가지 선택 사이에서 괴로워했습니다.'
    },
    creative: {
      title: '파미나에게 조언의 편지 쓰기',
      topic: '어머니의 명령과 자신의 양심 사이에서 괴로워하는 파미나에게 조언의 편지를 써 보세요.',
      hint: '옳은 선택이 무엇인지, 어떻게 마음을 다잡을 수 있을지 생각해 보세요.',
      examples: [
        '예시 1) 파미나, 네 마음속 양심의 목소리를 따르는 것이 결국 올바른 길일 거야.',
        '예시 2) 어머니를 사랑하는 마음은 변하지 않아도, 잘못된 명령을 따르지 않는 것이 진정한 효도일 수 있어.',
        '예시 3) 빛의 세계를 믿고 타미노와 함께 시험을 이겨내면 분명 좋은 결과가 있을 거야.'
      ]
    }
  },

  /* ===== world1_05 : "어린 왕자와 여우의 특별한 만남" (어린 왕자) ===== */
  world1_05: {
    labelNo: '05',
    title: '🦊 어린 왕자와 여우의 특별한 만남',
    passage: [
      '어린 왕자는 자신의 작은 별에서 장미꽃 한 송이를 정성껏 돌보며 살았어요. 하지만 장미는 까다롭고 <b>허영심</b>이 강해서 어린 왕자를 힘들게 했지요. 결국 어린 왕자는 다른 별들을 여행하기로 마음먹고 자신의 별을 떠났습니다. 여러 별을 돌아다니며 이상한 어른들을 만났지만, 그들은 모두 권력이나 돈, 숫자에만 관심이 있었어요. 어린 왕자는 점점 외로워졌고, 마침내 지구에 도착하게 되었습니다.',
      '지구의 사막을 걷던 어린 왕자는 한 <b>여우</b>를 만났어요. 여우는 어린 왕자에게 "나를 <b>길들여</b> 줘"라고 부탁했지요. 어린 왕자가 길들인다는 것이 무슨 뜻인지 묻자, 여우는 이렇게 대답했어요. "길들인다는 건 <b>관계</b>를 맺는 거야. 지금 너는 나에게 수천 명의 다른 소년들과 다를 바 없어. 하지만 네가 나를 길들이면, 우린 서로에게 <b>유일한</b> 존재가 되는 거야." 어린 왕자는 여우의 말을 듣고 깊이 생각에 잠겼습니다.',
      '어린 왕자는 매일 같은 시간에 여우를 찾아갔고, 둘은 점점 가까워졌어요. 헤어질 시간이 다가오자 여우는 슬퍼했지만, 어린 왕자에게 <b>비밀</b> 하나를 알려 주었어요. "가장 중요한 것은 눈에 보이지 않아. 오직 마음으로만 볼 수 있어." 또한 여우는 말했지요. "네가 장미에게 쏟은 <b>시간</b>이 장미를 그토록 소중하게 만든 거야. 너는 네가 길들인 것에 대해 영원히 <b>책임</b>을 져야 해." 어린 왕자는 그제야 자신이 떠나온 장미가 세상에서 단 하나뿐인 특별한 존재임을 깨달았습니다.'
    ],
    vocab: [
      ['길들이다', '서로 친밀한 관계를 맺어 마음이 통하게 되다.'],
      ['허영심', '겉으로 드러나는 것만 중요하게 여기는 마음.'],
      ['유일하다', '오직 하나밖에 없다.'],
      ['관계', '둘 이상의 사람이나 사물이 서로 연결된 상태.'],
      ['책임', '맡은 일이나 의무를 다해야 하는 마음가짐.'],
      ['비밀', '남에게 알리지 않고 숨기는 것.'],
      ['소중하다', '매우 귀중하고 중요하다.'],
      ['외롭다', '혼자이거나 의지할 곳이 없어 쓸쓸하다.']
    ],
    vocabFill: {
      instructions: '[어린 왕자 어휘]',
      items: [
        { no: 1, text: '서로 친밀한 관계를 맺어 마음이 통하게 되는 것을 (        )라고 해요.', answer: '길들이다', initials: 'ㄱㄷㅇㄷ', aliases: ['길들이다','길들임'] },
        { no: 2, text: '겉으로 드러나는 것만 중요하게 여기는 마음을 (      )이라고 해요.', answer: '허영심', initials: 'ㅎㅇㅅ', aliases: ['허영심'] },
        { no: 3, text: '오직 하나밖에 없다는 뜻을 (        )라고 해요.', answer: '유일하다', initials: 'ㅇㅇㅎㄷ', aliases: ['유일하다','유일'] },
        { no: 4, text: '둘 이상의 사람이나 사물이 서로 연결된 상태를 (      )라고 해요.', answer: '관계', initials: 'ㄱㄱ', aliases: ['관계'] },
        { no: 5, text: '맡은 일이나 의무를 다해야 하는 마음가짐을 (      )이라고 해요.', answer: '책임', initials: 'ㅊㅇ', aliases: ['책임'] },
        { no: 6, text: '남에게 알리지 않고 숨기는 것을 (      )이라고 해요.', answer: '비밀', initials: 'ㅂㅁ', aliases: ['비밀'] },
        { no: 7, text: '매우 귀중하고 중요한 것을 (        )라고 해요.', answer: '소중하다', initials: 'ㅅㅈㅎㄷ', aliases: ['소중하다','소중'] },
        { no: 8, text: '혼자이거나 의지할 곳이 없어 쓸쓸한 것을 (      )라고 해요.', answer: '외롭다', initials: 'ㅇㄹㄷ', aliases: ['외롭다','외로움'] }
      ]
    },
    quiz: {
      q1_text: '여우가 어린 왕자에게 "길들인다"의 의미로 설명한 것은 무엇인가요?',
      q1_opts: [
        '① 동물을 훈련시켜 말을 듣게 하는 것',
        '② 서로에게 유일한 존재가 되도록 관계를 맺는 것',
        '③ 함께 여행을 다니며 친구가 되는 것',
        '④ 매일 선물을 주고받으며 친해지는 것'
      ],
      q2_text: '이 글의 전개 구조로 가장 알맞은 것은 무엇인가요?',
      q2_opts: [
        '① 문제 제기 → 해결책 제시 → 결론 도출',
        '② 별을 떠난 이유 → 여우와의 만남 → 깨달음',
        '③ 현재 → 과거 회상 → 미래 예측',
        '④ 주장 → 반론 → 결론'
      ],
      q3_1_ph: 'ㄱㄷㅇ', q3_2_ph: 'ㅇㅇㅎ',
      q4_1_ph: 'ㅅㄱ', q4_2_ph: 'ㅊㅇ',
      q5_text: '여우가 말한 "가장 중요한 것은 눈에 보이지 않아"라는 말의 의미를 본문 내용과 연결하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['길들이다','길들임','길들여'], q3_2:['유일한','유일'], q4_1:['시간'], q4_2:['책임'] },
    essayKeywords: ['마음','눈','보이지','관계','시간','소중','길들이다','사랑','정성'],
    explain: {
      q1:'해설: 여우는 길들인다는 것이 서로에게 유일한 존재가 되도록 관계를 맺는 것이라고 설명했습니다.',
      q2:'해설: 글은 \'어린 왕자가 별을 떠난 이유 → 여우와의 만남 → 장미의 소중함을 깨달음\'의 순서로 전개됩니다.',
      q3:'해설: 여우는 어린 왕자에게 길들여 달라고 부탁했고, 그러면 서로에게 유일한 존재가 된다고 했습니다.',
      q4:'해설: 어린 왕자가 장미에게 쏟은 시간이 장미를 소중하게 만들었고, 길들인 것에 대해 책임을 져야 한다고 했습니다.',
      q5:'예시: 사랑이나 우정처럼 진정으로 소중한 것은 겉모습이 아니라 함께한 시간과 마음으로 느껴지기 때문입니다.'
    },
    creative: {
      title: '🦊 나에게 소중한 존재에게 편지 쓰기',
      topic: '여우의 말처럼 "네가 쏟은 시간이 그것을 소중하게 만든다"는 의미를 생각하며, 나에게 소중한 존재(가족, 친구, 반려동물 등)에게 편지를 써 보세요.',
      examples: [
        '예시 1) 엄마에게: 매일 아침 밥을 차려주시는 엄마, 그 시간들이 저를 행복하게 해요.',
        '예시 2) 친구에게: 함께 놀고 웃었던 시간들이 너를 특별하게 만들었어.',
        '예시 3) 강아지에게: 매일 산책하며 보낸 시간이 너를 세상에서 가장 소중한 친구로 만들었어.'
      ]
    }
  },

  /* ===== world1_06 : "지도를 보고 길을 찾아가다" (샘플 데이터) ===== */
  world1_06: {
    labelNo: '06',
    title: '🗺️ 지도를 보고 길을 찾아가다',
    passage: [
      '낯선 장소에 갔을 때 가장 먼저 하는 일은 지도를 확인하는 것입니다. 지도는 <b>방향</b>과 <b>거리</b>를 알려주어 목적지까지 안전하게 도달할 수 있게 합니다.',
      '지도를 읽을 때는 <b>축척</b>, <b>방위표</b>, <b>범례</b> 등을 이해해야 합니다. 이러한 정보를 활용하면 실제 공간에서 길을 찾는 데 큰 도움이 됩니다.',
      '요즘은 스마트폰의 <b>GPS</b> 기능으로 실시간 위치를 확인하며 길을 찾을 수 있지만, 종이 지도를 읽는 능력도 여전히 중요합니다.'
    ],
    vocab: [
      ['방향','동서남북 등 나아가는 쪽'],
      ['거리','두 지점 사이의 길이'],
      ['축척','실제와 지도의 크기 비율'],
      ['방위표','지도에서 방향을 나타내는 표시'],
      ['범례','지도 기호의 의미를 설명한 것'],
      ['GPS','위성을 이용한 위치 확인 시스템'],
      ['실시간','바로 지금 이 순간'],
      ['목적지','가고자 하는 곳'],
      ['경로','출발지에서 목적지까지의 길']
    ],
    vocabFill: {
      instructions: '[지도 읽기 어휘]',
      items: [
        { no: 1, text: '동서남북 등 나아가는 쪽을 (      )이라고 한다.', answer: '방향', initials: 'ㅂㅎ', aliases: ['방향'] },
        { no: 2, text: '두 지점 사이의 길이를 (      )라고 한다.', answer: '거리', initials: 'ㄱㄹ', aliases: ['거리'] },
        { no: 3, text: '실제와 지도의 크기 비율을 (      )이라 한다.', answer: '축척', initials: 'ㅊㅊ', aliases: ['축척'] },
        { no: 4, text: '지도에서 방향을 나타내는 표시를 (      )라 한다.', answer: '방위표', initials: 'ㅂㅇㅍ', aliases: ['방위표'] },
        { no: 5, text: '지도 기호의 의미를 설명한 것을 (      )라 한다.', answer: '범례', initials: 'ㅂㄹ', aliases: ['범례'] },
        { no: 6, text: '위성을 이용한 위치 확인 시스템을 (   )라 한다.', answer: 'GPS', initials: 'ㅈㅍㅅ', aliases: ['GPS','지피에스'] },
        { no: 7, text: '바로 지금 이 순간을 (      )이라고 한다.', answer: '실시간', initials: 'ㅅㅅㄱ', aliases: ['실시간'] },
        { no: 8, text: '가고자 하는 곳을 (      )라고 한다.', answer: '목적지', initials: 'ㅁㅈㅈ', aliases: ['목적지'] },
        { no: 9, text: '출발지에서 목적지까지의 길을 (      )라고 한다.', answer: '경로', initials: 'ㄱㄹ', aliases: ['경로'] }
      ]
    },
    quiz: {
      q1_text: '지도를 읽을 때 가장 중요한 요소는 무엇인가요?',
      q1_opts: ['① 지도의 색깔', '② 축척, 방위표, 범례', '③ 지도의 크기', '④ 지도를 만든 사람'],
      q2_text: 'GPS의 장점은 무엇인가요?',
      q2_opts: ['① 종이가 필요 없다', '② 실시간으로 위치를 확인할 수 있다', '③ 배터리가 필요 없다', '④ 항상 정확하다'],
      q3_1_ph: 'ㅊㅊ', q3_2_ph: 'ㅂㅇㅍ',
      q4_1_ph: 'ㅈㅍㅅ', q4_2_ph: 'ㅅㅅㄱ',
      q5_text: '종이 지도와 디지털 지도의 장단점을 비교하여 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['축척'], q3_2:['방위표'], q4_1:['GPS','지피에스'], q4_2:['실시간'] },
    essayKeywords: ['지도','종이','디지털','GPS','장점','단점'],
    explain: {
      q1:'해설: 축척, 방위표, 범례는 지도 읽기의 핵심 요소.',
      q2:'해설: GPS는 실시간 위치 확인이 가능함.',
      q3:'해설: 축척으로 거리를, 방위표로 방향을 알 수 있음.',
      q4:'해설: GPS는 실시간 위치 추적 가능.',
      q5:'예시: 종이 지도는 배터리 불필요, 디지털은 실시간 업데이트 가능.'
    }
  },

  /* ===== world1_07 : "세계 여러 나라의 위치와 특징" (샘플 데이터) ===== */
  world1_07: {
    labelNo: '07',
    title: '🌍 세계 여러 나라의 위치와 특징',
    passage: [
      '지구에는 약 200개가 넘는 나라가 있으며, 각 나라는 고유한 <b>지리적 위치</b>와 <b>문화</b>를 가지고 있습니다.',
      '나라의 위치는 그 나라의 <b>기후</b>, <b>산업</b>, <b>생활 방식</b>에 큰 영향을 미칩니다. 예를 들어 적도 근처 나라는 더운 날씨, 북극 근처 나라는 추운 날씨를 보입니다.',
      '세계 지도를 통해 각 나라의 위치를 파악하고, 그 특징을 이해하는 것은 <b>국제 이해</b>의 첫걸음입니다.'
    ],
    vocab: [
      ['지리적 위치','지구상에서 특정 지점이 있는 자리'],
      ['문화','한 사회의 생활 양식과 전통'],
      ['기후','어떤 지역의 평균적인 날씨'],
      ['산업','물건을 만들거나 서비스를 제공하는 일'],
      ['생활 방식','사람들이 살아가는 방법'],
      ['적도','지구의 중심을 가로지르는 가상의 선'],
      ['국제 이해','여러 나라를 이해하고 존중하는 태도'],
      ['대륙','지구를 이루는 큰 땅덩어리'],
      ['해양','지구를 둘러싼 넓은 바다']
    ],
    vocabFill: {
      instructions: '[세계 지리 어휘]',
      items: [
        { no: 1, text: '지구상에서 특정 지점이 있는 자리를 (        )라고 한다.', answer: '지리적 위치', initials: 'ㅈㄹㅈ ㅇㅊ', aliases: ['지리적위치'] },
        { no: 2, text: '한 사회의 생활 양식과 전통을 (      )라고 한다.', answer: '문화', initials: 'ㅁㅎ', aliases: ['문화'] },
        { no: 3, text: '어떤 지역의 평균적인 날씨를 (      )라고 한다.', answer: '기후', initials: 'ㄱㅎ', aliases: ['기후'] },
        { no: 4, text: '물건을 만들거나 서비스를 제공하는 일을 (      )이라 한다.', answer: '산업', initials: 'ㅅㅇ', aliases: ['산업'] },
        { no: 5, text: '사람들이 살아가는 방법을 (        )이라 한다.', answer: '생활 방식', initials: 'ㅅㅎ ㅂㅅ', aliases: ['생활방식'] },
        { no: 6, text: '지구의 중심을 가로지르는 가상의 선을 (      )라 한다.', answer: '적도', initials: 'ㅈㄷ', aliases: ['적도'] },
        { no: 7, text: '여러 나라를 이해하고 존중하는 태도를 (        )라 한다.', answer: '국제 이해', initials: 'ㄱㅈ ㅇㅎ', aliases: ['국제이해'] },
        { no: 8, text: '지구를 이루는 큰 땅덩어리를 (      )라고 한다.', answer: '대륙', initials: 'ㄷㄹ', aliases: ['대륙'] },
        { no: 9, text: '지구를 둘러싼 넓은 바다를 (      )라고 한다.', answer: '해양', initials: 'ㅎㅇ', aliases: ['해양'] }
      ]
    },
    quiz: {
      q1_text: '나라의 위치가 그 나라에 미치는 영향으로 가장 알맞은 것은?',
      q1_opts: ['① 위치는 기후와 산업에 영향을 준다', '② 위치는 아무 영향이 없다', '③ 위치는 문화와 무관하다', '④ 모든 나라의 위치는 같다'],
      q2_text: '국제 이해가 중요한 이유는 무엇인가요?',
      q2_opts: ['① 다른 나라를 비판하기 위해', '② 여러 나라를 이해하고 존중하기 위해', '③ 우리나라만 발전시키기 위해', '④ 세계 지도를 외우기 위해'],
      q3_1_ph: 'ㄱㅎ', q3_2_ph: 'ㅅㅇ',
      q4_1_ph: 'ㅈㄷ', q4_2_ph: 'ㄷㄹ',
      q5_text: '세계 여러 나라의 위치를 아는 것이 왜 중요한지 설명해 보세요.'
    },
    answerKey: { q1:'1', q2:'2', q3_1:['기후'], q3_2:['산업'], q4_1:['적도'], q4_2:['대륙'] },
    essayKeywords: ['세계','나라','위치','이해','기후','문화'],
    explain: {
      q1:'해설: 위치는 기후, 산업, 생활 방식에 영향을 미침.',
      q2:'해설: 국제 이해는 다양성 존중의 기초.',
      q3:'해설: 위치에 따라 기후와 산업이 달라짐.',
      q4:'해설: 적도 근처는 더운 기후, 대륙별로 특징 다름.',
      q5:'예시: 각 나라의 문화와 생활을 이해하고 존중하기 위해 필요함.'
    }
  },

  /* ===== world1_08 : "우리나라의 지리적 특성 이해하기" (샘플 데이터) ===== */
  world1_08: {
    labelNo: '08',
    title: '🇰🇷 우리나라의 지리적 특성 이해하기',
    passage: [
      '우리나라는 <b>한반도</b>에 위치하며, 삼면이 바다로 둘러싸여 있습니다. <b>동해</b>, <b>서해</b>, <b>남해</b>가 각각 다른 특징을 가지고 있습니다.',
      '국토의 약 70%가 산지로 이루어져 있어 <b>산악 지형</b>이 발달했습니다. 이로 인해 계곡과 분지가 많으며, 평야는 주로 서해안에 분포합니다.',
      '우리나라는 <b>사계절</b>이 뚜렷하여 계절마다 다른 풍경과 생활 모습을 보입니다.'
    ],
    vocab: [
      ['한반도','우리나라가 위치한 반도'],
      ['동해','한반도 동쪽의 바다'],
      ['서해','한반도 서쪽의 바다'],
      ['남해','한반도 남쪽의 바다'],
      ['산악 지형','산이 많은 땅의 모양'],
      ['평야','넓고 평평한 땅'],
      ['사계절','봄, 여름, 가을, 겨울'],
      ['계곡','산과 산 사이의 골짜기'],
      ['분지','주위가 산으로 둘러싸인 평지']
    ],
    vocabFill: {
      instructions: '[우리나라 지리 어휘]',
      items: [
        { no: 1, text: '우리나라가 위치한 반도를 (      )라고 한다.', answer: '한반도', initials: 'ㅎㅂㄷ', aliases: ['한반도'] },
        { no: 2, text: '한반도 동쪽의 바다를 (      )라고 한다.', answer: '동해', initials: 'ㄷㅎ', aliases: ['동해'] },
        { no: 3, text: '한반도 서쪽의 바다를 (      )라고 한다.', answer: '서해', initials: 'ㅅㅎ', aliases: ['서해'] },
        { no: 4, text: '한반도 남쪽의 바다를 (      )라고 한다.', answer: '남해', initials: 'ㄴㅎ', aliases: ['남해'] },
        { no: 5, text: '산이 많은 땅의 모양을 (        )이라 한다.', answer: '산악 지형', initials: 'ㅅㅇ ㅈㅎ', aliases: ['산악지형'] },
        { no: 6, text: '넓고 평평한 땅을 (      )라고 한다.', answer: '평야', initials: 'ㅍㅇ', aliases: ['평야'] },
        { no: 7, text: '봄, 여름, 가을, 겨울을 (      )이라 한다.', answer: '사계절', initials: 'ㅅㄱㅈ', aliases: ['사계절'] },
        { no: 8, text: '산과 산 사이의 골짜기를 (      )라고 한다.', answer: '계곡', initials: 'ㄱㄱ', aliases: ['계곡'] },
        { no: 9, text: '주위가 산으로 둘러싸인 평지를 (      )라고 한다.', answer: '분지', initials: 'ㅂㅈ', aliases: ['분지'] }
      ]
    },
    quiz: {
      q1_text: '우리나라의 지리적 특징으로 가장 알맞은 것은?',
      q1_opts: ['① 사면이 바다로 둘러싸임', '② 삼면이 바다, 산지 많음', '③ 평야만 있음', '④ 사막이 많음'],
      q2_text: '사계절이 뚜렷한 이유는 무엇인가요?',
      q2_opts: ['① 위도와 기후의 영향', '② 바다가 많아서', '③ 산이 많아서', '④ 인구가 많아서'],
      q3_1_ph: 'ㅎㅂㄷ', q3_2_ph: 'ㅅㅇ ㅈㅎ',
      q4_1_ph: 'ㅅㄱㅈ', q4_2_ph: 'ㅍㅇ',
      q5_text: '우리나라의 지리적 특징이 우리 생활에 미치는 영향을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'1', q3_1:['한반도'], q3_2:['산악지형','산악 지형'], q4_1:['사계절'], q4_2:['평야'] },
    essayKeywords: ['한반도','산','바다','사계절','평야','생활'],
    explain: {
      q1:'해설: 삼면이 바다, 국토의 70%가 산지.',
      q2:'해설: 위도와 기후의 영향으로 사계절 뚜렷.',
      q3:'해설: 한반도는 산악 지형이 발달.',
      q4:'해설: 사계절과 평야가 농업에 영향.',
      q5:'예시: 산지는 등산 문화, 바다는 어업, 사계절은 다양한 계절 행사.'
    }
  },

  /* ===== world1_09 : "자연재해와 인간의 대응" (샘플 데이터) ===== */
  world1_09: {
    labelNo: '09',
    title: '⚠️ 자연재해와 인간의 대응',
    passage: [
      '자연재해는 <b>지진</b>, <b>태풍</b>, <b>홍수</b>, <b>가뭄</b> 등 자연 현상으로 인해 발생하는 피해를 말합니다.',
      '이러한 재해는 인간의 생명과 재산에 큰 피해를 주지만, 사전에 철저히 <b>대비</b>하고 <b>대응</b>하면 피해를 줄일 수 있습니다.',
      '최근에는 <b>재해 예측 시스템</b>과 <b>대피 훈련</b>을 통해 피해를 최소화하려는 노력이 이루어지고 있습니다.'
    ],
    vocab: [
      ['자연재해','자연 현상으로 인한 큰 피해'],
      ['지진','땅이 흔들리는 현상'],
      ['태풍','강한 바람과 비를 동반하는 열대 저기압'],
      ['홍수','물이 넘쳐 피해를 주는 현상'],
      ['가뭄','오랫동안 비가 오지 않는 현상'],
      ['대비','미리 준비하는 것'],
      ['대응','상황에 맞게 행동하는 것'],
      ['재해 예측 시스템','재해를 미리 알려주는 기술'],
      ['대피 훈련','위험 상황에서 안전하게 피하는 연습']
    ],
    vocabFill: {
      instructions: '[자연재해 어휘]',
      items: [
        { no: 1, text: '자연 현상으로 인한 큰 피해를 (        )라고 한다.', answer: '자연재해', initials: 'ㅈㅇ ㅈㅎ', aliases: ['자연재해'] },
        { no: 2, text: '땅이 흔들리는 현상을 (      )이라고 한다.', answer: '지진', initials: 'ㅈㅈ', aliases: ['지진'] },
        { no: 3, text: '강한 바람과 비를 동반하는 열대 저기압을 (      )이라 한다.', answer: '태풍', initials: 'ㅌㅍ', aliases: ['태풍'] },
        { no: 4, text: '물이 넘쳐 피해를 주는 현상을 (      )라고 한다.', answer: '홍수', initials: 'ㅎㅅ', aliases: ['홍수'] },
        { no: 5, text: '오랫동안 비가 오지 않는 현상을 (      )이라 한다.', answer: '가뭄', initials: 'ㄱㅁ', aliases: ['가뭄'] },
        { no: 6, text: '미리 준비하는 것을 (      )라고 한다.', answer: '대비', initials: 'ㄷㅂ', aliases: ['대비'] },
        { no: 7, text: '상황에 맞게 행동하는 것을 (      )라고 한다.', answer: '대응', initials: 'ㄷㅇ', aliases: ['대응'] },
        { no: 8, text: '재해를 미리 알려주는 기술을 (            )이라 한다.', answer: '재해 예측 시스템', initials: 'ㅈㅎ ㅇㅊ ㅅㅅㅌ', aliases: ['재해예측시스템'] },
        { no: 9, text: '위험 상황에서 안전하게 피하는 연습을 (        )이라 한다.', answer: '대피 훈련', initials: 'ㄷㅍ ㅎㄹ', aliases: ['대피훈련'] }
      ]
    },
    quiz: {
      q1_text: '자연재해 피해를 줄이는 방법으로 가장 알맞은 것은?',
      q1_opts: ['① 아무것도 하지 않기', '② 사전 대비와 대응', '③ 재해 후에만 행동', '④ 무조건 피하기'],
      q2_text: '대피 훈련이 중요한 이유는 무엇인가요?',
      q2_opts: ['① 재미있어서', '② 위험 상황에서 빠르게 대응하기 위해', '③ 시간을 보내기 위해', '④ 법으로 정해져서'],
      q3_1_ph: 'ㅈㅈ', q3_2_ph: 'ㅌㅍ',
      q4_1_ph: 'ㄷㅂ', q4_2_ph: 'ㄷㅇ',
      q5_text: '자연재해가 발생했을 때 우리가 해야 할 행동을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['지진'], q3_2:['태풍'], q4_1:['대비'], q4_2:['대응'] },
    essayKeywords: ['재해','대비','대응','안전','대피','예방'],
    explain: {
      q1:'해설: 사전 대비와 신속한 대응이 피해를 줄임.',
      q2:'해설: 대피 훈련은 실제 상황에서 생명을 구함.',
      q3:'해설: 지진, 태풍 등 다양한 자연재해 존재.',
      q4:'해설: 미리 대비하고 상황에 맞게 대응해야 함.',
      q5:'예시: 안전한 곳으로 대피하고, 긴급 연락망을 확인하며, 침착하게 행동.'
    }
  },

  /* ===== world1_10 : "환경 문제와 지속 가능한 발전" (샘플 데이터) ===== */
  world1_10: {
    labelNo: '10',
    title: '🌱 환경 문제와 지속 가능한 발전',
    passage: [
      '현대 사회는 <b>환경 오염</b>, <b>지구 온난화</b>, <b>생물 다양성 감소</b> 등 심각한 환경 문제에 직면해 있습니다.',
      '이러한 문제를 해결하기 위해서는 <b>재생 에너지</b> 사용, <b>재활용</b>, <b>탄소 배출 감소</b> 등의 노력이 필요합니다.',
      '<b>지속 가능한 발전</b>은 현재 세대의 필요를 충족하면서도 미래 세대의 환경을 보호하는 것을 의미합니다.'
    ],
    vocab: [
      ['환경 오염','공기, 물, 토양이 더러워지는 것'],
      ['지구 온난화','지구의 평균 기온이 높아지는 현상'],
      ['생물 다양성','여러 종류의 생물이 존재하는 것'],
      ['재생 에너지','다시 만들어 쓸 수 있는 에너지'],
      ['재활용','쓴 물건을 다시 사용하는 것'],
      ['탄소 배출','이산화탄소를 내보내는 것'],
      ['지속 가능한 발전','미래를 위한 균형 잡힌 발전'],
      ['온실가스','지구를 덥게 만드는 기체'],
      ['친환경','환경을 보호하는']
    ],
    vocabFill: {
      instructions: '[환경과 발전 어휘]',
      items: [
        { no: 1, text: '공기, 물, 토양이 더러워지는 것을 (        )이라 한다.', answer: '환경 오염', initials: 'ㅎㄱ ㅇㅇ', aliases: ['환경오염'] },
        { no: 2, text: '지구의 평균 기온이 높아지는 현상을 (          )이라 한다.', answer: '지구 온난화', initials: 'ㅈㄱ ㅇㄴㅎ', aliases: ['지구온난화'] },
        { no: 3, text: '여러 종류의 생물이 존재하는 것을 (          )이라 한다.', answer: '생물 다양성', initials: 'ㅅㅁ ㄷㅇㅅ', aliases: ['생물다양성'] },
        { no: 4, text: '다시 만들어 쓸 수 있는 에너지를 (        )라 한다.', answer: '재생 에너지', initials: 'ㅈㅅ ㅇㄴㅈ', aliases: ['재생에너지'] },
        { no: 5, text: '쓴 물건을 다시 사용하는 것을 (      )이라 한다.', answer: '재활용', initials: 'ㅈㅎㅇ', aliases: ['재활용'] },
        { no: 6, text: '이산화탄소를 내보내는 것을 (        )이라 한다.', answer: '탄소 배출', initials: 'ㅌㅅ ㅂㅊ', aliases: ['탄소배출'] },
        { no: 7, text: '미래를 위한 균형 잡힌 발전을 (            )이라 한다.', answer: '지속 가능한 발전', initials: 'ㅈㅅ ㄱㄴㅎ ㅂㅈ', aliases: ['지속가능한발전'] },
        { no: 8, text: '지구를 덥게 만드는 기체를 (      )라고 한다.', answer: '온실가스', initials: 'ㅇㅅㄱㅅ', aliases: ['온실가스'] },
        { no: 9, text: '환경을 보호하는 것을 (      )이라고 한다.', answer: '친환경', initials: 'ㅊㅎㄱ', aliases: ['친환경'] }
      ]
    },
    quiz: {
      q1_text: '지속 가능한 발전의 의미로 가장 알맞은 것은?',
      q1_opts: ['① 현재만 생각', '② 미래 세대도 고려', '③ 개발 중단', '④ 환경 파괴'],
      q2_text: '환경 보호를 위해 우리가 할 수 있는 일은?',
      q2_opts: ['① 일회용품 많이 쓰기', '② 재활용하기', '③ 에너지 낭비', '④ 쓰레기 버리기'],
      q3_1_ph: 'ㅎㄱ ㅇㅇ', q3_2_ph: 'ㅈㄱ ㅇㄴㅎ',
      q4_1_ph: 'ㅈㅎㅇ', q4_2_ph: 'ㅈㅅ ㅇㄴㅈ',
      q5_text: '지속 가능한 발전을 위해 개인이 실천할 수 있는 방법을 설명해 보세요.'
    },
    answerKey: { q1:'2', q2:'2', q3_1:['환경오염','환경 오염'], q3_2:['지구온난화','지구 온난화'], q4_1:['재활용'], q4_2:['재생에너지','재생 에너지'] },
    essayKeywords: ['환경','재활용','에너지','탄소','지속','실천'],
    explain: {
      q1:'해설: 지속 가능한 발전은 미래 세대를 고려한 균형 발전.',
      q2:'해설: 재활용은 환경 보호의 기본 실천.',
      q3:'해설: 환경 오염과 지구 온난화는 현대의 주요 문제.',
      q4:'해설: 재활용과 재생 에너지가 핵심 해결책.',
      q5:'예시: 일회용품 줄이기, 분리수거, 대중교통 이용, 에너지 절약.'
    }
  },

  /* ===== world1_11 ~ world1_20 샘플 데이터 (더 간략하게) ===== */

  world1_11: {
    labelNo: '11',
    title: '🏙️ 도시와 농촌의 차이',
    passage: ['도시는 인구가 많고 다양한 산업이 발달한 곳입니다.','농촌은 자연과 가까우며 농업이 중심입니다.','각각의 특징을 이해하고 조화롭게 발전해야 합니다.'],
    vocab: [['도시','인구와 시설이 밀집한 곳'],['농촌','농업 중심의 시골 지역'],['인구 밀집','사람이 많이 모여 사는 것'],['산업','생산과 서비스 활동'],['농업','농사를 짓는 일'],['교통','이동 수단과 시스템'],['인프라','기반 시설'],['생활 환경','사람들이 사는 조건'],['조화','균형 있게 어울림']],
    vocabFill: { instructions: '[도시와 농촌]', items: [
      {no:1,text:'인구와 시설이 밀집한 곳을 (   )라고 한다.',answer:'도시',initials:'ㄷㅅ',aliases:['도시']},
      {no:2,text:'농업 중심의 시골 지역을 (   )이라 한다.',answer:'농촌',initials:'ㄴㅊ',aliases:['농촌']},
      {no:3,text:'사람이 많이 모여 사는 것을 (      )이라 한다.',answer:'인구 밀집',initials:'ㅇㄱ ㅁㅈ',aliases:['인구밀집']},
      {no:4,text:'생산과 서비스 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:5,text:'농사를 짓는 일을 (   )이라 한다.',answer:'농업',initials:'ㄴㅇ',aliases:['농업']},
      {no:6,text:'이동 수단과 시스템을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:7,text:'기반 시설을 (     )라고 한다.',answer:'인프라',initials:'ㅇㅍㄹ',aliases:['인프라']},
      {no:8,text:'사람들이 사는 조건을 (      )이라 한다.',answer:'생활 환경',initials:'ㅅㅎ ㅎㄱ',aliases:['생활환경']},
      {no:9,text:'균형 있게 어울림을 (   )라고 한다.',answer:'조화',initials:'ㅈㅎ',aliases:['조화']}
    ]},
    quiz: {q1_text:'도시의 특징은?',q1_opts:['① 인구 많음','② 인구 적음','③ 농업만','④ 시설 없음'],q2_text:'농촌의 장점은?',q2_opts:['① 자연과 가까움','② 시설 많음','③ 인구 많음','④ 공기 나쁨'],q3_1_ph:'ㄷㅅ',q3_2_ph:'ㄴㅊ',q4_1_ph:'ㅅㅇ',q4_2_ph:'ㄴㅇ',q5_text:'도시와 농촌이 조화롭게 발전하려면 어떻게 해야 할까요?'},
    answerKey: {q1:'1',q2:'1',q3_1:['도시'],q3_2:['농촌'],q4_1:['산업'],q4_2:['농업']},
    essayKeywords: ['도시','농촌','조화','발전','균형'],
    explain: {q1:'해설: 도시는 인구와 시설이 밀집.',q2:'해설: 농촌은 자연환경이 좋음.',q3:'해설: 도시와 농촌 각각의 특징.',q4:'해설: 도시=산업, 농촌=농업.',q5:'예시: 상호 교류와 균형 발전 필요.'}
  },

  world1_12: {
    labelNo: '12',
    title: '🚄 교통과 통신의 발달',
    passage: ['교통은 사람과 물건을 옮기는 수단입니다.','통신은 정보를 주고받는 방법입니다.','둘 다 현대 사회를 연결하는 중요한 역할을 합니다.'],
    vocab: [['교통','이동 수단'],['통신','정보 전달'],['발달','발전하여 나아감'],['연결','이어 붙임'],['정보','알아야 할 내용'],['수단','방법이나 도구'],['네트워크','연결망'],['기술','과학적 방법'],['현대','지금의 시대']],
    vocabFill: { instructions: '[교통과 통신]', items: [
      {no:1,text:'이동 수단을 (   )이라 한다.',answer:'교통',initials:'ㄱㅌ',aliases:['교통']},
      {no:2,text:'정보 전달을 (   )이라 한다.',answer:'통신',initials:'ㅌㅅ',aliases:['통신']},
      {no:3,text:'발전하여 나아감을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:4,text:'이어 붙임을 (   )이라 한다.',answer:'연결',initials:'ㅇㄱ',aliases:['연결']},
      {no:5,text:'알아야 할 내용을 (   )이라 한다.',answer:'정보',initials:'ㅈㅂ',aliases:['정보']},
      {no:6,text:'방법이나 도구를 (   )이라 한다.',answer:'수단',initials:'ㅅㄷ',aliases:['수단']},
      {no:7,text:'연결망을 (     )라고 한다.',answer:'네트워크',initials:'ㄴㅌㅇㅋ',aliases:['네트워크']},
      {no:8,text:'과학적 방법을 (   )이라 한다.',answer:'기술',initials:'ㄱㅅ',aliases:['기술']},
      {no:9,text:'지금의 시대를 (   )라고 한다.',answer:'현대',initials:'ㅎㄷ',aliases:['현대']}
    ]},
    quiz: {q1_text:'교통 발달의 영향은?',q1_opts:['① 이동 빨라짐','② 느려짐','③ 정보만 전달','④ 변화 없음'],q2_text:'통신의 중요성은?',q2_opts:['① 정보 빠르게 전달','② 필요 없음','③ 이동만 가능','④ 느림'],q3_1_ph:'ㄱㅌ',q3_2_ph:'ㅌㅅ',q4_1_ph:'ㅂㄷ',q4_2_ph:'ㄱㅅ',q5_text:'교통과 통신의 발달이 우리 생활에 미친 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['교통'],q3_2:['통신'],q4_1:['발달'],q4_2:['기술']},
    essayKeywords: ['교통','통신','발달','연결','편리','생활'],
    explain: {q1:'해설: 교통 발달로 이동 시간 단축.',q2:'해설: 통신으로 정보 신속 전달.',q3:'해설: 교통과 통신의 정의.',q4:'해설: 기술 발달이 핵심.',q5:'예시: 빠른 이동, 즉각적 정보 교환, 세계화 촉진.'}
  },

  world1_13: {
    labelNo: '13',
    title: '👨‍👩‍👧‍👦 인구 분포와 이동',
    passage: ['인구는 사람들이 사는 지역에 따라 분포가 다릅니다.','일자리와 생활 환경을 찾아 사람들이 이동합니다.','인구 분포와 이동은 지역 발전에 영향을 줍니다.'],
    vocab: [['인구','사람의 수'],['분포','퍼져 있는 상태'],['이동','장소를 옮김'],['도시화','도시로 인구 집중'],['일자리','직업과 고용'],['환경','주변 조건'],['밀도','단위 면적당 수'],['이촌향도','농촌→도시'],['정주','한곳에 머무름']],
    vocabFill: { instructions: '[인구 분포와 이동]', items: [
      {no:1,text:'사람의 수를 (   )라고 한다.',answer:'인구',initials:'ㅇㄱ',aliases:['인구']},
      {no:2,text:'퍼져 있는 상태를 (   )라 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:3,text:'장소를 옮김을 (   )이라 한다.',answer:'이동',initials:'ㅇㄷ',aliases:['이동']},
      {no:4,text:'도시로 인구가 집중되는 것을 (    )라고 한다.',answer:'도시화',initials:'ㄷㅅㅎ',aliases:['도시화']},
      {no:5,text:'직업과 고용을 (    )라고 한다.',answer:'일자리',initials:'ㅇㅈㄹ',aliases:['일자리']},
      {no:6,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:7,text:'단위 면적당 수를 (   )라고 한다.',answer:'밀도',initials:'ㅁㄷ',aliases:['밀도']},
      {no:8,text:'농촌에서 도시로 이동을 (      )라고 한다.',answer:'이촌향도',initials:'ㅇㅊㅎㄷ',aliases:['이촌향도']},
      {no:9,text:'한곳에 머무름을 (   )라고 한다.',answer:'정주',initials:'ㅈㅈ',aliases:['정주']}
    ]},
    quiz: {q1_text:'인구 이동의 주요 원인은?',q1_opts:['① 일자리','② 무관심','③ 강제','④ 여행'],q2_text:'도시화의 문제점은?',q2_opts:['① 인구 집중','② 인구 감소','③ 발전 없음','④ 농업 증가'],q3_1_ph:'ㅇㄱ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅇㄷ',q4_2_ph:'ㄷㅅㅎ',q5_text:'인구 이동이 지역에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['인구'],q3_2:['분포'],q4_1:['이동'],q4_2:['도시화']},
    essayKeywords: ['인구','이동','분포','도시','일자리','영향'],
    explain: {q1:'해설: 일자리를 찾아 이동.',q2:'해설: 도시 인구 집중 문제.',q3:'해설: 인구와 분포 정의.',q4:'해설: 이동과 도시화.',q5:'예시: 도시는 과밀, 농촌은 과소화.'}
  },

  world1_14: {
    labelNo: '14',
    title: '🏭 산업의 발달과 지역 변화',
    passage: ['산업이 발달하면서 지역의 모습이 크게 변했습니다.','공업 지역과 상업 지역이 생겨났습니다.','산업 발달은 경제 성장을 가져오지만 환경 문제도 발생합니다.'],
    vocab: [['산업','생산 활동'],['공업','제품 제조'],['상업','물건 사고파는 일'],['발달','성장하여 발전'],['경제','재화와 서비스'],['지역','특정한 장소'],['성장','커지고 발전'],['환경 문제','자연 훼손'],['균형 발전','골고루 발전']],
    vocabFill: { instructions: '[산업과 지역]', items: [
      {no:1,text:'생산 활동을 (   )이라 한다.',answer:'산업',initials:'ㅅㅇ',aliases:['산업']},
      {no:2,text:'제품 제조를 (   )이라 한다.',answer:'공업',initials:'ㄱㅇ',aliases:['공업']},
      {no:3,text:'물건 사고파는 일을 (   )이라 한다.',answer:'상업',initials:'ㅅㅇ',aliases:['상업']},
      {no:4,text:'성장하여 발전함을 (   )이라 한다.',answer:'발달',initials:'ㅂㄷ',aliases:['발달']},
      {no:5,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:6,text:'특정한 장소를 (   )라고 한다.',answer:'지역',initials:'ㅈㅇ',aliases:['지역']},
      {no:7,text:'커지고 발전함을 (   )이라 한다.',answer:'성장',initials:'ㅅㅈ',aliases:['성장']},
      {no:8,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:9,text:'골고루 발전을 (      )이라 한다.',answer:'균형 발전',initials:'ㄱㅎ ㅂㅈ',aliases:['균형발전']}
    ]},
    quiz: {q1_text:'산업 발달의 긍정적 영향은?',q1_opts:['① 경제 성장','② 환경 파괴','③ 인구 감소','④ 후퇴'],q2_text:'산업 발달의 문제점은?',q2_opts:['① 환경 오염','② 발전 없음','③ 인구 증가','④ 기술 퇴보'],q3_1_ph:'ㅅㅇ',q3_2_ph:'ㄱㅇ',q4_1_ph:'ㄱㅈ',q4_2_ph:'ㅎㄱ',q5_text:'산업 발달이 지역에 미친 변화를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['산업'],q3_2:['공업'],q4_1:['경제'],q4_2:['환경']},
    essayKeywords: ['산업','발달','지역','경제','환경','변화'],
    explain: {q1:'해설: 산업 발달로 경제 성장.',q2:'해설: 환경 오염 발생.',q3:'해설: 산업과 공업.',q4:'해설: 경제와 환경.',q5:'예시: 도시 형성, 일자리 증가, 환경 오염.'}
  },

  world1_15: {
    labelNo: '15',
    title: '🌦️ 세계의 다양한 기후',
    passage: ['세계 각지는 다양한 기후를 가지고 있습니다.','기후는 그 지역의 생활과 문화에 영향을 줍니다.','열대, 온대, 한대 등 기후대가 있습니다.'],
    vocab: [['기후','평균 날씨'],['열대','매우 더운 지역'],['온대','따뜻한 지역'],['한대','매우 추운 지역'],['기후대','기후 구분 영역'],['강수량','비 오는 양'],['기온','공기의 온도'],['계절','시간에 따른 날씨 변화'],['영향','결과에 미치는 힘']],
    vocabFill: { instructions: '[세계 기후]', items: [
      {no:1,text:'평균 날씨를 (   )라고 한다.',answer:'기후',initials:'ㄱㅎ',aliases:['기후']},
      {no:2,text:'매우 더운 지역을 (   )라고 한다.',answer:'열대',initials:'ㅇㄷ',aliases:['열대']},
      {no:3,text:'따뜻한 지역을 (   )라고 한다.',answer:'온대',initials:'ㅇㄷ',aliases:['온대']},
      {no:4,text:'매우 추운 지역을 (   )라고 한다.',answer:'한대',initials:'ㅎㄷ',aliases:['한대']},
      {no:5,text:'기후 구분 영역을 (    )라고 한다.',answer:'기후대',initials:'ㄱㅎㄷ',aliases:['기후대']},
      {no:6,text:'비 오는 양을 (    )라고 한다.',answer:'강수량',initials:'ㄱㅅㄹ',aliases:['강수량']},
      {no:7,text:'공기의 온도를 (   )이라 한다.',answer:'기온',initials:'ㄱㅇ',aliases:['기온']},
      {no:8,text:'시간에 따른 날씨 변화를 (   )이라 한다.',answer:'계절',initials:'ㄱㅈ',aliases:['계절']},
      {no:9,text:'결과에 미치는 힘을 (   )이라 한다.',answer:'영향',initials:'ㅇㅎ',aliases:['영향']}
    ]},
    quiz: {q1_text:'기후가 생활에 미치는 영향은?',q1_opts:['① 의식주 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'열대 기후의 특징은?',q2_opts:['① 매우 더움','② 매우 추움','③ 사계절 뚜렷','④ 비 안 옴'],q3_1_ph:'ㄱㅎ',q3_2_ph:'ㅇㄷ',q4_1_ph:'ㄱㅎㄷ',q4_2_ph:'ㄱㅅㄹ',q5_text:'기후가 지역 문화에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['기후'],q3_2:['열대'],q4_1:['기후대'],q4_2:['강수량']},
    essayKeywords: ['기후','열대','온대','한대','생활','문화'],
    explain: {q1:'해설: 기후가 의식주 결정.',q2:'해설: 열대는 매우 더움.',q3:'해설: 기후와 열대.',q4:'해설: 기후대와 강수량.',q5:'예시: 더운 지역은 가벼운 옷, 추운 지역은 두꺼운 옷.'}
  },

  world1_16: {
    labelNo: '16',
    title: '⛏️ 자원의 분포와 이용',
    passage: ['자원은 인간에게 필요한 물질입니다.','석유, 석탄, 광물 등이 있습니다.','자원은 지역마다 분포가 다르며 한정적입니다.'],
    vocab: [['자원','필요한 물질'],['석유','연료 원료'],['석탄','연료 광물'],['광물','땅속 자원'],['분포','퍼진 상태'],['한정적','제한된'],['이용','사용함'],['채굴','캐냄'],['보존','아껴 지킴']],
    vocabFill: { instructions: '[자원 분포와 이용]', items: [
      {no:1,text:'필요한 물질을 (   )이라 한다.',answer:'자원',initials:'ㅈㅇ',aliases:['자원']},
      {no:2,text:'연료 원료를 (   )라고 한다.',answer:'석유',initials:'ㅅㅇ',aliases:['석유']},
      {no:3,text:'연료 광물을 (   )이라 한다.',answer:'석탄',initials:'ㅅㅌ',aliases:['석탄']},
      {no:4,text:'땅속 자원을 (   )이라 한다.',answer:'광물',initials:'ㄱㅁ',aliases:['광물']},
      {no:5,text:'퍼진 상태를 (   )라고 한다.',answer:'분포',initials:'ㅂㅍ',aliases:['분포']},
      {no:6,text:'제한된 것을 (    )이라고 한다.',answer:'한정적',initials:'ㅎㅈㅈ',aliases:['한정적']},
      {no:7,text:'사용함을 (   )이라 한다.',answer:'이용',initials:'ㅇㅇ',aliases:['이용']},
      {no:8,text:'캐냄을 (   )이라 한다.',answer:'채굴',initials:'ㅊㄱ',aliases:['채굴']},
      {no:9,text:'아껴 지킴을 (   )이라 한다.',answer:'보존',initials:'ㅂㅈ',aliases:['보존']}
    ]},
    quiz: {q1_text:'자원이 한정적인 이유는?',q1_opts:['① 다시 안 만들어짐','② 무한함','③ 필요 없음','④ 항상 생김'],q2_text:'자원 보존 방법은?',q2_opts:['① 아껴 쓰기','② 많이 쓰기','③ 버리기','④ 무시하기'],q3_1_ph:'ㅈㅇ',q3_2_ph:'ㅂㅍ',q4_1_ph:'ㅎㅈㅈ',q4_2_ph:'ㅂㅈ',q5_text:'자원을 아껴 써야 하는 이유를 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['자원'],q3_2:['분포'],q4_1:['한정적'],q4_2:['보존']},
    essayKeywords: ['자원','한정','보존','이용','미래'],
    explain: {q1:'해설: 자원은 다시 안 만들어짐.',q2:'해설: 아껴 쓰는 것이 보존.',q3:'해설: 자원과 분포.',q4:'해설: 한정적이므로 보존 필요.',q5:'예시: 미래 세대를 위해 자원 절약 필요.'}
  },

  world1_17: {
    labelNo: '17',
    title: '🎭 문화와 지리적 특성',
    passage: ['지리적 환경은 문화 형성에 영향을 줍니다.','산지, 해안, 평야 등에 따라 다른 문화가 발달합니다.','문화는 지역의 정체성을 만듭니다.'],
    vocab: [['문화','생활 양식'],['지리적','땅과 관련된'],['환경','주변 조건'],['정체성','고유한 특성'],['전통','옛것을 이어옴'],['풍습','관습과 습관'],['의식주','옷,음식,집'],['다양성','여러 가지'],['공존','함께 존재']],
    vocabFill: { instructions: '[문화와 지리]', items: [
      {no:1,text:'생활 양식을 (   )이라 한다.',answer:'문화',initials:'ㅁㅎ',aliases:['문화']},
      {no:2,text:'땅과 관련된 것을 (    )이라고 한다.',answer:'지리적',initials:'ㅈㄹㅈ',aliases:['지리적']},
      {no:3,text:'주변 조건을 (   )이라 한다.',answer:'환경',initials:'ㅎㄱ',aliases:['환경']},
      {no:4,text:'고유한 특성을 (    )이라 한다.',answer:'정체성',initials:'ㅈㅊㅅ',aliases:['정체성']},
      {no:5,text:'옛것을 이어옴을 (   )이라 한다.',answer:'전통',initials:'ㅈㅌ',aliases:['전통']},
      {no:6,text:'관습과 습관을 (   )이라 한다.',answer:'풍습',initials:'ㅍㅅ',aliases:['풍습']},
      {no:7,text:'옷,음식,집을 (    )라고 한다.',answer:'의식주',initials:'ㅇㅅㅈ',aliases:['의식주']},
      {no:8,text:'여러 가지를 (    )라고 한다.',answer:'다양성',initials:'ㄷㅇㅅ',aliases:['다양성']},
      {no:9,text:'함께 존재함을 (   )이라 한다.',answer:'공존',initials:'ㄱㅈ',aliases:['공존']}
    ]},
    quiz: {q1_text:'지리적 환경이 문화에 미치는 영향은?',q1_opts:['① 생활 방식 결정','② 영향 없음','③ 언어만 결정','④ 색깔만 결정'],q2_text:'문화 다양성의 의미는?',q2_opts:['① 여러 문화 존중','② 한 가지만','③ 무시함','④ 통일'],q3_1_ph:'ㅁㅎ',q3_2_ph:'ㅈㄹㅈ',q4_1_ph:'ㅈㅊㅅ',q4_2_ph:'ㄷㅇㅅ',q5_text:'지리적 환경이 문화 형성에 어떤 영향을 주는지 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['문화'],q3_2:['지리적'],q4_1:['정체성'],q4_2:['다양성']},
    essayKeywords: ['문화','지리','환경','다양성','정체성'],
    explain: {q1:'해설: 환경이 생활 방식 결정.',q2:'해설: 다양성은 여러 문화 존중.',q3:'해설: 문화와 지리적.',q4:'해설: 정체성과 다양성.',q5:'예시: 산지는 산림 문화, 해안은 어업 문화 발달.'}
  },

  world1_18: {
    labelNo: '18',
    title: '🌐 국제 무역과 경제 협력',
    passage: ['국가 간 물건을 사고파는 것을 무역이라 합니다.','무역은 경제 발전에 도움을 줍니다.','국제 협력으로 함께 발전할 수 있습니다.'],
    vocab: [['무역','국가 간 거래'],['수출','물건 팔기'],['수입','물건 사기'],['경제','재화와 서비스'],['협력','함께 도움'],['국제','나라 사이'],['발전','성장함'],['교류','주고받음'],['상호 의존','서로 의지']],
    vocabFill: { instructions: '[국제 무역]', items: [
      {no:1,text:'국가 간 거래를 (   )라고 한다.',answer:'무역',initials:'ㅁㅇ',aliases:['무역']},
      {no:2,text:'물건 팔기를 (   )라고 한다.',answer:'수출',initials:'ㅅㅊ',aliases:['수출']},
      {no:3,text:'물건 사기를 (   )라고 한다.',answer:'수입',initials:'ㅅㅇ',aliases:['수입']},
      {no:4,text:'재화와 서비스를 (   )라고 한다.',answer:'경제',initials:'ㄱㅈ',aliases:['경제']},
      {no:5,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:6,text:'나라 사이를 (   )라고 한다.',answer:'국제',initials:'ㄱㅈ',aliases:['국제']},
      {no:7,text:'성장함을 (   )이라 한다.',answer:'발전',initials:'ㅂㅈ',aliases:['발전']},
      {no:8,text:'주고받음을 (   )이라 한다.',answer:'교류',initials:'ㄱㄹ',aliases:['교류']},
      {no:9,text:'서로 의지함을 (      )라고 한다.',answer:'상호 의존',initials:'ㅅㅎ ㅇㅈ',aliases:['상호의존']}
    ]},
    quiz: {q1_text:'무역의 장점은?',q1_opts:['① 경제 성장','② 고립','③ 감소','④ 중단'],q2_text:'국제 협력이 중요한 이유는?',q2_opts:['① 함께 발전','② 경쟁만','③ 단절','④ 무시'],q3_1_ph:'ㅁㅇ',q3_2_ph:'ㅅㅊ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㄱㅈ',q5_text:'국제 무역이 경제에 미치는 영향을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['무역'],q3_2:['수출'],q4_1:['협력'],q4_2:['국제']},
    essayKeywords: ['무역','수출','수입','협력','발전'],
    explain: {q1:'해설: 무역으로 경제 성장.',q2:'해설: 협력으로 함께 발전.',q3:'해설: 무역과 수출.',q4:'해설: 협력과 국제.',q5:'예시: 필요한 물건 교환, 경제 활성화, 상호 발전.'}
  },

  world1_19: {
    labelNo: '19',
    title: '🌏 지구촌 문제와 해결 방안',
    passage: ['지구촌은 전 세계가 하나로 연결된 것입니다.','환경, 빈곤, 전쟁 등 공동 문제가 있습니다.','협력하여 함께 해결해야 합니다.'],
    vocab: [['지구촌','세계가 하나로'],['환경 문제','자연 훼손'],['빈곤','가난한 상태'],['전쟁','무력 충돌'],['해결','문제 풀기'],['협력','함께 도움'],['공동','함께 하는'],['지속 가능','미래도 유지'],['연대','함께 뭉침']],
    vocabFill: { instructions: '[지구촌 문제]', items: [
      {no:1,text:'세계가 하나로 연결된 것을 (    )라고 한다.',answer:'지구촌',initials:'ㅈㄱㅊ',aliases:['지구촌']},
      {no:2,text:'자연 훼손을 (      )이라 한다.',answer:'환경 문제',initials:'ㅎㄱ ㅁㅈ',aliases:['환경문제']},
      {no:3,text:'가난한 상태를 (   )이라 한다.',answer:'빈곤',initials:'ㅂㄱ',aliases:['빈곤']},
      {no:4,text:'무력 충돌을 (   )이라 한다.',answer:'전쟁',initials:'ㅈㅈ',aliases:['전쟁']},
      {no:5,text:'문제 풀기를 (   )이라 한다.',answer:'해결',initials:'ㅎㄱ',aliases:['해결']},
      {no:6,text:'함께 도움을 (   )이라 한다.',answer:'협력',initials:'ㅎㄹ',aliases:['협력']},
      {no:7,text:'함께 하는 것을 (   )이라 한다.',answer:'공동',initials:'ㄱㄷ',aliases:['공동']},
      {no:8,text:'미래도 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'함께 뭉침을 (   )라고 한다.',answer:'연대',initials:'ㅇㄷ',aliases:['연대']}
    ]},
    quiz: {q1_text:'지구촌 문제 해결 방법은?',q1_opts:['① 국제 협력','② 무시','③ 방치','④ 혼자 해결'],q2_text:'지속 가능 발전이 중요한 이유는?',q2_opts:['① 미래 세대 위해','② 현재만','③ 개발만','④ 파괴'],q3_1_ph:'ㅈㄱㅊ',q3_2_ph:'ㅎㄱ ㅁㅈ',q4_1_ph:'ㅎㄹ',q4_2_ph:'ㅎㄱ',q5_text:'지구촌 문제를 해결하기 위해 우리가 할 수 있는 일을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['지구촌'],q3_2:['환경문제','환경 문제'],q4_1:['협력'],q4_2:['해결']},
    essayKeywords: ['지구촌','협력','환경','해결','지속'],
    explain: {q1:'해설: 국제 협력으로 해결.',q2:'해설: 미래 세대를 위해.',q3:'해설: 지구촌과 환경 문제.',q4:'해설: 협력과 해결.',q5:'예시: 환경 보호, 기부, 봉사, 평화 노력.'}
  },

  world1_20: {
    labelNo: '20',
    title: '🔮 미래의 지리적 변화와 전망',
    passage: ['미래에는 기후 변화와 기술 발전이 지리를 바꿀 것입니다.','새로운 도시와 교통 수단이 생길 것입니다.','우리는 미래를 준비하고 대비해야 합니다.'],
    vocab: [['미래','앞으로의 시간'],['전망','예상과 예측'],['변화','달라짐'],['기술 발전','과학 진보'],['기후 변화','날씨 변동'],['대비','준비함'],['예측','미리 짐작'],['지속 가능','미래 유지'],['혁신','새로운 변화']],
    vocabFill: { instructions: '[미래 전망]', items: [
      {no:1,text:'앞으로의 시간을 (   )라고 한다.',answer:'미래',initials:'ㅁㄹ',aliases:['미래']},
      {no:2,text:'예상과 예측을 (   )이라 한다.',answer:'전망',initials:'ㅈㅁ',aliases:['전망']},
      {no:3,text:'달라짐을 (   )이라 한다.',answer:'변화',initials:'ㅂㅎ',aliases:['변화']},
      {no:4,text:'과학 진보를 (      )이라 한다.',answer:'기술 발전',initials:'ㄱㅅ ㅂㅈ',aliases:['기술발전']},
      {no:5,text:'날씨 변동을 (      )이라 한다.',answer:'기후 변화',initials:'ㄱㅎ ㅂㅎ',aliases:['기후변화']},
      {no:6,text:'준비함을 (   )라고 한다.',answer:'대비',initials:'ㄷㅂ',aliases:['대비']},
      {no:7,text:'미리 짐작함을 (   )이라 한다.',answer:'예측',initials:'ㅇㅊ',aliases:['예측']},
      {no:8,text:'미래 유지를 (        )이라 한다.',answer:'지속 가능',initials:'ㅈㅅ ㄱㄴ',aliases:['지속가능']},
      {no:9,text:'새로운 변화를 (   )이라 한다.',answer:'혁신',initials:'ㅎㅅ',aliases:['혁신']}
    ]},
    quiz: {q1_text:'미래 지리 변화의 주요 요인은?',q1_opts:['① 기후·기술','② 변화 없음','③ 과거만','④ 무관심'],q2_text:'미래를 준비하는 방법은?',q2_opts:['① 지속 가능 발전','② 방치','③ 무시','④ 파괴'],q3_1_ph:'ㅁㄹ',q3_2_ph:'ㅂㅎ',q4_1_ph:'ㄱㅅ ㅂㅈ',q4_2_ph:'ㄷㅂ',q5_text:'미래의 지리적 변화를 예측하고 우리가 준비해야 할 것을 설명해 보세요.'},
    answerKey: {q1:'1',q2:'1',q3_1:['미래'],q3_2:['변화'],q4_1:['기술발전','기술 발전'],q4_2:['대비']},
    essayKeywords: ['미래','변화','기술','기후','준비','지속'],
    explain: {q1:'해설: 기후 변화와 기술 발전이 주요 요인.',q2:'해설: 지속 가능한 발전으로 준비.',q3:'해설: 미래와 변화.',q4:'해설: 기술 발전에 대비.',q5:'예시: 환경 보호, 새 기술 학습, 적응력 키우기.'}
  }
});

/* ===============================
   ★ 어휘 빈칸 렌더러 & 탭 이벤트
=================================*/
function getCurrentUnit() {
  return (window.CUR_UNIT || 'world1_01');
}

window.renderVocabFill = function () {
  const unit = window.CUR_UNIT || 'world1_01';
  const pack = window.CONTENTS?.[unit];
  const root = document.getElementById('vocab-fill') 
            || document.querySelector('.vocab-fill-text');

  if (!root || !pack?.vocabFill?.items?.length) {
    console.warn('[vocab] root or items missing:', { root: !!root, unit, items: pack?.vocabFill?.items?.length });
    return;
  }

  const html = (pack.vocabFill.items || []).map(({ no, text, answer, initials }) => {
    const slot = `
      <span class="blank-wrap" data-answer="${answer}">
        <span class="blank-icon">${no}</span>
        <span class="blank-mark"></span>
        <input type="text" class="blank-input" placeholder="${initials || ''}">
      </span>
    `;
    const p = text.replace(/\(\s*[-＿—\u00A0]*\s*\)/, slot);
    return `<p>${p}</p>`;
  }).join('');

  root.innerHTML = `
    <div class="vocab-instruction">${pack.vocabFill.instructions || ''}</div>
    <div class="vocab-inline">${html}</div>
  `;

  (function ensureVocabInlineStyle(){
    if (document.getElementById('vocab-inline-style')) return;
    const st = document.createElement('style');
    st.id = 'vocab-inline-style';
    st.textContent = `
      /* vocab 영역에서만 줄글 처리 */
      .vocab-box .vocab-inline > p { display:inline !important; margin:0 !important; }
      .vocab-box .vocab-inline > p + p::before { content:" "; }

      #vocab-fill .vocab-inline > p,
      .vocab-fill-text .vocab-inline > p { display:inline !important; margin:0 !important; }
      #vocab-fill .vocab-inline > p + p::before,
      .vocab-fill-text .vocab-inline > p + p::before { content:" "; }

      /* 🔶 줄 간격 조정 */
      .vocab-inline { line-height: 5.0 !important; }
    `;
    document.head.appendChild(st);
  })();

  window.reportState = window.reportState || {};
  window.reportState.vocabTotal = pack.vocabFill.items.length;

  // ✅ 어휘 렌더링 직후 상태 복원
  setTimeout(() => {
    // 1. localStorage에서 복원
    if (typeof window.loadVocabState === 'function') {
      window.loadVocabState();
    }
    // 2. 서버 데이터가 있으면 서버 데이터로 복원 (우선순위 높음)
    if (typeof window.restoreVocabFromServerData === 'function') {
      window.restoreVocabFromServerData();
    }
  }, 100);
};

// ✅ 이벤트 리스너 중복 방지를 위한 플래그
let _tabEventsInitialized = false;

function _bindTabEvents() {
  // 이미 초기화되었으면 건너뛰기
  if (_tabEventsInitialized) return;
  _tabEventsInitialized = true;

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-tab]');
    if (!btn) return;
    const tab = btn.getAttribute('data-tab');
    if (tab === 'vocab') renderVocabFill();
  });
}

/* ===== 텍스트 주입 (HTML 구조/ids 유지) ===== */
function applyContentPack(unitKey) {
  console.log('[applyContentPack] 호출됨, unitKey:', unitKey);
  const pack = window.CONTENTS[unitKey];
  if (!pack) {
    console.error('[applyContentPack] pack이 없음! unitKey:', unitKey, 'CONTENTS:', window.CONTENTS);
    return;
  }

  const labelNoEl = document.querySelector('.passage-label strong');
  const titleEl   = document.querySelector('.passage-title');
  if (labelNoEl) labelNoEl.textContent = pack.labelNo;
  if (titleEl)   titleEl.innerHTML = pack.title;

  const passageBox = document.querySelector('.passage-text');
  console.log('[applyContentPack] passageBox:', passageBox, 'pack.passage:', pack.passage);
  if (passageBox) {
    const html = pack.passage.map(p => `<p>${p}</p>`).join('');
    console.log('[applyContentPack] 생성된 HTML 길이:', html.length);
    passageBox.innerHTML = html;
    console.log('[applyContentPack] passageBox.innerHTML 설정 완료');
  }

  const vocabBox = document.querySelector('.passage-vocab ol');
  if (vocabBox)  vocabBox.innerHTML = pack.vocab.map(([w,d]) => `<li><b>${w}</b>: ${d}</li>`).join('');

  const blocks = Array.from(document.querySelectorAll('#tab-reading .quiz-block'));

  // Q1
  if (blocks[0]) {
    const q1Text = blocks[0].querySelector('.quiz-q');
    const q1Lis  = blocks[0].querySelectorAll('.quiz-options li');
    if (q1Text) q1Text.textContent = pack.quiz.q1_text;
    if (q1Lis.length === 4) {
      q1Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q1" value="${i+1}"><span>${pack.quiz.q1_opts[i]}</span></label>`);
    }
  }

  // Q2
  if (blocks[1]) {
    const q2Text = blocks[1].querySelector('.quiz-q');
    const q2Lis  = blocks[1].querySelectorAll('.quiz-options li');
    if (q2Text) q2Text.textContent = pack.quiz.q2_text;
    if (q2Lis.length === 4) {
      q2Lis.forEach((li,i)=> li.innerHTML = `<label><input type="radio" name="q2" value="${i+1}"><span>${pack.quiz.q2_opts[i]}</span></label>`);
    }
  }

  // Q3
  if (blocks[2]) {
    const q3P = blocks[2].querySelector('.quiz-q');
    if (q3P && pack.quiz.q3_html) q3P.innerHTML = pack.quiz.q3_html;
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    if (q3_1 && pack.quiz.q3_1_ph) q3_1.placeholder = pack.quiz.q3_1_ph;
    if (q3_2 && pack.quiz.q3_2_ph) q3_2.placeholder = pack.quiz.q3_2_ph;
  }

  // Q4
  if (blocks[3]) {
    const q4P = blocks[3].querySelector('.quiz-q');
    if (q4P && pack.quiz.q4_html) q4P.innerHTML = pack.quiz.q4_html;
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    if (q4_1 && pack.quiz.q4_1_ph) q4_1.placeholder = pack.quiz.q4_1_ph;
    if (q4_2 && pack.quiz.q4_2_ph) q4_2.placeholder = pack.quiz.q4_2_ph;
  }

  // Q5
  if (blocks[4]) {
    const q5Text = blocks[4].querySelector('.quiz-q');
    if (q5Text && pack.quiz.q5_text) q5Text.textContent = pack.quiz.q5_text;
  }

  // ✅ 모든 콘텐츠 로드 완료 후 로딩 오버레이 숨기기
  requestAnimationFrame(() => {
    const loadingOverlay = document.getElementById('loadingOverlay');
    if (loadingOverlay) {
      // 분석리포트 탭일 경우 1.3초 후에 숨기기
      const unit = window.CUR_UNIT || 'world1_01';
      const savedTab = localStorage.getItem(`current-geo-tab:${unit}`);
      const delay = (savedTab === 'report') ? 1300 : 0;

      setTimeout(() => {
        loadingOverlay.classList.remove('show');
        console.log('[applyContentPack] 로딩 오버레이 숨김 완료');
      }, delay);
    }
  });
}

/* ==== 본문학습 상태 저장/복원 (✅ 학생별 분리 저장) ==== */

/* 🔐 현재 로그인 학생 정보 가져오기 */
function getCurrentStudentForReading() {
  const saved = localStorage.getItem('currentStudent');
  if (!saved) return null;
  try { return JSON.parse(saved); } catch (e) { return null; }
}

/* 🔐 학생키 만들기: 학년_이름_전화숫자 */
function buildStudentKeyForReading(stu) {
  const cleanPhone = (stu.phone || '').replace(/\D/g, '');
  const cleanName  = (stu.name  || '').trim();
  const cleanGrade = (stu.grade || '').trim();
  return `${cleanGrade}_${cleanName}_${cleanPhone}`;
}

// ✅ 현재 로그인한 학생 키를 공용으로 쓰는 함수 (메뉴/단원 페이지 공유)
window.getStudentKey = function () {
  const stu = getCurrentStudent();
  if (!stu) return '';
  return buildStudentKey(stu);   // "학년_이름_전화번호" 형태
};

/* 🔐 단원별 + 학생별 로컬스토리지 키 */
function getReadingStateKey(unit) {
  const stu = getCurrentStudentForReading();
  if (!stu) {
    // 로그인 안 되어 있으면 예전처럼 단원 단독 키 사용
    return `dan-reading-state:${unit}`;
  }
  const studentKey = buildStudentKeyForReading(stu);
  return `dan-reading-state:${studentKey}:${unit}`;
}

function saveReadingState() {
  try {
    const unit = window.CUR_UNIT || 'world1_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키

    const q1   = document.querySelector('input[name="q1"]:checked');
    const q2   = document.querySelector('input[name="q2"]:checked');
    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    const state = {
      graded: true,
      q1:   q1   ? q1.value   : '',
      q2:   q2   ? q2.value   : '',
      q3_1: q3_1 ? q3_1.value : '',
      q3_2: q3_2 ? q3_2.value : '',
      q4_1: q4_1 ? q4_1.value : '',
      q4_2: q4_2 ? q4_2.value : '',
      q5:   q5   ? q5.value   : ''
    };

    localStorage.setItem(key, JSON.stringify(state));
  } catch (e) {
    console.warn('saveReadingState error', e);
  }
}

function loadReadingState() {
  try {
    const unit = window.CUR_UNIT || 'world1_01';
    const key  = getReadingStateKey(unit);   // ✅ 학생별 + 단원별 키
    const raw  = localStorage.getItem(key);
    if (!raw) return;

    const state = JSON.parse(raw);
    if (!state) return;

    if (state.q1) {
      const r1 = document.querySelector(`input[name="q1"][value="${state.q1}"]`);
      if (r1) r1.checked = true;
    }
    if (state.q2) {
      const r2 = document.querySelector(`input[name="q2"][value="${state.q2}"]`);
      if (r2) r2.checked = true;
    }

    const q3_1 = document.getElementById('q3-1');
    const q3_2 = document.getElementById('q3-2');
    const q4_1 = document.getElementById('q4-1');
    const q4_2 = document.getElementById('q4-2');
    const q5   = document.getElementById('q5');

    if (q3_1 && state.q3_1 !== undefined) q3_1.value = state.q3_1;
    if (q3_2 && state.q3_2 !== undefined) q3_2.value = state.q3_2;
    if (q4_1 && state.q4_1 !== undefined) q4_1.value = state.q4_1;
    if (q4_2 && state.q4_2 !== undefined) q4_2.value = state.q4_2;
    if (q5   && state.q5   !== undefined) q5.value   = state.q5;

    if (state.graded && typeof window.gradeQuiz === 'function') {
      setTimeout(() => {
        try { window.gradeQuiz(); } catch (e) {
          console.warn('auto re-grade reading error', e);
        }
      }, 0);
    }
  } catch (e) {
    console.warn('loadReadingState error', e);
  }
}

/* ===== 통합 채점기 ===== */
window.gradeQuiz = function () {
  const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.world1_01;
  const A = pack.answerKey;
  const EX = pack.explain;

  const quizBlocks = document.querySelectorAll('#tab-reading .quiz-block');
  const numLabels = ["01","02","03","04","05"];
  quizBlocks.forEach((block, idx) => {
    const numEl = block.querySelector('.quiz-num');
    if (!numEl) return;
    let markEl = numEl.querySelector('.mark');
    if (!markEl) {
      markEl = document.createElement('div');
      markEl.className = 'mark';
      numEl.appendChild(markEl);
    }
    numEl.textContent = numLabels[idx];
    numEl.appendChild(markEl);
    numEl.classList.remove('correct','wrong');
    markEl.textContent = '';
  });

  let score = 0;
  const totalAuto = 4;
  const shortMsgs = [];
  const fullMsgs = [];

  function norm(s){ return (s||'').toString().replace(/\s+/g,'').toLowerCase(); }
  function mark(idx, ok, label, ex, isEssay=false){
    const num = quizBlocks[idx]?.querySelector('.quiz-num');
    const markEl = num?.querySelector('.mark');
    if (ok) {
      score++;
      num?.classList.add('correct');
      if(markEl) markEl.textContent='⭕';
      shortMsgs.push(`${label} 정답 ✅`);
      fullMsgs.push(`${label} 정답 ✅ ${ex||''}`);
    } else {
      num?.classList.add('wrong');
      if(markEl) markEl.textContent='✖';
      shortMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌`);
      fullMsgs.push(`${label} ${isEssay?'서술형: ':''}오답 ❌ ${ex||''}`);
    }
  }

  // 1
  const q1 = document.querySelector('input[name="q1"]:checked');
  const q1ok = (q1 && q1.value === A.q1);
  mark(0, q1ok, '①', EX.q1);

  // 2
  const q2 = document.querySelector('input[name="q2"]:checked');
  const q2ok = (q2 && q2.value === A.q2);
  mark(1, q2ok, '②', EX.q2);

  // 3
  const q3New = document.getElementById('q3');
  const q3Old1 = document.getElementById('q3-1');
  const q3Old2 = document.getElementById('q3-2');
  const q3Text1 = q3New ? q3New.value.trim() : (q3Old1?.value || '').trim();
  const q3Text2 = q3New ? '' : (q3Old2?.value || '').trim();
  const ok3_1 = A.q3_1.some(a => norm(a) === norm(q3Text1));
  const ok3_2 = A.q3_2 ? A.q3_2.some(a => norm(a) === norm(q3Text2)) : true;
  const q3ok = ok3_1 && ok3_2;
  mark(2, q3ok, '③', EX.q3);

  // 4
  const q4New = document.getElementById('q4');
  const q4Old1 = document.getElementById('q4-1');
  const q4Old2 = document.getElementById('q4-2');
  const q4Text1 = q4New ? q4New.value.trim() : (q4Old1?.value || '').trim();
  const q4Text2 = q4New ? '' : (q4Old2?.value || '').trim();
  const ok4_1 = A.q4_1.some(a => norm(a) === norm(q4Text1));
  const ok4_2 = A.q4_2 ? A.q4_2.some(a => norm(a) === norm(q4Text2)) : true;
  const q4ok = ok4_1 && ok4_2;
  mark(3, q4ok, '④', EX.q4);

  // 5 (서술형)
  const essay = (document.getElementById('q5')?.value || '').trim().toLowerCase();
  const keys = (pack.essayKeywords && Array.isArray(pack.essayKeywords) && pack.essayKeywords.length)
    ? pack.essayKeywords
    : ["등고선","간격","좁","넓","급경사","완만","경사"];
  let hit = 0;
  keys.forEach(k => { if (essay.includes(k)) hit++; });
  const q5ok = essay.length && hit >= 2;
  mark(4, q5ok, '⑤', EX.q5, true);

  const box = document.getElementById('grade-result');
  if (box) {
    box.style.display = 'block';
    box.innerHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + shortMsgs.map(m => `<p>${m}</p>`).join('');
  }
  window.fullResultHTML = `<p><strong>점수: ${score} / ${totalAuto}</strong></p>` + fullMsgs.map(m => `<p>${m}</p>`).join('');

  const g=document.getElementById('grade-btn');
  const r=document.getElementById('reset-btn');
  const s=document.getElementById('submit-btn');
  if (g) g.style.display='inline-block';
  if (r) r.style.display='inline-block';
  if (s) s.style.display='inline-block';

  window.reportState = window.reportState || {};
  window.reportState.q1ok=q1ok;
  window.reportState.q2ok=q2ok;
  window.reportState.q3ok=q3ok;
  window.reportState.q4ok=q4ok;
  window.reportState.q5ok=q5ok;

  if (typeof updateReportPanel==='function') {
    const lexicalRatio = (typeof window.reportState.vocabScoreRatio==='number') ? window.reportState.vocabScoreRatio : 0;
    const lexicalOk = lexicalRatio >= 0.7;
    updateReportPanel({
      q1ok,q2ok,q3ok,q4ok,q5ok,
      messages:[
        "① 핵심 이해력: " + (q1ok?"좋아요! ✅":"보완 필요 ❗"),
        "② 구조 파악력: " + (q2ok?"좋아요! ✅":"보완 필요 ❗"),
        "③ 어휘 맥락력: " + (lexicalOk?"좋아요! ✅":"어휘 복습 필요 ❗"),
        "④ 추론·통합력: " + (q4ok?"좋아요! ✅":"보완 필요 ❗"),
        "⑤ 비판·적용력: " + (q5ok?"좋아요! ✅":"보완 필요 ❗")
      ]
    });
  }

  // ✅ 레이더 점수 객체로 빼두기
  const radarScores = {
    literal:     q1ok ? 10 : 6,
    structural:  q2ok ? 10 : 6,
    lexical:     q3ok ? 10 : 6,
    inferential: q4ok ? 10 : 6,
    critical:    q5ok ? 10 : 6
  };

  // ✅ 서버로 보낼 마지막 레이더 점수 기억해 두기 (전역)
  window._lastRadar = radarScores;

  // ✅ 화면 레이더 차트 그리기
  if (typeof updateRadarChart === 'function') {
    updateRadarChart(radarScores);
  }
  if (typeof drawRadarChart === 'function') {
    drawRadarChart(radarScores);
  }

  // ✅ 서버 로그용으로도 보관 (옵션)
  window.reportState = window.reportState || {};
  window.reportState.radarScores = radarScores;

  if (typeof saveReadingState === 'function') {
    saveReadingState();
  }
};

/* === 정답·해설 패널 렌더러 === */
function renderSolutions(pack) {
  const A = pack.answerKey, EX = pack.explain;
  const q1Text = pack.quiz.q1_opts[Number(A.q1) - 1] || '';
  const q2Text = pack.quiz.q2_opts[Number(A.q2) - 1] || '';

  // grade-result (점수 박스) 안의 하단에 해설 추가
  const gradeResult = document.getElementById('grade-result');
  if (!gradeResult) return;

  // 기존 solutions-box가 있으면 제거
  let box = document.getElementById('solutions-box');
  if (box) box.remove();

  // 새로운 solutions-box를 grade-result 내부 하단에 추가
  box = document.createElement('div');
  box.id = 'solutions-box';
  box.style.marginTop = '16px';
  box.style.paddingTop = '12px';
  box.style.borderTop = '1px dashed #e5d4c1';
  box.style.lineHeight = '1.6';

  box.innerHTML = `
    <h3 style="margin:0 0 10px; font-size:16px; color:#8b2f2f;">정답 · 해설</h3>
    <ol style="margin:0; padding-left:18px;">
      <li style="margin-bottom:8px;">
        <b>① 정답:</b> ${A.q1} — ${q1Text}<br>
        <span style="color:#6b5a48;">${EX.q1 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>② 정답:</b> ${A.q2} — ${q2Text}<br>
        <span style="color:#6b5a48;">${EX.q2 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>③ 정답(두 칸):</b> ${Array.isArray(A.q3_1)?A.q3_1[0]:A.q3_1} / ${Array.isArray(A.q3_2)?A.q3_2[0]:A.q3_2}<br>
        <span style="color:#6b5a48;">${EX.q3 || ''}</span>
      </li>
      <li style="margin-bottom:8px;">
        <b>④ 정답(두 칸):</b> ${Array.isArray(A.q4_1)?A.q4_1[0]:A.q4_1} / ${Array.isArray(A.q4_2)?A.q4_2[0]:A.q4_2}<br>
        <span style="color:#6b5a48;">${EX.q4 || ''}</span>
      </li>
      <li>
        <b>⑤ 서술형 예시:</b> <span style="color:#6b5a48;">${EX.q5 || '핵심어 2개 이상 포함 시 정답 처리'}</span>
      </li>
    </ol>
  `;

  // grade-result 내부 하단에 추가
  gradeResult.appendChild(box);
}

/* ========== 공통 진행도 매니저 (단일화 호환) ========== */
window.DanDan = window.DanDan || {};

(function () {
  // 이미 정의돼 있으면 다시 만들지 않기
  if (window.DanDan.ProgressManager) return;

  /* ✅ 단원 감지: world1_01, world1_02 ... */
  function detectUnit() {
    let unitParam = new URLSearchParams(location.search).get('unit');
    if (!unitParam) {
      const m = location.pathname.match(/world1_(\d+)\.html/i);
      if (m) unitParam = `world1_${m[1].padStart(2, '0')}`;
    }
    return (unitParam || (window.CUR_UNIT || 'world1_01')).toLowerCase();
  }

  /* ✅ 학생키: 학년_이름_전화숫자 */
  function buildStudentKey(stu) {
    const cleanPhone = (stu.phone || '').replace(/\D/g, '');
    const cleanName  = (stu.name  || '').trim();
    const cleanGrade = (stu.grade || '').trim();
    return `${cleanGrade}_${cleanName}_${cleanPhone}`;
  }

  /* ✅ 현재 로그인 학생 */
  function getCurrentStudent() {
    const saved = localStorage.getItem('currentStudent');
    if (!saved) return null;
    try { return JSON.parse(saved); } catch { return null; }
  }

  /* ✅ 특정 학생 + 단원 기준 진행도 key 만들기
     → dan-progress:학년_이름_전화:world1_04 */
  function buildProgressKey(stu, unit) {
    const studentKey = buildStudentKey(stu);
    return `dan-progress:${studentKey}:${unit}`;
  }

  /* ✅ 현재 학생의 완료된 단원 목록 읽기 */
  function readDoneList() {
    const stu = getCurrentStudent();
    if (!stu) return { keyPrefix: null, list: [] };

    const unitList = [];
    const studentKey = buildStudentKey(stu);
    const prefix = `dan-progress:${studentKey}:`; // 단원별 prefix

    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (!k || !k.startsWith(prefix)) continue;
      const unit = k.slice(prefix.length);  // world1_01, world1_02 ...
      const val  = localStorage.getItem(k);
      if (val) unitList.push(unit);
    }
    return { keyPrefix: prefix, list: unitList };
  }

  const ProgressManager = {
    /* 현재 단원 unit (world1_01 등) */
    getUnit: detectUnit,

    /* ✅ 이 단원을 "학습완료"로 표시 */
    markComplete() {
      const stu  = getCurrentStudent();
      if (!stu) return null;

      const unit = detectUnit();                  // world1_41
      const key  = buildProgressKey(stu, unit);   // dan-progress:학생키:world1_41

      // ✅ menu.html과 호환되게 배열 형식으로 저장
      const pageKey = `BRAINUP_worldlit_${unit}`;
      let saved = [];
      try {
        const existing = localStorage.getItem(key);
        if (existing) saved = JSON.parse(existing);
        if (!Array.isArray(saved)) saved = [];
      } catch(e) { saved = []; }
      if (!saved.includes(pageKey)) saved.push(pageKey);
      localStorage.setItem(key, JSON.stringify(saved));
      return key;
    },

    /* ✅ 이 단원이 완료됐는지 확인 */
    isCompleted(unitOptional) {
      const stu = getCurrentStudent();
      if (!stu) return false;
      const unit = (unitOptional || detectUnit());
      const key  = buildProgressKey(stu, unit);
      return !!localStorage.getItem(key);
    },

    /* ✅ 현재 학생의 완료 단원 리스트 얻기 (world1_01, world1_03 ...) */
    getStudentProgress() {
      return readDoneList();   // { keyPrefix, list }
    }
  };

  window.DanDan.ProgressManager = ProgressManager;

  /* ✅ 제출하기 훅: 완료처리 + 로그 전송 */
  (function hookSubmitReport() {
    const original = window.submitReport;

    window.submitReport = async function (...args) {
      const stu = getCurrentStudent();
      if (!stu) {
        alert('로그인한 학생 정보가 없습니다. 먼저 로그인 해주세요.');
        return;
      }

      // 1) 기존 제출 로직(PDF 등) 실행
      if (typeof original === 'function') {
        await original.apply(this, args);
      } else if (typeof window.captureElementToPDF === 'function') {
        await captureElementToPDF(
          'capture-report',
          '단단국어_분석리포트.pdf',
          { withStudentInfo: true }
        );
      }

      // 2) ✅ 진행도: 학생 + 단원 기준으로 학습완료 저장
      const key = ProgressManager.markComplete();

      if (typeof window.showSubmitSuccess === 'function') {
        showSubmitSuccess('분석리포트');
      } else {
        console.log(`학습완료 처리됨: ${key}`);
      }

      // 3) 서버 학습 이력 로그
      if (typeof window.sendLearningLog === 'function') {
        try {
          await window.sendLearningLog();
        } catch (e) {
          console.warn('[submitReport] sendLearningLog 실패', e);
        }
      }
    };
  })();
})();

/* ===========================
 * ✅ 창의활동 제출 → PDF 내보내기
 *   textarea 전체 내용을 div로 복사해서 캡처
 * =========================== */
window.submitCreative = async function () {
  const textarea   = document.getElementById('creative-input');
  const renderBox  = document.getElementById('creative-render');
  const captureBox = document.getElementById('capture-creative');

  if (!textarea || !renderBox || !captureBox) {
    console.warn('[submitCreative] 요소를 찾을 수 없음', {
      textarea: !!textarea,
      renderBox: !!renderBox,
      captureBox: !!captureBox,
    });
    alert('창의활동 영역을 찾을 수 없습니다.');
    return;
  }

  try {
    // 1) textarea 내용 → 렌더 박스로 복사
    renderBox.textContent = textarea.value || '';

    // 2) 캡처할 동안 textarea 숨기고 렌더 박스만 보이게
    textarea.style.display  = 'none';
    renderBox.style.display = 'block';

    // 3) 공통 함수가 있으면 그걸 사용 (captureElementToPDF)
    if (typeof window.captureElementToPDF === 'function') {
      await window.captureElementToPDF(
        'capture-creative',
        '단단국어_창의활동.pdf',
        { withStudentInfo: true }
      );
    }
    // 4) 없으면 html2canvas + jsPDF 직접 사용 (백업)
    else if (window.html2canvas && window.jsPDF) {
      const canvas = await html2canvas(captureBox);
      const imgData = canvas.toDataURL('image/png');

      const pdf = new jsPDF('p', 'mm', 'a4');
      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = (canvas.height * pageW) / canvas.width;

      pdf.addImage(imgData, 'PNG', 0, 0, pageW, pageH);
      pdf.save('단단국어_창의활동.pdf');
    } else {
      alert('PDF 모듈을 찾을 수 없습니다. (html2canvas / jsPDF 확인)');
    }

    // (원하면 여기에서 창의활동도 showSubmitSuccess 호출 가능)
    if (typeof window.showSubmitSuccess === 'function') {
      window.showSubmitSuccess('창의활동');
    }
  } catch (e) {
    console.warn('submitCreative error', e);
    alert('창의활동 PDF 생성 중 오류가 발생했습니다.');
  } finally {
    // 5) 화면 복구: textarea 다시 보이게, 렌더 박스 숨김
    if (textarea)   textarea.style.display  = 'block';
    if (renderBox)  renderBox.style.display = 'none';
  }
};

/* ===========================
 * ✅ 학습 이력 서버로 보내기 (테스트 버전)
 * =========================== */
/* ===== 🔄 서버에서 완료 상태 가져오기 ===== */
window.loadCompletionStatus = async function () {
  try {
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[loadCompletionStatus] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[loadCompletionStatus] 학생 정보 없음 → 스킵');
      return;
    }

    const params = new URLSearchParams({
      grade: stu.grade || '',
      name: stu.name || '',
      series: 'BRAIN업'
    });

    const res = await fetch(`/api/completion-status?${params}`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' }
    });

    if (!res.ok) {
      console.warn('[loadCompletionStatus] 서버 응답 오류:', res.status);
      return;
    }

    const data = await res.json();
    console.log('[loadCompletionStatus] 서버 응답:', data);

    if (data.ok && Array.isArray(data.completedUnits)) {
      // 학생 키 생성 (buildProgressKey 함수와 동일한 로직)
      const cleanPhone = (stu.phone || '').replace(/\D/g, '');
      const cleanName  = (stu.name  || '').trim();
      const cleanGrade = (stu.grade || '').trim();
      const studentKey = `${cleanGrade}_${cleanName}_${cleanPhone}`;
      const keyPrefix = `dan-progress:${studentKey}:`;

      console.log('[loadCompletionStatus] studentKey:', studentKey);
      console.log('[loadCompletionStatus] keyPrefix:', keyPrefix);

      data.completedUnits.forEach(unit => {
        const key = keyPrefix + unit;  // "dan-progress:학생키:world1_01"
        localStorage.setItem(key, '1');
        console.log('[loadCompletionStatus] 저장:', key);
      });

      console.log('[loadCompletionStatus] 완료 상태 동기화 완료:', data.completedUnits);
    }
  } catch (e) {
    console.warn('[loadCompletionStatus] 오류', e);
  }
};

window.sendLearningLog = async function () {
  try {
    // ✅ 세계문학(2)는 ORIGINAL_UNIT (world1_41) 사용 → menu.html과 매칭
    const unit = window.ORIGINAL_UNIT || window.CUR_UNIT || 'world1_02';

    // 1) localStorage 에서 현재 로그인 학생 가져오기
    let stu = null;
    try {
      const raw = localStorage.getItem('currentStudent');
      if (raw) stu = JSON.parse(raw);
    } catch (e) {
      console.warn('[sendLearningLog] currentStudent 파싱 실패', e);
    }

    if (!stu) {
      console.warn('[sendLearningLog] 학생 정보 없음 → 로그 전송 스킵');
      return;
    }

    // ✅ gradeQuiz 에서 저장해 둔 레이더 점수 꺼내기
    const radar =
      (window.reportState && window.reportState.radarScores)
      ? window.reportState.radarScores
      : null;

    const payload = {
      grade:  stu.grade  || '',
      name:   stu.name   || '',
      school: stu.school || '',
      series: 'BRAIN업',      // 필요하면 '정조편' 등으로 바꿔도 됨
      unit:   unit,
      radar:  radar,       // ✅ 여기 추가!
      completed: true      // ✅ 학습 완료 표시
    };

    console.log('[sendLearningLog] payload =', payload);

    const res = await fetch('/api/log', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    let data = {};
    try {
      data = await res.json();
    } catch (_) {
      data = {};
    }
    console.log('[sendLearningLog] result =', data);
  } catch (e) {
    console.warn('sendLearningLog outer error', e);
  }
};




/* ===== 로드 시 실행 + 버튼 타입 안전패치 ===== */
document.addEventListener('DOMContentLoaded', async () => {
  // 0) 🔄 서버에서 학습 완료 상태 동기화
  if (typeof window.loadCompletionStatus === 'function') {
    await loadCompletionStatus();
  }

  // 1) 본문 내용 채우기
  // 세계문학(2)인 경우 world2_content.js 로드 완료를 기다림
  if (window.IS_WORLD2) {
    if (window.WORLD2_CONTENT_LOADED) {
      // 이미 로드됨
      applyContentPack(window.CUR_UNIT);
    } else {
      // 로드 완료 이벤트 대기
      window.addEventListener('world2ContentLoaded', () => {
        console.log('[world1_content.js] world2ContentLoaded 이벤트 수신, applyContentPack 호출');
        applyContentPack(window.CUR_UNIT);
      }, { once: true });
    }
  } else {
    applyContentPack(window.CUR_UNIT);
  }

  // 2) 탭 이벤트 + 어휘 자동 렌더
  _bindTabEvents();
  if (location.hash.includes('어휘학습') || document.querySelector('#vocab-fill')) {
    renderVocabFill();
  }

  // 3) 버튼 type=button 통일
  ['grade-btn','reset-btn','submit-btn'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.type = 'button';
  });

  // 4) 제출하기 = 채점 + 해설 표시 (한 번만 등록)
  const submitBtn = document.getElementById('submit-btn');
  if (submitBtn) {
    submitBtn.addEventListener('click', () => {
      try {
        if (typeof window.gradeQuiz === 'function') {
          gradeQuiz();
        }
        const pack = window.CONTENTS[window.CUR_UNIT] || window.CONTENTS.world1_01;
        renderSolutions(pack);
      } catch (e) {
        console.warn('submit-btn handler error', e);
      }
    });
  }

    // 🔶 창의활동 제출 버튼 → submitCreative 연결
  const creativeBtn = document.getElementById('creative-submit-btn');
  if (creativeBtn && typeof window.submitCreative === 'function') {
    creativeBtn.type = 'button';
    creativeBtn.addEventListener('click', () => {
      submitCreative();
    });
  }


  // 5) 지난번 채점/입력 상태 복원 (✅ 학생별로 분리된 키 기준)
  if (typeof loadReadingState === 'function') {
    loadReadingState();
  }

});