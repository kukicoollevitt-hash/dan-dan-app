<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë‹¨ë‹¨êµ­ì–´ ë„ì„œ ì—¬í–‰ ì§€ë„ (Canvas)</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Gmarket Sans", "Noto Sans KR", sans-serif;
      overflow: hidden;
      background: linear-gradient(180deg, #87CEEB 0%, #B0E0E6 30%, #F0E68C 70%, #DEB887 100%);
    }

    /* ìº”ë²„ìŠ¤ ì»¨í…Œì´ë„ˆ */
    #container {
      width: 100vw;
      height: 100vh;
      cursor: grab;
    }

    #container.dragging {
      cursor: grabbing;
    }

    /* ìƒë‹¨ í—¤ë” */
    .header {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px 40px;
      border-radius: 20px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
      text-align: center;
      backdrop-filter: blur(10px);
      pointer-events: none;
    }

    .header h1 {
      font-size: 28px;
      color: #2c3e50;
      margin-bottom: 5px;
      font-weight: 700;
    }

    .header p {
      font-size: 14px;
      color: #7f8c8d;
    }

    /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ */
    .back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      background: white;
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      background: #f8f9fa;
    }

    /* íˆ´íŒ */
    .tooltip {
      position: absolute;
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 1000;
      max-width: 300px;
    }

    .tooltip.active {
      opacity: 1;
    }

    .tooltip h3 {
      color: #2c3e50;
      font-size: 20px;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .tooltip .badge {
      display: inline-block;
      padding: 4px 12px;
      background: #e8f4f8;
      color: #3498db;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .tooltip p {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .tooltip button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .tooltip button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    /* ì•ˆë‚´ íŒ¨ë„ */
    .info-panel {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .info-panel p {
      font-size: 13px;
      color: #7f8c8d;
      margin: 3px 0;
    }

    .info-panel strong {
      color: #2c3e50;
    }

    /* ë¡œë”© */
    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      color: #2c3e50;
      z-index: 999;
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .header {
        padding: 12px 20px;
      }
      .header h1 {
        font-size: 20px;
      }
      .header p {
        font-size: 12px;
      }
      .info-panel {
        bottom: 10px;
        right: 10px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
  <button class="back-btn" onclick="goBack()">â† ëŒì•„ê°€ê¸°</button>

  <!-- í—¤ë” -->
  <div class="header">
    <h1>ğŸ³ ë‹¨ë‹¨êµ­ì–´ ë„ì„œ ì—¬í–‰ ì§€ë„</h1>
    <p>ë“œë˜ê·¸ë¡œ ì´ë™í•˜ê³  ì„¬ì„ í´ë¦­í•´ë³´ì„¸ìš”!</p>
  </div>

  <!-- ì•ˆë‚´ íŒ¨ë„ -->
  <div class="info-panel">
    <p><strong>ğŸ’¡ ì‚¬ìš©ë²•</strong></p>
    <p>ğŸ–±ï¸ ë“œë˜ê·¸: ì§€ë„ ì´ë™</p>
    <p>ğŸ“ ì„¬ í´ë¦­: ìƒì„¸ ì •ë³´</p>
    <p>âœ¨ í˜¸ë²„: ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼</p>
  </div>

  <!-- ë¡œë”© -->
  <div class="loading">ğŸ—ºï¸ ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

  <!-- ìº”ë²„ìŠ¤ ì»¨í…Œì´ë„ˆ -->
  <div id="container"></div>

  <!-- íˆ´íŒ -->
  <div class="tooltip" id="tooltip">
    <h3 id="tooltip-title"></h3>
    <div class="badge" id="tooltip-badge"></div>
    <p id="tooltip-desc"></p>
    <button id="tooltip-btn" onclick="navigateFromTooltip()">ğŸš€ ì—¬í–‰ ë– ë‚˜ê¸°</button>
  </div>

  <!-- Konva.js -->
  <script src="https://unpkg.com/konva@9/konva.min.js"></script>

  <script>
    // ìº”ë²„ìŠ¤ í¬ê¸°
    const width = window.innerWidth;
    const height = window.innerHeight;

    // Stage ìƒì„±
    const stage = new Konva.Stage({
      container: 'container',
      width: width,
      height: height,
      draggable: true
    });

    // ë ˆì´ì–´ ìƒì„±
    const bgLayer = new Konva.Layer(); // ë°°ê²½ (íŒŒë„ ë“±)
    const islandLayer = new Konva.Layer(); // ì„¬ë“¤
    const whaleLayer = new Konva.Layer(); // ê³ ë˜ (ìµœìƒìœ„)

    stage.add(bgLayer);
    stage.add(islandLayer);
    stage.add(whaleLayer);

    // ë¡œë”© ì œê±°
    setTimeout(() => {
      document.querySelector('.loading').style.display = 'none';
    }, 500);

    // ë“œë˜ê·¸ ì»¤ì„œ ë³€ê²½
    stage.on('dragstart', () => {
      document.getElementById('container').classList.add('dragging');
    });
    stage.on('dragend', () => {
      document.getElementById('container').classList.remove('dragging');
    });

    // íŒŒë„ ê·¸ë¦¬ê¸°
    function createWave(x, y, width, height, opacity) {
      const wave = new Konva.Ellipse({
        x: x,
        y: y,
        radiusX: width,
        radiusY: height,
        fill: '#B0E0E6',
        opacity: opacity
      });

      bgLayer.add(wave);

      // íŒŒë„ ì• ë‹ˆë©”ì´ì…˜
      const anim = new Konva.Animation((frame) => {
        const period = 4000;
        const scale = Math.sin((frame.time * 2 * Math.PI) / period) * 0.2 + 1;
        wave.scaleX(scale);
      }, bgLayer);
      anim.start();
    }

    // íŒŒë„ 3ê°œ ì¶”ê°€
    createWave(200, 500, 80, 20, 0.3);
    createWave(700, 450, 100, 25, 0.3);
    createWave(450, 520, 90, 22, 0.3);

    // ì±… ì¹´í…Œê³ ë¦¬ ë°ì´í„°
    const bookCategories = [
      {
        name: 'ê³ ì „ë¬¸í•™',
        emoji: 'ğŸ“•',
        x: width * 0.25,
        y: height * 0.35,
        color: '#E74C3C',
        count: '40ê°œ ì‘í’ˆ',
        desc: 'ì‹œëŒ€ë¥¼ ì´ˆì›”í•œ ëª…ì‘ë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. ì¶˜í–¥ì „, ì‹¬ì²­ì „ ë“± ìš°ë¦¬ ê³ ì „ì„ ë§Œë‚˜ë³´ì„¸ìš”!',
        url: '/BRAINUP/korlit/classic_list.html'
      },
      {
        name: 'í˜„ëŒ€ë¬¸í•™',
        emoji: 'ğŸ“˜',
        x: width * 0.5,
        y: height * 0.55,
        color: '#3498DB',
        count: '40ê°œ ì‘í’ˆ',
        desc: 'í˜„ëŒ€ì˜ ê°ì„±ì´ ë‹´ê¸´ ì‘í’ˆë“¤. ì†Œë…„ì´ ì˜¨ë‹¤, 82ë…„ìƒ ê¹€ì§€ì˜ ë“± í˜„ëŒ€ ë¬¸í•™ì„ íƒí—˜í•´ë³´ì„¸ìš”!',
        url: '/BRAINUP/korlit/modern_list.html'
      },
      {
        name: 'ì¸ë¬¼ì „ê¸°',
        emoji: 'ğŸ“™',
        x: width * 0.75,
        y: height * 0.35,
        color: '#9B59B6',
        count: '40ëª…ì˜ ì¸ë¬¼',
        desc: 'ì—­ì‚¬ë¥¼ ë§Œë“  ìœ„ì¸ë“¤ì˜ ì´ì•¼ê¸°. ì„¸ì¢…ëŒ€ì™•, ì‹ ì‚¬ì„ë‹¹ ë“± 40ëª…ì˜ ì¸ë¬¼ì„ ë§Œë‚˜ë³´ì„¸ìš”!',
        url: '/BRAINUP/person/people_list.html'
      },
      {
        name: 'ì‚¬íšŒë¶„ì•¼',
        emoji: 'ğŸ“’',
        x: width * 0.3,
        y: height * 0.7,
        color: '#F39C12',
        count: 'ì§€ë¦¬Â·ì—­ì‚¬Â·ë„ë•',
        desc: 'ì„¸ìƒì„ ì´í•´í•˜ëŠ” ì§€í˜œ. ì§€ë¦¬, ì—­ì‚¬, ë„ë• ì˜ì—­ì˜ ë‹¤ì–‘í•œ ì§€ì‹ì´ ê¸°ë‹¤ë ¤ìš”!',
        url: '/BRAINUP/social/geo_list.html'
      },
      {
        name: 'ê³¼í•™ë¶„ì•¼',
        emoji: 'ğŸ“—',
        x: width * 0.7,
        y: height * 0.7,
        color: '#27AE60',
        count: 'ìƒë¬¼Â·ë¬¼ë¦¬Â·í™”í•™',
        desc: 'ìì—°ì˜ ì‹ ë¹„ë¥¼ íƒêµ¬í•´ìš”. ìƒë¬¼, ë¬¼ë¦¬, í™”í•™ì˜ í¥ë¯¸ë¡œìš´ ì„¸ê³„ë¡œ ë– ë‚˜ë³¼ê¹Œìš”?',
        url: '/BRAINUP/science/bio_list.html'
      }
    ];

    // ì„¬ ìƒì„± í•¨ìˆ˜
    function createIsland(data) {
      const group = new Konva.Group({
        x: data.x,
        y: data.y,
        draggable: false
      });

      // ì„¬ ë² ì´ìŠ¤ (íƒ€ì›í˜•)
      const islandBase = new Konva.Ellipse({
        x: 0,
        y: 20,
        radiusX: 100,
        radiusY: 40,
        fill: '#8B7355',
        stroke: '#654321',
        strokeWidth: 2,
        shadowColor: 'black',
        shadowBlur: 10,
        shadowOpacity: 0.3,
        shadowOffsetY: 5
      });

      // ì„¬ í’€ë°­
      const islandGrass = new Konva.Ellipse({
        x: 0,
        y: 10,
        radiusX: 95,
        radiusY: 38,
        fill: '#90EE90',
        stroke: '#228B22',
        strokeWidth: 1.5
      });

      // ì±… ì•„ì´ì½˜ (ì‚¬ê°í˜•ìœ¼ë¡œ í‘œí˜„)
      const bookRect = new Konva.Rect({
        x: -20,
        y: -35,
        width: 40,
        height: 35,
        fill: data.color,
        cornerRadius: 3,
        shadowColor: 'black',
        shadowBlur: 8,
        shadowOpacity: 0.4,
        shadowOffsetY: 4
      });

      // ì±… í˜ì´ì§€ ë¼ì¸
      const line1 = new Konva.Line({
        points: [-15, -25, 15, -25],
        stroke: 'white',
        strokeWidth: 1.5,
        opacity: 0.5
      });

      const line2 = new Konva.Line({
        points: [-15, -15, 15, -15],
        stroke: 'white',
        strokeWidth: 1.5,
        opacity: 0.5
      });

      // ì´ëª¨ì§€ í…ìŠ¤íŠ¸
      const emojiText = new Konva.Text({
        x: -15,
        y: -30,
        text: data.emoji,
        fontSize: 30,
        fill: 'white'
      });

      // ì„¬ ì´ë¦„
      const nameText = new Konva.Text({
        x: -50,
        y: 35,
        text: data.name,
        fontSize: 18,
        fontStyle: 'bold',
        fill: '#2c3e50',
        width: 100,
        align: 'center',
        shadowColor: 'white',
        shadowBlur: 5,
        shadowOpacity: 0.8
      });

      // ì‘í’ˆ ìˆ˜
      const countText = new Konva.Text({
        x: -50,
        y: 55,
        text: data.count,
        fontSize: 14,
        fill: '#7f8c8d',
        width: 100,
        align: 'center',
        shadowColor: 'white',
        shadowBlur: 5,
        shadowOpacity: 0.8
      });

      // ê·¸ë£¹ì— ì¶”ê°€
      group.add(islandBase);
      group.add(islandGrass);
      group.add(bookRect);
      group.add(line1);
      group.add(line2);
      group.add(emojiText);
      group.add(nameText);
      group.add(countText);

      // í˜¸ë²„ íš¨ê³¼
      group.on('mouseenter', () => {
        document.body.style.cursor = 'pointer';
        stage.container().style.cursor = 'pointer';

        // ìŠ¤ì¼€ì¼ ì• ë‹ˆë©”ì´ì…˜
        const tween = new Konva.Tween({
          node: group,
          duration: 0.3,
          scaleX: 1.1,
          scaleY: 1.1,
          easing: Konva.Easings.EaseOut
        });
        tween.play();

        // íˆ´íŒ í‘œì‹œ
        showTooltip(data);
      });

      group.on('mouseleave', () => {
        document.body.style.cursor = 'grab';
        stage.container().style.cursor = 'grab';

        const tween = new Konva.Tween({
          node: group,
          duration: 0.3,
          scaleX: 1,
          scaleY: 1,
          easing: Konva.Easings.EaseOut
        });
        tween.play();

        // íˆ´íŒ ìˆ¨ê¹€
        hideTooltip();
      });

      group.on('mousemove', (e) => {
        moveTooltip(e.evt.clientX, e.evt.clientY);
      });

      // í´ë¦­ ì´ë²¤íŠ¸
      group.on('click', () => {
        // í´ë¦­ ì• ë‹ˆë©”ì´ì…˜
        const tween = new Konva.Tween({
          node: group,
          duration: 0.1,
          scaleX: 0.95,
          scaleY: 0.95,
          onFinish: () => {
            const tweenBack = new Konva.Tween({
              node: group,
              duration: 0.1,
              scaleX: 1.1,
              scaleY: 1.1,
              onFinish: () => {
                navigateTo(data.url);
              }
            });
            tweenBack.play();
          }
        });
        tween.play();
      });

      // ë‘¥ë‘¥ ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜
      const floatAnim = new Konva.Animation((frame) => {
        const period = 3000;
        const amplitude = 10;
        const offset = Math.sin((frame.time * 2 * Math.PI) / period) * amplitude;
        group.y(data.y + offset);
      }, islandLayer);
      floatAnim.start();

      islandLayer.add(group);
    }

    // ëª¨ë“  ì„¬ ìƒì„±
    bookCategories.forEach(category => {
      createIsland(category);
    });

    // ê³ ë˜ ìƒì„±
    const whaleGroup = new Konva.Group({
      x: width * 0.5,
      y: height * 0.15
    });

    // ê³ ë˜ ëª¸ì²´
    const whaleBody = new Konva.Ellipse({
      x: 0,
      y: 0,
      radiusX: 40,
      radiusY: 25,
      fill: '#4A90E2',
      shadowColor: 'black',
      shadowBlur: 10,
      shadowOpacity: 0.3,
      shadowOffsetY: 5
    });

    // ê³ ë˜ ëˆˆ
    const whaleEye = new Konva.Circle({
      x: -10,
      y: -5,
      radius: 4,
      fill: 'white'
    });

    const whaleEyeBall = new Konva.Circle({
      x: -12,
      y: -6,
      radius: 2,
      fill: 'black'
    });

    // ê°€ë°©
    const bag = new Konva.Rect({
      x: -10,
      y: -20,
      width: 20,
      height: 25,
      fill: '#8B4513',
      cornerRadius: 2,
      shadowColor: 'black',
      shadowBlur: 5,
      shadowOpacity: 0.4
    });

    const bagFront = new Konva.Rect({
      x: -8,
      y: -18,
      width: 16,
      height: 21,
      fill: '#D2691E',
      cornerRadius: 1
    });

    // ì´ëª¨ì§€ í…ìŠ¤íŠ¸
    const whaleEmoji = new Konva.Text({
      x: -20,
      y: -15,
      text: 'ğŸ³',
      fontSize: 40
    });

    whaleGroup.add(whaleBody);
    whaleGroup.add(whaleEye);
    whaleGroup.add(whaleEyeBall);
    whaleGroup.add(bag);
    whaleGroup.add(bagFront);
    whaleGroup.add(whaleEmoji);

    whaleLayer.add(whaleGroup);

    // ê³ ë˜ ë– ë‹¤ë‹ˆê¸° ì• ë‹ˆë©”ì´ì…˜
    const whaleAnim = new Konva.Animation((frame) => {
      const period = 3000;
      const amplitude = 15;
      const offset = Math.sin((frame.time * 2 * Math.PI) / period) * amplitude;
      whaleGroup.y(height * 0.15 + offset);
    }, whaleLayer);
    whaleAnim.start();

    // íˆ´íŒ ê´€ë ¨ í•¨ìˆ˜
    let currentTooltipUrl = '';

    function showTooltip(data) {
      const tooltip = document.getElementById('tooltip');
      document.getElementById('tooltip-title').textContent = data.name;
      document.getElementById('tooltip-badge').textContent = data.count;
      document.getElementById('tooltip-desc').textContent = data.desc;
      currentTooltipUrl = data.url;
      tooltip.classList.add('active');
    }

    function hideTooltip() {
      document.getElementById('tooltip').classList.remove('active');
    }

    function moveTooltip(x, y) {
      const tooltip = document.getElementById('tooltip');
      tooltip.style.left = (x + 20) + 'px';
      tooltip.style.top = (y + 20) + 'px';
    }

    function navigateFromTooltip() {
      if (currentTooltipUrl) {
        window.location.href = currentTooltipUrl;
      }
    }

    function navigateTo(url) {
      window.location.href = url;
    }

    function goBack() {
      window.history.back();
    }

    // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        goBack();
      }
    });

    // ì°½ í¬ê¸° ë³€ê²½ ëŒ€ì‘
    window.addEventListener('resize', () => {
      location.reload();
    });
  </script>
</body>
</html>
