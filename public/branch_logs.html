<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•™ìŠµ ì´ë ¥</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans KR", sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      padding: 50px;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
      padding-bottom: 30px;
      border-bottom: 3px solid #e5d4c1;
    }

    h1 {
      font-size: 42px;
      font-weight: 800;
      color: #2c3e50;
      margin-bottom: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 16px;
      color: #7f8c8d;
      font-weight: 500;
    }

    .nav-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
    }

    .btn {
      display: inline-block;
      padding: 12px 28px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .btn-back {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-back:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-download {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    .btn-download:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
    }

    .btn-trash {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      color: white;
    }

    .btn-trash:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
    }

    .stats-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      color: #2d3436;
      padding: 8px 20px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 30px;
      box-shadow: 0 4px 15px rgba(253, 203, 110, 0.3);
    }

    .section-title {
      font-size: 28px;
      font-weight: 700;
      color: #2c3e50;
      margin: 50px 0 20px 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .section-description {
      font-size: 14px;
      color: #7f8c8d;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    .table-container {
      background: #ffffff;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      margin-bottom: 50px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      padding: 16px 20px;
      font-size: 15px;
      text-align: left;
    }

    th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 13px;
    }

    td {
      border-bottom: 1px solid #ecf0f1;
      color: #2c3e50;
    }

    tr:hover td {
      background: #f8f9fa;
    }

    /* í´ë¦­ ê°€ëŠ¥í•œ í–‰ ìŠ¤íƒ€ì¼ */
    tr.clickable-row {
      cursor: pointer;
      transition: all 0.2s ease;
    }

    tr.clickable-row:hover td {
      background: linear-gradient(135deg, #e8f4fd 0%, #d4edfc 100%);
    }

    tr.clickable-row:active td {
      background: linear-gradient(135deg, #cce5ff 0%, #b3d9ff 100%);
    }

    tr:last-child td {
      border-bottom: none;
    }

    hr {
      margin: 60px 0;
      border: none;
      border-top: 2px solid #e5d4c1;
    }

    #series-radar-wrap,
    #field-radar-wrap,
    #summary-radar-wrap,
    #radar-wrap {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-top: 30px;
      justify-content: center;
    }

    .radar-card {
      flex: 0 0 320px;
      border: 2px solid #e5d4c1;
      border-radius: 20px;
      padding: 24px;
      background: linear-gradient(135deg, #fef9f3 0%, #fff5eb 25%, #fffbf5 50%, #fef9f3 75%, #fff5eb 100%);
      background-size: 400% 400%;
      animation: cardGradientFlow 15s ease infinite;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.8) inset;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .radar-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-size: 200% 100%;
      animation: topGradientSlide 8s linear infinite;
    }

    .radar-card::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 248, 240, 0.8) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.5s ease;
      pointer-events: none;
    }

    .radar-card:hover::after {
      opacity: 1;
      animation: glowPulse 2s ease-in-out infinite;
    }

    @keyframes cardGradientFlow {
      0%, 100% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
    }

    @keyframes topGradientSlide {
      0% {
        background-position: 0% 0%;
      }
      100% {
        background-position: 200% 0%;
      }
    }

    @keyframes glowPulse {
      0%, 100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.6;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 0.8;
      }
    }

    .radar-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      border-color: #d4b89c;
    }

    .radar-card-header {
      margin-bottom: 20px;
      text-align: center;
      position: relative;
    }

    .delete-btn {
      position: absolute;
      top: -10px;
      right: -10px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      color: white;
      border: 2px solid white;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(238, 90, 111, 0.4);
      transition: all 0.3s ease;
      z-index: 10;
    }

    .delete-btn:hover {
      transform: scale(1.1);
      background: linear-gradient(135deg, #ee5a6f 0%, #ff4757 100%);
      box-shadow: 0 6px 15px rgba(238, 90, 111, 0.6);
    }

    .table-delete-btn {
      padding: 6px 12px;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(238, 90, 111, 0.3);
    }

    .table-delete-btn:hover {
      background: linear-gradient(135deg, #ee5a6f 0%, #ff4757 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(238, 90, 111, 0.5);
    }

    .radar-card-title {
      display: block;
      font-size: 18px;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .radar-card-time {
      color: #95a5a6;
      font-size: 12px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .radar-card-stats {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px solid #f0f0f0;
      gap: 10px;
    }

    .stat-item {
      text-align: center;
      flex: 1;
    }

    .stat-label {
      font-size: 11px;
      color: #95a5a6;
      font-weight: 600;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-value {
      font-size: 20px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .score-badge {
      display: inline-block;
      padding: 6px 16px;
      border-radius: 50px;
      font-size: 12px;
      font-weight: 700;
      margin-top: 10px;
    }

    .badge-excellent {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      color: #2d3436;
    }

    .badge-good {
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      color: #2d3436;
    }

    .badge-normal {
      background: linear-gradient(135deg, #dfe6e9 0%, #b2bec3 100%);
      color: #2d3436;
    }

    /* ì¢…í•© ë ˆì´ë” ì¹´ë“œ - ë¶‰ì€ ê³„ì—´ */
    .radar-card.summary-card::before {
      background: linear-gradient(90deg, #f093fb 0%, #f5576c 50%, #e74c3c 100%) !important;
    }

    .radar-card.summary-card {
      border-color: #f5c6cb;
    }

    .radar-card.summary-card:hover {
      border-color: #f5576c;
    }

    .radar-card.summary-card .stat-value {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%) !important;
      -webkit-background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
      background-clip: text !important;
    }

    /* ë”ë³´ê¸° ê¸°ëŠ¥ ìŠ¤íƒ€ì¼ */
    .hidden-row {
      display: none;
    }

    .hidden-card {
      display: none !important;
    }

    .toggle-btn {
      display: block;
      margin: 20px auto;
      padding: 12px 32px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 25px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .toggle-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .toggle-btn:active {
      transform: translateY(0);
    }

    /* ì‹œë¦¬ì¦ˆ ì„ íƒ ë“œë¡­ë‹¤ìš´ */
    .series-selector {
      position: absolute;
      top: 30px;
      left: 30px;
      z-index: 100;
    }

    .series-dropdown {
      position: relative;
    }

    .series-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      transition: all 0.3s ease;
    }

    .series-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .series-button .arrow {
      transition: transform 0.3s ease;
    }

    .series-button.active .arrow {
      transform: rotate(180deg);
    }

    .series-menu {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
      min-width: 200px;
      overflow: hidden;
      display: none;
    }

    .series-menu.show {
      display: block;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .series-item {
      padding: 14px 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-bottom: 1px solid #f0f0f0;
      font-size: 14px;
      font-weight: 500;
      color: #2c3e50;
    }

    .series-item:last-child {
      border-bottom: none;
    }

    .series-item:hover {
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf3 100%);
    }

    .series-item.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-weight: 700;
    }

    /* ì¤‘ì•™ ì•¡ì…˜ ë²„íŠ¼ */
    .action-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 40px 0 30px 0;
    }

    .btn-send {
      padding: 14px 32px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-send:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-download-action {
      padding: 14px 32px;
      background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
      color: white;
      border: none;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(74, 222, 128, 0.3);
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-download-action:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 222, 128, 0.4);
    }

    /* ì¹´ì¹´ì˜¤í†¡ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .btn-kakao {
      background: linear-gradient(135deg, #FEE500 0%, #FFCD00 100%);
      color: #3C1E1E;
      padding: 14px 30px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 205, 0, 0.3);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-kakao:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 205, 0, 0.5);
    }
  </style>

  <!-- ì¹´ì¹´ì˜¤ SDK -->
  <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- ì‹œë¦¬ì¦ˆ ì„ íƒ ë“œë¡­ë‹¤ìš´ -->
    <div class="series-selector">
      <div class="series-dropdown">
        <button class="series-button" id="seriesButton">
          <span id="currentSeries">ì „ì²´ ì‹œë¦¬ì¦ˆ</span>
          <span class="arrow">â–¼</span>
        </button>
        <div class="series-menu" id="seriesMenu">
          <div class="series-item active" data-series="all">ì „ì²´ ì‹œë¦¬ì¦ˆ</div>
          <div class="series-item" data-series="BRAINì˜¨">BRAINì˜¨</div>
          <div class="series-item" data-series="BRAINì—…">BRAINì—…</div>
          <div class="series-item" data-series="BRAINí•">BRAINí•</div>
          <div class="series-item" data-series="BRAINë”¥">BRAINë”¥</div>
          <div class="series-item" data-series="BRAINì¤‘ë“±">BRAINì¤‘ë“±</div>
          <div class="series-item" data-series="BRAINê³ ë“±">BRAINê³ ë“±</div>
        </div>
      </div>
    </div>

    <div class="header">
      <h1>í•™ìŠµ ì´ë ¥</h1>
      <p class="subtitle" id="student-info">ë¡œë”© ì¤‘...</p>

      <div class="nav-buttons">
        <a class="btn btn-back" href="/admin/branch/users">
          â† í•™ìƒ ëª©ë¡ìœ¼ë¡œ
        </a>
        <a class="btn btn-download" id="csv-download-link" href="#" style="display:none;">
          ğŸ“¥ CSV ë‹¤ìš´ë¡œë“œ
        </a>
        <a class="btn btn-trash" id="trash-link" href="#" style="display:none;">
          ğŸ—‘ï¸ íœ´ì§€í†µ
        </a>
      </div>
    </div>

    <div style="text-align: center;">
      <span class="stats-badge" id="stats-badge" style="font-size: 20px; padding: 16px 36px;">ğŸ“š ì´ 0ê±´ì˜ í•™ìŠµ ê¸°ë¡</span>
      <div style="margin-top: 5px; display: flex; justify-content: center; gap: 20px;">
        <span class="stats-badge" style="background: linear-gradient(135deg, #3b82f6 0%, #1e3a8a 100%); color: white;" id="normalLearningCount">ğŸ“– ì¼ë°˜í•™ìŠµ 0ê±´</span>
        <span class="stats-badge" style="background: linear-gradient(135deg, #a855f7 0%, #6b21a8 100%); color: white;" id="aiLearningCount">ğŸ¤– AIì¶”ì²œí•™ìŠµ 0ê±´</span>
      </div>
    </div>

    <div class="section-title">
      ğŸ“ ì¢…í•© í•™ìŠµ ê¸°ë¡ ëª©ë¡
    </div>
    <p class="section-description">
      ëª¨ë“  í•™ìŠµ í™œë™ì´ ì‹œê°„ ìˆœì„œëŒ€ë¡œ ê¸°ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
    </p>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>ë‚ ì§œ/ì‹œê°„<br/><small style="font-weight: normal; color: #999;">(ì¼ë°˜ê³¼ì œ)</small></th>
            <th>ë‚ ì§œ/ì‹œê°„<br/><small style="font-weight: normal; color: #999;">(AIë³µìŠµ)</small></th>
            <th>ì‹œë¦¬ì¦ˆ</th>
            <th>ë‹¨ì›ëª…</th>
            <th>ì‘ì—…</th>
          </tr>
        </thead>
        <tbody id="logs-tbody">
          <tr>
            <td colspan="6" style="text-align:center;">í•™ìŠµ ì´ë ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <button class="toggle-btn" id="toggleBtn" onclick="toggleRows()" style="display:none;">ë”ë³´ê¸° â–¼</button>

    <hr>

    <div class="section-title">
      ğŸ† ì‹œë¦¬ì¦ˆ ì¢…í•© ë ˆì´ë”
    </div>
    <p class="section-description">
      ì „ì²´ ì‹œë¦¬ì¦ˆì˜ ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ í†µí•©í•œ ìµœì¢… ë ˆì´ë”ì…ë‹ˆë‹¤.<br/>
      (â€» radar ë°ì´í„°ê°€ ìˆëŠ” ê¸°ë¡ë“¤ë§Œ í‰ê· ì— í¬í•¨ë©ë‹ˆë‹¤.)
    </p>

    <div id="series-radar-wrap"></div>

    <hr>

    <div class="section-title">
      ğŸ“š ë¶„ì•¼ë³„ ì¢…í•© ë ˆì´ë”
    </div>
    <p class="section-description">
      ë¶„ì•¼ë³„ë¡œ ëª¨ë“  í•™ìŠµ ë°ì´í„°ì˜ í‰ê· ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.<br/>
      (â€» radar ë°ì´í„°ê°€ ìˆëŠ” ê¸°ë¡ë“¤ë§Œ í‰ê· ì— í¬í•¨ë©ë‹ˆë‹¤.)
    </p>

    <div id="field-radar-wrap"></div>
    <button class="toggle-btn" id="toggleFieldBtn" onclick="toggleFieldRadar()" style="display:none;">ë”ë³´ê¸° â–¼</button>

    <hr>

    <div class="section-title">
      ğŸ“Š ê³¼ëª©ë³„ ì¢…í•© ë ˆì´ë”
    </div>
    <p class="section-description">
      ê³¼ëª©ë³„ë¡œ ëª¨ë“  í•™ìŠµ ë°ì´í„°ì˜ í‰ê· ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.<br/>
      (â€» radar ë°ì´í„°ê°€ ìˆëŠ” ê¸°ë¡ë“¤ë§Œ í‰ê· ì— í¬í•¨ë©ë‹ˆë‹¤.)
    </p>

    <div id="summary-radar-wrap"></div>
    <button class="toggle-btn" id="toggleSummaryBtn" onclick="toggleSummaryRadar()" style="display:none;">ë”ë³´ê¸° â–¼</button>

    <hr>

    <div class="section-title">
      ğŸ§  ë‹¨ì›ë³„ ë¬¸í•´ë ¥ ë ˆì´ë” ì°¨íŠ¸
    </div>
    <p class="section-description">
      ê°€ì¥ ìµœê·¼ ê¸°ë¡ì´ ìœ„ì— ì˜¤ë„ë¡ ì •ë ¬ë˜ì–´ ìˆì–´ìš”.<br/>
      (â€» ì•„ì§ radar ë°ì´í„°ê°€ ì—†ëŠ” ê¸°ë¡ì€ ê·¸ë˜í”„ê°€ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)
    </p>

    <div id="radar-wrap"></div>
    <button class="toggle-btn" id="toggleRadarBtn" onclick="toggleRadar()" style="display:none;">ë”ë³´ê¸° â–¼</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // URLì—ì„œ grade, name íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
    const params = new URLSearchParams(window.location.search);
    const grade = params.get('grade');
    const name = params.get('name');

    if (!grade || !name) {
      document.getElementById('logs-tbody').innerHTML =
        '<tr><td colspan="5" style="text-align:center; color:red;">gradeì™€ name íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤.</td></tr>';
    } else {
      // í˜ì´ì§€ ì œëª© ì—…ë°ì´íŠ¸
      document.querySelector('h1').textContent = 'í•™ìŠµ ì´ë ¥';
      document.getElementById('student-info').textContent = `${grade} ${name}`;

      // CSV ë‹¤ìš´ë¡œë“œ ë§í¬ í™œì„±í™” (ë‚˜ì¤‘ì— êµ¬í˜„)
      // document.getElementById('csv-download-link').style.display = 'inline-block';
      // document.getElementById('csv-download-link').href = `/admin/branch/logs-export?grade=${encodeURIComponent(grade)}&name=${encodeURIComponent(name)}`;

      // íœ´ì§€í†µ ë§í¬ í™œì„±í™” (ë‚˜ì¤‘ì— êµ¬í˜„)
      // document.getElementById('trash-link').style.display = 'inline-block';

      // ì„œë²„ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      fetchLogs(grade, name);
    }

    async function fetchLogs(grade, name) {
      try {
        const response = await fetch(`/api/branch/logs?grade=${encodeURIComponent(grade)}&name=${encodeURIComponent(name)}`, {
          credentials: 'include'
        });

        if (!response.ok) {
          throw new Error('HTTP ' + response.status);
        }

        const data = await response.json();

        if (!data.ok) {
          throw new Error(data.message || 'ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨');
        }

        const logs = data.logs || [];
        window.logsData = logs; // ì „ì—­ ë³€ìˆ˜ë¡œ ì €ì¥

        // í†µê³„ ë°°ì§€ ì—…ë°ì´íŠ¸
        updateLearningCounts(logs);

        // í…Œì´ë¸” ë Œë”ë§
        renderTable(logs);

        // ì‹œë¦¬ì¦ˆ ì¢…í•© ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§ (ë§¨ ìœ„)
        renderSeriesRadar(logs);

        // ë¶„ì•¼ë³„ ì¢…í•© ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§
        renderFieldRadar(logs);

        // ê³¼ëª©ë³„ ì¢…í•© ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§
        renderSummaryRadar(logs);

        // ë‹¨ì›ë³„ ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§
        renderRadarCharts(logs);

      } catch (err) {
        console.error('í•™ìŠµ ì´ë ¥ ë¡œë“œ ì˜¤ë¥˜:', err);
        document.getElementById('logs-tbody').innerHTML =
          `<tr><td colspan="5" style="text-align:center; color:red;">âŒ í•™ìŠµ ì´ë ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${err.message}</td></tr>`;
      }
    }

    // ===== ë‹¨ì› ì½”ë“œë¥¼ ë‹¨ì›ëª…ìœ¼ë¡œ ë³€í™˜ =====
    function getUnitName(unitCode) {
      // ê³¼ëª© ì½”ë“œ â†’ í•œê¸€ ì´ë¦„ ë§¤í•‘
      const subjectNames = {
        'geo': 'ì§€ë¦¬',
        'soc': 'ì‚¬íšŒë¬¸í™”',
        'law': 'ë²•',
        'pol': 'ì •ì¹˜ê²½ì œ',
        'bio': 'ìƒë¬¼',
        'chem': 'í™”í•™',
        'physics': 'ë¬¼ë¦¬',
        'earth': 'ì§€êµ¬ê³¼í•™',
        'classic': 'ê³ ì „ë¬¸í•™',
        'modern': 'í˜„ëŒ€ë¬¸í•™',
        'world': 'ì„¸ê³„ë¬¸í•™(1)',
        'people': 'í•œêµ­ì¸ë¬¼'
      };

      // unitCodeì—ì„œ ê³¼ëª©ì½”ë“œì™€ ë‹¨ì›ë²ˆí˜¸ ì¶”ì¶œ (ì˜ˆ: world_01 -> world, 01)
      const parts = unitCode.split('_');
      if (parts.length >= 2) {
        const subjectCode = parts[0];
        const unitNum = parseInt(parts[1], 10);
        const subjectName = subjectNames[subjectCode];
        if (subjectName) {
          return `${subjectName} ${unitNum}`;
        }
      }

      return unitCode;
    }

    // ===== ë‹¨ì› ì½”ë“œë¡œ í•™ìŠµ í˜ì´ì§€ ê²½ë¡œ ìƒì„± =====
    function getUnitPath(unitCode, series) {
      if (!unitCode) return null;

      // ì‹œë¦¬ì¦ˆë³„ í´ë” ë§¤í•‘ (BRAINí•ë„ BRAINUP í´ë” ì‚¬ìš©)
      const seriesFolders = {
        'BRAINì—…': 'BRAINUP',
        'BRAINì˜¨': 'BRAINON',
        'BRAINí•': 'BRAINUP',
        'BRAINë”¥': 'BRAINDEEP',
        'BRAINì¤‘ë“±': 'BRAINMID',
        'BRAINê³ ë“±': 'BRAINHIGH'
      };

      // ê³¼ëª© ì½”ë“œ â†’ í´ë” ë§¤í•‘
      const subjectFolders = {
        'geo': 'social',
        'soc': 'social',
        'law': 'social',
        'pol': 'social',
        'bio': 'science',
        'chem': 'science',
        'physics': 'science',
        'earth': 'science',
        'classic': 'korlit',
        'modern': 'korlit',
        'world': 'worldlit',
        'people': 'person',
        'people1': 'person'
      };

      const parts = unitCode.split('_');
      if (parts.length < 2) return null;

      const subjectCode = parts[0];
      const unitNum = parts[1];

      const seriesFolder = seriesFolders[series] || 'BRAINUP';
      const subjectFolder = subjectFolders[subjectCode];

      if (!subjectFolder) return null;

      // ê²½ë¡œ ìƒì„±: /BRAINUP/social/geo_01.html
      return `/${seriesFolder}/${subjectFolder}/${unitCode}.html`;
    }

    // ===== ë‹¨ì› í˜ì´ì§€ë¡œ ì´ë™ =====
    function goToUnit(unitCode, series) {
      const path = getUnitPath(unitCode, series);
      if (path) {
        window.open(path, '_blank');
      } else {
        alert('í•´ë‹¹ ë‹¨ì› í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }
    }

    // ===== í•™ìŠµ ê±´ìˆ˜ ì—…ë°ì´íŠ¸ =====
    function updateLearningCounts(logs) {
      const totalCount = logs.length;
      const normalCount = logs.filter(log => !log.aiReviewCompletedAt).length;
      const aiCount = logs.filter(log => log.aiReviewCompletedAt).length;

      document.getElementById('stats-badge').textContent = `ğŸ“š ì´ ${totalCount}ê±´ì˜ í•™ìŠµ ê¸°ë¡`;
      document.getElementById('normalLearningCount').textContent = `ğŸ“– ì¼ë°˜í•™ìŠµ ${normalCount}ê±´`;
      document.getElementById('aiLearningCount').textContent = `ğŸ¤– AIì¶”ì²œí•™ìŠµ ${aiCount}ê±´`;
    }

    // ===== ì‹œë¦¬ì¦ˆ ë“œë¡­ë‹¤ìš´ ê¸°ëŠ¥ =====
    document.addEventListener('DOMContentLoaded', function() {
      const seriesButton = document.getElementById('seriesButton');
      const seriesMenu = document.getElementById('seriesMenu');
      const seriesItems = document.querySelectorAll('.series-item');

      // ë“œë¡­ë‹¤ìš´ í† ê¸€
      seriesButton.addEventListener('click', function() {
        seriesButton.classList.toggle('active');
        seriesMenu.classList.toggle('show');
      });

      // ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
      document.addEventListener('click', function(e) {
        if (!seriesButton.contains(e.target) && !seriesMenu.contains(e.target)) {
          seriesButton.classList.remove('active');
          seriesMenu.classList.remove('show');
        }
      });

      // ì‹œë¦¬ì¦ˆ ì„ íƒ
      seriesItems.forEach(item => {
        item.addEventListener('click', function() {
          const selectedSeries = this.getAttribute('data-series');

          // í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
          seriesItems.forEach(i => i.classList.remove('active'));
          this.classList.add('active');

          // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
          document.getElementById('currentSeries').textContent = this.textContent;

          // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
          seriesButton.classList.remove('active');
          seriesMenu.classList.remove('show');

          // ë°ì´í„° í•„í„°ë§
          if (window.logsData) {
            const filteredLogs = selectedSeries === 'all'
              ? window.logsData
              : window.logsData.filter(log => log.series === selectedSeries);

            // UI ì—…ë°ì´íŠ¸
            updateLearningCounts(filteredLogs);
            renderTable(filteredLogs);
            renderSeriesRadar(filteredLogs);
            renderFieldRadar(filteredLogs);
            renderSummaryRadar(filteredLogs);
            renderRadarCharts(filteredLogs);
          }
        });
      });
    });

    // ===== ì‚­ì œ ê¸°ëŠ¥ (ê´€ë¦¬ì ì „ìš©) =====
    function deleteLog(logId) {
      if (!confirm('ì´ í•™ìŠµ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nì‚­ì œëœ í•­ëª©ì€ íœ´ì§€í†µì—ì„œ ë³µêµ¬í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {
        return;
      }

      fetch(`/admin/log/delete/${logId}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.');
          window.location.reload();
        } else {
          alert('ì‚­ì œ ì‹¤íŒ¨: ' + data.message);
        }
      })
      .catch(err => {
        alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + err.message);
      });
    }

    function renderTable(logs) {
      const tbody = document.getElementById('logs-tbody');

      if (logs.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;">í•™ìŠµ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        return;
      }

      tbody.innerHTML = logs.map((log, idx) => {
        const timestamp = log.timestamp ?
          new Date(log.timestamp).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' }) : '-';

        const aiReviewTimestamp = log.aiReviewCompletedAt ?
          new Date(log.aiReviewCompletedAt).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' }) : '-';

        const hiddenClass = idx >= 6 ? 'hidden-row' : '';
        const unitCode = log.unit || '';
        const series = log.series || 'BRAINì—…';

        return `
          <tr class="clickable-row ${hiddenClass}" onclick="goToUnit('${unitCode}', '${series}')" title="í´ë¦­í•˜ì—¬ ë‹¨ì›ìœ¼ë¡œ ì´ë™">
            <td>${idx + 1}</td>
            <td>${timestamp}</td>
            <td style="${log.aiReviewCompletedAt ? 'color: #6b21a8; font-weight: 600;' : 'color: #999;'}">${aiReviewTimestamp}</td>
            <td>${log.series || ''}</td>
            <td style="color: #667eea; font-weight: 600;">${getUnitName(unitCode)} ğŸ“–</td>
            <td>
              <button class="table-delete-btn" onclick="event.stopPropagation(); deleteLog('${log._id}')">
                ğŸ—‘ï¸ ì‚­ì œ
              </button>
            </td>
          </tr>
        `;
      }).join('');

      // ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
      if (logs.length > 6) {
        document.getElementById('toggleBtn').style.display = 'block';
      }
    }

    // ===== í•™ìŠµ ê¸°ë¡ ë”ë³´ê¸°/ì ‘ê¸° ê¸°ëŠ¥ =====
    function toggleRows() {
      const hiddenRows = document.querySelectorAll('.hidden-row');
      const toggleBtn = document.getElementById('toggleBtn');

      if (hiddenRows.length === 0) return;

      const isHidden = hiddenRows[0].style.display === 'none' || hiddenRows[0].style.display === '';

      hiddenRows.forEach(row => {
        row.style.display = isHidden ? 'table-row' : 'none';
      });

      toggleBtn.textContent = isHidden ? 'ì ‘ê¸° â–²' : 'ë”ë³´ê¸° â–¼';
    }

    // ===== ì¢…í•© ë ˆì´ë” ì°¨íŠ¸ ìƒì„± =====
    function renderSummaryRadar(logs) {
      const summaryWrap = document.getElementById('summary-radar-wrap');

      // ê³¼ëª© ì½”ë“œ â†’ ê³¼ëª©ëª… ë§¤í•‘
      const subjectNames = {
        'geo': 'ì§€ë¦¬',
        'soc': 'ì‚¬íšŒë¬¸í™”',
        'law': 'ë²•',
        'pol': 'ì •ì¹˜ê²½ì œ',
        'bio': 'ìƒë¬¼',
        'chem': 'í™”í•™',
        'physics': 'ë¬¼ë¦¬',
        'earth': 'ì§€êµ¬ê³¼í•™',
        'classic': 'ê³ ì „ë¬¸í•™',
        'modern': 'í˜„ëŒ€ë¬¸í•™',
        'world': 'ì„¸ê³„ë¬¸í•™(1)',
        'people': 'í•œêµ­ì¸ë¬¼'
      };

      // ê³¼ëª©ë³„ë¡œ ê·¸ë£¹í™” (unit ì½”ë“œì—ì„œ ê³¼ëª© ì¶”ì¶œ: geo, history ë“±)
      const subjectGroups = {};
      logs.forEach(log => {
        if (!log.radar || !log.unit) return;

        // unit ì½”ë“œì—ì„œ ê³¼ëª© ì¶”ì¶œ (geo_01 -> geo, history_01 -> history)
        const subjectCode = log.unit.split('_')[0];
        const subjectKey = (log.series || 'BRAINì—…') + '_' + subjectCode;

        if (!subjectGroups[subjectKey]) {
          subjectGroups[subjectKey] = {
            series: log.series || 'BRAINì—…',
            subjectCode: subjectCode,
            logs: []
          };
        }
        subjectGroups[subjectKey].logs.push(log);
      });

      // ê° ê³¼ëª©ë³„ë¡œ í‰ê·  ê³„ì‚° ë° ì°¨íŠ¸ ìƒì„±
      let summaryIndex = 0;
      Object.keys(subjectGroups).forEach(key => {
        const group = subjectGroups[key];
        const seriesLogs = group.logs;
        const subjectName = subjectNames[group.subjectCode] || group.subjectCode;
        const displayTitle = group.series + ' ' + subjectName;

        // í‰ê·  ê³„ì‚°
        let totalLiteral = 0, totalStructural = 0, totalLexical = 0;
        let totalInferential = 0, totalCritical = 0;
        let count = 0;

        seriesLogs.forEach(log => {
          if (log.radar) {
            totalLiteral += log.radar.literal || 0;
            totalStructural += log.radar.structural || 0;
            totalLexical += log.radar.lexical || 0;
            totalInferential += log.radar.inferential || 0;
            totalCritical += log.radar.critical || 0;
            count++;
          }
        });

        if (count === 0) return;

        const avgLiteral = Math.round((totalLiteral / count) * 10) / 10;
        const avgStructural = Math.round((totalStructural / count) * 10) / 10;
        const avgLexical = Math.round((totalLexical / count) * 10) / 10;
        const avgInferential = Math.round((totalInferential / count) * 10) / 10;
        const avgCritical = Math.round((totalCritical / count) * 10) / 10;

        const scores = [avgLiteral, avgStructural, avgLexical, avgInferential, avgCritical];
        const avgScore = (scores.reduce((a, b) => a + b, 0) / 5).toFixed(1);
        const maxScore = Math.max(...scores).toFixed(1);
        const minScore = Math.min(...scores).toFixed(1);

        // ë±ƒì§€ ë“±ê¸‰ ê²°ì •
        let badgeClass = 'badge-normal';
        let badgeText = 'ë³´í†µ';
        if (avgScore >= 9) {
          badgeClass = 'badge-excellent';
          badgeText = 'ìš°ìˆ˜';
        } else if (avgScore >= 8) {
          badgeClass = 'badge-good';
          badgeText = 'ì–‘í˜¸';
        } else if (avgScore >= 7) {
          badgeClass = 'badge-normal';
          badgeText = 'ë³´í†µ';
        }

        // ì°¨íŠ¸ ì¹´ë“œ ìƒì„±
        const card = document.createElement('div');
        card.className = 'radar-card summary-card' + (summaryIndex >= 6 ? ' hidden-card' : '');
        summaryIndex++;

        const header = document.createElement('div');
        header.className = 'radar-card-header';

        const title = document.createElement('div');
        title.className = 'radar-card-title';
        title.textContent = displayTitle;

        const subtitle = document.createElement('div');
        subtitle.className = 'radar-card-time';
        subtitle.innerHTML = 'ğŸ“š ì´ ' + count + 'íšŒ í•™ìŠµ';

        const badge = document.createElement('div');
        badge.className = 'score-badge ' + badgeClass;
        badge.textContent = badgeText + ' ë“±ê¸‰';

        header.appendChild(title);
        header.appendChild(subtitle);
        header.appendChild(badge);
        card.appendChild(header);

        const canvas = document.createElement('canvas');
        canvas.width = 280;
        canvas.height = 280;
        card.appendChild(canvas);

        // í†µê³„ ì •ë³´
        const stats = document.createElement('div');
        stats.className = 'radar-card-stats';
        stats.innerHTML =
          '<div class="stat-item">' +
            '<div class="stat-label">í‰ê· </div>' +
            '<div class="stat-value">' + avgScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœê³ </div>' +
            '<div class="stat-value">' + maxScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœì €</div>' +
            '<div class="stat-value">' + minScore + '</div>' +
          '</div>';
        card.appendChild(stats);

        summaryWrap.appendChild(card);

        // ì°¨íŠ¸ ìƒì„±
        new Chart(canvas.getContext('2d'), {
          type: 'radar',
          data: {
            labels: ['í•µì‹¬ ì´í•´ë ¥', 'êµ¬ì¡° íŒŒì•…ë ¥', 'ì–´íœ˜ ë§¥ë½ë ¥', 'ì¶”ë¡ Â·í†µí•©ë ¥', 'ë¹„íŒÂ·ì ìš©ë ¥'],
            datasets: [{
              label: displayTitle,
              data: scores,
              backgroundColor: 'rgba(245, 87, 108, 0.2)',
              borderColor: '#f5576c',
              borderWidth: 3,
              pointBackgroundColor: '#f5576c',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              r: {
                suggestedMin: 0,
                suggestedMax: 10,
                ticks: {
                  stepSize: 2,
                  backdropColor: 'transparent',
                  font: { size: 11 }
                },
                pointLabels: {
                  font: { size: 12, weight: 'bold' }
                },
                grid: { color: '#e5d4c1' },
                angleLines: { color: '#e5d4c1' }
              }
            }
          }
        });
      });

      // ì¢…í•© ë ˆì´ë” ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
      if (summaryIndex > 6) {
        document.getElementById('toggleSummaryBtn').style.display = 'block';
      }

      // ì¢…í•© ë ˆì´ë”ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€
      if (summaryIndex === 0) {
        summaryWrap.innerHTML = '<p style="color:#777; font-size:13px;">ì•„ì§ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ìˆëŠ” í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    // ===== ì¢…í•© ë ˆì´ë” ë”ë³´ê¸°/ì ‘ê¸° ê¸°ëŠ¥ =====
    function toggleSummaryRadar() {
      const allCards = document.querySelectorAll('#summary-radar-wrap .radar-card');
      const toggleBtn = document.getElementById('toggleSummaryBtn');
      const isExpanded = toggleBtn.textContent.includes('ì ‘ê¸°');

      allCards.forEach((card, index) => {
        if (index >= 6) {
          if (isExpanded) {
            card.classList.add('hidden-card');
          } else {
            card.classList.remove('hidden-card');
          }
        }
      });

      toggleBtn.textContent = isExpanded ? 'ë”ë³´ê¸° â–¼' : 'ì ‘ê¸° â–²';
    }

    // ===== ë¶„ì•¼ë³„ ì¢…í•© ë ˆì´ë” =====
    function renderFieldRadar(logs) {
      console.log('ğŸ¯ renderFieldRadar ì‹¤í–‰, ì´ ë¡œê·¸:', logs.length);
      const fieldWrap = document.getElementById('field-radar-wrap');

      // ê³¼ëª© ì½”ë“œ â†’ ë¶„ì•¼ ë§¤í•‘
      const subjectToField = {
        'geo': 'ì‚¬íšŒë¶„ì•¼',
        'soc': 'ì‚¬íšŒë¶„ì•¼',
        'law': 'ì‚¬íšŒë¶„ì•¼',
        'pol': 'ì‚¬íšŒë¶„ì•¼',
        'bio': 'ê³¼í•™ë¶„ì•¼',
        'chem': 'ê³¼í•™ë¶„ì•¼',
        'physics': 'ê³¼í•™ë¶„ì•¼',
        'earth': 'ê³¼í•™ë¶„ì•¼',
        'classic': 'í•œêµ­ë¬¸í•™ë¶„ì•¼',
        'modern': 'í•œêµ­ë¬¸í•™ë¶„ì•¼',
        'world': 'ì„¸ê³„ë¬¸í•™ë¶„ì•¼',
        'people': 'ì¸ë¬¼ë¶„ì•¼'
      };

      // ë¶„ì•¼ë³„ë¡œ ê·¸ë£¹í™”
      const fieldGroups = {};
      logs.forEach(log => {
        if (!log.radar || !log.unit) return;

        // unit ì½”ë“œì—ì„œ ê³¼ëª© ì¶”ì¶œ
        const subjectCode = log.unit.split('_')[0];
        const fieldName = subjectToField[subjectCode];

        if (!fieldName) return; // ë§¤í•‘ë˜ì§€ ì•Šì€ ê³¼ëª©ì€ ì œì™¸

        if (!fieldGroups[fieldName]) {
          fieldGroups[fieldName] = [];
        }
        fieldGroups[fieldName].push(log);
      });

      // ê° ë¶„ì•¼ë³„ë¡œ í‰ê·  ê³„ì‚° ë° ì°¨íŠ¸ ìƒì„±
      let fieldIndex = 0;
      Object.keys(fieldGroups).forEach(fieldName => {
        const fieldLogs = fieldGroups[fieldName];

        // í‰ê·  ê³„ì‚°
        let totalLiteral = 0, totalStructural = 0, totalLexical = 0;
        let totalInferential = 0, totalCritical = 0;
        let count = 0;

        fieldLogs.forEach(log => {
          if (log.radar) {
            totalLiteral += log.radar.literal || 0;
            totalStructural += log.radar.structural || 0;
            totalLexical += log.radar.lexical || 0;
            totalInferential += log.radar.inferential || 0;
            totalCritical += log.radar.critical || 0;
            count++;
          }
        });

        if (count === 0) return;

        const avgLiteral = Math.round((totalLiteral / count) * 10) / 10;
        const avgStructural = Math.round((totalStructural / count) * 10) / 10;
        const avgLexical = Math.round((totalLexical / count) * 10) / 10;
        const avgInferential = Math.round((totalInferential / count) * 10) / 10;
        const avgCritical = Math.round((totalCritical / count) * 10) / 10;

        const scores = [avgLiteral, avgStructural, avgLexical, avgInferential, avgCritical];
        const avgScore = (scores.reduce((a, b) => a + b, 0) / 5).toFixed(1);
        const maxScore = Math.max(...scores).toFixed(1);
        const minScore = Math.min(...scores).toFixed(1);

        // ë±ƒì§€ ë“±ê¸‰ ê²°ì •
        let badgeClass = 'badge-normal';
        let badgeText = 'ë³´í†µ';
        if (avgScore >= 9) {
          badgeClass = 'badge-excellent';
          badgeText = 'ìš°ìˆ˜';
        } else if (avgScore >= 8) {
          badgeClass = 'badge-good';
          badgeText = 'ì–‘í˜¸';
        } else if (avgScore >= 7) {
          badgeClass = 'badge-normal';
          badgeText = 'ë³´í†µ';
        }

        // ì°¨íŠ¸ ì¹´ë“œ ìƒì„±
        const card = document.createElement('div');
        card.className = 'radar-card summary-card' + (fieldIndex >= 3 ? ' hidden-card' : '');
        fieldIndex++;

        const header = document.createElement('div');
        header.className = 'radar-card-header';

        const title = document.createElement('div');
        title.className = 'radar-card-title';
        title.textContent = fieldName;

        const subtitle = document.createElement('div');
        subtitle.className = 'radar-card-time';
        subtitle.innerHTML = 'ğŸ“š ì´ ' + count + 'íšŒ í•™ìŠµ';

        const badge = document.createElement('div');
        badge.className = 'score-badge ' + badgeClass;
        badge.textContent = badgeText + ' ë“±ê¸‰';

        header.appendChild(title);
        header.appendChild(subtitle);
        header.appendChild(badge);
        card.appendChild(header);

        const canvas = document.createElement('canvas');
        canvas.width = 280;
        canvas.height = 280;
        card.appendChild(canvas);

        // í†µê³„ ì •ë³´
        const stats = document.createElement('div');
        stats.className = 'radar-card-stats';
        stats.innerHTML =
          '<div class="stat-item">' +
            '<div class="stat-label">í‰ê· </div>' +
            '<div class="stat-value">' + avgScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœê³ </div>' +
            '<div class="stat-value">' + maxScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœì €</div>' +
            '<div class="stat-value">' + minScore + '</div>' +
          '</div>';
        card.appendChild(stats);

        fieldWrap.appendChild(card);

        // ì°¨íŠ¸ ìƒì„±
        new Chart(canvas.getContext('2d'), {
          type: 'radar',
          data: {
            labels: ['í•µì‹¬ ì´í•´ë ¥', 'êµ¬ì¡° íŒŒì•…ë ¥', 'ì–´íœ˜ ë§¥ë½ë ¥', 'ì¶”ë¡ Â·í†µí•©ë ¥', 'ë¹„íŒÂ·ì ìš©ë ¥'],
            datasets: [{
              label: fieldName,
              data: scores,
              backgroundColor: 'rgba(102, 126, 234, 0.2)',
              borderColor: '#667eea',
              borderWidth: 3,
              pointBackgroundColor: '#667eea',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              r: {
                suggestedMin: 0,
                suggestedMax: 10,
                ticks: {
                  stepSize: 2,
                  backdropColor: 'transparent',
                  font: { size: 11 }
                },
                pointLabels: {
                  font: { size: 12, weight: 'bold' }
                },
                grid: { color: '#e5d4c1' },
                angleLines: { color: '#e5d4c1' }
              }
            }
          }
        });
      });

      // ë¶„ì•¼ë³„ ë ˆì´ë” ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
      if (fieldIndex > 3) {
        document.getElementById('toggleFieldBtn').style.display = 'block';
      }

      // ë¶„ì•¼ë³„ ë ˆì´ë”ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€
      if (fieldIndex === 0) {
        console.log('âš ï¸ ë¶„ì•¼ë³„ ë ˆì´ë” ë°ì´í„° ì—†ìŒ');
        fieldWrap.innerHTML = '<p style="color:#777; font-size:13px;">ì•„ì§ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ìˆëŠ” í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      } else {
        console.log('âœ… ë¶„ì•¼ë³„ ë ˆì´ë” ì°¨íŠ¸ ìƒì„± ì™„ë£Œ, ì´:', fieldIndex);
      }
    }

    // ===== ë¶„ì•¼ë³„ ë ˆì´ë” ë”ë³´ê¸°/ì ‘ê¸° ê¸°ëŠ¥ =====
    function toggleFieldRadar() {
      const allCards = document.querySelectorAll('#field-radar-wrap .radar-card');
      const toggleBtn = document.getElementById('toggleFieldBtn');
      const isExpanded = toggleBtn.textContent.includes('ì ‘ê¸°');

      allCards.forEach((card, index) => {
        if (index >= 3) {
          if (isExpanded) {
            card.classList.add('hidden-card');
          } else {
            card.classList.remove('hidden-card');
          }
        }
      });

      toggleBtn.textContent = isExpanded ? 'ë”ë³´ê¸° â–¼' : 'ì ‘ê¸° â–²';
    }

    // ===== ì‹œë¦¬ì¦ˆ ì¢…í•© ë ˆì´ë” =====
    function renderSeriesRadar(logs) {
      console.log('ğŸ¯ renderSeriesRadar ì‹¤í–‰, ì´ ë¡œê·¸:', logs.length);
      const seriesWrap = document.getElementById('series-radar-wrap');

      // ëª¨ë“  radar ë°ì´í„°ê°€ ìˆëŠ” ë¡œê·¸ ìˆ˜ì§‘
      const validLogs = logs.filter(log => log.radar);
      console.log('ğŸ“Š radar ë°ì´í„°ê°€ ìˆëŠ” ë¡œê·¸:', validLogs.length);

      if (validLogs.length === 0) {
        console.log('âš ï¸ ìœ íš¨í•œ ë¡œê·¸ê°€ ì—†ìŒ');
        seriesWrap.innerHTML = '<p style="color:#777; font-size:13px;">ì•„ì§ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ìˆëŠ” í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }
      console.log('âœ… ì‹œë¦¬ì¦ˆ ë ˆì´ë” ì°¨íŠ¸ ìƒì„± ì‹œì‘');

      // ì „ì²´ í‰ê·  ê³„ì‚°
      let totalLiteral = 0, totalStructural = 0, totalLexical = 0;
      let totalInferential = 0, totalCritical = 0;
      let count = 0;

      validLogs.forEach(log => {
        totalLiteral += log.radar.literal || 0;
        totalStructural += log.radar.structural || 0;
        totalLexical += log.radar.lexical || 0;
        totalInferential += log.radar.inferential || 0;
        totalCritical += log.radar.critical || 0;
        count++;
      });

      const avgLiteral = Math.round((totalLiteral / count) * 10) / 10;
      const avgStructural = Math.round((totalStructural / count) * 10) / 10;
      const avgLexical = Math.round((totalLexical / count) * 10) / 10;
      const avgInferential = Math.round((totalInferential / count) * 10) / 10;
      const avgCritical = Math.round((totalCritical / count) * 10) / 10;

      const scores = [avgLiteral, avgStructural, avgLexical, avgInferential, avgCritical];
      const avgScore = (scores.reduce((a, b) => a + b, 0) / 5).toFixed(1);
      const maxScore = Math.max(...scores).toFixed(1);
      const minScore = Math.min(...scores).toFixed(1);

      // ë±ƒì§€ ë“±ê¸‰ ê²°ì •
      let badgeClass = 'badge-normal';
      let badgeText = 'ë³´í†µ';
      if (avgScore >= 9) {
        badgeClass = 'badge-excellent';
        badgeText = 'ìš°ìˆ˜';
      } else if (avgScore >= 8) {
        badgeClass = 'badge-good';
        badgeText = 'ì–‘í˜¸';
      } else if (avgScore >= 7) {
        badgeClass = 'badge-normal';
        badgeText = 'ë³´í†µ';
      }

      // ì‹œë¦¬ì¦ˆ ì´ë¦„ (ì²« ë²ˆì§¸ ë¡œê·¸ì˜ series ì‚¬ìš©, ì—†ìœ¼ë©´ 'BRAINì—…')
      const seriesName = validLogs[0].series || 'BRAINì—…';

      // ì°¨íŠ¸ ì¹´ë“œ ìƒì„±
      const card = document.createElement('div');
      card.className = 'radar-card summary-card';

      const header = document.createElement('div');
      header.className = 'radar-card-header';

      const title = document.createElement('div');
      title.className = 'radar-card-title';
      title.textContent = seriesName;

      const subtitle = document.createElement('div');
      subtitle.className = 'radar-card-time';
      subtitle.innerHTML = 'ğŸ“š ì´ ' + count + 'íšŒ í•™ìŠµ';

      const badge = document.createElement('div');
      badge.className = 'score-badge ' + badgeClass;
      badge.textContent = badgeText + ' ë“±ê¸‰';

      header.appendChild(title);
      header.appendChild(subtitle);
      header.appendChild(badge);
      card.appendChild(header);

      const canvas = document.createElement('canvas');
      canvas.width = 280;
      canvas.height = 280;
      card.appendChild(canvas);

      // í†µê³„ ì •ë³´
      const stats = document.createElement('div');
      stats.className = 'radar-card-stats';
      stats.innerHTML =
        '<div class="stat-item">' +
          '<div class="stat-label">í‰ê· </div>' +
          '<div class="stat-value">' + avgScore + '</div>' +
        '</div>' +
        '<div class="stat-item">' +
          '<div class="stat-label">ìµœê³ </div>' +
          '<div class="stat-value">' + maxScore + '</div>' +
        '</div>' +
        '<div class="stat-item">' +
          '<div class="stat-label">ìµœì €</div>' +
          '<div class="stat-value">' + minScore + '</div>' +
        '</div>';
      card.appendChild(stats);

      seriesWrap.appendChild(card);

      // ì°¨íŠ¸ ìƒì„±
      new Chart(canvas.getContext('2d'), {
        type: 'radar',
        data: {
          labels: ['í•µì‹¬ ì´í•´ë ¥', 'êµ¬ì¡° íŒŒì•…ë ¥', 'ì–´íœ˜ ë§¥ë½ë ¥', 'ì¶”ë¡ Â·í†µí•©ë ¥', 'ë¹„íŒÂ·ì ìš©ë ¥'],
          datasets: [{
            label: seriesName + ' ì „ì²´',
            data: scores,
            backgroundColor: 'rgba(255, 193, 7, 0.2)',
            borderColor: '#ffc107',
            borderWidth: 3,
            pointBackgroundColor: '#ffc107',
            pointBorderColor: '#fff',
            pointBorderWidth: 2,
            pointRadius: 5,
            pointHoverRadius: 7
          }]
        },
        options: {
          responsive: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            r: {
              suggestedMin: 0,
              suggestedMax: 10,
              ticks: {
                stepSize: 2,
                backdropColor: 'transparent',
                font: { size: 11 }
              },
              pointLabels: {
                font: { size: 12, weight: 'bold' }
              },
              grid: { color: '#e5d4c1' },
              angleLines: { color: '#e5d4c1' }
            }
          }
        }
      });
    }

    function renderRadarCharts(logs) {
      const wrap = document.getElementById('radar-wrap');
      let radarIndex = 0;

      logs.forEach(function(log, idx) {
        if (!log.radar) return;

        const r = log.radar || {};

        // í‰ê·  ì ìˆ˜ ê³„ì‚°
        const scores = [
          r.literal || 0,
          r.structural || 0,
          r.lexical || 0,
          r.inferential || 0,
          r.critical || 0
        ];
        const avgScore = (scores.reduce((a, b) => a + b, 0) / 5).toFixed(1);
        const maxScore = Math.max(...scores).toFixed(1);
        const minScore = Math.min(...scores).toFixed(1);

        // ë±ƒì§€ ë“±ê¸‰ ê²°ì •
        let badgeClass = 'badge-normal';
        let badgeText = 'ë³´í†µ';
        if (avgScore >= 9) {
          badgeClass = 'badge-excellent';
          badgeText = 'ìš°ìˆ˜';
        } else if (avgScore >= 8) {
          badgeClass = 'badge-good';
          badgeText = 'ì–‘í˜¸';
        } else if (avgScore >= 7) {
          badgeClass = 'badge-normal';
          badgeText = 'ë³´í†µ';
        }

        const card = document.createElement('div');
        card.className = 'radar-card' + (radarIndex >= 6 ? ' hidden-card' : '');

        const header = document.createElement('div');
        header.className = 'radar-card-header';

        // ì‚­ì œ ë²„íŠ¼ ì¶”ê°€
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-btn';
        deleteBtn.textContent = 'âœ•';
        deleteBtn.onclick = function() {
          deleteLog(log._id);
        };
        header.appendChild(deleteBtn);

        const title = document.createElement('div');
        title.className = 'radar-card-title';
        title.textContent = getUnitName(log.unit || 'ë‹¨ì› ë¯¸ì§€ì •');

        const time = document.createElement('div');
        time.className = 'radar-card-time';
        time.innerHTML = 'ğŸ• ' + (log.timestamp ? new Date(log.timestamp).toLocaleString('ko-KR') : '-');

        const badge = document.createElement('div');
        badge.className = 'score-badge ' + badgeClass;
        badge.textContent = badgeText + ' ë“±ê¸‰';

        header.appendChild(title);
        header.appendChild(time);
        header.appendChild(badge);
        card.appendChild(header);

        const canvas = document.createElement('canvas');
        canvas.id = 'radar-' + idx;
        canvas.width = 280;
        canvas.height = 280;
        card.appendChild(canvas);

        // í†µê³„ ì •ë³´
        const stats = document.createElement('div');
        stats.className = 'radar-card-stats';
        stats.innerHTML =
          '<div class="stat-item">' +
            '<div class="stat-label">í‰ê· </div>' +
            '<div class="stat-value">' + avgScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœê³ </div>' +
            '<div class="stat-value">' + maxScore + '</div>' +
          '</div>' +
          '<div class="stat-item">' +
            '<div class="stat-label">ìµœì €</div>' +
            '<div class="stat-value">' + minScore + '</div>' +
          '</div>';
        card.appendChild(stats);

        wrap.appendChild(card);

        new Chart(canvas.getContext('2d'), {
          type: 'radar',
          data: {
            labels: ['í•µì‹¬ ì´í•´ë ¥', 'êµ¬ì¡° íŒŒì•…ë ¥', 'ì–´íœ˜ ë§¥ë½ë ¥', 'ì¶”ë¡ Â·í†µí•©ë ¥', 'ë¹„íŒÂ·ì ìš©ë ¥'],
            datasets: [{
              label: getUnitName(log.unit || 'ë‹¨ì›') + ' ë¶„ì„ë¦¬í¬íŠ¸',
              data: scores,
              backgroundColor: 'rgba(102, 126, 234, 0.2)',
              borderColor: '#667eea',
              borderWidth: 3,
              pointBackgroundColor: '#667eea',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              r: {
                suggestedMin: 0,
                suggestedMax: 10,
                ticks: {
                  stepSize: 2,
                  backdropColor: 'transparent',
                  font: { size: 11 }
                },
                pointLabels: {
                  font: { size: 12, weight: 'bold' }
                },
                grid: { color: '#e5d4c1' },
                angleLines: { color: '#e5d4c1' }
              }
            }
          }
        });

        radarIndex++;
      });

      // ê°œë³„ ë ˆì´ë” ì°¨íŠ¸ ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
      if (radarIndex > 6) {
        document.getElementById('toggleRadarBtn').style.display = 'block';
      }

      // radar ë°ì´í„°ê°€ ìˆëŠ” ì¹´ë“œê°€ í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€
      if (wrap.children.length === 0) {
        wrap.innerHTML = '<p style="color:#777; font-size:13px;">ì•„ì§ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ìˆëŠ” í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    // ===== ë‹¨ì›ë³„ ë ˆì´ë” ë”ë³´ê¸°/ì ‘ê¸° ê¸°ëŠ¥ =====
    function toggleRadar() {
      const allCards = document.querySelectorAll('#radar-wrap .radar-card');
      const toggleBtn = document.getElementById('toggleRadarBtn');
      const isExpanded = toggleBtn.textContent.includes('ì ‘ê¸°');

      allCards.forEach((card, index) => {
        if (index >= 6) {
          if (isExpanded) {
            card.classList.add('hidden-card');
          } else {
            card.classList.remove('hidden-card');
          }
        }
      });

      toggleBtn.textContent = isExpanded ? 'ë”ë³´ê¸° â–¼' : 'ì ‘ê¸° â–²';
    }

    // ===== PDF ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜ =====
    async function downloadPDF() {
      const container = document.querySelector('.container');
      const { jsPDF } = window.jspdf;

      try {
        // ëª¨ë“  hidden ìš”ì†Œë¥¼ ì„ì‹œë¡œ í‘œì‹œ
        const hiddenRows = document.querySelectorAll('.hidden-row');
        const hiddenCards = document.querySelectorAll('.hidden-card');
        const toggleBtns = document.querySelectorAll('.toggle-btn');

        hiddenRows.forEach(row => row.style.display = 'table-row');
        hiddenCards.forEach(card => card.classList.remove('hidden-card'));
        toggleBtns.forEach(btn => btn.style.display = 'none');

        const canvas = await html2canvas(container, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: '#ffffff'
        });

        // ì›ë˜ëŒ€ë¡œ ë³µêµ¬
        hiddenRows.forEach((row, idx) => {
          if (idx >= 6) row.style.display = 'none';
        });
        hiddenCards.forEach(card => card.classList.add('hidden-card'));
        toggleBtns.forEach(btn => {
          if (btn.textContent.includes('ë”ë³´ê¸°') || btn.textContent.includes('ì ‘ê¸°')) {
            btn.style.display = 'block';
          }
        });

        const imgData = canvas.toDataURL('image/jpeg', 0.5);
        const pdf = new jsPDF({
          orientation: 'portrait',
          unit: 'mm',
          format: 'a4'
        });

        const imgWidth = 210;
        const pageHeight = 297;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft > 0) {
          position = heightLeft - imgHeight;
          pdf.addPage();
          pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;
        }

        const fileName = `í•™ìŠµì´ë ¥_${grade}_${name}_${new Date().toISOString().slice(0, 10)}.pdf`;
        pdf.save(fileName);
      } catch (error) {
        console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
        alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    }
  </script>

  <script>
    // í•™ìŠµì´ë ¥ ì „ì†¡ (mailto ë°©ì‹)
    function openSendModal() {
      const subject = `[ë‹¨ë‹¨êµì‹¤] ${grade} ${name} í•™ìƒ í•™ìŠµì´ë ¥`;
      const body = `ì•ˆë…•í•˜ì„¸ìš”,\n\n${grade} ${name} í•™ìƒì˜ í•™ìŠµì´ë ¥ ë¦¬í¬íŠ¸ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.\n\nğŸ“Š í•™ìŠµ ë¶„ì„ ë‚´ìš©:\n- í•™ìŠµ ê¸°ë¡ ë° ì ìˆ˜\n- ë‹¨ì›ë³„ ë¬¸ì œë³„ ë ˆì´ë” ì°¨íŠ¸\n- ì¢…í•© ë¶„ì„ ê²°ê³¼\n\nìì„¸í•œ ë‚´ìš©ì€ ì²¨ë¶€ëœ PDF íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\n\nâ€» PDF íŒŒì¼ì€ 'ë‹¤ìš´ë¡œë“œ' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë¨¼ì € ì €ì¥í•œ í›„ ì´ë©”ì¼ì— ì²¨ë¶€í•´ì£¼ì„¸ìš”.\n\nê°ì‚¬í•©ë‹ˆë‹¤.`;

      const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

      console.log('ğŸ“§ ì´ë©”ì¼ ì•± ì—´ê¸°:', mailtoLink);
      window.location.href = mailtoLink;
    }
  </script>

  <div class="action-buttons">
    <button class="btn-send" onclick="openSendModal()">
      ğŸ“¤ ì´ë©”ì¼ ì „ì†¡
    </button>
    <button class="btn-kakao" onclick="shareKakao()">
      ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ì „ì†¡
    </button>
    <button class="btn-download-action" onclick="downloadPDF()">
      ğŸ“¥ ë‹¤ìš´ë¡œë“œ
    </button>
  </div>

  <script>
    // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”
    if (!Kakao.isInitialized()) {
      Kakao.init('6ad10cc6680c7a5829a4fd7a3cbb4a7e');
      console.log('âœ… Kakao SDK ì´ˆê¸°í™” ì™„ë£Œ:', Kakao.isInitialized());
    }

    // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  í•¨ìˆ˜
    function shareKakao() {
      const params = new URLSearchParams(window.location.search);
      const grade = params.get('grade') || '';
      const name = params.get('name') || '';

      // ë°°í¬ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ ë„ë©”ì¸ ì‚¬ìš©
      const baseUrl = window.location.hostname === 'localhost'
        ? window.location.origin
        : 'https://dan-dan-app.onrender.com';

      const reportUrl = `${baseUrl}/admin/branch/logs?${window.location.search.substring(1)}`;

      if (typeof Kakao !== 'undefined' && Kakao.isInitialized()) {
        try {
          Kakao.Share.sendDefault({
            objectType: 'feed',
            content: {
              title: `ğŸ“Š ${grade} ${name} í•™ìƒ í•™ìŠµ ì´ë ¥ ë¦¬í¬íŠ¸`,
              description: 'ë‹¨ë‹¨êµ­ì–´ í•™ìŠµ ì´ë ¥ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”!\n\nğŸ“ˆ í•™ìŠµ ê¸°ë¡ ë° ì ìˆ˜\nğŸ“Š ë‹¨ì›ë³„ ë¬¸í•´ë ¥ ë ˆì´ë” ì°¨íŠ¸\nâœ¨ ì¢…í•© ë¶„ì„ ê²°ê³¼',
              imageUrl: 'https://cdn.jsdelivr.net/gh/kukicoollevitt-hash/dan-dan-app@main/public/images/report-share-thumbnail.png',
              link: {
                mobileWebUrl: reportUrl,
                webUrl: reportUrl
              }
            },
            buttons: [
              {
                title: 'ë¦¬í¬íŠ¸ ë³´ê¸°',
                link: {
                  mobileWebUrl: reportUrl,
                  webUrl: reportUrl
                }
              }
            ]
          });
          console.log('âœ… ì¹´ì¹´ì˜¤í†¡ ê³µìœ í•˜ê¸° ì‹¤í–‰ë¨:', reportUrl);
        } catch (error) {
          console.error('âŒ ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ì˜¤ë¥˜:', error);
          alert('ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì¹´ì¹´ì˜¤í†¡ì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }
      } else {
        console.error('âŒ Kakao SDKê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
        alert('ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    }
  </script>

</body>
</html>
