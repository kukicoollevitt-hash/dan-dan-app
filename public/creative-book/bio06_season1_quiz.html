<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ³ ë„í† ë¦¬ì˜ ìœ„ëŒ€í•œ ëª¨í—˜ - ê´€ë¬¸í‰ê°€</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Gmarket Sans", "Noto Sans KR", sans-serif;
      background: linear-gradient(135deg, #3E2723 0%, #5D4037 50%, #6D4C41 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .quiz-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 24px;
      padding: 40px;
      max-width: 700px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .quiz-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .quiz-header h1 {
      font-size: 28px;
      color: #3E2723;
      margin-bottom: 10px;
    }

    .quiz-header p {
      color: #666;
      font-size: 14px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      margin-bottom: 30px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #5D4037, #8D6E63);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .question-number {
      display: inline-block;
      padding: 6px 16px;
      background: linear-gradient(135deg, #5D4037 0%, #3E2723 100%);
      color: white;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .category-tag {
      display: inline-block;
      padding: 4px 12px;
      background: rgba(93, 64, 55, 0.1);
      color: #5D4037;
      border-radius: 12px;
      font-size: 12px;
      margin-left: 10px;
    }

    .question-text {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 25px;
      line-height: 1.6;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      padding: 16px 20px;
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 15px;
      color: #444;
    }

    .option:hover {
      border-color: #5D4037;
      background: rgba(93, 64, 55, 0.05);
    }

    .option.selected {
      border-color: #5D4037;
      background: rgba(93, 64, 55, 0.1);
      color: #3E2723;
      font-weight: 600;
    }

    .option.correct {
      border-color: #27ae60;
      background: rgba(39, 174, 96, 0.15);
      color: #1e8449;
    }

    .option.wrong {
      border-color: #e74c3c;
      background: rgba(231, 76, 60, 0.15);
      color: #c0392b;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      gap: 15px;
    }

    .nav-btn {
      flex: 1;
      padding: 14px 24px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .nav-btn.prev {
      background: #e9ecef;
      color: #666;
    }

    .nav-btn.next {
      background: linear-gradient(135deg, #5D4037 0%, #3E2723 100%);
      color: white;
    }

    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* ê²°ê³¼ í™”ë©´ */
    .result-container {
      display: none;
      text-align: center;
    }

    .result-container.show {
      display: block;
    }

    .result-title {
      font-size: 32px;
      color: #3E2723;
      margin-bottom: 10px;
    }

    .result-score {
      font-size: 64px;
      font-weight: 700;
      color: #5D4037;
      margin: 20px 0;
    }

    .result-message {
      font-size: 18px;
      color: #666;
      margin-bottom: 30px;
    }

    .radar-container {
      width: 300px;
      height: 300px;
      margin: 0 auto 30px;
    }

    .category-scores {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .category-score {
      padding: 8px 16px;
      background: rgba(93, 64, 55, 0.1);
      border-radius: 20px;
      font-size: 13px;
      color: #3E2723;
    }

    .restart-btn {
      padding: 16px 40px;
      background: linear-gradient(135deg, #5D4037 0%, #3E2723 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .restart-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .close-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 44px;
      height: 44px;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      border-radius: 50%;
      font-size: 24px;
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    @media (max-width: 768px) {
      .quiz-container {
        padding: 25px;
        margin: 10px;
      }

      .quiz-header h1 {
        font-size: 22px;
      }

      .question-text {
        font-size: 16px;
      }

      .option {
        padding: 14px 16px;
        font-size: 14px;
      }

      .result-score {
        font-size: 48px;
      }

      .radar-container {
        width: 250px;
        height: 250px;
      }
    }
  </style>
</head>
<body>

  <button class="close-btn" onclick="closeQuiz()">Ã—</button>

  <div class="quiz-container">
    <!-- í€´ì¦ˆ í™”ë©´ -->
    <div id="quiz-screen">
      <div class="quiz-header">
        <h1>ğŸŒ³ ë„í† ë¦¬ì˜ ìœ„ëŒ€í•œ ëª¨í—˜</h1>
        <p>ê´€ë¬¸í‰ê°€ - ì´ì•¼ê¸°ë¥¼ ì˜ ì´í•´í–ˆëŠ”ì§€ í™•ì¸í•´ ë³´ì„¸ìš”!</p>
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>

      <div id="question-container">
        <span class="question-number" id="question-number">1/10</span>
        <span class="category-tag" id="category-tag">ì¸ë¬¼íŒŒì•…</span>
        <p class="question-text" id="question-text"></p>
        <div class="options" id="options"></div>
      </div>

      <div class="nav-buttons">
        <button class="nav-btn prev" id="prev-btn" onclick="prevQuestion()">ì´ì „</button>
        <button class="nav-btn next" id="next-btn" onclick="nextQuestion()">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- ê²°ê³¼ í™”ë©´ -->
    <div class="result-container" id="result-screen">
      <h2 class="result-title">ğŸ‰ í‰ê°€ ì™„ë£Œ!</h2>
      <div class="result-score" id="result-score">0ì </div>
      <p class="result-message" id="result-message"></p>

      <div class="radar-container">
        <canvas id="radar-chart" width="300" height="300"></canvas>
      </div>

      <div class="category-scores" id="category-scores"></div>

      <button class="restart-btn" onclick="closeQuiz()">ëŒì•„ê°€ê¸°</button>
    </div>
  </div>

  <script>
    // í€´ì¦ˆ ë°ì´í„° - 5ê°œ ì˜ì—­, ê° 2ë¬¸ì œì”© (ì´ 10ë¬¸ì œ)
    const quizData = [
      // ì¸ë¬¼íŒŒì•… (2ë¬¸ì œ)
      {
        category: "ì¸ë¬¼íŒŒì•…",
        question: "ë¿Œë¦¬ë§ˆì„ì—ì„œ ê°€ì¥ ì˜¤ë˜ë˜ê³  300ë…„ ë„˜ê²Œ ì„œ ìˆëŠ” ë‚˜ë¬´ëŠ” ëˆ„êµ¬ì¸ê°€ìš”?",
        options: ["ì†Œë‚˜ë¬´ ì•„ì €ì”¨", "ë–¡ê°ˆë‚˜ë¬´ í• ì•„ë²„ì§€", "ê°€ì‹œì¥êµ°", "íƒ±ìë‚˜ë¬´ ì‚¼ì´Œ"],
        answer: 1
      },
      {
        category: "ì¸ë¬¼íŒŒì•…",
        question: "ë‚ ì¹´ë¡œìš´ ê°€ì‹œë¡œ ì´ì›ƒì„ ì§€í‚¤ëŠ” ìš©ê°í•œ ë‚˜ë¬´ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”?",
        options: ["ë°”ëŒëŒì´", "í–‡ì‚´ì´", "ê°€ì‹œì¥êµ°", "ì„ ì¸ì¥ ì´ëª¨"],
        answer: 2
      },
      // ë‚´ìš©ì¼ì¹˜ (2ë¬¸ì œ)
      {
        category: "ë‚´ìš©ì¼ì¹˜",
        question: "ë„í† ë¦¬ëŠ” ì–´ë–¤ ë™ë¬¼ì˜ ë„ì›€ì„ ë°›ì•„ ì—¬í–‰ì„ ë– ë‚˜ë‚˜ìš”?",
        options: ["ìƒˆì™€ í† ë¼", "ë‹¤ëŒì¥ì™€ ì²­ì„¤ëª¨", "ì‚¬ìŠ´ê³¼ ë„ˆêµ¬ë¦¬", "ê³°ê³¼ ì—¬ìš°"],
        answer: 1
      },
      {
        category: "ë‚´ìš©ì¼ì¹˜",
        question: "í˜¸ë‘ë‚˜ë¬´ê°€ ë¿Œë¦¬ì—ì„œ ë‚´ë³´ë‚´ ì£¼ë³€ ì‹ë¬¼ì˜ ì„±ì¥ì„ ë°©í•´í•˜ëŠ” ë¬¼ì§ˆì˜ ì´ë¦„ì€?",
        options: ["ì—½ë¡ì†Œ", "ìœ ê¸€ë¡ ", "í¬ë„ë‹¹", "ì‚°ì†Œ"],
        answer: 1
      },
      // ë‚´ìš©êµ¬ì¡° (2ë¬¸ì œ)
      {
        category: "ë‚´ìš©êµ¬ì¡°",
        question: "ì´ ì´ì•¼ê¸°ì—ì„œ ë¿Œë¦¬ë¥¼ 'ë‚˜ë¬´ì˜ ì¸í„°ë„·'ì´ë¼ê³  ë¶€ë¥¸ ì´ìœ ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?",
        options: ["ë¿Œë¦¬ê°€ ë¬¼ì„ ë¹¨ì•„ë“¤ì´ê¸° ë•Œë¬¸ì—", "ë¿Œë¦¬ê°€ ë•…ì„ íŒŒê¸° ë•Œë¬¸ì—", "ë¿Œë¦¬ë¡œ ë‹¤ë¥¸ ë‚˜ë¬´ì™€ ì†Œí†µí•˜ê³  ì •ë³´ë¥¼ ì£¼ê³ ë°›ê¸° ë•Œë¬¸ì—", "ë¿Œë¦¬ê°€ ë¹¨ë¦¬ ìë¼ê¸° ë•Œë¬¸ì—"],
        answer: 2
      },
      {
        category: "ë‚´ìš©êµ¬ì¡°",
        question: "ì´ ì´ì•¼ê¸°ì˜ í•µì‹¬ ì£¼ì œë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?",
        options: ["ì›€ì§ì´ì§€ ì•Šì•„ë„ ì„¸ìƒì„ ë°”ê¿€ ìˆ˜ ìˆë‹¤", "ë™ë¬¼ì´ ì‹ë¬¼ë³´ë‹¤ ë” ìœ„ëŒ€í•˜ë‹¤", "ë‚˜ë¬´ëŠ” ì§€ë£¨í•œ ì‚¶ì„ ì‚°ë‹¤", "ê²½ìŸì—ì„œ ì´ê¸°ëŠ” ê²ƒë§Œì´ ì¤‘ìš”í•˜ë‹¤"],
        answer: 0
      },
      // ë‚´ìš©ì–´íœ˜ (2ë¬¸ì œ)
      {
        category: "ë‚´ìš©ì–´íœ˜",
        question: "'ê´‘í•©ì„±'ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?",
        options: ["ë¿Œë¦¬ë¡œ ë¬¼ì„ ë¹¨ì•„ë“¤ì´ëŠ” ê²ƒ", "ìì—ì„œ ë¹›, ë¬¼, ì´ì‚°í™”íƒ„ì†Œë¡œ í¬ë„ë‹¹ì„ ë§Œë“œëŠ” ê²ƒ", "ì¤„ê¸°ë¡œ ì–‘ë¶„ì„ ë‚´ë ¤ë³´ë‚´ëŠ” ê²ƒ", "ì”¨ì•—ì´ ì‹¹íŠ¸ëŠ” ê²ƒ"],
        answer: 1
      },
      {
        category: "ë‚´ìš©ì–´íœ˜",
        question: "ë‚˜ë¬´ ì¤„ê¸° ì•ˆì—ì„œ ë¬¼ì´ ê¼­ëŒ€ê¸°ê¹Œì§€ ì˜¬ë¼ê°€ëŠ” ê´€ì„ ë¬´ì—‡ì´ë¼ê³  í•˜ë‚˜ìš”?",
        options: ["ì²´ê´€", "ë¬¼ê´€", "ê¸°ê³µ", "ë‚˜ì´í…Œ"],
        answer: 1
      },
      // ë‚´ìš©ì¶”ë¡  (2ë¬¸ì œ)
      {
        category: "ë‚´ìš©ì¶”ë¡ ",
        question: "ê°€ì„ì— ë‚˜ë¬´ê°€ ìŠ¤ìŠ¤ë¡œ ìì„ ë–¨ì–´ëœ¨ë¦¬ëŠ” ì´ìœ ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?",
        options: ["ìì´ ì•„íŒŒì„œ", "ê²¨ìš¸ì— ê´‘í•©ì„± íš¨ìœ¨ì´ ë–¨ì–´ì§€ë¯€ë¡œ ì—ë„ˆì§€ë¥¼ ì ˆì•½í•˜ë ¤ê³ ", "ë°”ëŒì´ ì‹«ì–´ì„œ", "ìƒˆ ìì„ ë‹¬ê¸° ìœ„í•´"],
        answer: 1
      },
      {
        category: "ë‚´ìš©ì¶”ë¡ ",
        question: "ì„ ì¸ì¥ì´ ìì„ ê°€ì‹œë¡œ ë°”ê¾¼ ì´ìœ ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?",
        options: ["ë‹¤ë¥¸ ë™ë¬¼ì„ ê³µê²©í•˜ë ¤ê³ ", "ë” ì˜ˆì˜ê²Œ ë³´ì´ë ¤ê³ ", "ë¬¼ì´ ì¦ë°œí•˜ëŠ” ê²ƒì„ ë§‰ì•„ ê±´ì¡°í•œ í™˜ê²½ì—ì„œ ì‚´ì•„ë‚¨ìœ¼ë ¤ê³ ", "í–‡ë¹›ì„ ë” ë§ì´ ë°›ìœ¼ë ¤ê³ "],
        answer: 2
      }
    ];

    let currentQuestion = 0;
    let userAnswers = new Array(quizData.length).fill(null);
    let answered = new Array(quizData.length).fill(false);

    // ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜ ì¶”ì 
    const categoryScores = {
      "ì¸ë¬¼íŒŒì•…": { correct: 0, total: 2 },
      "ë‚´ìš©ì¼ì¹˜": { correct: 0, total: 2 },
      "ë‚´ìš©êµ¬ì¡°": { correct: 0, total: 2 },
      "ë‚´ìš©ì–´íœ˜": { correct: 0, total: 2 },
      "ë‚´ìš©ì¶”ë¡ ": { correct: 0, total: 2 }
    };

    function renderQuestion() {
      const q = quizData[currentQuestion];
      document.getElementById('question-number').textContent = `${currentQuestion + 1}/${quizData.length}`;
      document.getElementById('category-tag').textContent = q.category;
      document.getElementById('question-text').textContent = q.question;
      document.getElementById('progress-fill').style.width = `${((currentQuestion + 1) / quizData.length) * 100}%`;

      const optionsContainer = document.getElementById('options');
      optionsContainer.innerHTML = '';

      q.options.forEach((opt, idx) => {
        const optDiv = document.createElement('div');
        optDiv.className = 'option';
        if (userAnswers[currentQuestion] === idx) {
          optDiv.classList.add('selected');
        }
        if (answered[currentQuestion]) {
          if (idx === q.answer) {
            optDiv.classList.add('correct');
          } else if (userAnswers[currentQuestion] === idx) {
            optDiv.classList.add('wrong');
          }
        }
        optDiv.textContent = opt;
        optDiv.onclick = () => selectOption(idx);
        optionsContainer.appendChild(optDiv);
      });

      document.getElementById('prev-btn').disabled = currentQuestion === 0;
      const nextBtn = document.getElementById('next-btn');
      if (currentQuestion === quizData.length - 1) {
        nextBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
      } else {
        nextBtn.textContent = 'ë‹¤ìŒ';
      }
    }

    function selectOption(idx) {
      if (answered[currentQuestion]) return;

      userAnswers[currentQuestion] = idx;
      answered[currentQuestion] = true;

      const q = quizData[currentQuestion];
      if (idx === q.answer) {
        categoryScores[q.category].correct++;
      }

      renderQuestion();
    }

    function prevQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion();
      }
    }

    function nextQuestion() {
      if (userAnswers[currentQuestion] === null) {
        alert('ë‹µì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
        return;
      }

      if (currentQuestion < quizData.length - 1) {
        currentQuestion++;
        renderQuestion();
      } else {
        showResult();
      }
    }

    function convertToRadarScore(correct) {
      // 2ë¬¸ì œ ì¤‘: 2ê°œ ë§ìœ¼ë©´ 10ì , 1ê°œ ë§ìœ¼ë©´ 5ì , 0ê°œ ë§ìœ¼ë©´ 1ì 
      if (correct === 2) return 10;
      if (correct === 1) return 5;
      return 1;
    }

    function showResult() {
      document.getElementById('quiz-screen').style.display = 'none';
      document.getElementById('result-screen').classList.add('show');

      // ì´ì  ê³„ì‚° (100ì  ë§Œì  ë³€í™˜)
      let totalCorrect = 0;
      Object.values(categoryScores).forEach(cat => {
        totalCorrect += cat.correct;
      });

      // ê° ì¹´í…Œê³ ë¦¬ë³„ ë ˆì´ë” ì ìˆ˜ ê³„ì‚°
      const radarScores = {
        "ì¸ë¬¼íŒŒì•…": convertToRadarScore(categoryScores["ì¸ë¬¼íŒŒì•…"].correct),
        "ë‚´ìš©ì¼ì¹˜": convertToRadarScore(categoryScores["ë‚´ìš©ì¼ì¹˜"].correct),
        "ë‚´ìš©êµ¬ì¡°": convertToRadarScore(categoryScores["ë‚´ìš©êµ¬ì¡°"].correct),
        "ë‚´ìš©ì–´íœ˜": convertToRadarScore(categoryScores["ë‚´ìš©ì–´íœ˜"].correct),
        "ë‚´ìš©ì¶”ë¡ ": convertToRadarScore(categoryScores["ë‚´ìš©ì¶”ë¡ "].correct)
      };

      // ì´ì  = 5ê°œ ì˜ì—­ ë ˆì´ë” ì ìˆ˜ í•© * 2 (ìµœëŒ€ 50ì  -> 100ì )
      const totalScore = Object.values(radarScores).reduce((a, b) => a + b, 0) * 2;

      document.getElementById('result-score').textContent = `${totalScore}ì `;

      let message = '';
      if (totalScore >= 90) message = 'ğŸŒŸ ì™„ë²½í•´ìš”! ìˆ²ì˜ ë¹„ë°€ì„ ëª¨ë‘ ì´í•´í–ˆì–´ìš”!';
      else if (totalScore >= 70) message = 'ğŸ‘ ì˜í–ˆì–´ìš”! ì¡°ê¸ˆë§Œ ë” ë…¸ë ¥í•˜ë©´ ì™„ë²½í•´ì§ˆ ê±°ì˜ˆìš”!';
      else if (totalScore >= 50) message = 'ğŸ“š ê´œì°®ì•„ìš”! ì´ì•¼ê¸°ë¥¼ ë‹¤ì‹œ ì½ì–´ë³´ë©´ ë” ì˜ ì´í•´í•  ìˆ˜ ìˆì–´ìš”!';
      else message = 'ğŸ’ª í˜ë‚´ì„¸ìš”! ë‹¤ì‹œ ë„ì „í•´ ë³´ì•„ìš”!';

      document.getElementById('result-message').textContent = message;

      // ì¹´í…Œê³ ë¦¬ ì ìˆ˜ í‘œì‹œ
      const scoresContainer = document.getElementById('category-scores');
      scoresContainer.innerHTML = '';
      Object.entries(radarScores).forEach(([cat, score]) => {
        const span = document.createElement('span');
        span.className = 'category-score';
        span.textContent = `${cat}: ${score}ì `;
        scoresContainer.appendChild(span);
      });

      // ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
      drawRadarChart(radarScores);

      // ê²°ê³¼ ì €ì¥
      saveQuizResult(totalScore, radarScores);
    }

    function drawRadarChart(scores) {
      const canvas = document.getElementById('radar-chart');
      const ctx = canvas.getContext('2d');
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = 100;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const categories = ["ì¸ë¬¼íŒŒì•…", "ë‚´ìš©ì¼ì¹˜", "ë‚´ìš©êµ¬ì¡°", "ë‚´ìš©ì–´íœ˜", "ë‚´ìš©ì¶”ë¡ "];
      const numCategories = categories.length;

      // ë°°ê²½ ê·¸ë¦¬ë“œ (5ê°í˜•)
      ctx.strokeStyle = '#ddd';
      ctx.lineWidth = 1;
      for (let level = 1; level <= 5; level++) {
        ctx.beginPath();
        for (let i = 0; i < numCategories; i++) {
          const angle = (Math.PI * 2 * i / numCategories) - Math.PI / 2;
          const r = (radius * level) / 5;
          const x = centerX + r * Math.cos(angle);
          const y = centerY + r * Math.sin(angle);
          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.closePath();
        ctx.stroke();
      }

      // ì¶• ê·¸ë¦¬ê¸°
      ctx.strokeStyle = '#ccc';
      for (let i = 0; i < numCategories; i++) {
        const angle = (Math.PI * 2 * i / numCategories) - Math.PI / 2;
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(centerX + radius * Math.cos(angle), centerY + radius * Math.sin(angle));
        ctx.stroke();
      }

      // ë°ì´í„° ì˜ì—­ ê·¸ë¦¬ê¸°
      ctx.fillStyle = 'rgba(93, 64, 55, 0.3)';
      ctx.strokeStyle = '#5D4037';
      ctx.lineWidth = 2;
      ctx.beginPath();
      categories.forEach((cat, i) => {
        const angle = (Math.PI * 2 * i / numCategories) - Math.PI / 2;
        const value = scores[cat] / 10;
        const r = radius * value;
        const x = centerX + r * Math.cos(angle);
        const y = centerY + r * Math.sin(angle);
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.closePath();
      ctx.fill();
      ctx.stroke();

      // ë ˆì´ë¸” ê·¸ë¦¬ê¸°
      ctx.fillStyle = '#333';
      ctx.font = '12px "Noto Sans KR", sans-serif';
      ctx.textAlign = 'center';
      categories.forEach((cat, i) => {
        const angle = (Math.PI * 2 * i / numCategories) - Math.PI / 2;
        const x = centerX + (radius + 25) * Math.cos(angle);
        const y = centerY + (radius + 25) * Math.sin(angle);
        ctx.fillText(cat, x, y + 4);
      });
    }

    async function saveQuizResult(totalScore, radarScores) {
      try {
        // ë¡œê·¸ì¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (sessionStorage 'user' í‚¤ ì‚¬ìš©)
        const userInfo = JSON.parse(sessionStorage.getItem('user') || localStorage.getItem('user') || '{}');
        const grade = userInfo.grade || '';
        const name = userInfo.name || '';

        if (!grade || !name) {
          console.log('[saveQuizResult] ë¡œê·¸ì¸ ì •ë³´ ì—†ìŒ - ì €ì¥ ê±´ë„ˆëœ€');
          return;
        }

        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì‹œì¦Œ ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const season = urlParams.get('season') || 'season1';

        const response = await fetch('/api/creative-quiz/save', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            grade,
            name,
            storyId: 'bio06',
            season,
            scores: radarScores,
            totalScore
          })
        });

        const result = await response.json();
        if (result.ok) {
          console.log('[saveQuizResult] ì €ì¥ ì™„ë£Œ:', result);
        } else {
          console.error('[saveQuizResult] ì €ì¥ ì‹¤íŒ¨:', result.message);
        }
      } catch (err) {
        console.error('[saveQuizResult] ì˜¤ë¥˜:', err);
      }
    }

    function closeQuiz() {
      if (window.parent && window.parent !== window) {
        window.parent.postMessage({ type: 'closeStory' }, '*');
      } else {
        window.history.back();
      }
    }

    // ì´ˆê¸°í™”
    renderQuestion();
  </script>

</body>
</html>
