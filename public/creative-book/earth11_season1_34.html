<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>☀️ 하늘 마을 기상캐스터 솔이</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Gmarket Sans", "Noto Sans KR", sans-serif;
      overflow-x: hidden;
      background: #1a1a1a;
    }

    /* 고정 지도 캔버스 */
    #map-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: url('/images/창작도서/창작지구과학11/00.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transition: background-image 1s ease-in-out;
      z-index: 1;
    }

    #map-canvas {
      display: none;
    }

    /* 스크롤 가능한 콘텐츠 */
    #content {
      position: relative;
      z-index: 2;
      pointer-events: none;
    }

    .story-section {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 60px 120px;
      pointer-events: none;
    }

    /* 홀수 섹션은 왼쪽 */
    .story-section:nth-child(odd) {
      justify-content: flex-start;
    }

    /* 짝수 섹션은 오른쪽 */
    .story-section:nth-child(even) {
      justify-content: flex-end;
    }

    .story-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(15px);
      padding: 40px;
      border-radius: 24px;
      max-width: 600px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: translateX(100px);
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
      pointer-events: auto;
    }

    /* 왼쪽에서 나오는 카드 */
    .story-section:nth-child(odd) .story-card {
      transform: translateX(-100px);
    }

    /* 오른쪽에서 나오는 카드 */
    .story-section:nth-child(even) .story-card {
      transform: translateX(100px);
    }

    .story-card.active {
      transform: translateX(0);
      opacity: 1;
    }

    .story-card .chapter {
      display: inline-block;
      padding: 8px 20px;
      background: linear-gradient(135deg, #87CEEB 0%, #4682B4 100%);
      color: white;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 15px;
      box-shadow: 0 4px 15px rgba(135, 206, 235, 0.3);
    }

    .story-card .theme {
      display: inline-block;
      padding: 4px 12px;
      background: rgba(135, 206, 235, 0.15);
      color: #4682B4;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }

    .story-card h2 {
      font-size: 26px;
      color: #2c3e50;
      margin-bottom: 20px;
      line-height: 1.4;
    }

    .story-card p {
      font-size: 15px;
      line-height: 1.9;
      color: #34495e;
      margin-bottom: 14px;
      text-align: justify;
    }

    .story-card p:last-child {
      margin-bottom: 0;
    }

    .story-card .highlight {
      color: #4682B4;
      font-weight: 600;
    }

    .story-card .dialogue {
      color: #2c5282;
      font-weight: 600;
    }

    /* 인트로 섹션 */
    .intro-section {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 60px;
    }

    .intro-content {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      padding: 60px 80px;
      border-radius: 30px;
      max-width: 850px;
      animation: fadeInUp 1s ease-out;
    }

    .intro-content h1 {
      font-size: 44px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 20px;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    }

    .intro-content .subtitle {
      font-size: 20px;
      line-height: 1.8;
      color: #e0e0e0;
      margin-bottom: 30px;
      font-weight: 400;
    }

    .intro-content .characters {
      text-align: left;
      background: rgba(255, 255, 255, 0.1);
      padding: 25px;
      border-radius: 16px;
      margin-bottom: 30px;
    }

    .intro-content .characters h3 {
      color: #87CEEB;
      font-size: 16px;
      margin-bottom: 15px;
    }

    .intro-content .characters p {
      color: #d0d0d0;
      font-size: 14px;
      line-height: 1.7;
      margin-bottom: 8px;
    }

    .intro-content .scroll-hint {
      font-size: 16px;
      color: #ffffff;
      font-weight: 600;
      animation: pulse 2s infinite;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    /* 스크롤 인디케이터 */
    .scroll-indicator {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      animation: bounce 2s infinite;
      pointer-events: none;
    }

    .scroll-indicator svg {
      width: 40px;
      height: 40px;
      opacity: 0.7;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateX(-50%) translateY(0);
      }
      40% {
        transform: translateX(-50%) translateY(-20px);
      }
      60% {
        transform: translateX(-50%) translateY(-10px);
      }
    }

    /* 반응형 디자인 */
    @media (max-width: 768px) {
      .story-section {
        padding: 40px 20px;
      }

      .story-card {
        max-width: 100%;
        padding: 30px;
      }

      .story-card h2 {
        font-size: 22px;
      }

      .story-card p {
        font-size: 14px;
      }

      .intro-content {
        padding: 40px 30px;
      }

      .intro-content h1 {
        font-size: 28px;
      }

      .intro-content .subtitle {
        font-size: 15px;
      }
    }

    /* 네비게이션 버튼 */
    .nav-buttons {
      position: fixed;
      bottom: 40px;
      left: 50%; transform: translateX(-50%);
      z-index: 1000;
      display: flex;
      gap: 15px;
      pointer-events: auto;
    }

    .nav-btn {
      padding: 15px 30px;
      background: rgba(135, 206, 235, 0.9);
      backdrop-filter: blur(10px);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(135, 206, 235, 0.3);
    }

    .nav-btn:hover {
      background: rgba(70, 130, 180, 0.9);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(135, 206, 235, 0.4);
    }

    @media (max-width: 768px) {
      .nav-buttons {
        bottom: 20px;
        right: 20px;
        flex-direction: column;
      }

      .nav-btn {
        padding: 12px 24px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <!-- 고정된 배경 컨테이너 -->
  <div id="map-container">
    <canvas id="map-canvas"></canvas>
  </div>

  <!-- 스크롤 가능한 스토리 콘텐츠 -->
  <div id="content">
    <!-- 인트로 -->
    <section class="intro-section">
      <div class="intro-content">
        <h1>☀️ 하늘 마을 기상캐스터 솔이</h1>
        <p class="subtitle">
          — 날씨의 열 가지 비밀을 찾아서 —<br>
          교과기반 창작도서 · 지구과학 11 (3·4학년)
        </p>
        <div class="characters">
          <h3>🌈 등장인물 소개</h3>
          <p><strong>▸ 솔이:</strong> 호기심 가득한 견습 기상캐스터</p>
          <p><strong>▸ 청명 할아버지:</strong> 날씨의 비밀을 알려주는 원로</p>
          <p><strong>▸ 돌풍이:</strong> 장난꾸러기 바람 요정</p>
          <p><strong>▸ 뭉게 아주머니:</strong> 구름 공장을 운영하는 요정</p>
        </div>
        <p class="scroll-hint">↓ 아래로 스크롤하여 이야기를 시작하세요 ↓</p>
      </div>
    </section>

    <!-- Part 1 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/01.jpg">
      <div class="story-card">
        <span class="chapter">제1장</span>
        <span class="theme">기온 변화</span>
        <h2>하늘 마을의 온도계 소동</h2>
        <p>구름 위 높은 곳에 <span class="highlight">하늘 마을</span><br><br>이 있었어요. 이 마을에는 날씨를 만드는 요정들이 살고 있었지요. 해님 요정, 바람 요정, 구름 요정, 비 요정까지!</p>
        <p>하늘 마을 광장의 커다란 온도계가 자꾸 요동쳤어요. 열두 살 견습 기상캐스터 <span class="highlight">솔이</span><br><br>가 투덜거렸어요. <br><br><span class="dialogue">"도대체 왜 이렇게 변덕이야!"</span></p>
        <p>솔이의 꿈은 최고의 기상캐스터가 되는 거예요. 하지만 날씨가 왜 변하는지 이해할 수가 없었어요.</p>
        <p><span class="dialogue">"할아버지, 날씨는 왜 변덕스러워요?"</span></p>
        <p>원로 기상학자 <span class="highlight">청명 할아버지</span><br><br>가 웃으며 말했어요. <br><br><span class="dialogue">"변덕스러워 보이는 건 이유를 모르기 때문이야. 날씨의 모든 변화에는 이유가 있단다."</span></p>
        <p><span class="dialogue">"첫 번째 비밀은 기온이야. 모든 날씨 변화는 온도의 차이에서 시작되거든."</span></p>
      </div>
    </section>

    <!-- Part 2 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/02.jpg">
      <div class="story-card">
        <span class="chapter">제2장</span>
        <span class="theme">바람의 탄생</span>
        <h2>보이지 않는 바람의 고속도로</h2>
        <p>할아버지가 솔이를 전망대로 데려갔어요. 적도는 붉게 타오르고, 북극과 남극은 하얗게 빛났어요.</p>
        <p><span class="dialogue">"저 온도 차이가 바람을 만든단다. 따뜻한 공기는 가볍기 때문에 위로 올라가고, 차가운 공기는 무거워서 아래로 내려오지."</span></p>
        <p>그때 휘이잉~ 장난꾸러기 바람 요정 <span class="highlight">돌풍이</span><br><br>가 날아왔어요! <br><br><span class="dialogue">"야호! 누가 날 불렀어?"</span></p>
        <p>돌풍이가 지구 위를 날아다녔어요. 뜨거운 공기를 타고 올라갔다가, 찬 공기를 만나 내려오고, 지구의 자전 때문에 휘어지며 소용돌이쳤어요.</p>
        <p><span class="dialogue">"지구가 돌기 때문에 바람이 휘어지는 거야. 이것을 <span class="highlight">'전향력'</span><br><br>이라고 해."</span></p>
        <p>솔이가 감탄했어요. <br><br><span class="dialogue">"바람에도 고속도로가 있었네요! 모든 바람은 정해진 길을 따라 달리고 있구나!"</span></p>
      </div>
    </section>

    <!-- Part 3 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/03.jpg">
      <div class="story-card">
        <span class="chapter">제3장</span>
        <span class="theme">기압의 비밀</span>
        <h2>공기가 누르는 무게</h2>
        <p>할아버지가 동그란 시계 같은 도구를 건넸어요. <br><br><span class="dialogue">"이건 기압계야. 공기가 땅을 누르는 힘을 재는 거지."</span></p>
        <p>솔이가 물었어요. <br><br><span class="dialogue">"공기도 무게가 있어요?"</span></p>
        <p><span class="dialogue">"물론이지! 네 머리 위의 공기 무게가 약 1톤이나 된단다."</span></p>
        <p>솔이가 깜짝 놀랐어요. <br><br><span class="dialogue">"왜 안 눌려요?"</span></p>
        <p><span class="dialogue">"사방에서 똑같이 누르니까 느끼지 못하는 거야."</span></p>
        <p>할아버지가 설명했어요. 땅이 뜨거워지면 공기가 올라가며 <span class="highlight">저기압</span><br><br>이 되고, 차가워지면 공기가 내려와 <span class="highlight">고기압</span><br><br>이 돼요.</p>
        <p>돌풍이가 외쳤어요. <br><br><span class="dialogue">"나는 고기압에서 저기압으로 달리는 거야!"</span></p>
        <p>솔이가 무릎을 쳤어요. <br><br><span class="dialogue">"그래서 고기압이면 맑고, 저기압이면 흐린 거군요!"</span></p>
      </div>
    </section>

    <!-- Part 4 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/04.jpg">
      <div class="story-card">
        <span class="chapter">제4장</span>
        <span class="theme">구름 만들기</span>
        <h2>하늘 위 솜사탕 공장</h2>
        <p>솔이가 '구름 공장'을 찾아갔어요. 통통하고 포근한 <span class="highlight">뭉게 아주머니</span><br><br>가 반겼어요.</p>
        <p><span class="dialogue">"구름은 솜사탕으로 만드는 거예요?"</span></p>
        <p>아주머니가 웃었어요. <br><br><span class="dialogue">"구름의 재료는 아주 작은 물방울이란다!"</span></p>
        <p>아주머니가 설명해주었어요. 땅에서 증발한 수증기가 하늘로 올라가요. 올라갈수록 기온이 낮아지고, 어느 높이에서 수증기가 물방울로 변해요. 이것을 <span class="highlight">'응결'</span><br><br>이라고 해요!</p>
        <p>하지만 물방울이 되려면 한 가지가 더 필요해요. 바로 <span class="highlight">'응결핵'</span>! 먼지나 꽃가루 같은 작은 알갱이예요.</p>
        <p><span class="dialogue">"먼지가 없으면 구름도 없다니!"</span><br><br>솔이가 놀랐어요.</p>
        <p><span class="dialogue">"하찮은 먼지에도 중요한 역할이 있단다."</span></p>
      </div>
    </section>

    <!-- Part 5 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/05.jpg">
      <div class="story-card">
        <span class="chapter">제5장</span>
        <span class="theme">비의 탄생</span>
        <h2>구름이 참지 못하는 순간</h2>
        <p>뭉게 아주머니가 솔이를 구름 속으로 데려갔어요. 수억 개의 작은 물방울이 떠다니고 있었어요.</p>
        <p><span class="dialogue">"이 물방울은 머리카락 굵기의 백분의 일 정도야. 너무 작아서 떨어지지 않고 떠 있지."</span></p>
        <p>그런데 물방울들이 합쳐져 점점 커지면, 마침내 떨어져요. 이것이 바로 <span class="highlight">비</span><br><br>예요!</p>
        <p><span class="dialogue">"구름 속 물방울이 빗방울이 되려면 약 백만 개가 합쳐져야 해!"</span></p>
        <p>높은 구름에서는 물방울이 얼어서 얼음 결정이 돼요. 이것이 떨어지다 녹으면 비, 안 녹으면 <span class="highlight">눈</span><br><br>이에요! 녹았다 다시 얼면 <span class="highlight">우박</span><br><br>이고요.</p>
        <p>솔이가 감탄했어요. <br><br><span class="dialogue">"비, 눈, 우박이 모두 같은 원리에서 시작되는 거구나!"</span></p>
      </div>
    </section>

    <!-- Part 6 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/06.jpg">
      <div class="story-card">
        <span class="chapter">제6장</span>
        <span class="theme">전선의 이동</span>
        <h2>따뜻한 공기와 차가운 공기의 싸움</h2>
        <p>할아버지가 솔이를 '전략 지도실'로 데려갔어요. 빨간 화살표와 파란 화살표가 그려져 있었어요.</p>
        <p><span class="dialogue">"이건 전쟁이야. 따뜻한 공기와 차가운 공기의 싸움이지!"</span></p>
        <p>두 공기가 만나는 경계선을 <span class="highlight">'전선'</span><br><br>이라고 해요. 무거운 찬 공기가 따뜻한 공기 아래로 파고들면, 강한 비가 쏟아져요. 이것이 <span class="highlight">한랭 전선</span>!</p>
        <p>반대로 따뜻한 공기가 위로 올라타면, 보슬보슬 비가 오래 내려요. 이것이 <span class="highlight">온난 전선</span>!</p>
        <p>돌풍이가 신나서 외쳤어요. <br><br><span class="dialogue">"나는 전선이 지나갈 때가 제일 신나! 바람이 세지거든!"</span></p>
        <p>솔이가 정리했어요. <br><br><span class="dialogue">"한랭 전선은 소나기, 온난 전선은 보슬비구나!"</span></p>
      </div>
    </section>

    <!-- Part 7 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/07.jpg">
      <div class="story-card">
        <span class="chapter">제7장</span>
        <span class="theme">계절의 비밀</span>
        <h2>지구가 기울어서 생긴 선물</h2>
        <p><span class="dialogue">"할아버지, 여름엔 왜 덥고 겨울엔 왜 추워요?"</span></p>
        <p><span class="dialogue">"태양이 가까워져서가 아니야. 비밀은 지구의 기울기에 있단다."</span></p>
        <p>할아버지가 지구 모형을 보여주었어요. 지구는 약 <span class="highlight">23.5도</span><br><br>기울어진 채 태양 주위를 돌아요!</p>
        <p><span class="dialogue">"여름에는 북반구가 태양 쪽으로 기울어져 햇빛을 많이 받아. 겨울에는 반대로 적게 받지."</span></p>
        <p>솔이가 모형을 돌려보았어요. 정말이었어요!</p>
        <p>돌풍이가 말했어요. <br><br><span class="dialogue">"나는 봄바람이 좋아! 따뜻한 공기와 차가운 공기가 싸우니까 바람이 많이 불어!"</span></p>
        <p>솔이가 깨달았어요. <span class="dialogue">"<span class="highlight">사계절은 지구가 비스듬히 서 있어서 받은 선물</span><br><br>이구나!"</span></p>
      </div>
    </section>

    <!-- Part 8 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/08.jpg">
      <div class="story-card">
        <span class="chapter">제8장</span>
        <span class="theme">일기 예보</span>
        <h2>하늘의 비밀을 푸는 탐정들</h2>
        <p>할아버지가 솔이를 '예보 센터'로 데려갔어요. 수십 개의 화면에 위성 사진, 기온 지도, 바람 지도가 보였어요!</p>
        <p><span class="dialogue">"와! 이렇게 많은 정보가 필요해요?"</span></p>
        <p><span class="dialogue">"일기 예보는 하늘을 보고 짐작하는 게 아니야. 전 세계 관측소에서 데이터를 모아 분석하는 과학이지."</span></p>
        <p>지상 관측소에서 기온과 기압을 재고, 기상 레이더가 비구름을 추적하고, 위성이 구름 사진을 찍어요. 이 모든 데이터가 슈퍼컴퓨터로 모여요!</p>
        <p><span class="dialogue">"컴퓨터가 계산하지만, 결과를 해석하는 건 사람이야. 기상예보관은 탐정처럼 단서를 모아 내일 날씨를 추리하는 거지."</span></p>
        <p>솔이는 일기예보가 수천 명의 과학자가 협력해서 만드는 거대한 과학이라는 걸 알게 되었어요.</p>
      </div>
    </section>

    <!-- Part 9 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/09.jpg">
      <div class="story-card">
        <span class="chapter">제9장</span>
        <span class="theme">실수와 도전</span>
        <h2>틀릴 수도 있지만 포기하지 않아</h2>
        <p>어느 날 솔이의 첫 일기 예보가 틀렸어요. "맑음"이라고 했는데 폭우가 쏟아진 거예요!</p>
        <p>솔이는 눈물이 났어요. <br><br><span class="dialogue">"분명 잘 분석했는데... 왜요?"</span></p>
        <p>할아버지가 솔이를 감싸며 말했어요. <span class="dialogue">"대기는 세상에서 가장 복잡해. 브라질 나비의 날갯짓이 미국에 태풍을 일으킬 수도 있다는 <span class="highlight">'나비 효과'</span><br><br>라는 말이 있단다."</span></p>
        <p><span class="dialogue">"완벽한 예측은 불가능해. 하지만 포기하면 안 돼."</span></p>
        <p>돌풍이가 위로했어요. <br><br><span class="dialogue">"나도 가끔 예상 못 한 방향으로 불어. 하지만 예측하려고 노력하니까 사람들이 태풍에서 대피할 수 있는 거야."</span></p>
        <p>솔이가 눈물을 닦았어요. 한 번 틀렸다고 포기하면 안 돼요. 과학은 완벽함이 아니라 더 나은 것을 향한 도전이니까요!</p>
      </div>
    </section>

    <!-- Part 10 -->
    <section class="story-section" data-bg="/images/창작도서/창작지구과학11/10.jpg">
      <div class="story-card">
        <span class="chapter">제10장</span>
        <span class="theme">날씨의 의미</span>
        <h2>변화에는 이유가 있어요</h2>
        <p>열 가지 비밀을 배운 날, 솔이는 전망대에 올랐어요. 서쪽은 황금빛 노을, 동쪽은 먹구름과 번개!</p>
        <p>솔이는 더 이상 무섭지 않았어요. 동쪽의 먹구름이 한랭 전선이고, 지나가면 맑아질 거라는 걸 알았으니까요.</p>
        <p>할아버지가 물었어요. <br><br><span class="dialogue">"이제 날씨가 왜 변하는지 알겠니?"</span></p>
        <p>솔이가 환하게 웃었어요. <span class="dialogue">"네! 기온 차이가 바람을 만들고, 기압 차이가 공기를 움직이게 하고, 수증기가 구름이 되고, 구름이 비가 되고... <span class="highlight">모든 변화에는 이유가 있었어요!</span>"</span></p>
        <p>솔이가 수첩에 적었어요. <br><br><span class="dialogue">"내일의 날씨: 변화무쌍. 하지만 걱정 마세요. 변화에는 이유가 있고, 모든 날씨에는 의미가 있습니다."</span></p>
        <p style="text-align: center; margin-top: 25px; padding: 20px; background: rgba(135, 206, 235, 0.15); border-radius: 16px;">
          <strong style="color: #4682B4; font-size: 20px;">☀️ 「변화에는 이유가 있습니다.」</strong>
        </p>
      </div>
    </section>
  </div>

  <!-- 네비게이션 버튼 -->
  <div class="nav-buttons">
    <button class="nav-btn" onclick="goBack()">← 목록으로</button>
    <button class="nav-btn" style="background: linear-gradient(135deg, #f39c12 0%, #e74c3c 100%);" onclick="goToQuiz()">📝 관문평가</button>
  </div>

  <!-- 스크롤 인디케이터 -->
  <div class="scroll-indicator" id="scrollIndicator">
    <svg viewBox="0 0 24 24" fill="white">
      <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
    </svg>
  </div>

  <script>
    const mapContainer = document.getElementById('map-container');
    const sections = document.querySelectorAll('.story-section');
    const scrollIndicator = document.getElementById('scrollIndicator');
    let currentBg = '';
    let ticking = false;

    function updateBackground() {
      const scrollPos = window.scrollY + window.innerHeight / 2;

      // 스크롤 인디케이터 숨기기/보이기
      if (window.scrollY > 100) {
        scrollIndicator.style.opacity = '0';
      } else {
        scrollIndicator.style.opacity = '1';
      }

      sections.forEach((section, index) => {
        const rect = section.getBoundingClientRect();
        const sectionTop = window.scrollY + rect.top;
        const sectionBottom = sectionTop + rect.height;

        if (scrollPos >= sectionTop && scrollPos < sectionBottom) {
          // 배경 업데이트
          const bgImage = section.dataset.bg;
          if (bgImage && bgImage !== currentBg) {
            currentBg = bgImage;
            mapContainer.style.backgroundImage = `url(${bgImage})`;
          }

          // 카드 활성화
          const card = section.querySelector('.story-card');
          if (card && !card.classList.contains('active')) {
            card.classList.add('active');
          }
        }
      });
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateBackground();
          ticking = false;
        });
        ticking = true;
      }
    });

    // 초기 실행
    updateBackground();

    function goBack() {
      // 부모 창이 있으면 부모에게 메시지 전송
      if (window.parent !== window) {
        window.parent.postMessage({ action: 'closeStory' }, '*');
      } else {
        window.history.back();
      }
    }

    function goToQuiz() {
      window.location.href = '/creative-book/earth11_season1_quiz.html?season=season1';
    }
  </script>
</body>
</html>
