<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì°½ì‘ë¬¼ë¦¬14 í€´ì¦ˆ - ì‹œì¦Œ1 ê´€ë¬¸í‰ê°€</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: "Gmarket Sans", "Noto Sans KR", sans-serif; background: url('/images/ì°½ì‘ë„ì„œ/ì°½ì‘ë¬¼ë¦¬14/00.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; position: relative; }
    body::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: 0; }
    .quiz-container { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-radius: 30px; padding: 50px; max-width: 750px; width: 100%; box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3); animation: slideIn 0.5s ease-out; position: relative; z-index: 1; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .quiz-header { text-align: center; margin-bottom: 40px; }
    .quiz-header h1 { font-size: 32px; color: #2c3e50; margin-bottom: 10px; font-weight: 700; }
    .quiz-header .gate-number { font-size: 18px; color: #FF5722; font-weight: 600; background: linear-gradient(135deg, #FF5722 0%, #E64A19 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .quiz-header .category-badge { display: inline-block; padding: 6px 16px; background: linear-gradient(135deg, #FF5722 0%, #E64A19 100%); color: white; border-radius: 20px; font-size: 14px; font-weight: 600; margin-top: 10px; }
    .progress-bar-container { width: 100%; height: 8px; background: #e0e0e0; border-radius: 10px; margin-bottom: 30px; overflow: hidden; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #FF5722 0%, #E64A19 100%); border-radius: 10px; transition: width 0.5s ease; }
    .question-box { background: #f8f9fa; padding: 30px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #FF5722; }
    .question-text { font-size: 20px; color: #2c3e50; font-weight: 600; line-height: 1.7; }
    .options-container { display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; }
    .option-btn { background: white; border: 2px solid #e0e0e0; padding: 20px 25px; border-radius: 15px; font-size: 17px; color: #2c3e50; cursor: pointer; transition: all 0.3s ease; text-align: left; font-weight: 500; line-height: 1.5; }
    .option-btn:hover { border-color: #FF5722; background: #fbe9e7; transform: translateX(5px); }
    .option-btn.selected { border-color: #FF5722; background: linear-gradient(135deg, #FF5722 0%, #E64A19 100%); color: white; }
    .option-btn.correct { border-color: #27ae60; background: #27ae60; color: white; }
    .option-btn.wrong { border-color: #e74c3c; background: #e74c3c; color: white; }
    .option-btn:disabled { cursor: not-allowed; opacity: 0.7; }
    .submit-btn { width: 100%; padding: 18px; background: linear-gradient(135deg, #FF5722 0%, #E64A19 100%); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
    .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(255, 87, 34, 0.4); }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .result-message { text-align: center; padding: 20px; border-radius: 15px; margin-bottom: 20px; font-size: 18px; font-weight: 600; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .result-message.correct { background: #d4edda; color: #155724; border: 2px solid #28a745; }
    .result-message.wrong { background: #f8d7da; color: #721c24; border: 2px solid #dc3545; }
    .congrats-container { text-align: center; animation: scaleIn 0.6s ease-out; }
    @keyframes scaleIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
    .congrats-container h2 { font-size: 44px; margin-bottom: 20px; }
    .congrats-container p { font-size: 18px; color: #555; margin-bottom: 30px; line-height: 1.8; }
    .score-summary { background: #f8f9fa; padding: 25px; border-radius: 16px; margin: 25px 0; text-align: left; }
    .score-summary h3 { font-size: 18px; color: #FF5722; margin-bottom: 15px; text-align: center; }
    .score-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #e0e0e0; }
    .score-item:last-child { border-bottom: none; }
    .score-item .category { font-weight: 600; color: #2c3e50; }
    .score-item .score { font-weight: 700; color: #FF5722; }
    .back-btn { background: white; border: 2px solid #FF5722; color: #FF5722; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-right: 10px; }
    .back-btn:hover { background: #FF5722; color: white; }
    .radar-container { display: flex; justify-content: center; margin: 25px 0; }
    @media (max-width: 768px) { .quiz-container { padding: 30px 20px; } .quiz-header h1 { font-size: 24px; } .question-text { font-size: 17px; } .option-btn { font-size: 15px; padding: 15px 20px; } }
  </style>
</head>
<body>
  <div class="quiz-container" id="quizContainer"></div>
  <script>
    const quizData = [
      { gate: 1, category: "ì¸ë¬¼íŒŒì•…", question: "ì—´ì˜ ë¹„ë°€ì„ ì•Œë ¤ì£¼ëŠ” ì¶¤ì¶”ëŠ” ë¶„ì ì†Œë…€ëŠ”?", options: ["ì¨ëª¨", "ëª°ë¦¬", "íˆíŠ¸í”Œë¡œ", "í˜ì´ì¦ˆ"], correct: 1 },
      { gate: 2, category: "ì¸ë¬¼íŒŒì•…", question: "ì—´ì˜ ì—¬í–‰ìë¡œ ëœ¨ê±°ìš´ ê³³ì—ì„œ ì°¨ê°€ìš´ ê³³ìœ¼ë¡œ ì´ë™í•˜ëŠ” ìºë¦­í„°ëŠ”?", options: ["ëª°ë¦¬", "ì¨ëª¨", "íˆíŠ¸í”Œë¡œ", "ë¹„ì—´"], correct: 2 },
      { gate: 3, category: "ë‚´ìš©ì¼ì¹˜", question: "ì—´ì´ ì „ë‹¬ë˜ëŠ” ë°©í–¥ì€?", options: ["ì°¨ê°€ìš´ ê³³ì—ì„œ ëœ¨ê±°ìš´ ê³³ìœ¼ë¡œ", "ëœ¨ê±°ìš´ ê³³ì—ì„œ ì°¨ê°€ìš´ ê³³ìœ¼ë¡œ", "ë¬´ì‘ìœ„ ë°©í–¥ìœ¼ë¡œ", "ìœ„ì—ì„œ ì•„ë˜ë¡œë§Œ"], correct: 1 },
      { gate: 4, category: "ë‚´ìš©ì¼ì¹˜", question: "ë¶„ìê°€ ë¹ ë¥´ê²Œ ì›€ì§ì´ë©´ ì˜¨ë„ê°€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?", options: ["ë‚®ì•„ì§„ë‹¤", "ë†’ì•„ì§„ë‹¤", "ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤", "ì‚¬ë¼ì§„ë‹¤"], correct: 1 },
      { gate: 5, category: "ë‚´ìš©êµ¬ì¡°", question: "ì—´ì´ ì „ë‹¬ë˜ëŠ” ì„¸ ê°€ì§€ ë°©ë²•ì´ ì•„ë‹Œ ê²ƒì€?", options: ["ì „ë„", "ëŒ€ë¥˜", "ë³µì‚¬", "ë°˜ì‚¬"], correct: 3 },
      { gate: 6, category: "ë‚´ìš©êµ¬ì¡°", question: "ëƒ„ë¹„ ì†ì¡ì´ë¥¼ í”Œë¼ìŠ¤í‹±ìœ¼ë¡œ ë§Œë“œëŠ” ì´ìœ ëŠ”?", options: ["ì˜ˆë»ì„œ", "ì—´ì„ ì˜ ì „ë‹¬í•˜ì§€ ì•Šì•„ì„œ", "ê°€ë²¼ì›Œì„œ", "ì‹¸ì„œ"], correct: 1 },
      { gate: 7, category: "ë‚´ìš©ì–´íœ˜", question: "'ì „ë„'ì˜ ì˜ë¯¸ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?", options: ["ë¬¼ì§ˆì´ ì´ë™í•˜ë©° ì—´ì„ ì „ë‹¬", "ì ‘ì´‰í•˜ì—¬ ì—´ì„ ì „ë‹¬", "ë¹›ìœ¼ë¡œ ì—´ì„ ì „ë‹¬", "ì†Œë¦¬ë¡œ ì—´ì„ ì „ë‹¬"], correct: 1 },
      { gate: 8, category: "ë‚´ìš©ì–´íœ˜", question: "'ë¹„ì—´'ì˜ ì˜ë¯¸ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?", options: ["ì—´ì„ ì‹«ì–´í•˜ëŠ” ê²ƒ", "ë¬¼ì§ˆ 1gì˜ ì˜¨ë„ë¥¼ 1ë„ ì˜¬ë¦¬ëŠ” ë° í•„ìš”í•œ ì—´ëŸ‰", "ì—´ì˜ ì†ë„", "ì°¨ê°€ìš´ ì •ë„"], correct: 1 },
      { gate: 9, category: "ë‚´ìš©ì¶”ë¡ ", question: "ë°”ë‹¤ ê·¼ì²˜ê°€ ì—¬ë¦„ì— ëœ ë¥ê³  ê²¨ìš¸ì— ëœ ì¶”ìš´ ì´ìœ ëŠ”?", options: ["ë°”ëŒì´ ë§ì´ ë¶ˆì–´ì„œ", "ë¬¼ì˜ ë¹„ì—´ì´ ì»¤ì„œ ì˜¨ë„ ë³€í™”ê°€ ëŠë¦¬ê¸° ë•Œë¬¸ì—", "ì‚°ì´ ì—†ì–´ì„œ", "íƒœì–‘ì´ ëœ ë¹„ì¶°ì„œ"], correct: 1 },
      { gate: 10, category: "ë‚´ìš©ì¶”ë¡ ", question: "ì´ ì´ì•¼ê¸°ê°€ ì „í•˜ê³ ì í•˜ëŠ” í•µì‹¬ ë©”ì‹œì§€ëŠ”?", options: ["ì—´ì€ ìœ„í—˜í•˜ë‹¤", "ë³´ì´ì§€ ì•ŠëŠ” ë¶„ìë“¤ì˜ ì¶¤ì´ ì„¸ìƒì˜ ëª¨ë“  ë”°ëœ»í•¨ì„ ë§Œë“ ë‹¤", "ì°¨ê°€ìš´ ê²ƒì´ ì¢‹ë‹¤", "ì—´ì€ ì „ë‹¬ë˜ì§€ ì•ŠëŠ”ë‹¤"], correct: 1 }
    ];

    let currentGate = 0, selectedAnswer = null;
    let categoryScores = { "ì¸ë¬¼íŒŒì•…": 0, "ë‚´ìš©ì¼ì¹˜": 0, "ë‚´ìš©êµ¬ì¡°": 0, "ë‚´ìš©ì–´íœ˜": 0, "ë‚´ìš©ì¶”ë¡ ": 0 };

    function renderQuiz() { const container = document.getElementById('quizContainer'); const quiz = quizData[currentGate]; container.innerHTML = `<div class="quiz-header"><h1>ğŸ”¥ ê´€ë¬¸í‰ê°€</h1><p class="gate-number">10ê°œ ê´€ë¬¸ ì¤‘ ${quiz.gate}ë²ˆì§¸</p><span class="category-badge">${quiz.category}</span></div><div class="progress-bar-container"><div class="progress-bar" style="width: ${(quiz.gate / 10) * 100}%"></div></div><div class="question-box"><p class="question-text">${quiz.question}</p></div><div class="options-container">${quiz.options.map((option, index) => `<button class="option-btn" onclick="selectAnswer(${index})">${index + 1}. ${option}</button>`).join('')}</div><button class="submit-btn" onclick="submitAnswer()" disabled>ë‹µì•ˆ ì œì¶œ</button>`; }
    function selectAnswer(index) { selectedAnswer = index; document.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected')); document.querySelectorAll('.option-btn')[index].classList.add('selected'); document.querySelector('.submit-btn').disabled = false; }
    function submitAnswer() { const quiz = quizData[currentGate]; const buttons = document.querySelectorAll('.option-btn'); buttons.forEach(btn => btn.disabled = true); document.querySelector('.submit-btn').disabled = true; const isCorrect = selectedAnswer === quiz.correct; if (isCorrect) { categoryScores[quiz.category]++; buttons[selectedAnswer].classList.add('correct'); } else { buttons[selectedAnswer].classList.add('wrong'); buttons[quiz.correct].classList.add('correct'); } showResult(isCorrect); }
    function showResult(isCorrect) { const container = document.getElementById('quizContainer'); const resultMsg = document.createElement('div'); resultMsg.className = isCorrect ? 'result-message correct' : 'result-message wrong'; resultMsg.innerHTML = isCorrect ? 'ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! ë‹¤ìŒ ê´€ë¬¸ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤...' : 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ìŒ ê´€ë¬¸ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤...'; container.insertBefore(resultMsg, container.firstChild); setTimeout(() => { currentGate++; selectedAnswer = null; currentGate >= quizData.length ? showCongratulations() : renderQuiz(); }, 1500); }
    function convertToRadarScore(c) { return c === 2 ? 10 : c === 1 ? 5 : 1; }
    function drawRadarChart(scores) { const canvas = document.getElementById('radarCanvas'), ctx = canvas.getContext('2d'); const centerX = 140, centerY = 140, maxRadius = 100; const angles = []; for (let i = 0; i < 5; i++) angles.push((Math.PI * 2 * i / 5) - Math.PI / 2); ctx.strokeStyle = '#e0e0e0'; ctx.lineWidth = 1; [1, 0.5, 0.1].forEach(ratio => { ctx.beginPath(); for (let i = 0; i <= 5; i++) { const angle = angles[i % 5], x = centerX + Math.cos(angle) * maxRadius * ratio, y = centerY + Math.sin(angle) * maxRadius * ratio; i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); } ctx.closePath(); ctx.stroke(); }); ctx.strokeStyle = '#d0d0d0'; angles.forEach(angle => { ctx.beginPath(); ctx.moveTo(centerX, centerY); ctx.lineTo(centerX + Math.cos(angle) * maxRadius, centerY + Math.sin(angle) * maxRadius); ctx.stroke(); }); const categories = ['ì¸ë¬¼íŒŒì•…', 'ë‚´ìš©ì¼ì¹˜', 'ë‚´ìš©êµ¬ì¡°', 'ë‚´ìš©ì–´íœ˜', 'ë‚´ìš©ì¶”ë¡ ']; ctx.beginPath(); ctx.fillStyle = 'rgba(255, 87, 34, 0.3)'; ctx.strokeStyle = '#FF5722'; ctx.lineWidth = 2; categories.forEach((cat, i) => { const score = scores[cat], ratio = score / 10, x = centerX + Math.cos(angles[i]) * maxRadius * ratio, y = centerY + Math.sin(angles[i]) * maxRadius * ratio; i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); }); ctx.closePath(); ctx.fill(); ctx.stroke(); ctx.fillStyle = '#E64A19'; categories.forEach((cat, i) => { const score = scores[cat], ratio = score / 10, x = centerX + Math.cos(angles[i]) * maxRadius * ratio, y = centerY + Math.sin(angles[i]) * maxRadius * ratio; ctx.beginPath(); ctx.arc(x, y, 5, 0, Math.PI * 2); ctx.fill(); }); ctx.fillStyle = '#2c3e50'; ctx.font = 'bold 12px "Noto Sans KR", sans-serif'; ctx.textAlign = 'center'; const labelOffset = 18; categories.forEach((label, i) => { const x = centerX + Math.cos(angles[i]) * (maxRadius + labelOffset), y = centerY + Math.sin(angles[i]) * (maxRadius + labelOffset); ctx.fillText(label, x, y + 4); }); }
    function showCongratulations() { const container = document.getElementById('quizContainer'); const radarScores = { "ì¸ë¬¼íŒŒì•…": convertToRadarScore(categoryScores["ì¸ë¬¼íŒŒì•…"]), "ë‚´ìš©ì¼ì¹˜": convertToRadarScore(categoryScores["ë‚´ìš©ì¼ì¹˜"]), "ë‚´ìš©êµ¬ì¡°": convertToRadarScore(categoryScores["ë‚´ìš©êµ¬ì¡°"]), "ë‚´ìš©ì–´íœ˜": convertToRadarScore(categoryScores["ë‚´ìš©ì–´íœ˜"]), "ë‚´ìš©ì¶”ë¡ ": convertToRadarScore(categoryScores["ë‚´ìš©ì¶”ë¡ "]) }; const totalScore100 = Object.values(radarScores).reduce((a, b) => a + b, 0) * 2; container.innerHTML = `<div class="congrats-container"><h2>ğŸŠ ê´€ë¬¸í‰ê°€ ì™„ë£Œ! ğŸŠ</h2><p>10ê°œì˜ ê´€ë¬¸ì„ ëª¨ë‘ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!<br>'ì—´' ì´ì•¼ê¸°ë¥¼ ì˜ ì´í•´í•˜ì…¨ë„¤ìš”.</p><div class="radar-container"><canvas id="radarCanvas" width="280" height="280"></canvas></div><div class="score-summary"><h3>ğŸ“Š ì˜ì—­ë³„ ì ìˆ˜ (ê° 10ì  ë§Œì )</h3><div class="score-item"><span class="category">ğŸ‘¤ ì¸ë¬¼íŒŒì•…</span><span class="score">${radarScores["ì¸ë¬¼íŒŒì•…"]} / 10</span></div><div class="score-item"><span class="category">âœ… ë‚´ìš©ì¼ì¹˜</span><span class="score">${radarScores["ë‚´ìš©ì¼ì¹˜"]} / 10</span></div><div class="score-item"><span class="category">ğŸ—ï¸ ë‚´ìš©êµ¬ì¡°</span><span class="score">${radarScores["ë‚´ìš©êµ¬ì¡°"]} / 10</span></div><div class="score-item"><span class="category">ğŸ“š ë‚´ìš©ì–´íœ˜</span><span class="score">${radarScores["ë‚´ìš©ì–´íœ˜"]} / 10</span></div><div class="score-item"><span class="category">ğŸ” ë‚´ìš©ì¶”ë¡ </span><span class="score">${radarScores["ë‚´ìš©ì¶”ë¡ "]} / 10</span></div><div class="score-item" style="border-top: 2px solid #FF5722; margin-top: 10px; padding-top: 15px;"><span class="category" style="font-size: 18px;">ì´ì </span><span class="score" style="font-size: 22px; color: #E64A19;">${totalScore100}ì </span></div></div><button class="back-btn" onclick="goBack()">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button><button class="submit-btn" onclick="retryQuiz()" style="margin-top: 10px;">ğŸ”„ ë‹¤ì‹œ í’€ê¸°</button></div>`; setTimeout(() => drawRadarChart(radarScores), 100); saveQuizResult(radarScores, totalScore100); if (window.parent !== window) window.parent.postMessage({ action: 'quizComplete', storyId: 'physics14', season: getSeasonFromUrl(), scores: radarScores, totalScore: totalScore100 }, '*'); }
    function getSeasonFromUrl() { return new URLSearchParams(window.location.search).get('season') || 'season2'; }
    async function saveQuizResult(scores, totalScore) { try { const userInfo = JSON.parse(sessionStorage.getItem('user') || localStorage.getItem('user') || '{}'); if (!userInfo.grade || !userInfo.name) return; await fetch('/api/creative-quiz/save', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ grade: userInfo.grade, name: userInfo.name, storyId: 'physics14', season: getSeasonFromUrl(), scores, totalScore }) }); } catch (err) { console.error('[saveQuizResult] ì˜¤ë¥˜:', err); } }
    function goBack() { window.parent !== window ? window.parent.postMessage({ action: 'closeStory' }, '*') : window.history.back(); }
    function retryQuiz() { currentGate = 0; selectedAnswer = null; categoryScores = { "ì¸ë¬¼íŒŒì•…": 0, "ë‚´ìš©ì¼ì¹˜": 0, "ë‚´ìš©êµ¬ì¡°": 0, "ë‚´ìš©ì–´íœ˜": 0, "ë‚´ìš©ì¶”ë¡ ": 0 }; renderQuiz(); }
    window.addEventListener('DOMContentLoaded', () => renderQuiz());
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && confirm('í€´ì¦ˆë¥¼ ì¢…ë£Œí•˜ê³  ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')) goBack(); });
  </script>
</body>
</html>
