<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê³ ë˜ì˜ ì„¸ê³„ ì—¬í–‰ - ì§€ë¦¬ í•™ìŠµ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans KR", sans-serif;
      overflow: hidden;
      background: #f0f0f0;
    }

    .container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    /* ì„¸ê³„ì§€ë„ ë°°ê²½ */
    .world-map {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: url('/images/world-map.png') center/cover no-repeat;
      background-size: cover;
    }

    /* ìƒë‹¨ í—¤ë” */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-title {
      font-size: 20px;
      font-weight: 700;
      color: #2c5aa0;
    }

    .progress-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .progress-text {
      font-size: 14px;
      font-weight: 600;
      color: #333;
    }

    .progress-bar {
      width: 200px;
      height: 8px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #4caf50, #8bc34a);
      width: 0%;
      transition: width 0.5s ease;
    }

    /* ê¹ƒë°œ */
    .flag {
      position: absolute;
      cursor: pointer;
      z-index: 10;
      transition: transform 0.3s ease;
      width: 80px;
      height: 80px;
    }

    .flag:hover {
      transform: scale(1.2);
    }

    .flag-image {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: wave 2s ease-in-out infinite;
    }

    .flag.completed .flag-image {
      animation: none;
    }

    .flag-number {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: 900;
      font-size: 18px;
      color: #2c1810;
      text-shadow: 0 0 2px rgba(255,255,255,0.8);
      pointer-events: none;
      z-index: 2;
    }

    .flag.locked {
      opacity: 0.7;
    }

    @keyframes wave {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-3deg); }
      75% { transform: rotate(3deg); }
    }

    /* ê³ ë˜ */
    .whale {
      position: absolute;
      width: 60px;
      height: 60px;
      transition: all 2s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 100;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
    }

    .whale img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    /* ì´ë™ ê²½ë¡œ */
    .path {
      position: absolute;
      stroke: #4caf50;
      stroke-width: 3;
      stroke-dasharray: 5, 5;
      fill: none;
      opacity: 0.6;
      pointer-events: none;
      z-index: 5;
    }

    /* ê¹ƒë°œ ìœ„ì¹˜ (20ê°œ) */
    #flag1 { top: 35%; left: 10%; }
    #flag2 { top: 30%; left: 18%; }
    #flag3 { top: 38%; left: 25%; }
    #flag4 { top: 52%; left: 15%; }
    #flag5 { top: 68%; left: 22%; }
    #flag6 { top: 22%; left: 35%; }
    #flag7 { top: 30%; left: 38%; }
    #flag8 { top: 38%; left: 40%; }
    #flag9 { top: 45%; left: 42%; }
    #flag10 { top: 58%; left: 38%; }
    #flag11 { top: 70%; left: 43%; }
    #flag12 { top: 25%; left: 48%; }
    #flag13 { top: 35%; left: 52%; }
    #flag14 { top: 38%; left: 58%; }
    #flag15 { top: 48%; left: 62%; }
    #flag16 { top: 32%; left: 70%; }
    #flag17 { top: 48%; left: 73%; }
    #flag18 { top: 25%; left: 80%; }
    #flag19 { top: 65%; left: 82%; }
    #flag20 { top: 52%; left: 78%; }

    /* ëª¨ë‹¬ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: #fff;
      border-radius: 20px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      animation: modalSlide 0.3s ease;
    }

    @keyframes modalSlide {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e0e0e0;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #2c5aa0;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 32px;
      color: #999;
      cursor: pointer;
    }

    .modal-emoji {
      font-size: 80px;
      text-align: center;
      margin: 20px 0;
    }

    .modal-text {
      font-size: 16px;
      line-height: 1.8;
      color: #333;
      margin-bottom: 20px;
    }

    .modal-question {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .modal-question h3 {
      font-size: 18px;
      color: #2c5aa0;
      margin-bottom: 15px;
    }

    .answer-btn {
      display: block;
      width: 100%;
      padding: 12px 20px;
      margin-bottom: 10px;
      border: 2px solid #ddd;
      background: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      text-align: left;
      transition: all 0.2s ease;
    }

    .answer-btn:hover {
      border-color: #2c5aa0;
      background: #f0f7ff;
    }

    .answer-btn.correct {
      background: #4caf50;
      color: #fff;
      border-color: #4caf50;
    }

    .answer-btn.wrong {
      background: #f44336;
      color: #fff;
      border-color: #f44336;
    }

    .answer-btn:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .complete-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #2c5aa0, #4a7bc8);
      color: #fff;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
    }

    .complete-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(44, 90, 160, 0.3);
    }

    .complete-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    /* í­ì£½ íš¨ê³¼ */
    .fireworks {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 3000;
      pointer-events: none;
    }

    .fireworks.show {
      display: block;
    }

    .firework {
      position: absolute;
      font-size: 60px;
      animation: explode 1.5s ease-out forwards;
      filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.8));
    }

    @keyframes explode {
      0% {
        transform: translate(0, 0) scale(0);
        opacity: 1;
      }
      50% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(1.5);
        opacity: 0;
      }
    }

    /* ìµœì¢… ì™„ë£Œ */
    .celebration {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 4000;
      align-items: center;
      justify-content: center;
    }

    .celebration.show {
      display: flex;
    }

    .celebration-content {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 60px;
      border-radius: 20px;
      text-align: center;
      animation: celebPop 0.5s ease;
    }

    @keyframes celebPop {
      0% { transform: scale(0.5); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    .celebration-content h2 {
      font-size: 42px;
      margin-bottom: 20px;
    }

    .celebration-content p {
      font-size: 20px;
      margin-bottom: 30px;
    }

    .celebration-btn {
      background: #fff;
      color: #667eea;
      border: none;
      padding: 14px 35px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <div class="header">
    <div class="header-title">ğŸ‹ ê³ ë˜ì˜ ì„¸ê³„ ì—¬í–‰ - ì§€ë¦¬ íƒí—˜</div>
    <div class="progress-info">
      <span class="progress-text" id="progressText">0/20 ì™„ë£Œ</span>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- ì„¸ê³„ì§€ë„ -->
    <div class="world-map" id="worldMap">
      <!-- SVG ê²½ë¡œ -->
      <svg width="100%" height="100%" style="position: absolute; top: 0; left: 0;">
        <path class="path" id="travelPath" d=""></path>
      </svg>

      <!-- ê³ ë˜ -->
      <div class="whale" id="whale">
        <img src="/images/wh.png" alt="ê³ ë˜">
      </div>

      <!-- 20ê°œ ê¹ƒë°œ -->
      <div class="flag" id="flag1" data-location="1">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">01</div>
      </div>
      <div class="flag locked" id="flag2" data-location="2">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">02</div>
      </div>
      <div class="flag locked" id="flag3" data-location="3">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">03</div>
      </div>
      <div class="flag locked" id="flag4" data-location="4">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">04</div>
      </div>
      <div class="flag locked" id="flag5" data-location="5">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">05</div>
      </div>
      <div class="flag locked" id="flag6" data-location="6">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">06</div>
      </div>
      <div class="flag locked" id="flag7" data-location="7">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">07</div>
      </div>
      <div class="flag locked" id="flag8" data-location="8">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">08</div>
      </div>
      <div class="flag locked" id="flag9" data-location="9">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">09</div>
      </div>
      <div class="flag locked" id="flag10" data-location="10">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">10</div>
      </div>
      <div class="flag locked" id="flag11" data-location="11">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">11</div>
      </div>
      <div class="flag locked" id="flag12" data-location="12">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">12</div>
      </div>
      <div class="flag locked" id="flag13" data-location="13">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">13</div>
      </div>
      <div class="flag locked" id="flag14" data-location="14">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">14</div>
      </div>
      <div class="flag locked" id="flag15" data-location="15">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">15</div>
      </div>
      <div class="flag locked" id="flag16" data-location="16">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">16</div>
      </div>
      <div class="flag locked" id="flag17" data-location="17">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">17</div>
      </div>
      <div class="flag locked" id="flag18" data-location="18">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">18</div>
      </div>
      <div class="flag locked" id="flag19" data-location="19">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">19</div>
      </div>
      <div class="flag locked" id="flag20" data-location="20">
        <img class="flag-image" src="/images/gi1.png" alt="ê¹ƒë°œ">
        <div class="flag-number">20</div>
      </div>
    </div>

    <!-- í•™ìŠµ ëª¨ë‹¬ -->
    <div class="modal" id="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="modalTitle">ì§€ë¦¬ 01</h2>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-emoji" id="modalEmoji">ğŸ”ï¸</div>
        <div class="modal-text" id="modalText"></div>
        <div class="modal-question">
          <h3 id="questionText"></h3>
          <div id="answerOptions"></div>
        </div>
        <button class="complete-btn" id="completeBtn" disabled onclick="completeLocation()">
          ì™„ë£Œí•˜ê³  ë‹¤ìŒìœ¼ë¡œ â†’
        </button>
      </div>
    </div>

    <!-- í­ì£½ -->
    <div class="fireworks" id="fireworks"></div>

    <!-- ìµœì¢… ì™„ë£Œ -->
    <div class="celebration" id="celebration">
      <div class="celebration-content">
        <h2>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰</h2>
        <p>ì„¸ê³„ ì§€ë¦¬ 20ê°œ ì§€ì—­ì„ ëª¨ë‘ íƒí—˜í–ˆìŠµë‹ˆë‹¤!</p>
        <p>ê³ ë˜ì™€ í•¨ê»˜í•œ ë©‹ì§„ ì—¬í–‰ì´ì—ˆì–´ìš”!</p>
        <button class="celebration-btn" onclick="location.reload()">ë‹¤ì‹œ ì‹œì‘</button>
      </div>
    </div>
  </div>

  <script>
    const geoData = {
      1: { title: 'ì§€ë¦¬ 01 - ë¶ë¯¸ ì„œë¶€', emoji: 'ğŸ”ï¸', text: 'ë¡œí‚¤ ì‚°ë§¥ì€ ë¶ì•„ë©”ë¦¬ì¹´ ì„œë¶€ì— ìœ„ì¹˜í•œ ê±°ëŒ€í•œ ì‚°ë§¥ì…ë‹ˆë‹¤.', question: 'ë¡œí‚¤ ì‚°ë§¥ì˜ ìœ„ì¹˜ëŠ”?', answers: [{ text: 'ë¶ë¯¸ ì„œë¶€', correct: true }, { text: 'ë‚¨ë¯¸ ì¤‘ë¶€', correct: false }, { text: 'ìœ ëŸ½ ë™ë¶€', correct: false }, { text: 'ì•„ì‹œì•„ ë‚¨ë¶€', correct: false }] },
      2: { title: 'ì§€ë¦¬ 02 - ë¶ë¯¸ ì¤‘ë¶€', emoji: 'ğŸŒ¾', text: 'ë¯¸êµ­ ì¤‘ì„œë¶€ëŠ” ê´‘í™œí•œ ëŒ€í‰ì›ìœ¼ë¡œ ì„¸ê³„ ìµœëŒ€ ê³¡ì°½ì§€ëŒ€ì…ë‹ˆë‹¤.', question: 'ë¯¸êµ­ ì¤‘ì„œë¶€ì˜ íŠ¹ì§•ì€?', answers: [{ text: 'ê´‘í™œí•œ ëŒ€í‰ì›', correct: true }, { text: 'ë†’ì€ ì‚°ë§¥', correct: false }, { text: 'ì—´ëŒ€ìš°ë¦¼', correct: false }, { text: 'ì‚¬ë§‰', correct: false }] },
      3: { title: 'ì§€ë¦¬ 03 - ë¶ë¯¸ ë™ë¶€', emoji: 'ğŸ™ï¸', text: 'ë¶ë¯¸ ë™ë¶€ëŠ” ë‰´ìš• ë“± ëŒ€ë„ì‹œê°€ ë°€ì§‘ëœ ê²½ì œ ì¤‘ì‹¬ì§€ì…ë‹ˆë‹¤.', question: 'ë¶ë¯¸ ë™ë¶€ì˜ íŠ¹ì§•ì€?', answers: [{ text: 'ëŒ€ë„ì‹œ ë°€ì§‘', correct: true }, { text: 'ë†ì—… ì¤‘ì‹¬', correct: false }, { text: 'ì‚¬ë§‰', correct: false }, { text: 'íˆ°ë“œë¼', correct: false }] },
      4: { title: 'ì§€ë¦¬ 04 - ì¤‘ë¯¸', emoji: 'ğŸŒ´', text: 'ì¤‘ì•™ì•„ë©”ë¦¬ì¹´ëŠ” ì—´ëŒ€ê¸°í›„ë¡œ ì»¤í”¼, ë°”ë‚˜ë‚˜ê°€ ì¬ë°°ë©ë‹ˆë‹¤.', question: 'ì¤‘ë¯¸ì˜ ê¸°í›„ëŠ”?', answers: [{ text: 'ì—´ëŒ€ê¸°í›„', correct: true }, { text: 'ì˜¨ëŒ€ê¸°í›„', correct: false }, { text: 'í•œëŒ€ê¸°í›„', correct: false }, { text: 'ê±´ì¡°ê¸°í›„', correct: false }] },
      5: { title: 'ì§€ë¦¬ 05 - ë‚¨ë¯¸', emoji: 'ğŸ¦œ', text: 'ì•„ë§ˆì¡´ ì—´ëŒ€ìš°ë¦¼ì€ ì§€êµ¬ì˜ í—ˆíŒŒë¡œ ë¶ˆë¦½ë‹ˆë‹¤.', question: 'ì•„ë§ˆì¡´ì˜ ë³„ëª…ì€?', answers: [{ text: 'ì§€êµ¬ì˜ í—ˆíŒŒ', correct: true }, { text: 'ì§€êµ¬ì˜ ì‹¬ì¥', correct: false }, { text: 'ì§€êµ¬ì˜ ì‹ ì¥', correct: false }, { text: 'ì§€êµ¬ì˜ ê°„', correct: false }] },
      6: { title: 'ì§€ë¦¬ 06 - ë¶ìœ ëŸ½', emoji: 'ğŸŒŠ', text: 'ë¶ìœ ëŸ½ì€ í”¼ì˜¤ë¥´ ì§€í˜•ì´ ë°œë‹¬í–ˆìŠµë‹ˆë‹¤.', question: 'ë¶ìœ ëŸ½ì˜ ì§€í˜•ì€?', answers: [{ text: 'í”¼ì˜¤ë¥´', correct: true }, { text: 'ì¹´ë¥´ìŠ¤íŠ¸', correct: false }, { text: 'ì‚¬êµ¬', correct: false }, { text: 'ì‚¼ê°ì£¼', correct: false }] },
      7: { title: 'ì§€ë¦¬ 07 - ì„œìœ ëŸ½', emoji: 'ğŸ—¼', text: 'ì„œìœ ëŸ½ì€ ì‚°ì—…í˜ëª…ì˜ ë°œìƒì§€ì…ë‹ˆë‹¤.', question: 'ì‚°ì—…í˜ëª… ë°œìƒì§€ëŠ”?', answers: [{ text: 'ì„œìœ ëŸ½', correct: true }, { text: 'ë™ì•„ì‹œì•„', correct: false }, { text: 'ë‚¨ë¯¸', correct: false }, { text: 'ì•„í”„ë¦¬ì¹´', correct: false }] },
      8: { title: 'ì§€ë¦¬ 08 - ë‚¨ìœ ëŸ½', emoji: 'ğŸ›ï¸', text: 'ë‚¨ìœ ëŸ½ì€ ì§€ì¤‘í•´ì„± ê¸°í›„ë¡œ ì˜¬ë¦¬ë¸Œê°€ ì¬ë°°ë©ë‹ˆë‹¤.', question: 'ë‚¨ìœ ëŸ½ì˜ ê¸°í›„ëŠ”?', answers: [{ text: 'ì§€ì¤‘í•´ì„±', correct: true }, { text: 'ì—´ëŒ€', correct: false }, { text: 'ì‚¬ë§‰', correct: false }, { text: 'í•œëŒ€', correct: false }] },
      9: { title: 'ì§€ë¦¬ 09 - ë¶ì•„í”„ë¦¬ì¹´', emoji: 'ğŸœï¸', text: 'ì‚¬í•˜ë¼ ì‚¬ë§‰ì€ ì„¸ê³„ ìµœëŒ€ ì—´ì‚¬ë§‰ì…ë‹ˆë‹¤.', question: 'ì‚¬í•˜ë¼ ì‚¬ë§‰ ìœ„ì¹˜ëŠ”?', answers: [{ text: 'ë¶ì•„í”„ë¦¬ì¹´', correct: true }, { text: 'ë‚¨ì•„ì‹œì•„', correct: false }, { text: 'ì¤‘ì•™ì•„ì‹œì•„', correct: false }, { text: 'ì˜¤ì„¸ì•„ë‹ˆì•„', correct: false }] },
      10: { title: 'ì§€ë¦¬ 10 - ì„œì•„í”„ë¦¬ì¹´', emoji: 'ğŸ¦', text: 'ì„œì•„í”„ë¦¬ì¹´ëŠ” ì—´ëŒ€ ì‚¬ë°”ë‚˜ ê¸°í›„ì…ë‹ˆë‹¤.', question: 'ì„œì•„í”„ë¦¬ì¹´ ê¸°í›„ëŠ”?', answers: [{ text: 'ì—´ëŒ€ ì‚¬ë°”ë‚˜', correct: true }, { text: 'íˆ°ë“œë¼', correct: false }, { text: 'ì§€ì¤‘í•´ì„±', correct: false }, { text: 'ëƒ‰ëŒ€', correct: false }] },
      11: { title: 'ì§€ë¦¬ 11 - ë‚¨ì•„í”„ë¦¬ì¹´', emoji: 'ğŸ’', text: 'ë‚¨ì•„í”„ë¦¬ì¹´ëŠ” ê¸ˆ, ë‹¤ì´ì•„ëª¬ë“œê°€ í’ë¶€í•©ë‹ˆë‹¤.', question: 'ë‚¨ì•„í”„ë¦¬ì¹´ ìì›ì€?', answers: [{ text: 'ê¸ˆ, ë‹¤ì´ì•„ëª¬ë“œ', correct: true }, { text: 'ì„ìœ ', correct: false }, { text: 'ì²œì—°ê°€ìŠ¤', correct: false }, { text: 'êµ¬ë¦¬', correct: false }] },
      12: { title: 'ì§€ë¦¬ 12 - ë™ìœ ëŸ½', emoji: 'ğŸ°', text: 'ë™ìœ ëŸ½ì€ ëƒ‰ëŒ€ê¸°í›„ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.', question: 'ë™ìœ ëŸ½ì˜ ê¸°í›„ëŠ”?', answers: [{ text: 'ëƒ‰ëŒ€ê¸°í›„', correct: true }, { text: 'ì—´ëŒ€', correct: false }, { text: 'ê±´ì¡°', correct: false }, { text: 'ì§€ì¤‘í•´ì„±', correct: false }] },
      13: { title: 'ì§€ë¦¬ 13 - ì„œì•„ì‹œì•„', emoji: 'ğŸ•Œ', text: 'ì„œì•„ì‹œì•„ëŠ” ì„ìœ  ìì›ì´ í’ë¶€í•©ë‹ˆë‹¤.', question: 'ì„œì•„ì‹œì•„ ì£¼ìš” ìì›ì€?', answers: [{ text: 'ì„ìœ ', correct: true }, { text: 'ì„íƒ„', correct: false }, { text: 'ì² ê´‘ì„', correct: false }, { text: 'ìš°ë¼ëŠ„', correct: false }] },
      14: { title: 'ì§€ë¦¬ 14 - ì¤‘ì•™ì•„ì‹œì•„', emoji: 'ğŸ«', text: 'ì¤‘ì•™ì•„ì‹œì•„ëŠ” ê±´ì¡°í•œ ëŒ€ë¥™ì„± ê¸°í›„ì…ë‹ˆë‹¤.', question: 'ì¤‘ì•™ì•„ì‹œì•„ ê¸°í›„ëŠ”?', answers: [{ text: 'ê±´ì¡° ëŒ€ë¥™ì„±', correct: true }, { text: 'í•´ì–‘ì„±', correct: false }, { text: 'ì—´ëŒ€', correct: false }, { text: 'íˆ°ë“œë¼', correct: false }] },
      15: { title: 'ì§€ë¦¬ 15 - ë‚¨ì•„ì‹œì•„', emoji: 'ğŸ”ï¸', text: 'íˆë§ë¼ì•¼ëŠ” ì„¸ê³„ì—ì„œ ê°€ì¥ ë†’ì€ ì‚°ë§¥ì…ë‹ˆë‹¤.', question: 'ê°€ì¥ ë†’ì€ ì‚°ë§¥ì€?', answers: [{ text: 'íˆë§ë¼ì•¼', correct: true }, { text: 'ì•Œí”„ìŠ¤', correct: false }, { text: 'ì•ˆë°ìŠ¤', correct: false }, { text: 'ë¡œí‚¤', correct: false }] },
      16: { title: 'ì§€ë¦¬ 16 - ë™ì•„ì‹œì•„', emoji: 'ğŸ¯', text: 'ë™ì•„ì‹œì•„ëŠ” ê³„ì ˆí’ ê¸°í›„ì…ë‹ˆë‹¤.', question: 'ë™ì•„ì‹œì•„ ê¸°í›„ëŠ”?', answers: [{ text: 'ê³„ì ˆí’(ëª¬ìˆœ)', correct: true }, { text: 'ì‚¬ë§‰', correct: false }, { text: 'íˆ°ë“œë¼', correct: false }, { text: 'ì§€ì¤‘í•´ì„±', correct: false }] },
      17: { title: 'ì§€ë¦¬ 17 - ë™ë‚¨ì•„ì‹œì•„', emoji: 'ğŸŒº', text: 'ë™ë‚¨ì•„ì‹œì•„ëŠ” ì—°ì¤‘ ê³ ì˜¨ë‹¤ìŠµí•œ ì—´ëŒ€ê¸°í›„ì…ë‹ˆë‹¤.', question: 'ë™ë‚¨ì•„ì‹œì•„ ê¸°í›„ëŠ”?', answers: [{ text: 'ì—´ëŒ€', correct: true }, { text: 'ì˜¨ëŒ€', correct: false }, { text: 'í•œëŒ€', correct: false }, { text: 'ê±´ì¡°', correct: false }] },
      18: { title: 'ì§€ë¦¬ 18 - ë™ë¶ì•„ì‹œì•„', emoji: 'â„ï¸', text: 'ì‹œë² ë¦¬ì•„ëŠ” íƒ€ì´ê°€ê°€ ë¶„í¬í•©ë‹ˆë‹¤.', question: 'ì‹œë² ë¦¬ì•„ì˜ ì‹ìƒì€?', answers: [{ text: 'íƒ€ì´ê°€(ì¹¨ì—½ìˆ˜ë¦¼)', correct: true }, { text: 'ì—´ëŒ€ìš°ë¦¼', correct: false }, { text: 'ì‚¬ë°”ë‚˜', correct: false }, { text: 'ì´ˆì›', correct: false }] },
      19: { title: 'ì§€ë¦¬ 19 - ì˜¤ì„¸ì•„ë‹ˆì•„', emoji: 'ğŸï¸', text: 'ì˜¤ì„¸ì•„ë‹ˆì•„ëŠ” ìˆ˜ë§ì€ ì„¬ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.', question: 'ì˜¤ì„¸ì•„ë‹ˆì•„ íŠ¹ì§•ì€?', answers: [{ text: 'ìˆ˜ë§ì€ ì„¬', correct: true }, { text: 'ê±°ëŒ€ ëŒ€ë¥™', correct: false }, { text: 'ì‚¬ë§‰', correct: false }, { text: 'ê³ ì‚°', correct: false }] },
      20: { title: 'ì§€ë¦¬ 20 - í˜¸ì£¼', emoji: 'ğŸ¦˜', text: 'í˜¸ì£¼ëŠ” ì„¸ê³„ì—ì„œ ê°€ì¥ ê±´ì¡°í•œ ëŒ€ë¥™ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.', question: 'í˜¸ì£¼ ëŒ€ë¥™ íŠ¹ì§•ì€?', answers: [{ text: 'ê±´ì¡°í•œ ê¸°í›„', correct: true }, { text: 'ì—´ëŒ€ìš°ë¦¼', correct: false }, { text: 'ë¹™í•˜', correct: false }, { text: 'ë†’ì€ ì‚°ë§¥', correct: false }] }
    };

    let currentLocation = 1;
    let completedLocations = new Set();
    let travelPath = [];

    // ê³ ë˜ ì´ˆê¸° ìœ„ì¹˜
    const whale = document.getElementById('whale');
    positionWhaleAtFlag(1);

    function positionWhaleAtFlag(num) {
      const flag = document.getElementById(`flag${num}`);
      const rect = flag.getBoundingClientRect();
      const mapRect = document.getElementById('worldMap').getBoundingClientRect();
      whale.style.left = (rect.left - mapRect.left - 20) + 'px';
      whale.style.top = (rect.top - mapRect.top - 20) + 'px';
    }

    // ê¹ƒë°œ í´ë¦­
    document.querySelectorAll('.flag').forEach(flag => {
      flag.addEventListener('click', function() {
        if (this.classList.contains('locked')) {
          alert('ì´ì „ ì§€ì—­ì„ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”!');
          return;
        }
        const locationId = parseInt(this.dataset.location);
        openModal(locationId);
      });
    });

    function openModal(id) {
      currentLocation = id;
      const data = geoData[id];
      document.getElementById('modalTitle').textContent = data.title;
      document.getElementById('modalEmoji').textContent = data.emoji;
      document.getElementById('modalText').textContent = data.text;
      document.getElementById('questionText').textContent = data.question;

      const optionsContainer = document.getElementById('answerOptions');
      optionsContainer.innerHTML = '';
      data.answers.forEach((answer, index) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = answer.text;
        btn.onclick = () => checkAnswer(index);
        optionsContainer.appendChild(btn);
      });

      document.getElementById('completeBtn').disabled = true;
      document.getElementById('modal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('show');
    }

    function checkAnswer(index) {
      const data = geoData[currentLocation];
      const buttons = document.querySelectorAll('.answer-btn');
      buttons.forEach((btn, i) => {
        btn.disabled = true;
        if (data.answers[i].correct) {
          btn.classList.add('correct');
        } else if (i === index && !data.answers[i].correct) {
          btn.classList.add('wrong');
        }
      });

      if (data.answers[index].correct) {
        document.getElementById('completeBtn').disabled = false;
      } else {
        setTimeout(() => {
          buttons.forEach(btn => {
            btn.disabled = false;
            btn.classList.remove('wrong');
          });
        }, 1500);
      }
    }

    function completeLocation() {
      completedLocations.add(currentLocation);

      // ê¹ƒë°œ ì™„ë£Œ í‘œì‹œ
      const flag = document.getElementById(`flag${currentLocation}`);
      flag.classList.add('completed');
      // ê¹ƒë°œ ì´ë¯¸ì§€ë¥¼ ì™„ë£Œ ì´ë¯¸ì§€ë¡œ ë³€ê²½
      const flagImage = flag.querySelector('.flag-image');
      flagImage.src = '/images/gi2.png';

      // ëª¨ë‹¬ ë‹«ê¸°
      closeModal();

      // í­ì£½ íš¨ê³¼
      showFireworks();

      // ë‹¤ìŒ ê¹ƒë°œ ì ê¸ˆ í•´ì œ
      const nextLocation = currentLocation + 1;
      if (nextLocation <= 20) {
        setTimeout(() => {
          const nextFlag = document.getElementById(`flag${nextLocation}`);
          nextFlag.classList.remove('locked');

          // ê³ ë˜ ì´ë™
          moveWhaleToFlag(nextLocation);
        }, 1500);
      } else {
        // ëª¨ë“  ì™„ë£Œ
        setTimeout(() => {
          document.getElementById('celebration').classList.add('show');
        }, 2000);
      }

      // ì§„í–‰ë„ ì—…ë°ì´íŠ¸
      updateProgress();
    }

    function moveWhaleToFlag(num) {
      const flag = document.getElementById(`flag${num}`);
      const rect = flag.getBoundingClientRect();
      const mapRect = document.getElementById('worldMap').getBoundingClientRect();
      whale.style.left = (rect.left - mapRect.left - 20) + 'px';
      whale.style.top = (rect.top - mapRect.top - 20) + 'px';
    }

    function updateProgress() {
      const completed = completedLocations.size;
      const percentage = (completed / 20) * 100;
      document.getElementById('progressText').textContent = `${completed}/20 ì™„ë£Œ`;
      document.getElementById('progressFill').style.width = `${percentage}%`;
    }

    function showFireworks() {
      const container = document.getElementById('fireworks');
      container.classList.add('show');
      container.innerHTML = '';

      const emojis = ['ğŸ‰', 'âœ¨', 'ğŸŠ', 'â­', 'ğŸ’«', 'ğŸŒŸ', 'ğŸ’¥'];
      for (let i = 0; i < 40; i++) {
        const firework = document.createElement('div');
        firework.className = 'firework';
        firework.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        firework.style.left = '50%';
        firework.style.top = '50%';
        firework.style.setProperty('--tx', `${(Math.random() - 0.5) * 600}px`);
        firework.style.setProperty('--ty', `${(Math.random() - 0.5) * 600}px`);
        container.appendChild(firework);
      }

      setTimeout(() => {
        container.classList.remove('show');
      }, 1500);
    }

    // ê¹ƒë°œ ìœ„ì¹˜ ì„¤ì • (ì„¸ê³„ ë¬¸í™”ìœ ì‚° ê±´ë¬¼ì— ë°°ì¹˜)
    function setFlagPositions() {
      const flagPositions = {
        1: { left: '10%', top: '28%' },   // ë¶ë¯¸ - ììœ ì˜ ì—¬ì‹ ìƒ
        2: { left: '16%', top: '46%' },   // ì¤‘ë¯¸ - ë§ˆì•¼ í”¼ë¼ë¯¸ë“œ
        3: { left: '24%', top: '70%' },   // ë‚¨ë¯¸ - ë§ˆì¶”í”½ì¶”
        4: { left: '22%', top: '60%' },   // ë‚¨ë¯¸ - ê·¸ë¦¬ìŠ¤ë„ìƒ
        5: { left: '32%', top: '68%' },   // ë‚¨ë¯¸ - ì´ê³¼ìˆ˜ í­í¬
        6: { left: '8%', top: '14%' },    // ë¶ë¯¸ - í† í…œí´
        7: { left: '34%', top: '18%' },   // ìœ ëŸ½ - ë¹…ë²¤
        8: { left: '38%', top: '22%' },   // ìœ ëŸ½ - ì—í íƒ‘
        9: { left: '44%', top: '38%' },   // ìœ ëŸ½ - ì½œë¡œì„¸ì›€
        10: { left: '30%', top: '62%' },  // ì•„í”„ë¦¬ì¹´ - í”¼ë¼ë¯¸ë“œ
        11: { left: '36%', top: '72%' },  // ì•„í”„ë¦¬ì¹´ - ì‚¬íŒŒë¦¬
        12: { left: '50%', top: '28%' },  // ëŸ¬ì‹œì•„ - ì„± ë°”ì‹¤ë¦¬ ì„±ë‹¹
        13: { left: '54%', top: '42%' },  // ì¤‘ë™ - í˜íŠ¸ë¼
        14: { left: '62%', top: '48%' },  // ì¸ë„ - íƒ€ì§€ë§ˆí• 
        15: { left: '70%', top: '54%' },  // ë™ë‚¨ì•„ - ì•™ì½”ë¥´ì™€íŠ¸
        16: { left: '78%', top: '28%' },  // ì¤‘êµ­ - ë§Œë¦¬ì¥ì„±
        17: { left: '74%', top: '32%' },  // ì¤‘êµ­ - ìê¸ˆì„±
        18: { left: '82%', top: '34%' },  // ì¼ë³¸ - í›„ì§€ì‚°/ì‹ ì‚¬
        19: { left: '86%', top: '78%' },  // í˜¸ì£¼ - ì‹œë“œë‹ˆ ì˜¤í˜ë¼í•˜ìš°ìŠ¤
        20: { left: '78%', top: '68%' }   // ë™ë‚¨ì•„ - ë¶ˆêµ ì‚¬ì›
      };

      Object.keys(flagPositions).forEach(num => {
        const flag = document.getElementById(`flag${num}`);
        if (flag) {
          flag.style.left = flagPositions[num].left;
          flag.style.top = flagPositions[num].top;
        }
      });
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¹ƒë°œ ìœ„ì¹˜ ì„¤ì •
    setFlagPositions();

    // ê¹ƒë°œ ë“œë˜ê·¸ ê¸°ëŠ¥ ì¶”ê°€
    let isDragging = false;
    let currentFlag = null;
    let offsetX = 0;
    let offsetY = 0;

    // ëª¨ë“  ê¹ƒë°œì— ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì¶”ê°€
    document.querySelectorAll('.flag').forEach(flag => {
      flag.addEventListener('mousedown', function(e) {
        // ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ë“œë˜ê·¸ ì•ˆí•¨
        if (document.getElementById('modal').style.display === 'flex') return;

        isDragging = true;
        currentFlag = this;

        const rect = currentFlag.getBoundingClientRect();
        const parentRect = document.getElementById('worldMap').getBoundingClientRect();

        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;

        currentFlag.style.cursor = 'grabbing';
        e.preventDefault();
      });
    });

    document.addEventListener('mousemove', function(e) {
      if (!isDragging || !currentFlag) return;

      const parentRect = document.getElementById('worldMap').getBoundingClientRect();

      let newLeft = ((e.clientX - parentRect.left - offsetX) / parentRect.width) * 100;
      let newTop = ((e.clientY - parentRect.top - offsetY) / parentRect.height) * 100;

      // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šë„ë¡ ì œí•œ
      newLeft = Math.max(0, Math.min(95, newLeft));
      newTop = Math.max(0, Math.min(95, newTop));

      currentFlag.style.left = newLeft + '%';
      currentFlag.style.top = newTop + '%';
    });

    document.addEventListener('mouseup', function(e) {
      if (isDragging && currentFlag) {
        currentFlag.style.cursor = 'pointer';

        // ì½˜ì†”ì— ìµœì¢… ìœ„ì¹˜ ì¶œë ¥
        const flagNum = currentFlag.id.replace('flag', '');
        console.log(`Flag ${flagNum}: { left: '${currentFlag.style.left}', top: '${currentFlag.style.top}' }`);

        isDragging = false;
        currentFlag = null;
      }
    });
  </script>
</body>
</html>
