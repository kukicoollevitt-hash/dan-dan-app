<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>단단국어 문해력 시리즈 | 목차</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #e9d5c7;
      --panel: #f7f0eb;
      --line: #cc9e71;
      --accent: #8b2f2f;
      --text: #2e2e2e;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      font-family: "Apple SD Gothic Neo","Noto Sans KR",sans-serif;
      min-height: 100vh;
    }
    header {
      background: #fff;
      padding: 14px 22px 10px;
      border-bottom: 1px solid rgba(0,0,0,.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .page-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }
    #user-info {
      font-size: 14px;
      font-weight: 600;
      color: var(--accent);
    }
    .layout {
      display: grid;
      grid-template-columns: 210px 200px 230px 1fr;
      gap: 0;
      height: calc(100vh - 58px);
    }
    .col {
      background: #fff;
      border-right: 1px solid rgba(0,0,0,0.04);
      overflow-y: auto;
    }
    .col-title {
      padding: 14px 14px 6px;
      font-size: 14px;
      font-weight: 600;
      color: #5d4732;
    }
    .col-sub {
      padding: 0 14px 10px;
      font-size: 12px;
      color: #9a8066;
    }
    .list {
      list-style: none;
      margin: 0;
      padding: 0 8px 16px;
    }
    .list-item {
      padding: 8px 10px;
      border-radius: 10px;
      margin: 4px 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: transparent;
    }
    .list-item small {
      font-size: 11px;
      color: #a69485;
      margin-left: 8px;
    }
    .list-item.active {
      background: rgba(139,47,47,0.08);
      color: var(--accent);
      font-weight: 600;
    }
    .empty {
      font-size: 13px;
      color: #a08b78;
      padding: 16px 14px;
    }
    .unit-search {
      padding: 8px 12px 0;
    }
    .unit-search input {
      width: 100%;
      border: 1px solid rgba(0,0,0,.08);
      border-radius: 8px;
      padding: 6px 8px;
      font-size: 13px;
      outline: none;
    }
    .detail-pane {
      background: #fff6f1;
      padding: 16px 18px;
    }
    .detail-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #5c3f33;
    }
    .detail-body {
      font-size: 13px;
      color: #7b5b4a;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <header>
    <div class="page-title">단단국어 문해력 시리즈</div>
    <div id="user-info">로그인한 학생 표시 영역</div>
  </header>

  <div class="layout">
    <!-- ① 시리즈 -->
    <div class="col" id="series-col">
      <div class="col-title">① 시리즈 선택</div>
      <div class="col-sub">세종 · 정조 · 영조 · 문종 · 성균관 · 국자감</div>
      <ul class="list" id="series-list"></ul>
    </div>

    <!-- ② 분야 -->
    <div class="col" id="domain-col">
      <div class="col-title">② 분야 선택</div>
      <div class="col-sub">과목을 선택하면 오른쪽에 세부 과목이 나옵니다.</div>
      <ul class="list" id="domain-list"></ul>
    </div>

    <!-- ③ 세부 과목 -->
    <div class="col" id="unit-col">
      <div class="col-title">③ 세부 과목</div>
      <div class="unit-search">
        <input type="text" id="unit-search" placeholder="단원명/번호 검색" />
      </div>
      <ul class="list" id="unit-list"></ul>
    </div>

    <!-- ④ 단원 선택 -->
    <div class="col detail-pane" id="lesson-col">
      <div class="detail-title">단원 선택</div>
      <div class="detail-body" id="lesson-body">
        좌측에서 시리즈 → 분야 → 과목을 선택하면 이곳에 단원이 나옵니다.
      </div>
    </div>
  </div>

  <script>
    // -----------------------------
    // 0. 로그인한 학생 정보 표시
    // -----------------------------
    const params = new URLSearchParams(location.search);
    const studentName = params.get("name");
    const studentGrade = params.get("grade");
    const userInfoEl = document.getElementById("user-info");
    if (studentName) {
      userInfoEl.textContent = `${studentGrade || ""} ${studentName}님 환영합니다!`.trim();
    } else {
      userInfoEl.textContent = "로그인한 학생 정보 없음";
    }

    // -----------------------------
    // 1. 데이터 정의
    // -----------------------------
    const DATA = {
      sejong: {
        label: "세종편",
        desc: "개념이해",
        domains: {
          science: {
            label: "과학분야",
            units: [
              { label: "1과: 과학 글의 구조", num: "세-과-01" },
              { label: "2과: 실험 설명하기", num: "세-과-02" },
              { label: "3과: 비교하는 글", num: "세-과-03" },
              { label: "4과: 도표 읽기", num: "세-과-04" }
            ]
          },
          society: {
            label: "사회분야",
            units: [
              { label: "1과: 인물 탐구", num: "세-사-01" },
              { label: "2과: 사건 정리", num: "세-사-02" },
              { label: "3과: 설명문 요약", num: "세-사-03" },
              { label: "4과: 관점 비교", num: "세-사-04" }
            ]
          },
          korean: {
            label: "한국문학분야",
            units: [
              { label: "1과: 고전 읽기", num: "세-한-01" },
              { label: "2과: 시 감상", num: "세-한-02" }
            ]
          },
          world: {
            label: "세계문학분야",
            units: [
              { label: "1과: 전래 이야기", num: "세-세-01" }
            ]
          },
          human: {
            label: "인물분야",
            units: [
              { label: "1과: 세종대왕", num: "세-인-01" }
            ]
          }
        }
      },
      jeongjo: {
        label: "정조편",
        desc: "응용적용",
        domains: {
          science: {
            label: "과학분야",
            units: [
              { label: "1과: 과학 기사 읽기", num: "정-과-01" },
              { label: "2과: 과정 설명", num: "정-과-02" },
              { label: "3과: 문제 해결", num: "정-과-03" },
              { label: "4과: 실험 결과 해석", num: "정-과-04" }
            ]
          },
          society: {
            label: "사회분야",
            units: [
              { label: "1과: 인물 비교", num: "정-사-01" },
              { label: "2과: 사건 카드 만들기", num: "정-사-02" },
              { label: "3과: 의견 제시", num: "정-사-03" },
              { label: "4과: 문화유산", num: "정-사-04" }
            ]
          }
        }
      },
      yeongjo: {
        label: "영조편",
        desc: "논리연결",
        domains: {}
      },
      munjong: {
        label: "문종편",
        desc: "심화추론",
        domains: {}
      },
      seonggyungwan: {
        label: "성균관",
        desc: "중등교과",
        domains: {}
      },
      gukjagam: {
        label: "국자감",
        desc: "고등교과",
        domains: {}
      }
    };

    // -----------------------------
    // 2. DOM 참조
    // -----------------------------
    const seriesListEl = document.getElementById("series-list");
    const domainListEl = document.getElementById("domain-list");
    const unitListEl = document.getElementById("unit-list");
    const lessonBodyEl = document.getElementById("lesson-body");
    const unitSearchEl = document.getElementById("unit-search");

    let currentUnits = []; // 검색을 위해 저장

    // -----------------------------
    // 3. 시리즈 렌더
    // -----------------------------
    function renderSeries() {
      seriesListEl.innerHTML = "";
      Object.keys(DATA).forEach(key => {
        const li = document.createElement("li");
        li.className = "list-item";
        li.dataset.series = key;
        li.innerHTML = `
          <span>${DATA[key].label}</span>
          <small>${DATA[key].desc || ""}</small>
        `;
        li.addEventListener("click", () => {
          // active처리
          Array.from(seriesListEl.children).forEach(c => c.classList.remove("active"));
          li.classList.add("active");
          renderDomains(key);
        });
        seriesListEl.appendChild(li);
      });
    }

    // -----------------------------
    // 4. 분야 렌더
    // -----------------------------
    function renderDomains(seriesKey) {
      const series = DATA[seriesKey];
      domainListEl.innerHTML = "";
      unitListEl.innerHTML = "";
      lessonBodyEl.textContent = "과목을 선택하면 단원이 나옵니다.";

      if (!series || !series.domains || Object.keys(series.domains).length === 0) {
        domainListEl.innerHTML = `<li class="empty">등록된 분야가 없습니다.</li>`;
        currentUnits = [];
        return;
      }

      Object.keys(series.domains).forEach(dKey => {
        const dom = series.domains[dKey];
        const li = document.createElement("li");
        li.className = "list-item";
        li.textContent = `${dom.label} ${dom.units ? dom.units.length + "과목" : ""}`;
        li.addEventListener("click", () => {
          Array.from(domainListEl.children).forEach(c => c.classList.remove("active"));
          li.classList.add("active");
          renderUnitList(dom.units || []);
        });
        domainListEl.appendChild(li);
      });
    }

    // -----------------------------
    // 5. 단원 리스트 렌더
    // -----------------------------
    function renderUnitList(units) {
      currentUnits = units || [];
      unitListEl.innerHTML = "";

      if (!units || units.length === 0) {
        unitListEl.innerHTML = `<li class="empty">단원이 없습니다.</li>`;
        return;
      }

      units.forEach(u => {
        const li = document.createElement("li");
        li.className = "list-item";
        li.textContent = `${u.label}`;
        li.addEventListener("click", () => {
          Array.from(unitListEl.children).forEach(c => c.classList.remove("active"));
          li.classList.add("active");
          lessonBodyEl.innerHTML = `
            <div class="detail-title">${u.label}</div>
            <div class="detail-body">
              단원 번호: ${u.num}<br/>
              이 단원에 대한 설명을 여기에 적어 주세요.
            </div>
          `;
        });
        unitListEl.appendChild(li);
      });
    }

    // -----------------------------
    // 6. 단원 검색
    // -----------------------------
    unitSearchEl.addEventListener("input", (e) => {
      const q = e.target.value.trim();
      if (q === "") {
        renderUnitList(currentUnits);
        return;
      }
      const filtered = currentUnits.filter(u =>
        (u.label && u.label.includes(q)) ||
        (u.num && u.num.includes(q))
      );
      renderUnitList(filtered);
    });

    // 시작은 세종편으로
    renderSeries();
    // 첫 번째 시리즈를 자동 active
    const firstSeries = seriesListEl.querySelector(".list-item");
    if (firstSeries) firstSeries.classList.add("active");
    renderDomains("sejong");
  </script>
</body>
</html>
