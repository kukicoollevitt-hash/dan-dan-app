<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë‹¨ë‹¨êµ­ì–´ ë¬¸í•´ë ¥ ì‹œë¦¬ì¦ˆ | ëª©ì°¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f2ede5;
      --panel: #fffaf3;
      --accent: #8b2f2f;
      --line: #e5d4c1;
      --text: #3b2a1a;
    }
    * { box-sizing: border-box; }
body {
  margin: 0;
  min-height: 100vh;
  font-family: "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  background: #f2ede5;   /* ê¸°ë³¸ ë°°ê²½ìƒ‰ë§Œ ë‚¨ê¸°ê¸° (ë¹„ë””ì˜¤ ë¡œë”© ì‹¤íŒ¨ ì‹œìš©) */
  position: relative;
  overflow-x: hidden;
}

/* ğŸ”¥ ë©”ë‰´ ì „ì²´ì— ê¹ŒëŠ” MP4 ë°°ê²½ ì˜ìƒ */
.menu-bg-video {
  position: fixed;
  inset: 0;              /* top:0; right:0; bottom:0; left:0; ì™€ ê°™ìŒ */
  width: 100%;
  height: 100%;
  object-fit: cover;     /* í™”ë©´ ê°€ë“ ì±„ìš°ê¸° */
  z-index: -1;           /* ëª¨ë“  ë‚´ìš© ë’¤ë¡œ ë³´ë‚´ê¸° */
  pointer-events: none;  /* í´ë¦­ ë§‰ê¸° */
}

    header {
      background: #f7f1e5;
      border-bottom: 3px solid #c58a45;
      padding: 12px 20px 10px;
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: center;
    }
    .brand-title { font-size: 22px; font-weight: 700; color: #7f2b2b; }
    .brand-sub { font-size: 12px; color: #a57145; }

    /* ğŸ”¹ í—¤ë” ì˜¤ë¥¸ìª½(ìœ ì €ì •ë³´ + ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼) */
    .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .layout {
      display: grid;
  grid-template-columns: 220px 210px 220px 1fr;  /* ğŸ”¥ ì²« ì»¬ëŸ¼ í­ë§Œ 220pxë¡œ í™•ëŒ€ */
      min-height: calc(100vh - 65px);
    }
.col {
  border-right: 1px solid #e1d3c0;
  background: rgba(255, 250, 240, 0.85);
  overflow-y: auto;
}
    .col-title {
      padding: 12px 14px 6px;
      font-weight: 700;
      font-size: 13px;
      color: #5b3a22;
    }
    .series-list, .domain-list, .subject-list, .unit-list {
      list-style: none;
      margin: 0;
      padding: 4px 8px 16px;
    }
    .series-item,
    .domain-item,
    .subject-item,
    .unit-item {
      padding: 14px 18px;
      margin-bottom: 6px;
  background: rgba(248, 238, 214, 0.9);  /* âœ… ì—¬ê¸°ë§Œ êµì²´ */
      border: 1px solid transparent;
      border-radius: 10px;
      font-size: 15px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }
    .series-item:hover,
    .domain-item:hover,
    .subject-item:hover,
    .unit-item:hover {
      border-color: rgba(139,47,47,0.5);
      background: rgba(255,248,240,0.8);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(139,47,47,0.15);
    }
    .series-item.active,
    .domain-item.active,
    .subject-item.active,
    .unit-item.active {
      background: #af4604;
      color: #fff;
      border-color: #8b2f2f;
    }
    /* ë¹„í™œì„±í™”ëœ ì‹œë¦¬ì¦ˆ */
    .series-item.disabled {
      opacity: 0.4;
      filter: grayscale(1);
      cursor: not-allowed;
      pointer-events: none;
    }
    .meta { font-size: 11px; opacity: 0.6; }
    .detail-panel {
      padding: 14px 18px 40px;
      background: #fffdf8;
      overflow-y: auto;
    }
    .detail-title { font-weight: 700; margin-bottom: 2px; }
    .detail-desc { font-size: 12px; color: #9b7a54; margin-bottom: 10px; }
    

    /* ë‹¨ì› ì˜¤ë¥¸ìª½ ë¬¶ìŒ(ë²ˆí˜¸ + ìƒíƒœ) */
    .unit-right {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .unit-list .unit-item { border-radius: 7px; font-size: 14px; }

    .badge {
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.4);
      border-radius: 999px;
      padding: 1px 8px 2px;
      font-size: 10px;
    }

    /* âœ… ìƒíƒœ ë±ƒì§€ */
    .status-badge {
      display: inline-block;
      border-radius: 8px;
      padding: 3px 8px 4px;
      font-size: 11px;
      font-weight: 500;
      white-space: nowrap;
    }
    /* âœï¸ ë¯¸ì™„ë£Œ */
    .status-default {
      background: #f8d4d4;
      color: #7f2525;
    }
    /* ğŸ† í•™ìŠµì™„ë£Œ */
    .status-done {
      background: #aef3ae;
      color: #18622e;
    }

    /* ëª¨ë‹¬ (ì¤€ë¹„ì¤‘) */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
      backdrop-filter: blur(2px);
    }
    .overlay.show { display: flex; }
    .modal-box {
      background: #fffaf3;
      border: 1px solid rgba(139,47,47,0.08);
      border-radius: 18px;
      padding: 22px 24px 20px;
      width: 330px;
      text-align: center;
      box-shadow: 0 15px 45px rgba(0,0,0,0.12);
      animation: pop 0.25s ease;
    }
    @keyframes pop {
      from { transform: translateY(10px) scale(0.97); opacity: 0; }
      to { transform: translateY(0) scale(1); opacity: 1; }
    }
    .modal-emoji { font-size: 34px; margin-bottom: 6px; }
    .modal-title { font-weight: 700; margin-bottom: 6px; color: #6f2e2e; }
    .modal-msg { font-size: 12.5px; color: #8d6f51; line-height: 1.5; margin-bottom: 14px; }
    .modal-btn { background: #8b2f2f; color: #fff; border: none; border-radius: 999px; padding: 7px 16px 8px; font-size: 12.5px; cursor: pointer; }
    .modal-btn:hover { opacity: 0.9; }
    .modal-btn-danger {
      background: #b02a2a;
      border: 1px solid rgba(176,42,42,0.3);
    }
    .modal-btn-danger:hover {
      opacity: 0.95;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    /* ìƒë‹¨ ì‚¬ìš©ì í‘œì‹œ */
    #user-info {
      font-size: 12px;
      color: #8d6f51;
      background: rgba(255,255,255,0.3);
      padding: 6px 12px 7px;
      border-radius: 999px;
      border: 1px solid rgba(197,138,69,0.15);
      white-space: nowrap;
    }

    /* ğŸ”´ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ */
    .logout-btn {
      padding: 6px 14px 7px;
      border-radius: 999px;
      border: 1px solid rgba(139,47,47,0.25);
      background: #8b2f2f;
      color: #fff;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
      transition: transform 0.05s ease, box-shadow 0.05s ease, opacity 0.15s;
    }
    .logout-btn:hover {
      opacity: 0.95;
      box-shadow: 0 3px 8px rgba(0,0,0,0.12);
      transform: translateY(-1px);
    }
    .logout-btn:active {
      transform: translateY(0);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .logout-btn:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    /* ğŸ”‹ ë¡œë”© ì˜¤ë²„ë ˆì´ */
    .overlay-loading {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      backdrop-filter: blur(4px);
    }
    .overlay-loading.show {
      display: flex;
    }
    .loading-box {
      background: #fffaf3;
      border: 1px solid rgba(139,47,47,0.12);
      border-radius: 18px;
      width: 320px;
      text-align: center;
      padding: 28px 30px 26px;
      box-shadow: 0 15px 45px rgba(0,0,0,0.12);
    }
    .loading-emoji {
      font-size: 56px;
      margin-bottom: 8px;
    }
    .loading-title {
      font-weight: 700;
      margin-bottom: 6px;
      color: #6f2e2e;
    }
    .loading-msg {
      font-size: 13px;
      color: #8d6f51;
      margin-bottom: 14px;
    }
    .loading-progress {
      width: 100%;
      height: 10px;
      background: #e0d2c1;
      border-radius: 999px;
      position: relative;
      overflow: hidden;
    }
    .loading-bar {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 0;
      background: #8b2f2f;
      border-radius: 999px;
      transition: width 0.25s ease;
    }
    .loading-percent {
      margin-top: 8px;
      font-size: 12px;
      font-weight: 600;
      color: #8b2f2f;
    }

    .brand-sub-wrap {
      position: relative;      /* ë£¨ëŒí”„ì˜ ê¸°ì¤€ì  */
      display: inline-block;
    }

    .brand-sub {
      white-space: nowrap;     /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
      line-height: 1.2;        /* í˜„ì¬ ì¤„ ë†’ì´ ìœ ì§€ */
    }

    .brand-rudolph {
      position: absolute;
      right: -60px;
      top: -5px;
      transform: translateY(-50%);
      height: 50px;
      width: auto;
      display: block;
      pointer-events: none;
    }
    .bottom-snow {
      position: fixed;
      bottom: -100px;
      left: 0;
      width: 100%;
      pointer-events: none;
      z-index: 1;
    }
    /* === ë©”ë‰´ ì»¬ëŸ¼ê³¼ ìƒì„¸ íŒ¨ë„ì„ íˆ¬ëª…í•˜ê²Œ === */
.col {
  background: transparent !important;
}

.detail-panel {
  background: transparent !important;
}
/* ë¸Œëœë“œ ì„œë¸Œ + ë£¨ëŒí”„ë¥¼ í•œ ì¤„ ì •ë ¬ */
.brand-sub-wrap {
  display: flex;
  align-items: center;
  justify-content: space-between;  /* ì™¼ìª½ í…ìŠ¤íŠ¸, ì˜¤ë¥¸ìª½ ë£¨ëŒí”„ */
}

/* ë£¨ëŒí”„ ì˜ìƒ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
.brand-rudolph {
  width: 60px;          /* ì›í•˜ëŠ” í¬ê¸° */
  height: 60px;
  object-fit: contain;  /* ë¹„ìœ¨ ìœ ì§€ */
  display: block;
  margin-left: 12px;    /* í…ìŠ¤íŠ¸ë‘ ê°„ê²© */
  pointer-events: none;
  border: none;
  background: none;
}

/* ë ˆì´ë” ì°¨íŠ¸ ì•„ì´ì½˜ */
.radar-chart-icon {
  position: fixed;
  bottom: 30px;
  left: 30px;
  width: 120px;
  height: 120px;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 1000;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
}

.radar-chart-icon:hover {
  transform: scale(1.1) translateY(-5px);
  filter: drop-shadow(0 8px 20px rgba(139, 47, 47, 0.4));
}

.radar-chart-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* í•™ìŠµ ë¶„ì„ ëª¨ë‹¬ */
.learning-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(3px);
}

.learning-modal.show {
  display: flex;
}

.learning-modal-content {
  background: #fff;
  width: 90vw;
  height: 90vh;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
  from {
    transform: translateY(30px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.learning-modal-header {
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
}

.learning-modal-title {
  display: none;
}

.learning-modal-close {
  background: rgba(0, 0, 0, 0.5);
  border: none;
  color: #fff;
  font-size: 28px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.learning-modal-close:hover {
  background: rgba(0, 0, 0, 0.7);
  transform: scale(1.1);
}

.learning-modal-iframe {
  flex: 1;
  border: none;
  width: 100%;
  height: 100%;
}

/* ë‹¨ì› í•™ìŠµ ëª¨ë‹¬ */
.unit-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10001;
  backdrop-filter: blur(3px);
}

.unit-modal.show {
  display: flex;
}

.unit-modal-content {
  background: #fff;
  width: 95vw;
  height: 95vh;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  animation: modalSlideIn 0.3s ease;
}

.unit-modal-header {
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
}

.unit-modal-close {
  background: rgba(0, 0, 0, 0.5);
  border: none;
  color: #fff;
  font-size: 28px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.unit-modal-close:hover {
  background: rgba(0, 0, 0, 0.7);
  transform: scale(1.1);
}

.unit-modal-iframe {
  flex: 1;
  border: none;
  width: 100%;
  height: 100%;
}

/* AI ì±—ë´‡ í”Œë¡œíŒ… ë²„íŠ¼ */
.ai-chatbot-floating-btn {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 120px;
  height: 120px;
  cursor: pointer;
  z-index: 10002;
  transition: transform 0.3s ease;
  animation: floatingBounce 3s ease-in-out infinite;
}

.ai-chatbot-floating-btn:hover {
  animation: floatingHover 1s ease-in-out infinite;
}

.ai-chatbot-floating-btn img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
}

@keyframes floatingBounce {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-15px);
  }
}

@keyframes floatingHover {
  0%, 100% {
    transform: translateY(-5px) scale(1.05);
  }
  50% {
    transform: translateY(-20px) scale(1.1);
  }
}

/* AI ì±—ë´‡ ëª¨ë‹¬ - í•¸ë“œí° í˜•íƒœ */
.ai-chatbot-modal {
  position: fixed;
  bottom: 160px;
  right: 30px;
  display: none;
  z-index: 10003;
}

.ai-chatbot-modal.show {
  display: block;
  animation: chatbotSlideUp 0.3s ease;
}

.ai-chatbot-modal-content {
  background: #fff;
  width: 400px;
  height: 650px;
  border-radius: 24px;
  overflow: hidden;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  display: flex;
  flex-direction: column;
  position: relative;
}

.ai-chatbot-modal-header {
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
}

.ai-chatbot-modal-close {
  background: rgba(0, 0, 0, 0.5);
  border: none;
  color: #fff;
  font-size: 24px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.ai-chatbot-modal-close:hover {
  background: rgba(0, 0, 0, 0.7);
  transform: scale(1.1);
}

.ai-chatbot-modal-iframe {
  flex: 1;
  border: none;
  width: 100%;
  height: 100%;
  border-radius: 24px;
}

@keyframes chatbotSlideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ë°˜ì‘í˜•: ì‘ì€ í™”ë©´ì—ì„œëŠ” í¬ê¸° ì¡°ì • */
@media (max-width: 768px) {
  .ai-chatbot-modal-content {
    width: calc(100vw - 40px);
    height: calc(100vh - 200px);
    max-width: 400px;
  }

  .ai-chatbot-modal {
    right: 20px;
    bottom: 140px;
  }
}

  </style>
</head>
<body>
  <!-- ğŸ”¥ MP4 ë©”ë‰´ ë°°ê²½ ì˜ìƒ -->
  <video class="menu-bg-video" autoplay muted loop playsinline>
    <source src="/images/brain-menu-bg-a.mp4" type="video/mp4" />
  </video>
  
  <header>
    <div>
      <div class="brand-title">ë‹¨ë‹¨êµ­ì–´ BRAIN ë¬¸í•´ë ¥ ì‹œë¦¬ì¦ˆ</div>

      <div class="brand-sub-wrap">
        <div class="brand-sub">
          BRAINì˜¨ â†’ BRAINì—… â†’ BRAINí• â†’ BRAINë”¥ â†’ BRAINì¤‘ë“± â†’ BRAINê³ ë“± â†’ ë¶„ì•¼ â†’ ì„¸ë¶€ ê³¼ëª© â†’ ë‹¨ì›
        </div>

        <img src="/images/rudolph.png" class="brand-rudolph" alt="ë£¨ëŒí”„">
      </div>
    </div>

    <!-- ğŸ”¹ ì˜¤ë¥¸ìª½: ì‚¬ìš©ì ì •ë³´ + ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
    <div class="header-right">
      <div id="user-info">ì„±ì¸ ì•ˆìœ ë¹ˆë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!</div>
      <button id="logoutBtn" class="logout-btn" type="button">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </header>

  <div class="layout">
    <!-- â‘  ì‹œë¦¬ì¦ˆ -->
    <div class="col" id="colSeries">
      <div class="col-title">â‘  ì‹œë¦¬ì¦ˆ ì„ íƒ</div>
      <ul class="series-list" id="seriesList">
        <li class="series-item active" data-series="BRAINON"><span>ğŸ’¡ BRAINì˜¨</span><span class="meta">ê°œë…ì´í•´</span></li>
        <li class="series-item" data-series="BRAINUP"><span>ğŸš€ BRAINì—…</span><span class="meta">ì‘ìš©ì ìš©</span></li>
        <li class="series-item" data-series="BRAINFIT"><span>ğŸ”— BRAINí•</span><span class="meta">ë…¼ë¦¬ì—°ê²°</span></li>
        <li class="series-item" data-series="BRAINDEEP"><span>ğŸ” BRAINë”¥</span><span class="meta">ì‹¬í™”ì¶”ë¡ </span></li>
        <li class="series-item" data-series="BRAINM"><span>ğŸ“˜ BRAINì¤‘ë“±</span><span class="meta">ì¤‘ë“±êµê³¼</span></li>
        <li class="series-item" data-series="BRAINH"><span>ğŸ“• BRAINê³ ë“±</span><span class="meta">ê³ ë“±êµê³¼</span></li>
      </ul>
    </div>

    <!-- â‘¡ ë¶„ì•¼ -->
    <div class="col" id="colDomain">
      <div class="col-title">â‘¡ ë¶„ì•¼ ì„ íƒ</div>
      <ul class="domain-list" id="domainList"></ul>
    </div>

    <!-- â‘¢ ì„¸ë¶€ ê³¼ëª© -->
    <div class="col" id="colSubject">
      <div class="col-title">â‘¢ ì„¸ë¶€ ê³¼ëª©</div>
      <ul class="subject-list" id="subjectList"></ul>
    </div>

    <!-- â‘£ ë‹¨ì› + ê²€ìƒ‰ -->
    <div class="detail-panel" id="detailPanel">
      <div style="display:flex; justify-content:space-between; gap:12px; align-items:center;">
        <div>
          <div class="detail-title" id="unitTitle">ë‹¨ì› ì„ íƒ</div>
          <div class="detail-desc" id="unitDesc">[ë³¸ë¬¸í•™ìŠµ] â†’ [ì–´íœ˜í•™ìŠµ] â†’ [ì°½ì˜í™œë™]ì„ ì™„ë£Œ í›„ ì œì¶œí•´ì£¼ì„¸ìš”!</div>
        </div>
        <input
          type="text"
          id="unitSearch"
          placeholder="ë‹¨ì› ê²€ìƒ‰"
          style="padding:5px 8px; border:1px solid #e2d5c3; border-radius:6px; font-size:12px; min-width:140px; background:#ffffff;">
      </div>
      <ul class="unit-list" id="unitList"></ul>
    </div>
  </div>

  <!-- ì¤€ë¹„ì¤‘ ëª¨ë‹¬ -->
  <div class="overlay" id="pendingModal">
    <div class="modal-box">
      <div class="modal-emoji">ğŸ“šâœ¨</div>
      <div class="modal-title">ì•„ì§ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</div>
      <div class="modal-msg">ê³§ ì§€ë¬¸ì´ ì˜¤í”ˆë©ë‹ˆë‹¤. ê¸°ëŒ€í•´ì£¼ì„¸ìš”!</div>
      <button class="modal-btn" id="closeModalBtn">í™•ì¸</button>
    </div>
  </div>

  <script>
    function showPendingModal() { modal.classList.add("show"); }
    function hidePendingModal() { modal.classList.remove("show"); }
    closeModalBtn.addEventListener("click", hidePendingModal);
    modal.addEventListener("click", e => { if (e.target === modal) hidePendingModal(); });

    // ğŸšª ë¡œê·¸ì•„ì›ƒ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
    function showLogoutModal(cb) {
      logoutCallback = cb || null;
      if (logoutModal) logoutModal.classList.add("show");
    }
    function hideLogoutModal() {
      if (logoutModal) logoutModal.classList.remove("show");
    }

    if (logoutCancelBtn) {
      logoutCancelBtn.addEventListener("click", () => {
        hideLogoutModal();
        if (logoutCallback) logoutCallback(false);
      });
    }

    if (logoutConfirmBtn) {
      logoutConfirmBtn.addEventListener("click", () => {
        hideLogoutModal();
        if (logoutCallback) logoutCallback(true);
      });
    }
  </script>

  <!-- ğŸ”¥ ì„¸ì…˜ ì •ë³´ë¥¼ sessionStorageì— ì €ì¥ -->
  <script>
    (async function() {
      try {
        const response = await fetch('/api/session');
        const data = await response.json();

        if (data.ok && data.user) {
          // ì„œë²„ ì„¸ì…˜ ì •ë³´ë¥¼ sessionStorageì— ì €ì¥
          sessionStorage.setItem('user', JSON.stringify(data.user));
          console.log('âœ… Session data saved to sessionStorage:', data.user);
        } else {
          console.log('âŒ No session data available');
        }
      } catch (error) {
        console.error('âŒ Error fetching session:', error);
      }
    })();
  </script>

  <!-- ë¡œê·¸ì•„ì›ƒ í™•ì¸ ëª¨ë‹¬ -->
  <div class="overlay" id="logoutConfirm">
    <div class="modal-box">
      <div class="modal-emoji">ğŸšª</div>
      <div class="modal-title">ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ì–´ìš”?</div>
      <div class="modal-msg">
        ë¡œê·¸ì•„ì›ƒí•˜ë©´ ì´ í•™ìŠµ ë©”ë‰´ë¥¼ ë‹¤ì‹œ ë³´ë ¤ë©´<br>
        ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì•¼ í•´ìš”.
      </div>
      <div style="display:flex; gap:8px; justify-content:center;">
        <button type="button" class="modal-btn" id="logoutCancelBtn">ì·¨ì†Œ</button>
        <button type="button" class="modal-btn modal-btn-danger" id="logoutOkBtn">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
    </div>
  </div>

    <!-- ğŸšª ë¡œê·¸ì•„ì›ƒ í™•ì¸ ëª¨ë‹¬ -->
  <div class="overlay" id="logoutModal">
    <div class="modal-box">
      <div style="font-size:32px; margin-bottom:8px;">ğŸšª</div>
      <div class="modal-title">ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ì–´ìš”?</div>
      <div class="modal-msg">
        ë¡œê·¸ì•„ì›ƒí•˜ë©´ ì´ í•™ìŠµ ë©”ë‰´ë¥¼ ë‹¤ì‹œ ë³´ë ¤ë©´<br>
        ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì•¼ í•´ìš”.
      </div>
      <div style="display:flex; justify-content:center; gap:10px; margin-top:8px;">
        <button
          type="button"
          class="modal-btn"
          id="logoutCancelBtn"
          style="background:#b9a090;"
        >
          ì·¨ì†Œ
        </button>
        <button
          type="button"
          class="modal-btn"
          id="logoutConfirmBtn"
        >
          ë¡œê·¸ì•„ì›ƒ
        </button>
      </div>
    </div>
  </div>



  <!-- ğŸ”‹ ë¡œë”© ì˜¤ë²„ë ˆì´ -->
  <div class="overlay-loading" id="loadingOverlay">
    <div class="loading-box">
      <div class="loading-emoji">ğŸ‹</div>
      <div class="loading-title">ë¡œë”© ì¤‘...</div>
      <div class="loading-msg">í•™ìŠµ ìë£Œë¥¼ ì¤€ë¹„í•˜ê³  ìˆì–´ìš”.</div>
      <div class="loading-progress">
        <div class="loading-bar" id="loadingBar"></div>
      </div>
      <div class="loading-percent" id="loadingPercent">0%</div>
    </div>
  </div>

  <script>
    /* 0. ì‹œë¦¬ì¦ˆ ì •ë³´ */
    const seriesInfo = {
      BRAINON: { name: "BRAINì˜¨", desc: "ê°œë… ì´í•´" },
      BRAINUP: { name: "BRAINì—…", desc: "ì‘ìš© ì ìš©" },
      BRAINFIT: { name: "BRAINí•", desc: "ë…¼ë¦¬ ì—°ê²°" },
      BRAINDEEP: { name: "BRAINë”¥", desc: "ì‹¬í™” ì¶”ë¡ " },
      BRAINM: { name: "BRAINì¤‘ë“±", desc: "ì¤‘ë“± êµê³¼" },
      BRAINH: { name: "BRAINê³ ë“±", desc: "ê³ ë“± êµê³¼" }
    };

    /* 1. ì‹œë¦¬ì¦ˆë³„ ë¶„ì•¼/ê³¼ëª© */
    const domainsBySeries = {
      BRAINON: [
        {
          id: "science",
          label: "ê³¼í•™ë¶„ì•¼",
          subs: [
            { id: "bio", label: "ìƒë¬¼", count: 20 },
            { id: "earth", label: "ì§€êµ¬ê³¼í•™", count: 20 },
            { id: "physics", label: "ë¬¼ë¦¬", count: 20 },
            { id: "chem", label: "í™”í•™", count: 20 }
          ]
        },
        {
          id: "social",
          label: "ì‚¬íšŒë¶„ì•¼",
          subs: [
            { id: "society", label: "ì‚¬íšŒë¬¸í™”", count: 20 },
            { id: "geo", label: "ì§€ë¦¬", count: 20 },
            { id: "law", label: "ë²•", count: 20 },
            { id: "econ", label: "ì •ì¹˜ê²½ì œ", count: 20 }
          ]
        },
        {
          id: "korlit",
          label: "í•œêµ­ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "modern", label: "í˜„ëŒ€ë¬¸í•™", count: 40 },
            { id: "classic", label: "ê³ ì „ë¬¸í•™", count: 40 }
          ]
        },
        {
          id: "worldlit",
          label: "ì„¸ê³„ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "world", label: "ì„¸ê³„ë¬¸í•™", count: 80 }
          ]
        },
        {
          id: "person",
          label: "ì¸ë¬¼ë¶„ì•¼",
          subs: [
            { id: "people", label: "ì¸ë¬¼", count: 80 }
          ]
        }
      ],
      // ë‚˜ë¨¸ì§€ëŠ” ì„¸ì¢… êµ¬ì¡° ì¬ì‚¬ìš©
      BRAINUP: null,
      BRAINFIT: null,
      BRAINDEEP: null,
      // ì„±ê· ê´€
      BRAINM: [
        {
          id: "nonfiction",
          label: "ë¹„ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "naesin", label: "ë‚´ì‹ êµê³¼", count: 20 },
            { id: "suneung", label: "ìˆ˜ëŠ¥ëª¨ê³ ", count: 20 }
          ]
        },
        {
          id: "modernlit",
          label: "í˜„ëŒ€ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "poem", label: "í˜„ëŒ€ì‹œ", count: 20 },
            { id: "novel", label: "í˜„ëŒ€ì†Œì„¤", count: 20 },
            { id: "etc", label: "ê·¹Â·ìˆ˜í•„Â·í¬ê³¡", count: 20 }
          ]
        },
        {
          id: "classiclit",
          label: "ê³ ì „ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "gosi", label: "ê³ ì „ì‹œê°€", count: 20 },
            { id: "gonovel", label: "ê³ ì „ì†Œì„¤", count: 20 },
            { id: "goessay", label: "ê³ ì „ìˆ˜í•„", count: 20 }
          ]
        },
        {
          id: "grammar",
          label: "ë¬¸ë²•ë¶„ì•¼",
          subs: [
            { id: "modern", label: "í˜„ëŒ€", count: 12 },
            { id: "middle", label: "ì¤‘ì„¸", count: 12 }
          ]
        }
      ],
      // êµ­ìê°
      BRAINH: [
        {
          id: "nonfiction",
          label: "ë¹„ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "naesin", label: "ë‚´ì‹ êµê³¼", count: 24 },
            { id: "suneung", label: "ìˆ˜ëŠ¥ëª¨ê³ ", count: 24 }
          ]
        },
        {
          id: "modernlit",
          label: "í˜„ëŒ€ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "poem", label: "í˜„ëŒ€ì‹œ", count: 20 },
            { id: "novel", label: "í˜„ëŒ€ì†Œì„¤", count: 20 },
            { id: "etc", label: "ê·¹Â·ìˆ˜í•„Â·í¬ê³¡", count: 15 }
          ]
        },
        {
          id: "classiclit",
          label: "ê³ ì „ë¬¸í•™ë¶„ì•¼",
          subs: [
            { id: "gosi", label: "ê³ ì „ì‹œê°€", count: 20 },
            { id: "gonovel", label: "ê³ ì „ì†Œì„¤", count: 20 },
            { id: "goessay", label: "ê³ ì „ìˆ˜í•„", count: 15 }
          ]
        },
        {
          id: "grammar",
          label: "ë¬¸ë²•ë¶„ì•¼",
          subs: [
            { id: "modern", label: "í˜„ëŒ€", count: 12 },
            { id: "middle", label: "ì¤‘ì„¸", count: 12 }
          ]
        }
      ]
    };

    /* 2. ê³¼ëª©ë³„ í…Œë§ˆ */
    const titleThemes = {
      bio: [
        "ìƒëª…ì˜ ê¸°ë³¸ ì›ë¦¬ë¥¼ ì´í•´í•˜ê¸°",
        "ì„¸í¬ì—ì„œë¶€í„° ì‹œì‘ë˜ëŠ” ìƒëª…",
        "ë‹¤ì–‘í•œ ìƒë¬¼ì˜ êµ¬ì¡°ì™€ ê¸°ëŠ¥",
        "ìœ ì „ê³¼ ë²ˆì‹ì˜ ë¹„ë°€",
        "í™˜ê²½ê³¼ ìƒë¬¼ì˜ ìƒí˜¸ì‘ìš©",
        "ì ì‘ê³¼ ì§„í™”ì˜ ê³¼ì •",
        "ìƒíƒœê³„ì˜ êµ¬ì„±ê³¼ ìˆœí™˜",
        "ì¸ê°„ê³¼ ìƒíƒœê³„ì˜ ì¡°í™”",
        "ì§ˆë³‘ê³¼ ë©´ì—­ì˜ ì´í•´",
        "ìƒëª…ê³µí•™ì˜ ê¸°ì´ˆ ì‚´í´ë³´ê¸°"
      ],
      earth: [
        "ì§€êµ¬ì˜ êµ¬ì„±ê³¼ ë³€í™”",
        "ëŒ€ê¸°ì™€ ë‚ ì”¨ë¥¼ ì½ë‹¤",
        "ì§€ì§ˆ êµ¬ì¡°ì˜ ì›ë¦¬",
        "í•´ì–‘ì˜ íë¦„ê³¼ ìƒíƒœ",
        "ê¸°ìƒ ì¬í•´ì™€ ëŒ€ë¹„",
        "ê¸°í›„ ë³€í™”ì˜ ì´í•´",
        "ë³„ê³¼ ìš°ì£¼ì˜ ê´€ì°°",
        "ì§€êµ¬ ë‚´ë¶€ì˜ ë¹„ë°€",
        "ìì—°ìì›ì˜ í˜•ì„±ê³¼ ì´ìš©",
        "ì§€êµ¬ í™˜ê²½ì˜ ë³´ì „"
      ],
      physics: [
        "í˜ê³¼ ìš´ë™ì˜ ê¸°ë³¸ ê°œë…",
        "ì—ë„ˆì§€ì˜ í˜•íƒœì™€ ì „í™˜",
        "íŒŒë™ê³¼ ì†Œë¦¬ì˜ ì„¸ê³„",
        "ë¹›ê³¼ ì „ìê¸° í˜„ìƒ",
        "ì—´ê³¼ ì˜¨ë„ì˜ ì›ë¦¬",
        "ì¼ê³¼ ëŠ¥ë¥ ì„ ê³„ì‚°í•˜ë‹¤",
        "ì „ê¸°íšŒë¡œì˜ ê¸°ì´ˆ",
        "ê³¼í•™ì  ì‚¬ê³ ë¡œ ë¬¸ì œ í•´ê²°",
        "ë¬¼ë¦¬ ë²•ì¹™ì˜ ì‹¤ì œ ì ìš©",
        "í˜„ëŒ€ ë¬¼ë¦¬ì˜ ê°„ë‹¨í•œ ì´í•´"
      ],
      chem: [
        "ë¬¼ì§ˆì˜ ì„±ì§ˆê³¼ ìƒíƒœ",
        "ì›ìì™€ ë¶„ìì˜ êµ¬ì¡°",
        "í™”í•™ ë°˜ì‘ì˜ ê¸°ë³¸",
        "ìš©ì•¡ê³¼ ë†ë„ ê³„ì‚°",
        "ì‚°ê³¼ ì—¼ê¸°ì˜ ì„±ì§ˆ",
        "ì£¼ê¸°ìœ¨í‘œë¡œ ë³´ëŠ” ê·œì¹™ì„±",
        "ì—ë„ˆì§€ì™€ í™”í•™ ë³€í™”",
        "ìƒí™œ ì† í™”í•™ ì•Œì•„ë³´ê¸°",
        "í™˜ê²½ê³¼ í™”í•™ ë¬¼ì§ˆ",
        "ì‹¤í—˜ìœ¼ë¡œ í™•ì¸í•˜ëŠ” í™”í•™"
      ],
      society: [
        "ì‚¬íšŒë¬¸í™”ë¥¼ ë°”ë¼ë³´ëŠ” ì‹œê°",
        "ì‚¬íšŒì˜ êµ¬ì¡°ì™€ ì§‘ë‹¨",
        "ë¬¸í™”ì˜ ë‹¤ì–‘ì„±ê³¼ ì´í•´",
        "ì‚¬íšŒ ë³€ë™ê³¼ í˜„ëŒ€ì‚¬íšŒ",
        "ë¯¸ë””ì–´ì™€ ëŒ€ì¤‘ë¬¸í™” ì½ê¸°",
        "ê°€ì¹˜ê´€ê³¼ ê·œë²”ì˜ í˜•ì„±",
        "ì²­ì†Œë…„ê³¼ ì‚¬íšŒ ì°¸ì—¬",
        "ì¸ê¶Œê³¼ í‰ë“±ì˜ í™•ì¥",
        "ê°ˆë“±ê³¼ í•´ê²°ì˜ ë°©ë²•",
        "ì„¸ê³„í™” ì‹œëŒ€ì˜ ì‚¬íšŒë¬¸í™”"
      ],
      geo: [
        "ì§€ë„ë¥¼ í†µí•´ ì„¸ìƒì„ ì´í•´í•˜ë‹¤",
        "ì§€ë„ì— ë‹´ê¸´ ì•½ì†ê³¼ í‘œí˜„",
        "ìš°ë¦¬ ê³ ì¥ì˜ ìƒì§•ê³¼ ìœ ë˜",
        "ê¸°í›„ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ìƒí™œ ëª¨ìŠµ",
        "ìì—°ê³¼ ì¸ê°„ì˜ ì¡°í™”ë¡œìš´ ê´€ê³„",
        "ì§€ë„ë¥¼ ë³´ê³  ê¸¸ì„ ì°¾ì•„ê°€ë‹¤",
        "ì„¸ê³„ ì—¬ëŸ¬ ë‚˜ë¼ì˜ ìœ„ì¹˜ì™€ íŠ¹ì§•",
        "ìš°ë¦¬ë‚˜ë¼ì˜ ì§€ë¦¬ì  íŠ¹ì„± ì´í•´í•˜ê¸°",
        "ìì—°ì¬í•´ì™€ ì¸ê°„ì˜ ëŒ€ì‘",
        "í™˜ê²½ ë¬¸ì œì™€ ì§€ì† ê°€ëŠ¥í•œ ë°œì „",
        "ë„ì‹œì™€ ë†ì´Œì˜ ì°¨ì´",
        "êµí†µê³¼ í†µì‹ ì˜ ë°œë‹¬",
        "ì„¸ê³„í™”ì™€ ì§€ì—­í™”ì˜ ê´€ê³„",
        "ì¸êµ¬ ë¶„í¬ì™€ ì´ë™",
        "ë¬¸í™”ê¶Œì˜ ë‹¤ì–‘ì„± ì´í•´í•˜ê¸°",
        "ì§€ë¦¬ ì •ë³´ ê¸°ìˆ ì˜ í™œìš©",
        "ì„¸ê³„ì˜ ì£¼ìš” ì‚°ì—…",
        "ì—ë„ˆì§€ ìì›ì˜ ì´ìš©",
        "ì§€êµ¬ì´Œì˜ í™˜ê²½ ë¬¸ì œ",
        "ë¯¸ë˜ì˜ ì§€êµ¬ë¥¼ ê·¸ë¦¬ë‹¤"
      ],
      law: [
        "ë²•ì´ í•„ìš”í•œ ì´ìœ ",
        "í—Œë²•ê³¼ ê¸°ë³¸ê¶Œ ì´í•´",
        "ë¯¼ë²•ìœ¼ë¡œ ë³´ëŠ” ê¶Œë¦¬ ê´€ê³„",
        "í˜•ë²•ê³¼ ë²”ì£„ì˜ êµ¬ì„±",
        "ë…¸ë™ê³¼ ì‚¬íšŒ ë³´ì¥ ì œë„",
        "ìƒí™œ ì† ê³„ì•½ê³¼ ë¶„ìŸ",
        "êµ­ê°€ì™€ ì‹œë¯¼ì˜ ì±…ì„",
        "ë²•ì  ì ˆì°¨ì™€ ì¬íŒ",
        "êµ­ì œ ì‚¬íšŒì™€ ë²•",
        "ê³µì •í•œ ì‚¬íšŒë¥¼ ìœ„í•œ ê·œë²”"
      ],
      econ: [
        "ê²½ì œ í™œë™ì˜ ê¸°ë³¸ ì›ë¦¬",
        "ì‹œì¥ê³¼ ìˆ˜ìš”Â·ê³µê¸‰",
        "ê°€ê²©ì´ ê²°ì •ë˜ëŠ” ê³¼ì •",
        "ê¸ˆìœµê³¼ í™”íì˜ ì—­í• ",
        "êµ­ê°€ ê²½ì œì˜ ìˆœí™˜",
        "ë¬´ì—­ê³¼ ì„¸ê³„ ê²½ì œ",
        "ì†Œë¹„ìì™€ í•©ë¦¬ì  ì„ íƒ",
        "ê¸°ì—…ì˜ ì—­í• ê³¼ ê²½ì˜",
        "ê²½ì œ ë¬¸ì œì™€ ì •ì±…",
        "ë¯¸ë˜ ì‚°ì—…ê³¼ ê²½ì œ ë³€í™”"
      ],
      modern: [
        "í˜„ëŒ€ë¬¸í•™ì˜ íë¦„ ì½ê¸°",
        "ì‹œëŒ€ë¥¼ ë‹´ì€ í˜„ëŒ€ì‹œ",
        "í˜„ëŒ€ì†Œì„¤ì˜ ì¸ë¬¼ê³¼ ê°ˆë“±",
        "ì„œì •ê³¼ ì„œì‚¬ êµ¬ë¶„í•˜ê¸°",
        "í˜„ëŒ€ë¬¸í•™ì˜ ì£¼ì œ ì˜ì‹",
        "ì‘ê°€ì˜ ì‹œì„ ê³¼ í‘œí˜„ ê¸°ë²•",
        "ì‹œì–´ì™€ ì´ë¯¸ì§€ í•´ì„",
        "ì‹œëŒ€ ë°°ê²½ê³¼ ì‘í’ˆ ì´í•´",
        "í˜„ëŒ€ ìˆ˜í•„ì˜ ë§›",
        "ê°ìƒë¬¸ ì“°ê¸° ì‹¤ìŠµ"
      ],
      classic: [
        "ê³ ì „ë¬¸í•™ì˜ ì¥ë¥´ ì´í•´",
        "ê³ ì „ì‹œê°€ì˜ ì •ì„œ ì½ê¸°",
        "ê³ ì „ì†Œì„¤ì˜ êµ¬ì¡°ì™€ ì¸ë¬¼",
        "ì‹œëŒ€ìƒì„ ë°˜ì˜í•œ ì´ì•¼ê¸°",
        "ì „ê¸°ë¬¸ê³¼ ì„¤í™”ì˜ íŠ¹ì§•",
        "ìš°ë¦¬ë§ì˜ ì˜› í‘œí˜„ ìµíˆê¸°",
        "ì£¼ì œì™€ êµí›ˆ íŒŒì•…í•˜ê¸°",
        "êµ¬ë¹„ë¬¸í•™ê³¼ ê¸°ë¡ë¬¸í•™",
        "ê³ ì „ê³¼ í˜„ëŒ€ì˜ ì—°ê²°",
        "ê³ ì „ ê°ìƒë²• ì •ë¦¬"
      ],
      world: [
        "ì„¸ê³„ ì—¬ëŸ¬ ì§€ì—­ì˜ ë¬¸í•™",
        "ì„œì–‘ ê³ ì „ì˜ ì „ê°œ",
        "ë™ì–‘ ë¬¸í•™ì˜ ì •ì„œ",
        "ë¯¼ì¡±ë¬¸í•™ê³¼ ì •ì²´ì„±",
        "ì‹ í™”ì™€ ì „ì„¤ì˜ ë³€ì£¼",
        "í˜„ëŒ€ ì„¸ê³„ë¬¸í•™ì˜ íë¦„",
        "ì „ìŸê³¼ í‰í™”ë¥¼ ë…¸ë˜í•˜ë‹¤",
        "ì‚¬ë‘ê³¼ ì¸ê°„ ë‚´ë©´ì˜ í‘œí˜„",
        "ì‚¬íšŒ ë¹„íŒì  ì‹œê°ì˜ ë¬¸í•™",
        "ì—¬ì„±ê³¼ ë¬¸í•™ì˜ ëª©ì†Œë¦¬"
      ],
      people: [
        "ì—­ì‚¬ë¥¼ ë°”ê¾¼ ì¸ë¬¼ë“¤",
        "ì‚¬ìƒê°€ë“¤ì˜ ìƒê° ë”°ë¼ê°€ê¸°",
        "ê³¼í•™ ë°œì „ì— ê¸°ì—¬í•œ ì‚¬ëŒë“¤",
        "ë¬¸í™”ì˜ˆìˆ ì„ ë¹›ë‚¸ ì¸ë¬¼",
        "ë…ë¦½ê³¼ í‰í™”ë¥¼ ìœ„í•œ ì§€ë„ì",
        "êµìœ¡ê³¼ ë³µì§€ë¥¼ ì´ëˆ ì´ë“¤",
        "ì„¸ê³„ ë¬´ëŒ€ì˜ ë¦¬ë”ì‹­",
        "ë„ì „ê³¼ í˜ì‹ ì˜ ì‚¬ë¡€",
        "ì¸ë¬¼ë¹„êµë¡œ ë³´ëŠ” ì‹œëŒ€",
        "ì¸ë¬¼ ì´ì•¼ê¸°ë¡œ ì½ëŠ” ì—­ì‚¬"
      ],
      naesin: [
        "êµê³¼ ê°œë…ì„ ì •ë¦¬í•˜ë‹¤",
        "ì§€ë¬¸ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ë‹¤",
        "ë¬¸ë‹¨ ì „ê°œë¥¼ ì´í•´í•˜ë‹¤",
        "ì¤‘ìš” ì–´íœ˜ë¥¼ ìµíˆë‹¤",
        "ìë£Œì™€ í‘œë¥¼ í•´ì„í•˜ë‹¤",
        "ì¶œì œ í¬ì¸íŠ¸ë¥¼ ì •ë¦¬í•˜ë‹¤",
        "ì„œìˆ í˜• ë‹µì•ˆì„ ì—°ìŠµí•˜ë‹¤",
        "ë¹„íŒì  ì½ê¸°ë¡œ í™•ì¥í•˜ë‹¤",
        "ìœ í˜•ë³„ ë¬¸ì œì— ì ì‘í•˜ë‹¤",
        "í•™ìŠµí•œ ë‚´ìš©ì„ ë§ˆë¬´ë¦¬í•˜ë‹¤"
      ],
      suneung: [
        "ìˆ˜ëŠ¥ ì§€ë¬¸ì˜ ì „ê°œ ë°©ì‹",
        "ì‚¬ì„¤Â·í‰ë¡  ì§€ë¬¸ ë…í•´",
        "ì •ë³´ í™•ì¸ ë¬¸ì œ ê³µëµ",
        "ì¶”ë¡ í˜• ë¬¸ì œ ì ‘ê·¼ë²•",
        "ê°„ì ‘ ì—°ê³„ ì§€ë¬¸ ì—°ìŠµ",
        "ì‹œê°„ ê´€ë¦¬ ì „ëµ ì„¸ìš°ê¸°",
        "ë³´ê¸° ìë£Œì™€ í•¨ê»˜ ì½ê¸°",
        "ì˜¤ë‹µ ìœ í˜• ë¶„ì„í•˜ê¸°",
        "ìˆ˜ëŠ¥ ì–´íœ˜ ë³´ì¶©í•˜ê¸°",
        "ì‹¤ì „ì²˜ëŸ¼ í’€ì–´ë³´ê¸°"
      ],
      poem: [
        "ì‹œì  í™”ìì™€ ì •ì„œ íŒŒì•…",
        "ì´ë¯¸ì§€ì™€ ìƒì§• ì½ê¸°",
        "ë¦¬ë“¬ê³¼ ìš´ìœ¨ ëŠë¼ê¸°",
        "ë¹„ìœ ë²•ì˜ íš¨ê³¼ ì´í•´",
        "í˜„ëŒ€ì‹œì˜ ì£¼ì œ ì •ë¦¬",
        "í™”ìì˜ íƒœë„ ë³€í™” ë³´ê¸°",
        "ëŒ€ìƒê³¼ ì‹œì„ ì˜ ê±°ë¦¬",
        "ì œëª©ê³¼ ë‚´ìš©ì˜ ê´€ê³„",
        "ìœ í˜•ë³„ ë¬¸ì œ ì ‘ê·¼",
        "ê°ìƒë¬¸ìœ¼ë¡œ ì˜®ê²¨ë³´ê¸°"
      ],
      novel: [
        "ì¸ë¬¼ê³¼ ê°ˆë“± êµ¬ì¡°",
        "ì‹œì ê³¼ ì„œìˆ  ë°©ì‹",
        "ë°°ê²½ê³¼ ì£¼ì œì˜ ì—°ê²°",
        "ëŒ€í™”ì™€ í–‰ë™ì˜ ì˜ë¯¸",
        "í˜„ëŒ€ì†Œì„¤ì˜ í‘œí˜„ ê¸°ë²•",
        "ê²°ë§ì„ í†µí•œ ì£¼ì œ í™•ì¸",
        "ë°˜ì „ê³¼ ë³µì„  íŒŒì•…",
        "ì¸ë¬¼ì˜ ì‹¬ë¦¬ ì½ê¸°",
        "ìƒì§•ì  ì¥ë©´ í•´ì„",
        "ì„œì‚¬ êµ¬ì¡° ì •ë¦¬í•˜ê¸°"
      ],
      etc: [
        "ê·¹ì˜ êµ¬ì¡° ì´í•´í•˜ê¸°",
        "í¬ê³¡ ì¸ë¬¼ì˜ ëŒ€ì‚¬ ë¶„ì„",
        "ìˆ˜í•„ì˜ í™”ìì™€ íƒœë„",
        "í¬ê³¡ ë¬´ëŒ€ì§€ì‹œ ì½ê¸°",
        "ìˆ˜í•„ì˜ ì¤‘ì‹¬ ìƒê° ì°¾ê¸°",
        "ê·¹ì˜ ê°ˆë“±ê³¼ í•´ê²°",
        "í¬ê³¡ ì¥ë¥´ì˜ íŠ¹ì§•",
        "ì‚¶ì„ ë‹´ì€ ìˆ˜í•„ ì½ê¸°",
        "í‘œí˜„ìƒì˜ íŠ¹ì§• ì •ë¦¬",
        "ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì“°ê¸°"
      ],
      gosi: [
        "ì‹œì¡°ì˜ í˜•ì‹ê³¼ ì •ì„œ",
        "í–¥ê°€ì™€ ê³ ë ¤ê°€ìš”ì˜ ë¯¸",
        "ê³ ì „ì‹œê°€ì˜ í™”ì ì´í•´",
        "í‘œí˜„ë²•ê³¼ ë¶€ì‚¬ì–´ í•´ì„",
        "ì‹œëŒ€ë³„ ì‹œê°€ì˜ íŠ¹ì§•",
        "ìì—°ê³¼ ì¸ê°„ì˜ êµê°",
        "ì—°êµ°Â·ì—°êµ°ê°€ì˜ ì˜ë¯¸",
        "ì—¬ì„± í™”ìì˜ ëª©ì†Œë¦¬",
        "ìš´ìœ¨ê³¼ ì–´ì¡° íŒŒì•…",
        "í˜„ëŒ€ì–´ í’€ì´ ì—°ìŠµ"
      ],
      gonovel: [
        "ê³ ì „ì†Œì„¤ì˜ êµ¬ì¡°",
        "ì˜ì›…ì†Œì„¤ì˜ ì „ê°œ",
        "ì• ì •ì†Œì„¤ì˜ ê°ˆë“±",
        "ê°€ì •ì†Œì„¤ê³¼ êµí›ˆ",
        "ìš°í™”ì  í‘œí˜„ ì½ê¸°",
        "ì—¬ì„± ì¸ë¬¼ì˜ í˜•ìƒí™”",
        "ê¶Œì„ ì§•ì•… êµ¬ì¡° ì´í•´",
        "ì„œì‚¬ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ê¸°",
        "ê³ ì „ì†Œì„¤ì˜ ë°°ê²½",
        "í˜„ëŒ€ì  ì˜ë¯¸ë¡œ í™•ì¥"
      ],
      goessay: [
        "ê³ ì „ ìˆ˜í•„ì˜ ì–´ì¡°",
        "ìì—°ê³¼ ì€ì¼ì˜ ì •ì„œ",
        "ì¸ë¬¼ í‰ê°€ì™€ êµí›ˆ",
        "ì—­ì‚¬ì  ì¼í™” ì½ê¸°",
        "ìê¸° ì„±ì°°ì˜ ê¸€",
        "ê°„ê²°í•œ í‘œí˜„ì˜ ë¯¸",
        "ë¹„ìœ ì™€ í•œìì–´ í•´ì„",
        "ê¸€ì“´ì´ì˜ ì‚¶ê³¼ íƒœë„",
        "ë¬¸ì¥ ê³ ì³ ì“°ê¸°",
        "ê°ìƒ ì •ë¦¬í•˜ê¸°"
      ],
      modernGrammar: [
        "í˜„ëŒ€ êµ­ì–´ì˜ ìŒìš´",
        "í’ˆì‚¬ì™€ í˜•íƒœì†Œ ë¶„ì„",
        "ë‹¨ì–´ì˜ í˜•ì„± ë°©ì‹",
        "ë¬¸ì¥ì˜ ì„±ë¶„ ì´í•´",
        "ë¬¸ì¥ í˜¸ì‘ê³¼ ì–´ìˆœ",
        "ë†’ì„ë²•ê³¼ ê³µì† í‘œí˜„",
        "ì–´íœ˜ì˜ ì˜ë¯¸ ê´€ê³„",
        "í‘œì¤€ì–´ì™€ ë§ì¶¤ë²•",
        "ë„ì–´ì“°ê¸° ê·œì¹™",
        "ë‹´í™”ì™€ ë‹´í™” í‘œì§€"
      ],
      middleGrammar: [
        "ì¤‘ì„¸êµ­ì–´ì˜ ë¬¸ìì™€ ì†Œë¦¬",
        "í›ˆë¯¼ì •ìŒ ì°½ì œ ë°°ê²½",
        "ì¤‘ì„¸êµ­ì–´ì˜ ë¬¸ë²• ìš”ì†Œ",
        "ì˜›ë§ ì–´ë¯¸ì™€ ì„ ì–´ë§ì–´ë¯¸",
        "ì¤‘ì„¸êµ­ì–´ ì–´íœ˜ ì‚´í´ë³´ê¸°",
        "ì‹œëŒ€ë³„ ë¬¸í—Œ ì½ê¸°",
        "ì¤‘ì„¸êµ­ì–´ ë¬¸ì¥ ë¶„ì„",
        "í˜„ëŒ€êµ­ì–´ì™€ì˜ ì°¨ì´",
        "ì˜ë¯¸ ë³€ì²œ ì´í•´",
        "ê³ ì–´ í•´ì„ ì—°ìŠµ"
      ]
    };

    /* 3. ì „ì²´ ê³¼ëª© ì„ì‹œ ì œëª© ìë™ ìƒì„± */
    function buildUnitTitleOverrides() {
      const overrides = {};

      for (const [seriesKey, domains] of Object.entries(domainsBySeries)) {
        const realDomains = domains || domainsBySeries["BRAINON"];

        realDomains.forEach(domainObj => {
          domainObj.subs.forEach(subObj => {
            const key = `${seriesKey}.${domainObj.id}.${subObj.id}`;
            const count = subObj.count;

            const theme =
              titleThemes[subObj.id] ||
              titleThemes[subObj.label] ||
              ["ë‚´ìš©ì„ ì´í•´í•˜ê³  ì •ë¦¬í•˜ê¸°", "í•µì‹¬ì–´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì½ê¸°", "ë¬¸ë‹¨ ì „ê°œ íŒŒì•…í•˜ê¸°", "ìë£Œì™€ í•¨ê»˜ ìƒê°í•˜ê¸°"];

            const arr = [];
            for (let i = 1; i <= count; i++) {
              const picked = theme[(i - 1) % theme.length];
              arr.push(`${picked}`);
            }
            overrides[key] = arr;
          });
        });
      }

      // ì‹¤ì œ ì•Œê³  ìˆëŠ” ì œëª© ë®ì–´ì“°ê¸° (ì •ì¡°/ì‚¬íšŒ/ì§€ë¦¬)
      overrides["BRAINUP.social.geo"] = [
        "ì§€ë„ë¥¼ í†µí•´ ì„¸ìƒì„ ì´í•´í•˜ë‹¤",
        "ì§€ë„ì— ë‹´ê¸´ ì•½ì†ê³¼ í‘œí˜„",
        "ìš°ë¦¬ ê³ ì¥ì˜ ìƒì§•ê³¼ ìœ ë˜",
        "ê¸°í›„ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ìƒí™œ ëª¨ìŠµ",
        "ìì—°ê³¼ ì¸ê°„ì˜ ì¡°í™”ë¡œìš´ ê´€ê³„",
        "ì§€ë„ë¥¼ ë³´ê³  ê¸¸ì„ ì°¾ì•„ê°€ë‹¤",
        "ì„¸ê³„ ì—¬ëŸ¬ ë‚˜ë¼ì˜ ìœ„ì¹˜ì™€ íŠ¹ì§•",
        "ìš°ë¦¬ë‚˜ë¼ì˜ ì§€ë¦¬ì  íŠ¹ì„± ì´í•´í•˜ê¸°",
        "ìì—°ì¬í•´ì™€ ì¸ê°„ì˜ ëŒ€ì‘",
        "í™˜ê²½ ë¬¸ì œì™€ ì§€ì† ê°€ëŠ¥í•œ ë°œì „",
        "ë„ì‹œì™€ ë†ì´Œì˜ ì°¨ì´",
        "êµí†µê³¼ í†µì‹ ì˜ ë°œë‹¬",
        "ì„¸ê³„í™”ì™€ ì§€ì—­í™”ì˜ ê´€ê³„",
        "ì¸êµ¬ ë¶„í¬ì™€ ì´ë™",
        "ë¬¸í™”ê¶Œì˜ ë‹¤ì–‘ì„± ì´í•´í•˜ê¸°",
        "ì§€ë¦¬ ì •ë³´ ê¸°ìˆ ì˜ í™œìš©",
        "ì„¸ê³„ì˜ ì£¼ìš” ì‚°ì—…",
        "ì—ë„ˆì§€ ìì›ì˜ ì´ìš©",
        "ì§€êµ¬ì´Œì˜ í™˜ê²½ ë¬¸ì œ",
        "ë¯¸ë˜ì˜ ì§€êµ¬ë¥¼ ê·¸ë¦¬ë‹¤"
      ];

      return overrides;
    }

    const unitTitleOverrides = buildUnitTitleOverrides();

    /* 4. DOM ìºì‹± */
    const domainList = document.getElementById("domainList");
    const subjectList = document.getElementById("subjectList");
    const unitList = document.getElementById("unitList");
    const modal = document.getElementById("pendingModal");
    const closeModalBtn = document.getElementById("closeModalBtn");
    const unitSearch = document.getElementById("unitSearch");
    let currentUnits = [];

    

    // ğŸšª ë¡œê·¸ì•„ì›ƒ ëª¨ë‹¬ ê´€ë ¨
const logoutModal = document.getElementById("logoutModal");
const logoutCancelBtn = document.getElementById("logoutCancelBtn");
const logoutConfirmBtn = document.getElementById("logoutConfirmBtn");
let logoutCallback = null;


    function showPendingModal() {
      modal.classList.add("show");
    }

    function hidePendingModal() {
      modal.classList.remove("show");
    }

    closeModalBtn.addEventListener("click", hidePendingModal);

    modal.addEventListener("click", e => {
      if (e.target === modal) hidePendingModal();
    });

/* ğŸšª ë¡œê·¸ì•„ì›ƒ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° */
function showLogoutModal(cb) {
  logoutCallback = cb || null;
  if (logoutModal) logoutModal.classList.add("show");
}
function hideLogoutModal() {
  if (logoutModal) logoutModal.classList.remove("show");
}

if (logoutCancelBtn) {
  logoutCancelBtn.addEventListener("click", () => {
    hideLogoutModal();
    if (logoutCallback) logoutCallback(false);  // ì·¨ì†Œ
  });
}

if (logoutConfirmBtn) {
  logoutConfirmBtn.addEventListener("click", () => {
    hideLogoutModal();
    if (logoutCallback) logoutCallback(true);   // í™•ì¸
  });
}


    

    /* 5. ì‹œë¦¬ì¦ˆ í´ë¦­ */
    document.querySelectorAll("#seriesList .series-item").forEach(li => {
      li.addEventListener("click", () => {
        document.querySelectorAll("#seriesList .series-item").forEach(x => x.classList.remove("active"));
        li.classList.add("active");
        const series = li.dataset.series;
        renderDomains(series);
        subjectList.innerHTML = "";
        unitList.innerHTML = "";
        document.getElementById("unitTitle").textContent = "ë‹¨ì› ì„ íƒ";
        document.getElementById("unitDesc").textContent =
          seriesInfo[series].desc + " Â· ë¶„ì•¼ì™€ ê³¼ëª©ì„ ì„ íƒí•˜ì„¸ìš”.";
        unitSearch.value = "";
      });
    });

    /* 6. ë¶„ì•¼ í‘œì‹œ */
    function renderDomains(seriesKey) {
      domainList.innerHTML = "";
      const domainData = domainsBySeries[seriesKey] || domainsBySeries["BRAINON"];

      domainData.forEach(dom => {
        const li = document.createElement("li");
        li.className = "domain-item";
        li.dataset.domain = dom.id;
        li.innerHTML = `<span>${dom.label}</span><span class="meta">${dom.subs.length}ê³¼ëª©</span>`;
        li.addEventListener("click", () => {
          document.querySelectorAll(".domain-item").forEach(x => x.classList.remove("active"));
          li.classList.add("active");
          renderSubjects(seriesKey, dom);
          unitList.innerHTML = "";
          document.getElementById("unitTitle").textContent = dom.label;
          document.getElementById("unitDesc").textContent = "ì„¸ë¶€ ê³¼ëª©ì„ ì„ íƒí•˜ë©´ 01~ë²ˆí˜¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
          unitSearch.value = "";
        });
        domainList.appendChild(li);
      });
    }

    /* 7. ì„¸ë¶€ ê³¼ëª© í‘œì‹œ */
    function renderSubjects(seriesKey, domainObj) {
      subjectList.innerHTML = "";
      domainObj.subs.forEach(sub => {
        const li = document.createElement("li");
        li.className = "subject-item";
        li.dataset.sub = sub.id;
        li.innerHTML = `<span>${sub.label}</span><span class="meta">${sub.count}ê°œ</span>`;
        li.addEventListener("click", () => {
          document.querySelectorAll(".subject-item").forEach(x => x.classList.remove("active"));
          li.classList.add("active");
          renderUnits(seriesKey, domainObj, sub);
        });
        subjectList.appendChild(li);
      });
    }

    /* 8. ë‹¨ì› í‘œì‹œ */
    function renderUnits(seriesKey, domainObj, subObj) {
      unitList.innerHTML = "";
      document.getElementById("unitTitle").textContent =
        `${seriesInfo[seriesKey].name} / ${domainObj.label} / ${subObj.label}`;
      document.getElementById("unitDesc").textContent =
        `${subObj.label} ${subObj.count}ê°œ ë‹¨ì›ì…ë‹ˆë‹¤.`;

      unitSearch.value = "";
      currentUnits = [];

      const key = `${seriesKey}.${domainObj.id}.${subObj.id}`;
      const titles = unitTitleOverrides[key] || [];

      for (let i = 1; i <= subObj.count; i++) {
        const num = String(i).padStart(2, "0");
        const title = titles[i - 1] || `${subObj.label} ${num} í•™ìŠµí•˜ê¸°`;
        currentUnits.push({
          label: `${subObj.label} ${num} ${title}`.trim(),
          num,
          path: `./${seriesKey}/${domainObj.id}/${subObj.id}_${num}.html`
        });
      }

      renderUnitList(currentUnits);
    }

    /* 9. ë‹¨ì› ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ */
    function renderUnitList(units) {
      unitList.innerHTML = "";
      units.forEach(u => {
        const li = document.createElement("li");
        li.className = "unit-item";
        li.dataset.page = u.path;
        li.innerHTML = `
          <span>${u.label}</span>
          <span class="unit-right">
            <span class="badge">${u.num}</span>
            <span class="status-badge status-default">âœï¸ ë¯¸ì™„ë£Œ</span>
          </span>
        `;
        li.addEventListener("click", () => {
          // ë‹¨ì› íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
          fetch(u.path, { method: "HEAD" })
            .then(res => {
              if (res.ok) {
                openUnitModal(u.path);
              } else {
                showPendingModal();
              }
            })
            .catch(() => showPendingModal());
        });
        unitList.appendChild(li);
      });

      // ëª©ë¡ ê·¸ë¦´ ë•Œë§ˆë‹¤ ì €ì¥ëœ ì™„ë£Œ ìƒíƒœ ë‹¤ì‹œ ë°˜ì˜
      restoreProgressOnRenderedList();
    }

    /* 10. ê²€ìƒ‰ */
    unitSearch.addEventListener("input", (e) => {
      const q = e.target.value.trim();
      if (!q) {
        renderUnitList(currentUnits);
        return;
      }
      const filtered = currentUnits.filter(u =>
        u.label.includes(q) || u.num.includes(q)
      );
      renderUnitList(filtered);
    });

    // âœ… ìƒíƒœë¥¼ ë°”ê¾¸ëŠ” ê³µìš© í•¨ìˆ˜
    function updateLessonStatus(pageKey, status) {
      const li = document.querySelector(`.unit-item[data-page="${pageKey}"]`);
      if (!li) return;
      const badge = li.querySelector('.status-badge');
      if (!badge) return;

      badge.classList.remove('status-default', 'status-done');

      if (status === 'done') {
        badge.classList.add('status-done');
        badge.textContent = 'ğŸ† í•™ìŠµì™„ë£Œ';
      } else {
        badge.classList.add('status-default');
        badge.textContent = 'âœï¸ ë¯¸ì™„ë£Œ';
      }
    }

    /* ğŸ” í•™ìƒ ì •ë³´ ê°€ì ¸ì˜¤ê¸° */
    function getCurrentStudent() {
      const saved = localStorage.getItem('currentStudent');
      if (!saved) return null;
      try { return JSON.parse(saved); }
      catch(e) { return null; }
    }

    /* ğŸ” í•™ìƒí‚¤ ë§Œë“¤ê¸° (ë¡œê·¸ì¸ í˜ì´ì§€ë‘ ê°™ì€ ê·œì¹™) */
    function buildStudentKey(stu) {
      const cleanPhone = (stu.phone || '').replace(/\D/g, '');
      const cleanName = (stu.name || '').trim();
      const cleanGrade = (stu.grade || '').trim();
      return `${cleanGrade}_${cleanName}_${cleanPhone}`;
    }

    /* âœ… í˜„ì¬ ë¡œê·¸ì¸í•œ í•™ìƒì˜ ì™„ë£Œ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° */
    function getStudentProgressList() {
      const stu = getCurrentStudent();
      if (!stu) return [];  // ë¡œê·¸ì¸ ì•ˆ ë˜ì–´ ìˆìœ¼ë©´ ë¹ˆë°°ì—´
      const stuKey = buildStudentKey(stu);
      const progressKey = `dan-progress:${stuKey}`;
      return JSON.parse(localStorage.getItem(progressKey) || '[]');
    }

    // ğŸ”„ ì„œë²„ì—ì„œ ìµœì‹  ì™„ë£Œ ìƒíƒœ ê°€ì ¸ì™€ì„œ localStorageì— ì €ì¥
    async function syncCompletionStatusFromServer() {
      try {
        const stu = getCurrentStudent();
        if (!stu) return;

        const params = new URLSearchParams({
          grade: stu.grade || '',
          name: stu.name || '',
          series: 'BRAINì—…'
        });

        const res = await fetch(`/api/completion-status?${params}`, {
          method: 'GET',
          headers: { 'Content-Type': 'application/json' }
        });

        if (!res.ok) {
          console.warn('[syncCompletionStatus] ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜:', res.status);
          return;
        }

        const data = await res.json();
        console.log('[syncCompletionStatus] ì„œë²„ ì‘ë‹µ:', data);

        if (data.ok && Array.isArray(data.completedUnits)) {
          const stuKey = buildStudentKey(stu);
          const keyPrefix = `dan-progress:${stuKey}:`;

          data.completedUnits.forEach(unit => {
            const key = keyPrefix + unit;
            localStorage.setItem(key, '1');
            console.log('[syncCompletionStatus] ì €ì¥:', key);
          });

          console.log('[syncCompletionStatus] ì™„ë£Œ ìƒíƒœ ë™ê¸°í™” ì™„ë£Œ:', data.completedUnits);
        }
      } catch (e) {
        console.warn('[syncCompletionStatus] ì˜¤ë¥˜', e);
      }
    }

    // âœ… localStorageì— ì €ì¥í•´ë‘” ì™„ë£Œëœ ë‹¨ì›ë“¤ì„ ë©”ë‰´ì— ë°˜ì˜ (í•™ìƒë³„)
    function restoreProgressOnRenderedList() {
      const stu = getCurrentStudent();
      if (!stu) return;

      // 1ï¸âƒ£ ê¸°ì¡´ ë°©ì‹: ë°°ì—´ë¡œ ì €ì¥ëœ ì™„ë£Œ ëª©ë¡ (í•˜ìœ„ í˜¸í™˜)
      const saved = getStudentProgressList(); // ["./BRAINUP/social/geo_01.html", ...]
      saved.forEach(pageKey => {
        updateLessonStatus(pageKey, 'done');
      });

      // 2ï¸âƒ£ ìƒˆ ë°©ì‹: ê°œë³„ í‚¤ë¡œ ì €ì¥ëœ ì™„ë£Œ ìƒíƒœ (dan-progress:í•™ìƒí‚¤:geo_01 = "1")
      const stuKey = buildStudentKey(stu);
      const keyPrefix = `dan-progress:${stuKey}:`;

      // í˜„ì¬ í™”ë©´ì— í‘œì‹œëœ ëª¨ë“  ë‹¨ì› li ìˆœíšŒ
      document.querySelectorAll('.unit-item').forEach(li => {
        const pageKey = li.dataset.page; // "./BRAINUP/social/geo_01.html"
        if (!pageKey) return;

        // ê²½ë¡œì—ì„œ ë‹¨ì› ì½”ë“œ ì¶”ì¶œ (geo_01, geo_02 ë“±)
        const match = pageKey.match(/\/([^\/]+)\.html$/);
        if (!match) return;
        const unitCode = match[1]; // "geo_01"

        // localStorageì—ì„œ ì™„ë£Œ ìƒíƒœ í™•ì¸
        const storageKey = keyPrefix + unitCode;
        const isDone = localStorage.getItem(storageKey) === '1';

        if (isDone) {
          updateLessonStatus(pageKey, 'done');
        }
      });
    }

    /* ğŸ”‹ ë¡œë”© ì˜¤ë²„ë ˆì´ ì œì–´ (ë‹¨ì› ì´ë™ìš©) */
    function hideLoadingScreen() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      loadingOverlay.classList.remove('show');
    }

    function showLoadingScreen(targetUrl) {
      const overlay = document.getElementById('loadingOverlay');
      const bar = document.getElementById('loadingBar');
      const percent = document.getElementById('loadingPercent');
      const emoji = document.querySelector('.loading-emoji');
      const title = document.querySelector('.loading-title');
      const msg = document.querySelector('.loading-msg');

      if (!overlay || !bar || !percent) {
        window.location.href = targetUrl;
        return;
      }

      overlay.classList.add('show');
      // ê¸°ë³¸ ëª¨ë“œëŠ” í•™ìŠµ ë¡œë”© ìŠ¤íƒ€ì¼ ìœ ì§€
      if (emoji) emoji.textContent = 'ğŸ‹';
      if (title) title.textContent = 'ë¡œë”© ì¤‘...';
      if (msg) msg.textContent = 'í•™ìŠµ ìë£Œë¥¼ ì¤€ë¹„í•˜ê³  ìˆì–´ìš”.';

      bar.style.width = '0%';
      percent.textContent = '0%';

      let p = 0;
      const timer = setInterval(() => {
        p += 5;
        if (p > 100) p = 100;
        bar.style.width = p + '%';
        percent.textContent = p + '%';

        if (p === 100) {
          clearInterval(timer);
          setTimeout(() => {
            window.location.href = targetUrl;
          }, 500);
        }
      }, 80);
    }

    window.onbeforeunload = () => {
      hideLoadingScreen();
    };

    // ğŸ”» ìƒë‹¨ ì‚¬ìš©ì í‘œì‹œ: localStorageê°€ ìš°ì„ , ì—†ìœ¼ë©´ URL íŒŒë¼ë¯¸í„°
    function showUserInfo() {
      const infoTarget = document.getElementById("user-info");
      if (!infoTarget) return;

      const stu = getCurrentStudent();
      if (stu) {
        infoTarget.textContent = `${stu.grade || ''} ${stu.name || ''}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`.trim();
      } else {
        infoTarget.textContent = "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.";
      }
    }

        // ì‹¤ì œë¡œ ë¡œê·¸ì•„ì›ƒ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ (ë²„íŠ¼/ë’¤ë¡œê°€ê¸°ì—ì„œ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©)
    async function performLogout() {
      const btn = document.getElementById('logoutBtn');
      const overlay = document.getElementById('loadingOverlay');
      const bar = document.getElementById('loadingBar');
      const percent = document.getElementById('loadingPercent');
      const emoji = document.querySelector('.loading-emoji');
      const title = document.querySelector('.loading-title');
      const msg = document.querySelector('.loading-msg');

      // ğŸ”„ ë¡œë”© ì˜¤ë²„ë ˆì´ë¥¼ "ë¡œê·¸ì•„ì›ƒ ëª¨ë“œ"ë¡œ ì‚¬ìš©
      if (overlay && bar && percent) {
        overlay.classList.add('show');
        if (emoji) emoji.textContent = 'ğŸšª';
        if (title) title.textContent = 'ë¡œê·¸ì•„ì›ƒ ì¤‘...';
        if (msg) msg.textContent = 'ì ì‹œ í›„ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.';

        bar.style.width = '0%';
        percent.textContent = '0%';
      }

      if (btn) btn.disabled = true;

      let progressTimer = null;
      if (bar && percent) {
        progressTimer = setInterval(() => {
          let current = parseInt(percent.textContent) || 0;
          if (current < 95) {
            current += 5;
            bar.style.width = current + '%';
            percent.textContent = current + '%';
          }
        }, 80);
      }

      try {
        // í˜„ì¬ í•™ìƒ ì •ë³´ ì œê±°
        localStorage.removeItem('currentStudent');

        await fetch("/logout", {
          method: "POST",
          headers: { "Content-Type": "application/json" }
        });
      } catch (e) {
        console.error("logout error", e);
      } finally {
        if (bar && percent) {
          bar.style.width = '100%';
          percent.textContent = '100%';
        }
        if (progressTimer) clearInterval(progressTimer);

        setTimeout(() => {
          window.location.href = "/";
        }, 400);
      }
    }


    // âœ… í˜ì´ì§€ ë¡œë“œ ì‹œ: ìœ ì €ì •ë³´ ë°˜ì˜ + ë’¤ë¡œê°€ê¸°ìš© íˆìŠ¤í† ë¦¬ 1ë‹¨ê³„ ìŒ“ê¸°
    document.addEventListener('DOMContentLoaded', () => {
      showUserInfo();

      // í˜„ì¬ ë©”ë‰´ í˜ì´ì§€ë¥¼ í•œ ë²ˆ ë” pushí•´ì„œ,
      // ì²« ë²ˆì§¸ ë’¤ë¡œê°€ê¸°ëŠ” popstateë§Œ ë°œìƒí•˜ê³  í™”ë©´ì€ ê·¸ëŒ€ë¡œ ìˆê²Œ ë§Œë“¤ê¸°
      if (window.history && window.history.pushState) {
        history.pushState({ page: 'menu' }, '', location.href);
      }
    });

    // âœ… ì‹¤ì œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ê³µìš© í•¨ìˆ˜ (í—¤ë” ë²„íŠ¼/ë’¤ë¡œê°€ê¸° ê³µìš© ì‚¬ìš©)
    async function doLogoutWithAnimation() {
      const overlay = document.getElementById('loadingOverlay');
      const bar = document.getElementById('loadingBar');
      const percent = document.getElementById('loadingPercent');
      const emoji = document.querySelector('.loading-emoji');
      const title = document.querySelector('.loading-title');
      const msg = document.querySelector('.loading-msg');

      // ğŸ”„ ë¡œë”© ì˜¤ë²„ë ˆì´ë¥¼ "ë¡œê·¸ì•„ì›ƒ ëª¨ë“œ"ë¡œ ì‚¬ìš©
      if (overlay && bar && percent) {
        overlay.classList.add('show');
        if (emoji) emoji.textContent = 'ğŸšª';
        if (title) title.textContent = 'ë¡œê·¸ì•„ì›ƒ ì¤‘...';
        if (msg) msg.textContent = 'ì ì‹œ í›„ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.';

        bar.style.width = '0%';
        percent.textContent = '0%';
      }

      let progressTimer = null;
      if (bar && percent) {
        progressTimer = setInterval(() => {
          let current = parseInt(percent.textContent) || 0;
          if (current < 95) {
            current += 5;
            bar.style.width = current + '%';
            percent.textContent = current + '%';
          }
        }, 80);
      }

      try {
        // í˜„ì¬ í•™ìƒ ì •ë³´ ì œê±°
        localStorage.removeItem('currentStudent');

        await fetch("/logout", {
          method: "POST",
          headers: { "Content-Type": "application/json" }
        });
      } catch (e) {
        console.error("logout error", e);
      } finally {
        if (bar && percent) {
          bar.style.width = '100%';
          percent.textContent = '100%';
        }
        if (progressTimer) clearInterval(progressTimer);

        setTimeout(() => {
          window.location.href = "/";
        }, 400);
      }
    }

async function performLogout() {
  const btn = document.getElementById('logoutBtn');
  const overlay = document.getElementById('loadingOverlay');
  const bar = document.getElementById('loadingBar');
  const percent = document.getElementById('loadingPercent');
  const emoji = document.querySelector('.loading-emoji');
  const title = document.querySelector('.loading-title');
  const msg = document.querySelector('.loading-msg');

  if (overlay && bar && percent) {
    overlay.classList.add('show');
    if (emoji) emoji.textContent = 'ğŸšª';
    if (title) title.textContent = 'ë¡œê·¸ì•„ì›ƒ ì¤‘...';
    if (msg) msg.textContent = 'ì ì‹œ í›„ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.';

    bar.style.width = '0%';
    percent.textContent = '0%';
  }

  if (btn) btn.disabled = true;

  let progressTimer = null;
  if (bar && percent) {
    progressTimer = setInterval(() => {
      let current = parseInt(percent.textContent) || 0;
      if (current < 95) {
        current += 5;
        bar.style.width = current + '%';
        percent.textContent = current + '%';
      }
    }, 80);
  }

  try {
    localStorage.removeItem('currentStudent');

    await fetch("/logout", {
      method: "POST",
      headers: { "Content-Type": "application/json" }
    });
  } catch (e) {
    console.error("logout error", e);
  } finally {
    if (bar && percent) {
      bar.style.width = '100%';
      percent.textContent = '100%';
    }
    if (progressTimer) clearInterval(progressTimer);

    setTimeout(() => {
      window.location.href = "/";
    }, 400);
  }
}


    // âœ… ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë™ì‘ (ì»¤ìŠ¤í…€ ëª¨ë‹¬ ì‚¬ìš©)
    (function setupLogout() {
      const btn = document.getElementById('logoutBtn');
      const modal = document.getElementById('logoutConfirm');
      const cancelBtn = document.getElementById('logoutCancelBtn');
      const okBtn = document.getElementById('logoutOkBtn');

      if (!btn || !modal || !cancelBtn || !okBtn) return;

      // 1) ë©”ë‰´ ìƒë‹¨ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ê¸°
      btn.addEventListener('click', () => {
        modal.classList.add('show');
      });

      // 2) ì·¨ì†Œ ë²„íŠ¼ â†’ ëª¨ë‹¬ ë‹«ê¸°
      cancelBtn.addEventListener('click', () => {
        modal.classList.remove('show');
      });

      // 3) ë°”ê¹¥ ê²€ì€ ì˜ì—­ í´ë¦­ â†’ ëª¨ë‹¬ ë‹«ê¸°
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('show');
        }
      });

      // 4) í™•ì¸(ë¡œê·¸ì•„ì›ƒ) ë²„íŠ¼ â†’ ì‹¤ì œ ë¡œê·¸ì•„ì›ƒ ì‹¤í–‰
      okBtn.addEventListener('click', async () => {
        modal.classList.remove('show');
        btn.disabled = true;     // ì¤‘ë³µ í´ë¦­ ë°©ì§€
        await doLogoutWithAnimation();
      });
    })();

    // ğŸ”™ ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ì¸í„°ì…‰íŠ¸
    window.addEventListener('popstate', (event) => {
      // menu.html ì—ì„œë§Œ ë™ì‘ (í˜¹ì‹œ ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ ì„ì´ì§€ ì•Šê²Œ)
      if (!location.pathname.includes('menu')) return;

      const ok = confirm('ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');

      if (ok) {
        // ë’¤ë¡œê°€ê¸°ì—ì„œ í™•ì¸ ëˆ„ë¥´ë©´ ë°”ë¡œ ë¡œê·¸ì•„ì›ƒ ì‹¤í–‰
        doLogoutWithAnimation();
      } else {
        // ì·¨ì†Œí•˜ë©´ ë‹¤ì‹œ íˆìŠ¤í† ë¦¬ ìŒ“ì•„ì„œ í™”ë©´ ìœ ì§€
        if (window.history && window.history.pushState) {
          history.pushState({ page: 'menu' }, '', location.href);
        }
      }
    });

    // ì‹œì‘ì€ ì„¸ì¢… ì‹œë¦¬ì¦ˆ
    renderDomains("BRAINON");

    // ===== ì‹œë¦¬ì¦ˆ í™œì„±í™”/ë¹„í™œì„±í™” ì²˜ë¦¬ =====
    function applySeriesRestrictions() {
      try {
        const user = JSON.parse(sessionStorage.getItem('user') || '{}');
        const assignedSeries = user.assignedSeries || [];

        console.log('ğŸ”’ Applying series restrictions:', assignedSeries);

        // ì‹œë¦¬ì¦ˆ ì´ë¦„ ë§¤í•‘ (ëª¨ë‹¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë¦„ -> HTML data-series ê°’)
        const seriesMapping = {
          'BRAINì€': 'BRAINON',
          'BRAINì•”': 'BRAINUP',
          'BRAINë¹›': 'BRAINFIT',
          'BRAINë‹µ': 'BRAINDEEP',
          'BRAINì¤‘ë“±': 'BRAINM',
          'BRAINê³ ë“±': 'BRAINH',
          // ì—­ë°©í–¥ ë§¤í•‘ë„ ì¶”ê°€ (ì´ë¯¸ ì˜ë¬¸ IDì¸ ê²½ìš° ëŒ€ì‘)
          'BRAINON': 'BRAINON',
          'BRAINUP': 'BRAINUP',
          'BRAINFIT': 'BRAINFIT',
          'BRAINDEEP': 'BRAINDEEP',
          'BRAINM': 'BRAINM',
          'BRAINH': 'BRAINH'
        };

        // assignedSeriesë¥¼ data-series í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        const allowedSeriesIds = assignedSeries.map(name => seriesMapping[name]).filter(Boolean);

        console.log('âœ… Allowed series IDs:', allowedSeriesIds);

        // ëª¨ë“  ì‹œë¦¬ì¦ˆ ì•„ì´í…œ í™•ì¸
        document.querySelectorAll("#seriesList .series-item").forEach(li => {
          const seriesId = li.dataset.series;

          if (allowedSeriesIds.includes(seriesId)) {
            // í™œì„±í™”
            li.classList.remove("disabled");
          } else {
            // ë¹„í™œì„±í™”
            li.classList.add("disabled");
          }
        });
      } catch (err) {
        console.error('âŒ Error applying series restrictions:', err);
      }
    }

    // ì‹œë¦¬ì¦ˆ ì œí•œ ì ìš©
    applySeriesRestrictions();

    // í˜ì´ì§€ ì²˜ìŒ ì—´ë¦´ ë•Œë„ ì´ë¯¸ ì €ì¥ë¼ ìˆë˜ ì™„ë£Œ ë‚´ì—­ ìˆìœ¼ë©´ ë°˜ì˜
    restoreProgressOnRenderedList();

    window.addEventListener("pageshow", async function (event) {
      // ë’¤ë¡œê°€ê¸° ìºì‹œì—ì„œ ëŒì•„ì˜¬ ë•Œ ë¡œë”© ê°€ë¦¬ê¸°
      document.getElementById("loadingOverlay")?.classList.remove("show");

      const stu = getCurrentStudent();

      // ğŸ” ë¡œê·¸ì•„ì›ƒ í›„ ë’¤ë¡œê°€ê¸° í•˜ë©´ ë¬´ì¡°ê±´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ëŒë ¤ë³´ë‚´ê¸°
      if (!stu) {
        window.location.href = "/";
        return;
      }

      // ğŸ”„ ì„œë²„ì—ì„œ ìµœì‹  ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì‹œë¦¬ì¦ˆ ë¶€ì—¬ ì—…ë°ì´íŠ¸ ë°˜ì˜)
      if (stu && stu.grade && stu.name) {
        try {
          const res = await fetch(`/api/user-info?grade=${encodeURIComponent(stu.grade)}&name=${encodeURIComponent(stu.name)}`);
          if (res.ok) {
            const userData = await res.json();
            if (userData) {
              // sessionStorage ì—…ë°ì´íŠ¸
              sessionStorage.setItem('user', JSON.stringify(userData));
              console.log('âœ… User info updated from server:', userData);

              // ì‹œë¦¬ì¦ˆ ì œí•œ ë‹¤ì‹œ ì ìš©
              applySeriesRestrictions();
            }
          }
        } catch (err) {
          console.error('Failed to fetch updated user info:', err);
        }
      }

      // í•™ìƒ ì •ë³´ê°€ ìˆìœ¼ë©´ í—¤ë” ë¬¸êµ¬ ë‹¤ì‹œ ê°±ì‹ 
      showUserInfo();

      // ğŸ”„ ì„œë²„ì—ì„œ ìµœì‹  ì™„ë£Œ ìƒíƒœ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸° (ìƒˆë¡œ ì™„ë£Œëœ ë‹¨ì› ë°˜ì˜)
      await syncCompletionStatusFromServer();
      restoreProgressOnRenderedList();
    });

    // === ë‹¨ì› í•™ìŠµ ëª¨ë‹¬ ê´€ë ¨ ===
    function openUnitModal(unitPath) {
      const unitModal = document.getElementById('unitModal');
      const unitIframe = document.getElementById('unitIframe');

      if (unitModal && unitIframe) {
        unitIframe.src = unitPath;
        unitModal.classList.add('show');
        // sessionStorageì— í˜„ì¬ ì—´ë¦° ë‹¨ì› ê²½ë¡œ ì €ì¥
        sessionStorage.setItem('currentOpenUnit', unitPath);
      }
    }

    function closeUnitModal() {
      const unitModal = document.getElementById('unitModal');
      const unitIframe = document.getElementById('unitIframe');

      if (unitModal) {
        unitModal.classList.remove('show');
        if (unitIframe) {
          unitIframe.src = ''; // iframe ì´ˆê¸°í™”
        }
        // sessionStorageì—ì„œ í˜„ì¬ ì—´ë¦° ë‹¨ì› ê²½ë¡œ ì œê±°
        sessionStorage.removeItem('currentOpenUnit');
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ì „ì— ì—´ë ¤ìˆë˜ ëª¨ë‹¬ ë³µì›
    function restoreUnitModal() {
      const savedUnitPath = sessionStorage.getItem('currentOpenUnit');
      if (savedUnitPath) {
        openUnitModal(savedUnitPath);
      }
    }

    // ë‹¨ì› ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    window.addEventListener('DOMContentLoaded', function() {
      const closeUnitBtn = document.getElementById('closeUnitModal');
      const unitModal = document.getElementById('unitModal');

      if (closeUnitBtn) {
        closeUnitBtn.addEventListener('click', closeUnitModal);
      }

      // ë°°ê²½ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
      if (unitModal) {
        unitModal.addEventListener('click', function(e) {
          if (e.target === unitModal) {
            closeUnitModal();
          }
        });
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ì „ì— ì—´ë ¤ìˆë˜ ëª¨ë‹¬ ë³µì›
      restoreUnitModal();
    });

    // === AI ì±—ë´‡ í”Œë¡œíŒ… ë²„íŠ¼ ===
    window.addEventListener('DOMContentLoaded', function() {
      const aiChatbotBtn = document.getElementById('aiChatbotBtn');
      const aiChatbotModal = document.getElementById('aiChatbotModal');
      const aiChatbotIframe = document.getElementById('aiChatbotIframe');
      const closeAiChatbotBtn = document.getElementById('closeAiChatbotModal');

      if (aiChatbotBtn && aiChatbotModal && aiChatbotIframe) {
        // í”Œë¡œíŒ… ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° í† ê¸€
        aiChatbotBtn.addEventListener('click', function() {
          if (aiChatbotModal.classList.contains('show')) {
            aiChatbotModal.classList.remove('show');
            aiChatbotIframe.src = ''; // iframe ì´ˆê¸°í™”
          } else {
            aiChatbotIframe.src = '/demo-ai-korean-chatbot.html';
            aiChatbotModal.classList.add('show');
          }
        });

        // ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
        if (closeAiChatbotBtn) {
          closeAiChatbotBtn.addEventListener('click', function() {
            aiChatbotModal.classList.remove('show');
            aiChatbotIframe.src = ''; // iframe ì´ˆê¸°í™”
          });
        }
      }
    });

    // === ë ˆì´ë” ì°¨íŠ¸ ì•„ì´ì½˜ í´ë¦­ ì´ë²¤íŠ¸ (ëª¨ë‹¬ë¡œ í‘œì‹œ) ===
    window.addEventListener('DOMContentLoaded', function() {
      const radarIcon = document.getElementById('radarChartIcon');
      const learningModal = document.getElementById('learningModal');
      const learningIframe = document.getElementById('learningIframe');
      const closeModalBtn = document.getElementById('closeLearningModal');

      if (radarIcon && learningModal && learningIframe) {
        // ì•„ì´ì½˜ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
        radarIcon.addEventListener('click', function() {
          const user = JSON.parse(sessionStorage.getItem('user') || '{}');
          console.log('ğŸ” sessionStorage user:', user);
          const grade = user.grade || 'í•™ë…„ë¯¸ì§€ì •';
          const name = user.name || 'ì´ë¦„ë¯¸ì§€ì •';
          console.log('ğŸ“Š Opening learning page:', { grade, name });

          const url = `/my-learning?grade=${encodeURIComponent(grade)}&name=${encodeURIComponent(name)}`;
          console.log('ğŸ”— URL:', url);

          // iframeì— URL ì„¤ì •í•˜ê³  ëª¨ë‹¬ ì—´ê¸°
          learningIframe.src = url;
          learningModal.classList.add('show');
        });

        // ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
        if (closeModalBtn) {
          closeModalBtn.addEventListener('click', function() {
            learningModal.classList.remove('show');
            learningIframe.src = ''; // iframe ì´ˆê¸°í™”
          });
        }

        // ë°°ê²½ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
        learningModal.addEventListener('click', function(e) {
          if (e.target === learningModal) {
            learningModal.classList.remove('show');
            learningIframe.src = ''; // iframe ì´ˆê¸°í™”
          }
        });
      }
    });
  </script>

  <!-- ë ˆì´ë” ì°¨íŠ¸ ì•„ì´ì½˜ -->
  <div class="radar-chart-icon" id="radarChartIcon" title="ë‚˜ì˜ í•™ìŠµ ë¶„ì„ ë³´ê¸°">
    <img src="/images/total-radar-chart.png" alt="í•™ìŠµ ë¶„ì„ ë ˆì´ë” ì°¨íŠ¸">
  </div>

  <!-- í•™ìŠµ ë¶„ì„ ëª¨ë‹¬ -->
  <div class="learning-modal" id="learningModal">
    <div class="learning-modal-content">
      <div class="learning-modal-header">
        <div class="learning-modal-title">ë‚˜ì˜ í•™ìŠµ ë¶„ì„</div>
        <button class="learning-modal-close" id="closeLearningModal">&times;</button>
      </div>
      <iframe class="learning-modal-iframe" id="learningIframe"></iframe>
    </div>
  </div>

  <!-- ë‹¨ì› í•™ìŠµ ëª¨ë‹¬ -->
  <div class="unit-modal" id="unitModal">
    <div class="unit-modal-content">
      <div class="unit-modal-header">
        <button class="unit-modal-close" id="closeUnitModal">&times;</button>
      </div>
      <iframe class="unit-modal-iframe" id="unitIframe"></iframe>
    </div>
  </div>

  <!-- AI ì±—ë´‡ í”Œë¡œíŒ… ë²„íŠ¼ -->
  <div class="ai-chatbot-floating-btn" id="aiChatbotBtn">
    <img src="/images/whale-ai-teacher.png" alt="AI êµ­ì–´ ì±—ë´‡">
  </div>

  <!-- AI ì±—ë´‡ ëª¨ë‹¬ -->
  <div class="ai-chatbot-modal" id="aiChatbotModal">
    <div class="ai-chatbot-modal-content">
      <div class="ai-chatbot-modal-header">
        <button class="ai-chatbot-modal-close" id="closeAiChatbotModal">&times;</button>
      </div>
      <iframe class="ai-chatbot-modal-iframe" id="aiChatbotIframe"></iframe>
    </div>
  </div>

</body>
</html>
