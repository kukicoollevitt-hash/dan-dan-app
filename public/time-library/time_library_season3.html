<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>⏰ 시간도서관 — 시즌 3</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Gmarket Sans", "Noto Sans KR", sans-serif;
      overflow-x: hidden;
      background: #1a1a1a;
    }

    /* 고정 지도 캔버스 */
    #map-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: url(https://cdn.jsdelivr.net/gh/kukicoollevitt-hash/dan-dan-app@main/public/images/time-library-story/time_part3_main.jpg);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transition: background-image 1s ease-in-out;
      z-index: 1;
    }

    #map-canvas {
      display: none;
    }

    /* 스크롤 가능한 콘텐츠 */
    #content {
      position: relative;
      z-index: 2;
      pointer-events: none;
    }

    .story-section {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 60px 120px;
      pointer-events: none;
    }

    /* 홀수 섹션은 왼쪽 */
    .story-section:nth-child(odd) {
      justify-content: flex-start;
    }

    /* 짝수 섹션은 오른쪽 */
    .story-section:nth-child(even) {
      justify-content: flex-end;
    }

    .story-card {
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(15px);
      padding: 40px;
      border-radius: 24px;
      max-width: 550px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: translateX(100px);
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
      pointer-events: auto;
    }

    /* 왼쪽에서 나오는 카드 */
    .story-section:nth-child(odd) .story-card {
      transform: translateX(-100px);
    }

    /* 오른쪽에서 나오는 카드 */
    .story-section:nth-child(even) .story-card {
      transform: translateX(100px);
    }

    .story-card.active {
      transform: translateX(0);
      opacity: 1;
    }

    .story-card .chapter {
      display: inline-block;
      padding: 8px 20px;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      color: white;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 15px;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    .story-card h2 {
      font-size: 28px;
      color: #2c3e50;
      margin-bottom: 20px;
      line-height: 1.4;
    }

    .story-card p {
      font-size: 16px;
      line-height: 1.8;
      color: #34495e;
      margin-bottom: 12px;
    }

    .story-card p:last-child {
      margin-bottom: 0;
    }

    /* 인트로 섹션 */
    .intro-section {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 60px;
    }

    .intro-content {
      background: transparent;
      padding: 60px 80px;
      border-radius: 30px;
      max-width: 800px;
      animation: fadeInUp 1s ease-out;
    }

    .intro-content h1 {
      font-size: 48px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 20px;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.8);
    }

    .intro-content .subtitle {
      font-size: 20px;
      line-height: 1.8;
      color: #ffffff;
      margin-bottom: 40px;
      font-weight: 500;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    }

    .intro-content .scroll-hint {
      font-size: 16px;
      color: #ffffff;
      font-weight: 600;
      animation: pulse 2s infinite;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    /* 스크롤 인디케이터 */
    .scroll-indicator {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      animation: bounce 2s infinite;
      pointer-events: none;
    }

    .scroll-indicator svg {
      width: 40px;
      height: 40px;
      opacity: 0.7;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateX(-50%) translateY(0);
      }
      40% {
        transform: translateX(-50%) translateY(-20px);
      }
      60% {
        transform: translateX(-50%) translateY(-10px);
      }
    }

    /* 반응형 디자인 */
    @media (max-width: 768px) {
      .story-section {
        padding: 40px 20px;
      }

      .story-card {
        max-width: 100%;
        padding: 30px;
      }

      .story-card h2 {
        font-size: 24px;
      }

      .story-card p {
        font-size: 15px;
      }
    }

    /* 네비게이션 버튼 */
    .nav-buttons {
      position: fixed;
      bottom: 40px;
      right: 40px;
      z-index: 1000;
      display: flex;
      gap: 15px;
      pointer-events: auto;
    }

    .nav-btn {
      padding: 15px 30px;
      background: rgba(255, 107, 53, 0.9);
      backdrop-filter: blur(10px);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    .nav-btn:hover {
      background: rgba(247, 147, 30, 0.9);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
    }

    @media (max-width: 768px) {
      .nav-buttons {
        bottom: 20px;
        right: 20px;
        flex-direction: column;
      }

      .nav-btn {
        padding: 12px 24px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <!-- 고정된 배경 컨테이너 -->
  <div id="map-container">
    <canvas id="map-canvas"></canvas>
  </div>

  <!-- 스크롤 가능한 스토리 콘텐츠 -->
  <div id="content">
    <!-- 인트로 -->
    <section class="intro-section">
      <div class="intro-content">
        <h1>⏰ 시간도서관</h1>
        <p class="subtitle">
          시즌 3 - 미래의 심장<br>
          시간을 지키는 마지막 아이들
        </p>
        <p class="scroll-hint">↓ 아래로 스크롤 해주세요 ↓</p>
      </div>
    </section>

    <!-- Part 1 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_01.jpg">
      <div class="story-card">
        <span class="chapter">Part 1</span>
        <h2>미래 도착, 낯선 시간의 도시</h2>
        <p>아이들이 시간 관문을 통과하자, 눈앞에는 완전히 다른 세계가 펼쳐졌다.</p>
        <p>하늘 위에는 투명한 도로가 나 있고, 그 위로 빛으로 된 책들이 천천히 떠다니고 있었다. 건물들은 벽돌 대신 '시간의 조각'이 쌓여 만들어진 형태였고, 바람이 스칠 때마다 공기 중에 수천 개의 글자들이 반짝이며 흩어졌다.</p>
        <p>주변을 둘러싼 거대한 구조물은 오래된 도서관을 닮은 초대형 아카이브였으며, 도시 전체를 품은 하나의 거대한 지식의 성 같았다.</p>
        <p>하지만 이 미래 도시는 평화로워 보이지 않았다.</p>
        <p>공중 도로 곳곳이 깜빡이며 사라졌다 나타나고, 건물 벽엔 커다란 균열이 생겨 있었다. 하늘에는 붉은 기운이 번져 나가며 도시 전체를 뒤덮고 있었고, 시민들은 두려움으로 얼굴이 하얗게 질린 채 대피하고 있었다.</p>
        <p>루미는 이를 바라보며 낮게 말했다.</p>
        <p><strong>"여기가… 크로노폴리스. 미래의 도서관이자 시간관리 본부야. 하지만… 이미 붕괴가 시작됐어."</strong></p>
      </div>
    </section>

    <!-- Part 2 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_02.jpg">
      <div class="story-card">
        <span class="chapter">Part 2</span>
        <h2>크로노 브레이커스의 진짜 본부</h2>
        <p>아이들은 도시 바닥에 도착하자마자 빛나는 드론 떼에 둘러싸였다.</p>
        <p>그 드론들은 금속이 아니라, 시간 파편을 이어 만든 생체 기계처럼 보였다. 루미는 눈을 크게 뜨며 아이들을 잡아끌어 도시 하부의 비밀 수로로 숨겨진 통로를 찾아 들어갔다.</p>
        <p>그곳에서 아이들은 미래 도서관의 수호자 '아르카(ARCA)'를 만난다.</p>
        <p>아르카는 사람의 몸을 하고 있었지만, 눈동자에는 책 페이지 같은 문양이 떠 있고, 목소리는 기계와 인간 사이 어딘가처럼 들렸다.</p>
        <p><strong>"너희가 가져온 과거 파편 때문에 시간심장이 흔들렸다. 그 틈을 이용해 크로노 브레이커스가 더 강해졌지."</strong></p>
        <p>민준은 당황해 억울하다고 말하려 했으나, 아르카는 이미 상황을 분석한 듯 경고했다.</p>
        <p><strong>"미래는 곧 무너진다. 시간심장은 이제 '붉은 심연(Red Abyss)'에 있다."</strong></p>
        <p>아이들은 이때 비로소 깨닫는다. 크로노 브레이커스는 단순한 악당이 아니라, 과거·현재·미래의 시간 흐름을 모두 통제해 역사 자체를 재구성하려는 위험한 집단이었다.</p>
      </div>
    </section>

    <!-- Part 3 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_03.jpg">
      <div class="story-card">
        <span class="chapter">Part 3</span>
        <h2>시간관리국의 내부 붕괴</h2>
        <p>아르카의 안내로 도착한 미래 도서관 내부는 상상을 뛰어넘는 광경이었다.</p>
        <p>공중에 떠 있는 통로들이 복잡하게 얽혀 있고, 끝없이 이어지는 빛의 책장 속에는 과거·현재·미래의 문서가 동시에 떠다니고 있었다. 기록실마다 서로 다른 시대가 마치 살아 움직이듯 재생되고 있었지만, 그 모든 것 또한 붉게 왜곡되고 있었다.</p>
        <p>기록실의 문서들은 붉은 물결에 잠식되고, 책장 일부에서는 글자들이 폭발하듯 튀어나왔다. 서로 다른 시대들의 장면이 한 공간에 충돌하면서 도서관은 혼란 그 자체였다.</p>
        <p>시간관리국 요원들은 회의 중에도 서로를 불신하며 소리쳤다.</p>
        <p>"시간심장이 도난당하면 현재와 미래는 사라진다!"</p>
        <p>"아이들이 과거 파편을 가져온 게 문제야!"</p>
        <p>"아니야! 크로노 브레이커스가 먼저 움직였어!"</p>
        <p>분열된 미래 요원들 사이에서 아이들을 보는 시선은 차갑고 의심스러웠다.</p>
        <p>루미는 아이들을 감싸며 단호히 말했다.</p>
        <p><strong>"아이들의 잘못만은 아니야. 시간심장은 이미 흔들릴 준비가 되어 있었던 거야."</strong></p>
      </div>
    </section>

    <!-- Part 4 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_04.jpg">
      <div class="story-card">
        <span class="chapter">Part 4</span>
        <h2>미래의 그림자: 타임 리퍼의 과거</h2>
        <p>그때, 도심 중앙에서 검은 바람이 몰아치듯 퍼지더니 타임 리퍼가 모습을 드러냈다.</p>
        <p>그의 얼굴은 절반이 비어 있었다. 마치 책의 페이지가 찢겨 사라진 듯한 공백이었고, 나머지 절반만이 인간의 모습으로 남아 있었다. 그의 발자국마다 시간선이 꺾여 사라지는 기묘한 현상이 나타났다.</p>
        <p>리퍼는 아이들을 차갑게 내려다보며 입을 열었다.</p>
        <p><strong>"나는 원래 시간관리국의 연구원이었지. 세계의 시간을 지키려 했지만… 그들은 시간을 지키는 것이 아니라 '통제'하려 했다."</strong></p>
        <p>루미가 충격에 잠긴 얼굴로 그를 바라보자, 리퍼는 한 마디를 덧붙였다.</p>
        <p><strong>"나는… 루미와 함께 일하던 동료였다."</strong></p>
        <p>그리고 그는 손에 쥔 시간심장을 붉게 빛내며 선언했다.</p>
        <p><strong>"시간을 되돌릴 자는… 나뿐이다."</strong></p>
        <p>말을 마친 리퍼는 어둠 속에 몸을 잠갔다.</p>
      </div>
    </section>

    <!-- Part 5 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_05.jpg">
      <div class="story-card">
        <span class="chapter">Part 5</span>
        <h2>붉은 심연으로 향하는 길</h2>
        <p>아이들은 시간관리국의 내부 장치를 통해 '붉은 심연(Red Abyss)'의 입구를 찾는다.</p>
        <p>붉은 심연은 과거와 미래가 서로 뒤틀려 끝없이 반복되는, 시간의 가장 깊은 심층구역이었다.</p>
        <p>입구에 들어서자 길은 자신들의 발밑에서 사라졌다 다시 생겼다.</p>
        <p>• 옆 방에는 300년 전 풍경이 비치고</p>
        <p>• 아래쪽은 미래 도시가 무너지는 영상이 끝없이 재생되고 있었다</p>
        <p>• 깨진 시계 조각들이 공중에서 떠다니며 또 다른 시간을 비추고</p>
        <p>• 아이들의 그림자는 스스로 다른 움직임을 보였다</p>
        <p>수아는 손에 든 지도를 다시 분석하며 말했다.</p>
        <p><strong>"이곳은… 시간 그 자체가 살아 있어."</strong></p>
        <p>루미도 불안한 목소리로 덧붙였다.</p>
        <p><strong>"리퍼가 이곳에 숨은 이유가 분명 있어."</strong></p>
      </div>
    </section>

    <!-- Part 6 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_06.jpg">
      <div class="story-card">
        <span class="chapter">Part 6</span>
        <h2>붉은 심연의 수호자, 타임 비스트</h2>
        <p>심연 깊숙한 곳에서 땅이 크게 흔들렸고, 어둠 속에서 엄청난 생명체가 등장했다.</p>
        <p>축구장만 한 몸집에, 종이처럼 얇았다가 돌처럼 두껍게 변하는 괴물이 있었다. 그 눈 속에는 과거·현재·미래가 번갈아 번쩍이며 비쳤다.</p>
        <p>'시간을 먹는 괴물(Time Beast)'이었다.</p>
        <p>타임 비스트의 공격은 상상 이상이었다.</p>
        <p>• 공격을 '미래로 먼저 보내' 피할 수 없게 만들고</p>
        <p>• 어떤 공격은 '과거의 움직임'을 끌어와 현재에 발동했으며</p>
        <p>• 아이들의 움직임을 그대로 복제해 반대로 공격해왔다</p>
        <p>태영은 괴물의 움직임을 보며 비명을 질렀다. "야… 이건 반칙이지!"</p>
        <p>민준은 문양을 활성화해 괴물의 시간 흐름을 읽어냈고, 수아는 괴물 몸 곳곳에 있는 '시간 상처'를 찾아 타이밍을 분리해냈다.</p>
        <p>힘겨운 전투 끝에 괴물은 사라졌고, 그 자리에는 거대한 문 하나가 떠올랐다.</p>
        <p>문에는 단 한 문장이 새겨져 있었다.</p>
        <p><strong>〈TIME CORE / 시간심장〉</strong></p>
      </div>
    </section>

    <!-- Part 7 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_07.jpg">
      <div class="story-card">
        <span class="chapter">Part 7</span>
        <h2>시간심장 회수… 하지만 드러난 진실</h2>
        <p>문을 열고 아이들은 마침내 시간심장을 찾았다.</p>
        <p>수백 개의 문서가 겹겹이 겹쳐 하나의 심장처럼 움직이는 형태였고, 파란빛이 뛰는 순간 아이들은 마치 숨이 막히는 듯한 압력을 느꼈다.</p>
        <p>그 순간, 리퍼가 나타났다.</p>
        <p><strong>"드디어… 돌려받는군."</strong></p>
        <p>그리고 그는 충격적인 진실을 언급했다.</p>
        <p><strong>"시간심장은 원래 나의 것이다."</strong></p>
        <p>루미가 외쳤다. "그건 거짓말이야! 리퍼, 넌—"</p>
        <p>하지만 리퍼는 시간을 멈추고 아이들에게 자신의 과거를 보여준다.</p>
        <p>• 시간관리국이 시간 통제를 위해 실험을 반복했고</p>
        <p>• 리퍼는 이를 막기 위해 시간심장을 연구하다</p>
        <p>• 사고로 절반이 지워지는 존재가 되었으며</p>
        <p>• 시간관리국은 그를 버렸고</p>
        <p>• 그는 자신과 같은 이들을 모아 크로노 브레이커스를 만들었다</p>
        <p>아이들은 충격과 혼란에 빠졌다.</p>
      </div>
    </section>

    <!-- Part 8 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_08.jpg">
      <div class="story-card">
        <span class="chapter">Part 8</span>
        <h2>미래의 멸망이 시작되다</h2>
        <p>리퍼는 시간심장을 손에 넣은 순간, 미래 도시 전체가 뒤흔들렸다.</p>
        <p>하늘이 붉게 찢어지고, 도서관은 종이처럼 접히며 사라졌다 나타났다. 시간관리국 건물들은 순서 없이 무너졌다 다시 재생되는 괴상한 시간 루프에 빠져들었다.</p>
        <p>시민들은 같은 하루를 반복하며 고통에 갇혔고, 과거와 미래의 문들이 무작위로 열려 도시 곳곳에 충돌을 일으켰다.</p>
        <p>미래 도서관의 수호 장치까지 붉게 타오르며 작동을 멈추었다.</p>
        <p>아르카가 외쳤다.</p>
        <p><strong>"시간심장이 오염됐어! 세계 전체가 붕괴하고 있어!"</strong></p>
        <p>민준은 리퍼를 향해 한 걸음 나아가며 말했다.</p>
        <p><strong>"시간은 누구의 소유도 아니야! 모두가 함께 지켜야 해!"</strong></p>
        <p>그러자 리퍼는 비웃듯 고개를 저었다.</p>
        <p><strong>"너희 같은 아이들에게 시간을 맡기라고? 나는… 모든 것을 되돌릴 수 있어."</strong></p>
      </div>
    </section>

    <!-- Part 9 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_09.jpg">
      <div class="story-card">
        <span class="chapter">Part 9</span>
        <h2>최종 전투: 리퍼 vs 아이들</h2>
        <p>붉은 심연의 중심에서 마지막 전투가 시작됐다.</p>
        <p>시간은 멈추었다가, 역전되었다가, 수천 장면이 동시에 펼쳐지며 현실이 무너져 내렸다.</p>
        <p><strong>■ 1단계: 시간 역행 전투</strong></p>
        <p>리퍼는 '과거의 공격'을 불러오고 '미래 공격'을 미리 보내 아이들의 예측을 무력화했다.</p>
        <p>그러나 아이들은 각자 문양을 더욱 깊게 깨우며 능력을 강화했다.</p>
        <p>• 민준: 미래 예지 능력 각성</p>
        <p>• 수아: 시간 분석 강화</p>
        <p>• 태영: 시간 결속력 증가, 방어력 폭발적 강화</p>
        <p><strong>■ 2단계: 세계 붕괴 전투</strong></p>
        <p>리퍼가 시간심장을 붉게 오염시키자 전장은 완전히 무너졌다. 거대한 책장산이 떨어지고, 과거의 전쟁 장면이 현실로 튀어나오고, 붉은 시간문들이 폭발하며 주변을 끌어당겼다.</p>
        <p>아이들은 서로를 지키며 끝까지 버텼다.</p>
        <p><strong>■ 3단계: 마지막 선택</strong></p>
        <p>리퍼는 아이들을 거의 압도하며 말했다. "시간은… 나에게 돌아와야 한다."</p>
        <p>그때, 시간심장 속에서 작은 금빛 파편이 떨어졌다. 민준은 본능적으로 그 파편을 잡았다.</p>
        <p>그리고 리퍼에게 손을 내밀었다.</p>
        <p><strong>"당신도… 지워진 시간 속에서 외로웠던 거죠?"</strong></p>
        <p>수아도 말한다. "당신이 잃은 건, 시간심장이 아니라… 마음이에요."</p>
        <p>태영이 마지막으로 덧붙였다. "우리가… 함께 되돌리자!"</p>
        <p>리퍼의 붉은빛이 흔들리며 약해졌다.</p>
      </div>
    </section>

    <!-- Part 10 -->
    <section class="story-section" data-bg="/images/time-library-story/time_part3_10.jpg">
      <div class="story-card">
        <span class="chapter">Part 10</span>
        <h2>정화, 그리고 새로운 시간의 시작</h2>
        <p>금빛 파편이 리퍼의 가슴 속으로 들어가자, 붉은 심연 전체가 부드러운 파란빛으로 물들기 시작했다.</p>
        <p>지워졌던 그의 얼굴이 서서히 복원되고, 붉은 왜곡은 사라지고, 미래 도시의 균열이 하나씩 봉합되었다.</p>
        <p>시민들은 루프에서 해방되고, 미래 도서관의 모든 기록도 복구되었다.</p>
        <p>과거·현재·미래가 각자의 자리로 돌아왔다.</p>
        <p>리퍼는 마지막으로 아이들을 바라보며 말했다.</p>
        <p><strong>"이제… 시간은 내 것이 아니다. 너희가… 진짜 수호자다."</strong></p>
        <p>그리고 그는 파란빛 먼지가 되어 사라졌다.</p>
        <p>시간심장은 본래 자리로 돌아가며 미래 도서관은 천천히 재구성되었다.</p>
        <p>루미는 눈가를 적시며 말했다. "정말… 해냈어."</p>
        <p>아르카도 조용히 선언했다.</p>
        <p><strong>"이제부터 시간은, 아이들의 선택에 의해 기록된다."</strong></p>
        <p>마지막 장면. 아이들은 미래 도서관 꼭대기에서 파란빛으로 살아나는 크로노폴리스를 내려다본다.</p>
        <p>민준이 미소 지으며 말했다.</p>
        <p><strong>"이제… 우리 시대를 지키러 가자."</strong></p>
      </div>
    </section>
  </div>

  <!-- 스크롤 인디케이터 -->
  <div class="scroll-indicator">
    <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24">
      <path d="M12 4l-8 8h6v8h4v-8h6z"/>
    </svg>
  </div>

  <!-- 네비게이션 버튼 -->
  <div class="nav-buttons">
    <button class="nav-btn" onclick="window.location.href='/menu.html'">← 메인으로</button>
  </div>

  <script>
    // 스크롤 기반 배경 이미지 변경
    const sections = document.querySelectorAll('.story-section');
    const mapContainer = document.getElementById('map-container');
    const scrollIndicator = document.querySelector('.scroll-indicator');

    let currentBg = '';

    function updateBackground() {
      const scrollPos = window.scrollY + window.innerHeight / 2;

      sections.forEach((section, index) => {
        const rect = section.getBoundingClientRect();
        const sectionTop = window.scrollY + rect.top;
        const sectionBottom = sectionTop + rect.height;

        // 섹션이 화면 중앙에 있을 때
        if (scrollPos >= sectionTop && scrollPos < sectionBottom) {
          const bgImage = section.dataset.bg;
          if (bgImage && bgImage !== currentBg) {
            currentBg = bgImage;
            mapContainer.style.backgroundImage = `url(${bgImage})`;
          }

          // 카드 활성화
          const card = section.querySelector('.story-card');
          if (card && !card.classList.contains('active')) {
            card.classList.add('active');
          }
        }
      });

      // 스크롤 인디케이터 숨기기
      if (window.scrollY > 100) {
        scrollIndicator.style.opacity = '0';
      } else {
        scrollIndicator.style.opacity = '0.7';
      }
    }

    // 초기 로드
    window.addEventListener('load', () => {
      updateBackground();
      // 첫 번째 카드는 바로 표시
      const firstCard = sections[0].querySelector('.story-card');
      if (firstCard) {
        firstCard.classList.add('active');
      }
    });

    // 스크롤 이벤트
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateBackground();
          ticking = false;
        });
        ticking = true;
      }
    });
  </script>
</body>
</html>
